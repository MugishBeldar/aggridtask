/*! For license information please see main.7a79c6d3.js.LICENSE.txt */
(()=>{"use strict";var e={4:(e,t,i)=>{var r=i(853),n=i(43),o=i(950);function s(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var i=2;i<arguments.length;i++)t+="&args[]="+encodeURIComponent(arguments[i])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}var l=Symbol.for("react.element"),c=Symbol.for("react.transitional.element"),u=Symbol.for("react.portal"),d=Symbol.for("react.fragment"),h=Symbol.for("react.strict_mode"),g=Symbol.for("react.profiler"),p=Symbol.for("react.provider"),f=Symbol.for("react.consumer"),m=Symbol.for("react.context"),v=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),w=Symbol.for("react.suspense_list"),b=Symbol.for("react.memo"),S=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var y=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.tracing_marker");var R=Symbol.for("react.memo_cache_sentinel"),E=Symbol.iterator;function x(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=E&&e[E]||e["@@iterator"])?e:null}var T=Symbol.for("react.client.reference");function F(e){if(null==e)return null;if("function"===typeof e)return e.$$typeof===T?null:e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case d:return"Fragment";case u:return"Portal";case g:return"Profiler";case h:return"StrictMode";case C:return"Suspense";case w:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case m:return(e.displayName||"Context")+".Provider";case f:return(e._context.displayName||"Context")+".Consumer";case v:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case b:return null!==(t=e.displayName||null)?t:F(e.type)||"Memo";case S:t=e._payload,e=e._init;try{return F(e(t))}catch(i){}}return null}var P,D,k=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,A=Object.assign;function M(e){if(void 0===P)try{throw Error()}catch(i){var t=i.stack.trim().match(/\n( *(at )?)/);P=t&&t[1]||"",D=-1<i.stack.indexOf("\n    at")?" (<anonymous>)":-1<i.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+P+e+D}var I=!1;function L(e,t){if(!e||I)return"";I=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var r={DetermineComponentFrameRoot:function(){try{if(t){var i=function(){throw Error()};if(Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(i,[])}catch(n){var r=n}Reflect.construct(e,[],i)}else{try{i.call()}catch(o){r=o}e.call(i.prototype)}}else{try{throw Error()}catch(s){r=s}(i=e())&&"function"===typeof i.catch&&i.catch((function(){}))}}catch(a){if(a&&r&&"string"===typeof a.stack)return[a.stack,r.stack]}return[null,null]}};r.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var n=Object.getOwnPropertyDescriptor(r.DetermineComponentFrameRoot,"name");n&&n.configurable&&Object.defineProperty(r.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var o=r.DetermineComponentFrameRoot(),s=o[0],a=o[1];if(s&&a){var l=s.split("\n"),c=a.split("\n");for(n=r=0;r<l.length&&!l[r].includes("DetermineComponentFrameRoot");)r++;for(;n<c.length&&!c[n].includes("DetermineComponentFrameRoot");)n++;if(r===l.length||n===c.length)for(r=l.length-1,n=c.length-1;1<=r&&0<=n&&l[r]!==c[n];)n--;for(;1<=r&&0<=n;r--,n--)if(l[r]!==c[n]){if(1!==r||1!==n)do{if(r--,0>--n||l[r]!==c[n]){var u="\n"+l[r].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=r&&0<=n);break}}}finally{I=!1,Error.prepareStackTrace=i}return(i=e?e.displayName||e.name:"")?M(i):""}function O(e){switch(e.tag){case 26:case 27:case 5:return M(e.type);case 16:return M("Lazy");case 13:return M("Suspense");case 19:return M("SuspenseList");case 0:case 15:return e=L(e.type,!1);case 11:return e=L(e.type.render,!1);case 1:return e=L(e.type,!0);default:return""}}function N(e){try{var t="";do{t+=O(e),e=e.return}while(e);return t}catch(i){return"\nError generating stack: "+i.message+"\n"+i.stack}}function B(e){var t=e,i=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(i=t.return),e=t.return}while(e)}return 3===t.tag?i:null}function G(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function H(e){if(B(e)!==e)throw Error(s(188))}function z(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=z(e)))return t;e=e.sibling}return null}var V=Array.isArray,_=o.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,W={pending:!1,data:null,method:null,action:null},U=[],j=-1;function K(e){return{current:e}}function Y(e){0>j||(e.current=U[j],U[j]=null,j--)}function q(e,t){j++,U[j]=e.current,e.current=t}var Q=K(null),$=K(null),X=K(null),J=K(null);function Z(e,t){switch(q(X,t),q($,e),q(Q,null),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)&&(t=t.namespaceURI)?$u(t):0;break;default:if(t=(e=8===e?t.parentNode:t).tagName,e=e.namespaceURI)t=Xu(e=$u(e),t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}Y(Q),q(Q,t)}function ee(){Y(Q),Y($),Y(X)}function te(e){null!==e.memoizedState&&q(J,e);var t=Q.current,i=Xu(t,e.type);t!==i&&(q($,e),q(Q,i))}function ie(e){$.current===e&&(Y(Q),Y($)),J.current===e&&(Y(J),Nd._currentValue=W)}var re=Object.prototype.hasOwnProperty,ne=r.unstable_scheduleCallback,oe=r.unstable_cancelCallback,se=r.unstable_shouldYield,ae=r.unstable_requestPaint,le=r.unstable_now,ce=r.unstable_getCurrentPriorityLevel,ue=r.unstable_ImmediatePriority,de=r.unstable_UserBlockingPriority,he=r.unstable_NormalPriority,ge=r.unstable_LowPriority,pe=r.unstable_IdlePriority,fe=r.log,me=r.unstable_setDisableYieldValue,ve=null,Ce=null;function we(e){if("function"===typeof fe&&me(e),Ce&&"function"===typeof Ce.setStrictMode)try{Ce.setStrictMode(ve,e)}catch(t){}}var be=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(Se(e)/ye|0)|0},Se=Math.log,ye=Math.LN2;var Re=128,Ee=4194304;function xe(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194176&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Te(e,t){var i=e.pendingLanes;if(0===i)return 0;var r=0,n=e.suspendedLanes,o=e.pingedLanes,s=e.warmLanes;e=0!==e.finishedLanes;var a=134217727&i;return 0!==a?0!==(i=a&~n)?r=xe(i):0!==(o&=a)?r=xe(o):e||0!==(s=a&~s)&&(r=xe(s)):0!==(a=i&~n)?r=xe(a):0!==o?r=xe(o):e||0!==(s=i&~s)&&(r=xe(s)),0===r?0:0!==t&&t!==r&&0===(t&n)&&((n=r&-r)>=(s=t&-t)||32===n&&0!==(4194176&s))?t:r}function Fe(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function Pe(e,t){switch(e){case 1:case 2:case 4:case 8:return t+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function De(){var e=Re;return 0===(4194176&(Re<<=1))&&(Re=128),e}function ke(){var e=Ee;return 0===(62914560&(Ee<<=1))&&(Ee=4194304),e}function Ae(e){for(var t=[],i=0;31>i;i++)t.push(e);return t}function Me(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Ie(e,t,i){e.pendingLanes|=t,e.suspendedLanes&=~t;var r=31-be(t);e.entangledLanes|=t,e.entanglements[r]=1073741824|e.entanglements[r]|4194218&i}function Le(e,t){var i=e.entangledLanes|=t;for(e=e.entanglements;i;){var r=31-be(i),n=1<<r;n&t|e[r]&t&&(e[r]|=t),i&=~n}}function Oe(e){return 2<(e&=-e)?8<e?0!==(134217727&e)?32:268435456:8:2}function Ne(){var e=_.p;return 0!==e?e:void 0===(e=window.event)?32:Xd(e.type)}var Be=Math.random().toString(36).slice(2),Ge="__reactFiber$"+Be,He="__reactProps$"+Be,ze="__reactContainer$"+Be,Ve="__reactEvents$"+Be,_e="__reactListeners$"+Be,We="__reactHandles$"+Be,Ue="__reactResources$"+Be,je="__reactMarker$"+Be;function Ke(e){delete e[Ge],delete e[He],delete e[Ve],delete e[_e],delete e[We]}function Ye(e){var t=e[Ge];if(t)return t;for(var i=e.parentNode;i;){if(t=i[ze]||i[Ge]){if(i=t.alternate,null!==t.child||null!==i&&null!==i.child)for(e=ld(e);null!==e;){if(i=e[Ge])return i;e=ld(e)}return t}i=(e=i).parentNode}return null}function qe(e){if(e=e[Ge]||e[ze]){var t=e.tag;if(5===t||6===t||13===t||26===t||27===t||3===t)return e}return null}function Qe(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(s(33))}function $e(e){var t=e[Ue];return t||(t=e[Ue]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function Xe(e){e[je]=!0}var Je=new Set,Ze={};function et(e,t){tt(e,t),tt(e+"Capture",t)}function tt(e,t){for(Ze[e]=t,e=0;e<t.length;e++)Je.add(t[e])}var it=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),rt=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),nt={},ot={};function st(e,t,i){if(n=t,re.call(ot,n)||!re.call(nt,n)&&(rt.test(n)?ot[n]=!0:(nt[n]=!0,0)))if(null===i)e.removeAttribute(t);else{switch(typeof i){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var r=t.toLowerCase().slice(0,5);if("data-"!==r&&"aria-"!==r)return void e.removeAttribute(t)}e.setAttribute(t,""+i)}var n}function at(e,t,i){if(null===i)e.removeAttribute(t);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+i)}}function lt(e,t,i,r){if(null===r)e.removeAttribute(i);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(i)}e.setAttributeNS(t,i,""+r)}}function ct(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function ut(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function dt(e){e._valueTracker||(e._valueTracker=function(e){var t=ut(e)?"checked":"value",i=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof i&&"function"===typeof i.get&&"function"===typeof i.set){var n=i.get,o=i.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return n.call(this)},set:function(e){r=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:i.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function ht(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var i=t.getValue(),r="";return e&&(r=ut(e)?e.checked?"true":"false":e.value),(e=r)!==i&&(t.setValue(e),!0)}function gt(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var pt=/[\n"\\]/g;function ft(e){return e.replace(pt,(function(e){return"\\"+e.charCodeAt(0).toString(16)+" "}))}function mt(e,t,i,r,n,o,s,a){e.name="",null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s?e.type=s:e.removeAttribute("type"),null!=t?"number"===s?(0===t&&""===e.value||e.value!=t)&&(e.value=""+ct(t)):e.value!==""+ct(t)&&(e.value=""+ct(t)):"submit"!==s&&"reset"!==s||e.removeAttribute("value"),null!=t?Ct(e,s,ct(t)):null!=i?Ct(e,s,ct(i)):null!=r&&e.removeAttribute("value"),null==n&&null!=o&&(e.defaultChecked=!!o),null!=n&&(e.checked=n&&"function"!==typeof n&&"symbol"!==typeof n),null!=a&&"function"!==typeof a&&"symbol"!==typeof a&&"boolean"!==typeof a?e.name=""+ct(a):e.removeAttribute("name")}function vt(e,t,i,r,n,o,s,a){if(null!=o&&"function"!==typeof o&&"symbol"!==typeof o&&"boolean"!==typeof o&&(e.type=o),null!=t||null!=i){if(!("submit"!==o&&"reset"!==o||void 0!==t&&null!==t))return;i=null!=i?""+ct(i):"",t=null!=t?""+ct(t):i,a||t===e.value||(e.value=t),e.defaultValue=t}r="function"!==typeof(r=null!=r?r:n)&&"symbol"!==typeof r&&!!r,e.checked=a?e.checked:!!r,e.defaultChecked=!!r,null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s&&(e.name=s)}function Ct(e,t,i){"number"===t&&gt(e.ownerDocument)===e||e.defaultValue===""+i||(e.defaultValue=""+i)}function wt(e,t,i,r){if(e=e.options,t){t={};for(var n=0;n<i.length;n++)t["$"+i[n]]=!0;for(i=0;i<e.length;i++)n=t.hasOwnProperty("$"+e[i].value),e[i].selected!==n&&(e[i].selected=n),n&&r&&(e[i].defaultSelected=!0)}else{for(i=""+ct(i),t=null,n=0;n<e.length;n++){if(e[n].value===i)return e[n].selected=!0,void(r&&(e[n].defaultSelected=!0));null!==t||e[n].disabled||(t=e[n])}null!==t&&(t.selected=!0)}}function bt(e,t,i){null==t||((t=""+ct(t))!==e.value&&(e.value=t),null!=i)?e.defaultValue=null!=i?""+ct(i):"":e.defaultValue!==t&&(e.defaultValue=t)}function St(e,t,i,r){if(null==t){if(null!=r){if(null!=i)throw Error(s(92));if(V(r)){if(1<r.length)throw Error(s(93));r=r[0]}i=r}null==i&&(i=""),t=i}i=ct(t),e.defaultValue=i,(r=e.textContent)===i&&""!==r&&null!==r&&(e.value=r)}function yt(e,t){if(t){var i=e.firstChild;if(i&&i===e.lastChild&&3===i.nodeType)return void(i.nodeValue=t)}e.textContent=t}var Rt=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Et(e,t,i){var r=0===t.indexOf("--");null==i||"boolean"===typeof i||""===i?r?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":r?e.setProperty(t,i):"number"!==typeof i||0===i||Rt.has(t)?"float"===t?e.cssFloat=i:e[t]=(""+i).trim():e[t]=i+"px"}function xt(e,t,i){if(null!=t&&"object"!==typeof t)throw Error(s(62));if(e=e.style,null!=i){for(var r in i)!i.hasOwnProperty(r)||null!=t&&t.hasOwnProperty(r)||(0===r.indexOf("--")?e.setProperty(r,""):"float"===r?e.cssFloat="":e[r]="");for(var n in t)r=t[n],t.hasOwnProperty(n)&&i[n]!==r&&Et(e,n,r)}else for(var o in t)t.hasOwnProperty(o)&&Et(e,o,t[o])}function Tt(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ft=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Pt=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Dt(e){return Pt.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var kt=null;function At(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Mt=null,It=null;function Lt(e){var t=qe(e);if(t&&(e=t.stateNode)){var i=e[He]||null;e:switch(e=t.stateNode,t.type){case"input":if(mt(e,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name),t=i.name,"radio"===i.type&&null!=t){for(i=e;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll('input[name="'+ft(""+t)+'"][type="radio"]'),t=0;t<i.length;t++){var r=i[t];if(r!==e&&r.form===e.form){var n=r[He]||null;if(!n)throw Error(s(90));mt(r,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name)}}for(t=0;t<i.length;t++)(r=i[t]).form===e.form&&ht(r)}break e;case"textarea":bt(e,i.value,i.defaultValue);break e;case"select":null!=(t=i.value)&&wt(e,!!i.multiple,t,!1)}}}var Ot=!1;function Nt(e,t,i){if(Ot)return e(t,i);Ot=!0;try{return e(t)}finally{if(Ot=!1,(null!==Mt||null!==It)&&(Gc(),Mt&&(t=Mt,e=It,It=Mt=null,Lt(t),e)))for(t=0;t<e.length;t++)Lt(e[t])}}function Bt(e,t){var i=e.stateNode;if(null===i)return null;var r=i[He]||null;if(null===r)return null;i=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(i&&"function"!==typeof i)throw Error(s(231,t,typeof i));return i}var Gt=!1;if(it)try{var Ht={};Object.defineProperty(Ht,"passive",{get:function(){Gt=!0}}),window.addEventListener("test",Ht,Ht),window.removeEventListener("test",Ht,Ht)}catch(Sh){Gt=!1}var zt=null,Vt=null,_t=null;function Wt(){if(_t)return _t;var e,t,i=Vt,r=i.length,n="value"in zt?zt.value:zt.textContent,o=n.length;for(e=0;e<r&&i[e]===n[e];e++);var s=r-e;for(t=1;t<=s&&i[r-t]===n[o-t];t++);return _t=n.slice(e,1<t?1-t:void 0)}function Ut(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function jt(){return!0}function Kt(){return!1}function Yt(e){function t(t,i,r,n,o){for(var s in this._reactName=t,this._targetInst=r,this.type=i,this.nativeEvent=n,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(n):n[s]);return this.isDefaultPrevented=(null!=n.defaultPrevented?n.defaultPrevented:!1===n.returnValue)?jt:Kt,this.isPropagationStopped=Kt,this}return A(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=jt)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=jt)},persist:function(){},isPersistent:jt}),t}var qt,Qt,$t,Xt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Jt=Yt(Xt),Zt=A({},Xt,{view:0,detail:0}),ei=Yt(Zt),ti=A({},Zt,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:hi,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==$t&&($t&&"mousemove"===e.type?(qt=e.screenX-$t.screenX,Qt=e.screenY-$t.screenY):Qt=qt=0,$t=e),qt)},movementY:function(e){return"movementY"in e?e.movementY:Qt}}),ii=Yt(ti),ri=Yt(A({},ti,{dataTransfer:0})),ni=Yt(A({},Zt,{relatedTarget:0})),oi=Yt(A({},Xt,{animationName:0,elapsedTime:0,pseudoElement:0})),si=Yt(A({},Xt,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),ai=Yt(A({},Xt,{data:0})),li={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ci={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ui={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function di(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=ui[e])&&!!t[e]}function hi(){return di}var gi=Yt(A({},Zt,{key:function(e){if(e.key){var t=li[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Ut(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?ci[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:hi,charCode:function(e){return"keypress"===e.type?Ut(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Ut(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),pi=Yt(A({},ti,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),fi=Yt(A({},Zt,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:hi})),mi=Yt(A({},Xt,{propertyName:0,elapsedTime:0,pseudoElement:0})),vi=Yt(A({},ti,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),Ci=Yt(A({},Xt,{newState:0,oldState:0})),wi=[9,13,27,32],bi=it&&"CompositionEvent"in window,Si=null;it&&"documentMode"in document&&(Si=document.documentMode);var yi=it&&"TextEvent"in window&&!Si,Ri=it&&(!bi||Si&&8<Si&&11>=Si),Ei=String.fromCharCode(32),xi=!1;function Ti(e,t){switch(e){case"keyup":return-1!==wi.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Fi(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Pi=!1;var Di={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ki(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Di[e.type]:"textarea"===t}function Ai(e,t,i,r){Mt?It?It.push(r):It=[r]:Mt=r,0<(t=Nu(t,"onChange")).length&&(i=new Jt("onChange","change",null,i,r),e.push({event:i,listeners:t}))}var Mi=null,Ii=null;function Li(e){Pu(e,0)}function Oi(e){if(ht(Qe(e)))return e}function Ni(e,t){if("change"===e)return t}var Bi=!1;if(it){var Gi;if(it){var Hi="oninput"in document;if(!Hi){var zi=document.createElement("div");zi.setAttribute("oninput","return;"),Hi="function"===typeof zi.oninput}Gi=Hi}else Gi=!1;Bi=Gi&&(!document.documentMode||9<document.documentMode)}function Vi(){Mi&&(Mi.detachEvent("onpropertychange",_i),Ii=Mi=null)}function _i(e){if("value"===e.propertyName&&Oi(Ii)){var t=[];Ai(t,Ii,e,At(e)),Nt(Li,t)}}function Wi(e,t,i){"focusin"===e?(Vi(),Ii=i,(Mi=t).attachEvent("onpropertychange",_i)):"focusout"===e&&Vi()}function Ui(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Oi(Ii)}function ji(e,t){if("click"===e)return Oi(t)}function Ki(e,t){if("input"===e||"change"===e)return Oi(t)}var Yi="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function qi(e,t){if(Yi(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var i=Object.keys(e),r=Object.keys(t);if(i.length!==r.length)return!1;for(r=0;r<i.length;r++){var n=i[r];if(!re.call(t,n)||!Yi(e[n],t[n]))return!1}return!0}function Qi(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function $i(e,t){var i,r=Qi(e);for(e=0;r;){if(3===r.nodeType){if(i=e+r.textContent.length,e<=t&&i>=t)return{node:r,offset:t-e};e=i}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Qi(r)}}function Xi(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?Xi(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function Ji(e){for(var t=gt((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var i="string"===typeof t.contentWindow.location.href}catch(r){i=!1}if(!i)break;t=gt((e=t.contentWindow).document)}return t}function Zi(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function er(e,t){var i=Ji(t);t=e.focusedElem;var r=e.selectionRange;if(i!==t&&t&&t.ownerDocument&&Xi(t.ownerDocument.documentElement,t)){if(null!==r&&Zi(t))if(e=r.start,void 0===(i=r.end)&&(i=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(i,t.value.length);else if((i=(e=t.ownerDocument||document)&&e.defaultView||window).getSelection){i=i.getSelection();var n=t.textContent.length,o=Math.min(r.start,n);r=void 0===r.end?o:Math.min(r.end,n),!i.extend&&o>r&&(n=r,r=o,o=n),n=$i(t,o);var s=$i(t,r);n&&s&&(1!==i.rangeCount||i.anchorNode!==n.node||i.anchorOffset!==n.offset||i.focusNode!==s.node||i.focusOffset!==s.offset)&&((e=e.createRange()).setStart(n.node,n.offset),i.removeAllRanges(),o>r?(i.addRange(e),i.extend(s.node,s.offset)):(e.setEnd(s.node,s.offset),i.addRange(e)))}for(e=[],i=t;i=i.parentNode;)1===i.nodeType&&e.push({element:i,left:i.scrollLeft,top:i.scrollTop});for("function"===typeof t.focus&&t.focus(),t=0;t<e.length;t++)(i=e[t]).element.scrollLeft=i.left,i.element.scrollTop=i.top}}var tr=it&&"documentMode"in document&&11>=document.documentMode,ir=null,rr=null,nr=null,or=!1;function sr(e,t,i){var r=i.window===i?i.document:9===i.nodeType?i:i.ownerDocument;or||null==ir||ir!==gt(r)||("selectionStart"in(r=ir)&&Zi(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},nr&&qi(nr,r)||(nr=r,0<(r=Nu(rr,"onSelect")).length&&(t=new Jt("onSelect","select",null,t,i),e.push({event:t,listeners:r}),t.target=ir)))}function ar(e,t){var i={};return i[e.toLowerCase()]=t.toLowerCase(),i["Webkit"+e]="webkit"+t,i["Moz"+e]="moz"+t,i}var lr={animationend:ar("Animation","AnimationEnd"),animationiteration:ar("Animation","AnimationIteration"),animationstart:ar("Animation","AnimationStart"),transitionrun:ar("Transition","TransitionRun"),transitionstart:ar("Transition","TransitionStart"),transitioncancel:ar("Transition","TransitionCancel"),transitionend:ar("Transition","TransitionEnd")},cr={},ur={};function dr(e){if(cr[e])return cr[e];if(!lr[e])return e;var t,i=lr[e];for(t in i)if(i.hasOwnProperty(t)&&t in ur)return cr[e]=i[t];return e}it&&(ur=document.createElement("div").style,"AnimationEvent"in window||(delete lr.animationend.animation,delete lr.animationiteration.animation,delete lr.animationstart.animation),"TransitionEvent"in window||delete lr.transitionend.transition);var hr=dr("animationend"),gr=dr("animationiteration"),pr=dr("animationstart"),fr=dr("transitionrun"),mr=dr("transitionstart"),vr=dr("transitioncancel"),Cr=dr("transitionend"),wr=new Map,br="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll scrollEnd toggle touchMove waiting wheel".split(" ");function Sr(e,t){wr.set(e,t),et(t,[e])}var yr=[],Rr=0,Er=0;function xr(){for(var e=Rr,t=Er=Rr=0;t<e;){var i=yr[t];yr[t++]=null;var r=yr[t];yr[t++]=null;var n=yr[t];yr[t++]=null;var o=yr[t];if(yr[t++]=null,null!==r&&null!==n){var s=r.pending;null===s?n.next=n:(n.next=s.next,s.next=n),r.pending=n}0!==o&&Dr(i,n,o)}}function Tr(e,t,i,r){yr[Rr++]=e,yr[Rr++]=t,yr[Rr++]=i,yr[Rr++]=r,Er|=r,e.lanes|=r,null!==(e=e.alternate)&&(e.lanes|=r)}function Fr(e,t,i,r){return Tr(e,t,i,r),kr(e)}function Pr(e,t){return Tr(e,null,null,t),kr(e)}function Dr(e,t,i){e.lanes|=i;var r=e.alternate;null!==r&&(r.lanes|=i);for(var n=!1,o=e.return;null!==o;)o.childLanes|=i,null!==(r=o.alternate)&&(r.childLanes|=i),22===o.tag&&(null===(e=o.stateNode)||1&e._visibility||(n=!0)),e=o,o=o.return;n&&null!==t&&3===e.tag&&(o=e.stateNode,n=31-be(i),null===(e=(o=o.hiddenUpdates)[n])?o[n]=[t]:e.push(t),t.lane=536870912|i)}function kr(e){if(50<Pc)throw Pc=0,Dc=null,Error(s(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var Ar={},Mr=new WeakMap;function Ir(e,t){if("object"===typeof e&&null!==e){var i=Mr.get(e);return void 0!==i?i:(t={value:e,source:t,stack:N(t)},Mr.set(e,t),t)}return{value:e,source:t,stack:N(t)}}var Lr=[],Or=0,Nr=null,Br=0,Gr=[],Hr=0,zr=null,Vr=1,_r="";function Wr(e,t){Lr[Or++]=Br,Lr[Or++]=Nr,Nr=e,Br=t}function Ur(e,t,i){Gr[Hr++]=Vr,Gr[Hr++]=_r,Gr[Hr++]=zr,zr=e;var r=Vr;e=_r;var n=32-be(r)-1;r&=~(1<<n),i+=1;var o=32-be(t)+n;if(30<o){var s=n-n%5;o=(r&(1<<s)-1).toString(32),r>>=s,n-=s,Vr=1<<32-be(t)+n|i<<n|r,_r=o+e}else Vr=1<<o|i<<n|r,_r=e}function jr(e){null!==e.return&&(Wr(e,1),Ur(e,1,0))}function Kr(e){for(;e===Nr;)Nr=Lr[--Or],Lr[Or]=null,Br=Lr[--Or],Lr[Or]=null;for(;e===zr;)zr=Gr[--Hr],Gr[Hr]=null,_r=Gr[--Hr],Gr[Hr]=null,Vr=Gr[--Hr],Gr[Hr]=null}var Yr=null,qr=null,Qr=!1,$r=null,Xr=!1,Jr=Error(s(519));function Zr(e){throw on(Ir(Error(s(418,"")),e)),Jr}function en(e){var t=e.stateNode,i=e.type,r=e.memoizedProps;switch(t[Ge]=e,t[He]=r,i){case"dialog":Du("cancel",t),Du("close",t);break;case"iframe":case"object":case"embed":Du("load",t);break;case"video":case"audio":for(i=0;i<Tu.length;i++)Du(Tu[i],t);break;case"source":Du("error",t);break;case"img":case"image":case"link":Du("error",t),Du("load",t);break;case"details":Du("toggle",t);break;case"input":Du("invalid",t),vt(t,r.value,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name,!0),dt(t);break;case"select":Du("invalid",t);break;case"textarea":Du("invalid",t),St(t,r.value,r.defaultValue,r.children),dt(t)}"string"!==typeof(i=r.children)&&"number"!==typeof i&&"bigint"!==typeof i||t.textContent===""+i||!0===r.suppressHydrationWarning||_u(t.textContent,i)?(null!=r.popover&&(Du("beforetoggle",t),Du("toggle",t)),null!=r.onScroll&&Du("scroll",t),null!=r.onScrollEnd&&Du("scrollend",t),null!=r.onClick&&(t.onclick=Wu),t=!0):t=!1,t||Zr(e)}function tn(e){for(Yr=e.return;Yr;)switch(Yr.tag){case 3:case 27:return void(Xr=!0);case 5:case 13:return void(Xr=!1);default:Yr=Yr.return}}function rn(e){if(e!==Yr)return!1;if(!Qr)return tn(e),Qr=!0,!1;var t,i=!1;if((t=3!==e.tag&&27!==e.tag)&&((t=5===e.tag)&&(t=!("form"!==(t=e.type)&&"button"!==t)||Ju(e.type,e.memoizedProps)),t=!t),t&&(i=!0),i&&qr&&Zr(e),tn(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,i=0;e;){if(8===e.nodeType)if("/$"===(t=e.data)){if(0===i){qr=ad(e.nextSibling);break e}i--}else"$"!==t&&"$!"!==t&&"$?"!==t||i++;e=e.nextSibling}qr=null}}else qr=Yr?ad(e.stateNode.nextSibling):null;return!0}function nn(){qr=Yr=null,Qr=!1}function on(e){null===$r?$r=[e]:$r.push(e)}var sn=Error(s(460)),an=Error(s(474)),ln={then:function(){}};function cn(e){return"fulfilled"===(e=e.status)||"rejected"===e}function un(){}function dn(e,t,i){switch(void 0===(i=e[i])?e.push(t):i!==t&&(t.then(un,un),t=i),t.status){case"fulfilled":return t.value;case"rejected":if((e=t.reason)===sn)throw Error(s(483));throw e;default:if("string"===typeof t.status)t.then(un,un);else{if(null!==(e=tc)&&100<e.shellSuspendCounter)throw Error(s(482));(e=t).status="pending",e.then((function(e){if("pending"===t.status){var i=t;i.status="fulfilled",i.value=e}}),(function(e){if("pending"===t.status){var i=t;i.status="rejected",i.reason=e}}))}switch(t.status){case"fulfilled":return t.value;case"rejected":if((e=t.reason)===sn)throw Error(s(483));throw e}throw hn=t,sn}}var hn=null;function gn(){if(null===hn)throw Error(s(459));var e=hn;return hn=null,e}var pn=null,fn=0;function mn(e){var t=fn;return fn+=1,null===pn&&(pn=[]),dn(pn,e,t)}function vn(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function Cn(e,t){if(t.$$typeof===l)throw Error(s(525));throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function wn(e){return(0,e._init)(e._payload)}function bn(e){function t(t,i){if(e){var r=t.deletions;null===r?(t.deletions=[i],t.flags|=16):r.push(i)}}function i(i,r){if(!e)return null;for(;null!==r;)t(i,r),r=r.sibling;return null}function r(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function n(e,t){return(e=Bl(e,t)).index=0,e.sibling=null,e}function o(t,i,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<i?(t.flags|=33554434,i):r:(t.flags|=33554434,i):(t.flags|=1048576,i)}function a(t){return e&&null===t.alternate&&(t.flags|=33554434),t}function l(e,t,i,r){return null===t||6!==t.tag?((t=_l(i,e.mode,r)).return=e,t):((t=n(t,i)).return=e,t)}function h(e,t,i,r){var o=i.type;return o===d?p(e,t,i.props.children,r,i.key):null!==t&&(t.elementType===o||"object"===typeof o&&null!==o&&o.$$typeof===S&&wn(o)===t.type)?(vn(t=n(t,i.props),i),t.return=e,t):(vn(t=Hl(i.type,i.key,i.props,null,e.mode,r),i),t.return=e,t)}function g(e,t,i,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==i.containerInfo||t.stateNode.implementation!==i.implementation?((t=Wl(i,e.mode,r)).return=e,t):((t=n(t,i.children||[])).return=e,t)}function p(e,t,i,r,o){return null===t||7!==t.tag?((t=zl(i,e.mode,r,o)).return=e,t):((t=n(t,i)).return=e,t)}function f(e,t,i){if("string"===typeof t&&""!==t||"number"===typeof t||"bigint"===typeof t)return(t=_l(""+t,e.mode,i)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case c:return vn(i=Hl(t.type,t.key,t.props,null,e.mode,i),t),i.return=e,i;case u:return(t=Wl(t,e.mode,i)).return=e,t;case S:return f(e,t=(0,t._init)(t._payload),i)}if(V(t)||x(t))return(t=zl(t,e.mode,i,null)).return=e,t;if("function"===typeof t.then)return f(e,mn(t),i);if(t.$$typeof===m)return f(e,Ta(e,t),i);Cn(e,t)}return null}function v(e,t,i,r){var n=null!==t?t.key:null;if("string"===typeof i&&""!==i||"number"===typeof i||"bigint"===typeof i)return null!==n?null:l(e,t,""+i,r);if("object"===typeof i&&null!==i){switch(i.$$typeof){case c:return i.key===n?h(e,t,i,r):null;case u:return i.key===n?g(e,t,i,r):null;case S:return v(e,t,i=(n=i._init)(i._payload),r)}if(V(i)||x(i))return null!==n?null:p(e,t,i,r,null);if("function"===typeof i.then)return v(e,t,mn(i),r);if(i.$$typeof===m)return v(e,t,Ta(e,i),r);Cn(e,i)}return null}function C(e,t,i,r,n){if("string"===typeof r&&""!==r||"number"===typeof r||"bigint"===typeof r)return l(t,e=e.get(i)||null,""+r,n);if("object"===typeof r&&null!==r){switch(r.$$typeof){case c:return h(t,e=e.get(null===r.key?i:r.key)||null,r,n);case u:return g(t,e=e.get(null===r.key?i:r.key)||null,r,n);case S:return C(e,t,i,r=(0,r._init)(r._payload),n)}if(V(r)||x(r))return p(t,e=e.get(i)||null,r,n,null);if("function"===typeof r.then)return C(e,t,i,mn(r),n);if(r.$$typeof===m)return C(e,t,i,Ta(t,r),n);Cn(t,r)}return null}function w(l,h,g,p){if("object"===typeof g&&null!==g&&g.type===d&&null===g.key&&(g=g.props.children),"object"===typeof g&&null!==g){switch(g.$$typeof){case c:e:{for(var b=g.key;null!==h;){if(h.key===b){if((b=g.type)===d){if(7===h.tag){i(l,h.sibling),(p=n(h,g.props.children)).return=l,l=p;break e}}else if(h.elementType===b||"object"===typeof b&&null!==b&&b.$$typeof===S&&wn(b)===h.type){i(l,h.sibling),vn(p=n(h,g.props),g),p.return=l,l=p;break e}i(l,h);break}t(l,h),h=h.sibling}g.type===d?((p=zl(g.props.children,l.mode,p,g.key)).return=l,l=p):(vn(p=Hl(g.type,g.key,g.props,null,l.mode,p),g),p.return=l,l=p)}return a(l);case u:e:{for(b=g.key;null!==h;){if(h.key===b){if(4===h.tag&&h.stateNode.containerInfo===g.containerInfo&&h.stateNode.implementation===g.implementation){i(l,h.sibling),(p=n(h,g.children||[])).return=l,l=p;break e}i(l,h);break}t(l,h),h=h.sibling}(p=Wl(g,l.mode,p)).return=l,l=p}return a(l);case S:return w(l,h,g=(b=g._init)(g._payload),p)}if(V(g))return function(n,s,a,l){for(var c=null,u=null,d=s,h=s=0,g=null;null!==d&&h<a.length;h++){d.index>h?(g=d,d=null):g=d.sibling;var p=v(n,d,a[h],l);if(null===p){null===d&&(d=g);break}e&&d&&null===p.alternate&&t(n,d),s=o(p,s,h),null===u?c=p:u.sibling=p,u=p,d=g}if(h===a.length)return i(n,d),Qr&&Wr(n,h),c;if(null===d){for(;h<a.length;h++)null!==(d=f(n,a[h],l))&&(s=o(d,s,h),null===u?c=d:u.sibling=d,u=d);return Qr&&Wr(n,h),c}for(d=r(d);h<a.length;h++)null!==(g=C(d,n,h,a[h],l))&&(e&&null!==g.alternate&&d.delete(null===g.key?h:g.key),s=o(g,s,h),null===u?c=g:u.sibling=g,u=g);return e&&d.forEach((function(e){return t(n,e)})),Qr&&Wr(n,h),c}(l,h,g,p);if(x(g)){if("function"!==typeof(b=x(g)))throw Error(s(150));return function(n,a,l,c){if(null==l)throw Error(s(151));for(var u=null,d=null,h=a,g=a=0,p=null,m=l.next();null!==h&&!m.done;g++,m=l.next()){h.index>g?(p=h,h=null):p=h.sibling;var w=v(n,h,m.value,c);if(null===w){null===h&&(h=p);break}e&&h&&null===w.alternate&&t(n,h),a=o(w,a,g),null===d?u=w:d.sibling=w,d=w,h=p}if(m.done)return i(n,h),Qr&&Wr(n,g),u;if(null===h){for(;!m.done;g++,m=l.next())null!==(m=f(n,m.value,c))&&(a=o(m,a,g),null===d?u=m:d.sibling=m,d=m);return Qr&&Wr(n,g),u}for(h=r(h);!m.done;g++,m=l.next())null!==(m=C(h,n,g,m.value,c))&&(e&&null!==m.alternate&&h.delete(null===m.key?g:m.key),a=o(m,a,g),null===d?u=m:d.sibling=m,d=m);return e&&h.forEach((function(e){return t(n,e)})),Qr&&Wr(n,g),u}(l,h,g=b.call(g),p)}if("function"===typeof g.then)return w(l,h,mn(g),p);if(g.$$typeof===m)return w(l,h,Ta(l,g),p);Cn(l,g)}return"string"===typeof g&&""!==g||"number"===typeof g||"bigint"===typeof g?(g=""+g,null!==h&&6===h.tag?(i(l,h.sibling),(p=n(h,g)).return=l,l=p):(i(l,h),(p=_l(g,l.mode,p)).return=l,l=p),a(l)):i(l,h)}return function(e,t,i,r){try{fn=0;var n=w(e,t,i,r);return pn=null,n}catch(s){if(s===sn)throw s;var o=Ol(29,s,null,e.mode);return o.lanes=r,o.return=e,o}}}var Sn=bn(!0),yn=bn(!1),Rn=K(null),En=K(0);function xn(e,t){q(En,e=cc),q(Rn,t),cc=e|t.baseLanes}function Tn(){q(En,cc),q(Rn,Rn.current)}function Fn(){cc=En.current,Y(Rn),Y(En)}var Pn=K(null),Dn=null;function kn(e){var t=e.alternate;q(Ln,1&Ln.current),q(Pn,e),null===Dn&&(null===t||null!==Rn.current||null!==t.memoizedState)&&(Dn=e)}function An(e){if(22===e.tag){if(q(Ln,Ln.current),q(Pn,e),null===Dn){var t=e.alternate;null!==t&&null!==t.memoizedState&&(Dn=e)}}else Mn()}function Mn(){q(Ln,Ln.current),q(Pn,Pn.current)}function In(e){Y(Pn),Dn===e&&(Dn=null),Y(Ln)}var Ln=K(0);function On(e){for(var t=e;null!==t;){if(13===t.tag){var i=t.memoizedState;if(null!==i&&(null===(i=i.dehydrated)||"$?"===i.data||"$!"===i.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Nn="undefined"!==typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,i){e.push(i)}};this.abort=function(){t.aborted=!0,e.forEach((function(e){return e()}))}},Bn=r.unstable_scheduleCallback,Gn=r.unstable_NormalPriority,Hn={$$typeof:m,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function zn(){return{controller:new Nn,data:new Map,refCount:0}}function Vn(e){e.refCount--,0===e.refCount&&Bn(Gn,(function(){e.controller.abort()}))}var _n=null,Wn=0,Un=0,jn=null;function Kn(){if(0===--Wn&&null!==_n){null!==jn&&(jn.status="fulfilled");var e=_n;_n=null,Un=0,jn=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var Yn=k.S;k.S=function(e,t){"object"===typeof t&&null!==t&&"function"===typeof t.then&&function(e,t){if(null===_n){var i=_n=[];Wn=0,Un=Su(),jn={status:"pending",value:void 0,then:function(e){i.push(e)}}}Wn++,t.then(Kn,Kn)}(0,t),null!==Yn&&Yn(e,t)};var qn=K(null);function Qn(){var e=qn.current;return null!==e?e:tc.pooledCache}function $n(e,t){q(qn,null===t?qn.current:t.pool)}function Xn(){var e=Qn();return null===e?null:{parent:Hn._currentValue,pool:e}}var Jn=0,Zn=null,eo=null,to=null,io=!1,ro=!1,no=!1,oo=0,so=0,ao=null,lo=0;function co(){throw Error(s(321))}function uo(e,t){if(null===t)return!1;for(var i=0;i<t.length&&i<e.length;i++)if(!Yi(e[i],t[i]))return!1;return!0}function ho(e,t,i,r,n,o){return Jn=o,Zn=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,k.H=null===e||null===e.memoizedState?Ts:Fs,no=!1,o=i(r,n),no=!1,ro&&(o=po(t,i,r,n)),go(e),o}function go(e){k.H=xs;var t=null!==eo&&null!==eo.next;if(Jn=0,to=eo=Zn=null,io=!1,so=0,ao=null,t)throw Error(s(300));null===e||Us||null!==(e=e.dependencies)&&Ra(e)&&(Us=!0)}function po(e,t,i,r){Zn=e;var n=0;do{if(ro&&(ao=null),so=0,ro=!1,25<=n)throw Error(s(301));if(n+=1,to=eo=null,null!=e.updateQueue){var o=e.updateQueue;o.lastEffect=null,o.events=null,o.stores=null,null!=o.memoCache&&(o.memoCache.index=0)}k.H=Ps,o=t(i,r)}while(ro);return o}function fo(){var e=k.H,t=e.useState()[0];return t="function"===typeof t.then?So(t):t,e=e.useState()[0],(null!==eo?eo.memoizedState:null)!==e&&(Zn.flags|=1024),t}function mo(){var e=0!==oo;return oo=0,e}function vo(e,t,i){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i}function Co(e){if(io){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}io=!1}Jn=0,to=eo=Zn=null,ro=!1,so=oo=0,ao=null}function wo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===to?Zn.memoizedState=to=e:to=to.next=e,to}function bo(){if(null===eo){var e=Zn.alternate;e=null!==e?e.memoizedState:null}else e=eo.next;var t=null===to?Zn.memoizedState:to.next;if(null!==t)to=t,eo=e;else{if(null===e){if(null===Zn.alternate)throw Error(s(467));throw Error(s(310))}e={memoizedState:(eo=e).memoizedState,baseState:eo.baseState,baseQueue:eo.baseQueue,queue:eo.queue,next:null},null===to?Zn.memoizedState=to=e:to=to.next=e}return to}function So(e){var t=so;return so+=1,null===ao&&(ao=[]),e=dn(ao,e,t),t=Zn,null===(null===to?t.memoizedState:to.next)&&(t=t.alternate,k.H=null===t||null===t.memoizedState?Ts:Fs),e}function yo(e){if(null!==e&&"object"===typeof e){if("function"===typeof e.then)return So(e);if(e.$$typeof===m)return xa(e)}throw Error(s(438,String(e)))}function Ro(e){var t=null,i=Zn.updateQueue;if(null!==i&&(t=i.memoCache),null==t){var r=Zn.alternate;null!==r&&(null!==(r=r.updateQueue)&&(null!=(r=r.memoCache)&&(t={data:r.data.map((function(e){return e.slice()})),index:0})))}if(null==t&&(t={data:[],index:0}),null===i&&(i={lastEffect:null,events:null,stores:null,memoCache:null},Zn.updateQueue=i),i.memoCache=t,void 0===(i=t.data[t.index]))for(i=t.data[t.index]=Array(e),r=0;r<e;r++)i[r]=R;return t.index++,i}function Eo(e,t){return"function"===typeof t?t(e):t}function xo(e){return To(bo(),eo,e)}function To(e,t,i){var r=e.queue;if(null===r)throw Error(s(311));r.lastRenderedReducer=i;var n=e.baseQueue,o=r.pending;if(null!==o){if(null!==n){var a=n.next;n.next=o.next,o.next=a}t.baseQueue=n=o,r.pending=null}if(o=e.baseState,null===n)e.memoizedState=o;else{var l=a=null,c=null,u=t=n.next,d=!1;do{var h=-536870913&u.lane;if(h!==u.lane?(rc&h)===h:(Jn&h)===h){var g=u.revertLane;if(0===g)null!==c&&(c=c.next={lane:0,revertLane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),h===Un&&(d=!0);else{if((Jn&g)===g){u=u.next,g===Un&&(d=!0);continue}h={lane:0,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=h,a=o):c=c.next=h,Zn.lanes|=g,dc|=g}h=u.action,no&&i(o,h),o=u.hasEagerState?u.eagerState:i(o,h)}else g={lane:h,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===c?(l=c=g,a=o):c=c.next=g,Zn.lanes|=h,dc|=h;u=u.next}while(null!==u&&u!==t);if(null===c?a=o:c.next=l,!Yi(o,e.memoizedState)&&(Us=!0,d&&null!==(i=jn)))throw i;e.memoizedState=o,e.baseState=a,e.baseQueue=c,r.lastRenderedState=o}return null===n&&(r.lanes=0),[e.memoizedState,r.dispatch]}function Fo(e){var t=bo(),i=t.queue;if(null===i)throw Error(s(311));i.lastRenderedReducer=e;var r=i.dispatch,n=i.pending,o=t.memoizedState;if(null!==n){i.pending=null;var a=n=n.next;do{o=e(o,a.action),a=a.next}while(a!==n);Yi(o,t.memoizedState)||(Us=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),i.lastRenderedState=o}return[o,r]}function Po(e,t,i){var r=Zn,n=bo(),o=Qr;if(o){if(void 0===i)throw Error(s(407));i=i()}else i=t();var a=!Yi((eo||n).memoizedState,i);if(a&&(n.memoizedState=i,Us=!0),n=n.queue,Zo(Ao.bind(null,r,n,e),[e]),n.getSnapshot!==t||a||null!==to&&1&to.memoizedState.tag){if(r.flags|=2048,qo(9,ko.bind(null,r,n,i,t),{destroy:void 0},null),null===tc)throw Error(s(349));o||0!==(60&Jn)||Do(r,t,i)}return i}function Do(e,t,i){e.flags|=16384,e={getSnapshot:t,value:i},null===(t=Zn.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},Zn.updateQueue=t,t.stores=[e]):null===(i=t.stores)?t.stores=[e]:i.push(e)}function ko(e,t,i,r){t.value=i,t.getSnapshot=r,Mo(t)&&Io(e)}function Ao(e,t,i){return i((function(){Mo(t)&&Io(e)}))}function Mo(e){var t=e.getSnapshot;e=e.value;try{var i=t();return!Yi(e,i)}catch(r){return!0}}function Io(e){var t=Pr(e,2);null!==t&&Mc(t,e,2)}function Lo(e){var t=wo();if("function"===typeof e){var i=e;if(e=i(),no){we(!0);try{i()}finally{we(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Eo,lastRenderedState:e},t}function Oo(e,t,i,r){return e.baseState=i,To(e,eo,"function"===typeof r?r:Eo)}function No(e,t,i,r,n){if(ys(e))throw Error(s(485));if(null!==(e=t.action)){var o={payload:n,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){o.listeners.push(e)}};null!==k.T?i(!0):o.isTransition=!1,r(o),null===(i=t.pending)?(o.next=t.pending=o,Bo(t,o)):(o.next=i.next,t.pending=i.next=o)}}function Bo(e,t){var i=t.action,r=t.payload,n=e.state;if(t.isTransition){var o=k.T,s={};k.T=s;try{var a=i(n,r),l=k.S;null!==l&&l(s,a),Go(e,t,a)}catch(c){zo(e,t,c)}finally{k.T=o}}else try{Go(e,t,o=i(n,r))}catch(u){zo(e,t,u)}}function Go(e,t,i){null!==i&&"object"===typeof i&&"function"===typeof i.then?i.then((function(i){Ho(e,t,i)}),(function(i){return zo(e,t,i)})):Ho(e,t,i)}function Ho(e,t,i){t.status="fulfilled",t.value=i,Vo(t),e.state=i,null!==(t=e.pending)&&((i=t.next)===t?e.pending=null:(i=i.next,t.next=i,Bo(e,i)))}function zo(e,t,i){var r=e.pending;if(e.pending=null,null!==r){r=r.next;do{t.status="rejected",t.reason=i,Vo(t),t=t.next}while(t!==r)}e.action=null}function Vo(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function _o(e,t){return t}function Wo(e,t){if(Qr){var i=tc.formState;if(null!==i){e:{var r=Zn;if(Qr){if(qr){t:{for(var n=qr,o=Xr;8!==n.nodeType;){if(!o){n=null;break t}if(null===(n=ad(n.nextSibling))){n=null;break t}}n="F!"===(o=n.data)||"F"===o?n:null}if(n){qr=ad(n.nextSibling),r="F!"===n.data;break e}}Zr(r)}r=!1}r&&(t=i[0])}}return(i=wo()).memoizedState=i.baseState=t,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:_o,lastRenderedState:t},i.queue=r,i=ws.bind(null,Zn,r),r.dispatch=i,r=Lo(!1),o=Ss.bind(null,Zn,!1,r.queue),n={state:t,dispatch:null,action:e,pending:null},(r=wo()).queue=n,i=No.bind(null,Zn,n,o,i),n.dispatch=i,r.memoizedState=e,[t,i,!1]}function Uo(e){return jo(bo(),eo,e)}function jo(e,t,i){t=To(e,t,_o)[0],e=xo(Eo)[0],t="object"===typeof t&&null!==t&&"function"===typeof t.then?So(t):t;var r=bo(),n=r.queue,o=n.dispatch;return i!==r.memoizedState&&(Zn.flags|=2048,qo(9,Ko.bind(null,n,i),{destroy:void 0},null)),[t,o,e]}function Ko(e,t){e.action=t}function Yo(e){var t=bo(),i=eo;if(null!==i)return jo(t,i,e);bo(),t=t.memoizedState;var r=(i=bo()).queue.dispatch;return i.memoizedState=e,[t,r,!1]}function qo(e,t,i,r){return e={tag:e,create:t,inst:i,deps:r,next:null},null===(t=Zn.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},Zn.updateQueue=t),null===(i=t.lastEffect)?t.lastEffect=e.next=e:(r=i.next,i.next=e,e.next=r,t.lastEffect=e),e}function Qo(){return bo().memoizedState}function $o(e,t,i,r){var n=wo();Zn.flags|=e,n.memoizedState=qo(1|t,i,{destroy:void 0},void 0===r?null:r)}function Xo(e,t,i,r){var n=bo();r=void 0===r?null:r;var o=n.memoizedState.inst;null!==eo&&null!==r&&uo(r,eo.memoizedState.deps)?n.memoizedState=qo(t,i,o,r):(Zn.flags|=e,n.memoizedState=qo(1|t,i,o,r))}function Jo(e,t){$o(8390656,8,e,t)}function Zo(e,t){Xo(2048,8,e,t)}function es(e,t){return Xo(4,2,e,t)}function ts(e,t){return Xo(4,4,e,t)}function is(e,t){if("function"===typeof t){e=e();var i=t(e);return function(){"function"===typeof i?i():t(null)}}if(null!==t&&void 0!==t)return e=e(),t.current=e,function(){t.current=null}}function rs(e,t,i){i=null!==i&&void 0!==i?i.concat([e]):null,Xo(4,4,is.bind(null,t,e),i)}function ns(){}function os(e,t){var i=bo();t=void 0===t?null:t;var r=i.memoizedState;return null!==t&&uo(t,r[1])?r[0]:(i.memoizedState=[e,t],e)}function ss(e,t){var i=bo();t=void 0===t?null:t;var r=i.memoizedState;if(null!==t&&uo(t,r[1]))return r[0];if(r=e(),no){we(!0);try{e()}finally{we(!1)}}return i.memoizedState=[r,t],r}function as(e,t,i){return void 0===i||0!==(1073741824&Jn)?e.memoizedState=t:(e.memoizedState=i,e=Ac(),Zn.lanes|=e,dc|=e,i)}function ls(e,t,i,r){return Yi(i,t)?i:null!==Rn.current?(e=as(e,i,r),Yi(e,t)||(Us=!0),e):0===(42&Jn)?(Us=!0,e.memoizedState=i):(e=Ac(),Zn.lanes|=e,dc|=e,t)}function cs(e,t,i,r,n){var o=_.p;_.p=0!==o&&8>o?o:8;var s=k.T,a={};k.T=a,Ss(e,!1,t,i);try{var l=n(),c=k.S;if(null!==c&&c(a,l),null!==l&&"object"===typeof l&&"function"===typeof l.then)bs(e,t,function(e,t){var i=[],r={status:"pending",value:null,reason:null,then:function(e){i.push(e)}};return e.then((function(){r.status="fulfilled",r.value=t;for(var e=0;e<i.length;e++)(0,i[e])(t)}),(function(e){for(r.status="rejected",r.reason=e,e=0;e<i.length;e++)(0,i[e])(void 0)})),r}(l,r),kc());else bs(e,t,r,kc())}catch(u){bs(e,t,{then:function(){},status:"rejected",reason:u},kc())}finally{_.p=o,k.T=s}}function us(){}function ds(e,t,i,r){if(5!==e.tag)throw Error(s(476));var n=hs(e).queue;cs(e,n,t,W,null===i?us:function(){return gs(e),i(r)})}function hs(e){var t=e.memoizedState;if(null!==t)return t;var i={};return(t={memoizedState:W,baseState:W,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Eo,lastRenderedState:W},next:null}).next={memoizedState:i,baseState:i,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Eo,lastRenderedState:i},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function gs(e){bs(e,hs(e).next.queue,{},kc())}function ps(){return xa(Nd)}function fs(){return bo().memoizedState}function ms(){return bo().memoizedState}function vs(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var i=kc(),r=Ma(t,e=Aa(i),i);return null!==r&&(Mc(r,t,i),Ia(r,t,i)),t={cache:zn()},void(e.payload=t)}t=t.return}}function Cs(e,t,i){var r=kc();i={lane:r,revertLane:0,action:i,hasEagerState:!1,eagerState:null,next:null},ys(e)?Rs(t,i):null!==(i=Fr(e,t,i,r))&&(Mc(i,e,r),Es(i,t,r))}function ws(e,t,i){bs(e,t,i,kc())}function bs(e,t,i,r){var n={lane:r,revertLane:0,action:i,hasEagerState:!1,eagerState:null,next:null};if(ys(e))Rs(t,n);else{var o=e.alternate;if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var s=t.lastRenderedState,a=o(s,i);if(n.hasEagerState=!0,n.eagerState=a,Yi(a,s))return Tr(e,t,n,0),null===tc&&xr(),!1}catch(l){}if(null!==(i=Fr(e,t,n,r)))return Mc(i,e,r),Es(i,t,r),!0}return!1}function Ss(e,t,i,r){if(r={lane:2,revertLane:Su(),action:r,hasEagerState:!1,eagerState:null,next:null},ys(e)){if(t)throw Error(s(479))}else null!==(t=Fr(e,i,r,2))&&Mc(t,e,2)}function ys(e){var t=e.alternate;return e===Zn||null!==t&&t===Zn}function Rs(e,t){ro=io=!0;var i=e.pending;null===i?t.next=t:(t.next=i.next,i.next=t),e.pending=t}function Es(e,t,i){if(0!==(4194176&i)){var r=t.lanes;i|=r&=e.pendingLanes,t.lanes=i,Le(e,i)}}var xs={readContext:xa,use:yo,useCallback:co,useContext:co,useEffect:co,useImperativeHandle:co,useLayoutEffect:co,useInsertionEffect:co,useMemo:co,useReducer:co,useRef:co,useState:co,useDebugValue:co,useDeferredValue:co,useTransition:co,useSyncExternalStore:co,useId:co};xs.useCacheRefresh=co,xs.useMemoCache=co,xs.useHostTransitionStatus=co,xs.useFormState=co,xs.useActionState=co,xs.useOptimistic=co;var Ts={readContext:xa,use:yo,useCallback:function(e,t){return wo().memoizedState=[e,void 0===t?null:t],e},useContext:xa,useEffect:Jo,useImperativeHandle:function(e,t,i){i=null!==i&&void 0!==i?i.concat([e]):null,$o(4194308,4,is.bind(null,t,e),i)},useLayoutEffect:function(e,t){return $o(4194308,4,e,t)},useInsertionEffect:function(e,t){$o(4,2,e,t)},useMemo:function(e,t){var i=wo();t=void 0===t?null:t;var r=e();if(no){we(!0);try{e()}finally{we(!1)}}return i.memoizedState=[r,t],r},useReducer:function(e,t,i){var r=wo();if(void 0!==i){var n=i(t);if(no){we(!0);try{i(t)}finally{we(!1)}}}else n=t;return r.memoizedState=r.baseState=n,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:n},r.queue=e,e=e.dispatch=Cs.bind(null,Zn,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},wo().memoizedState=e},useState:function(e){var t=(e=Lo(e)).queue,i=ws.bind(null,Zn,t);return t.dispatch=i,[e.memoizedState,i]},useDebugValue:ns,useDeferredValue:function(e,t){return as(wo(),e,t)},useTransition:function(){var e=Lo(!1);return e=cs.bind(null,Zn,e.queue,!0,!1),wo().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,i){var r=Zn,n=wo();if(Qr){if(void 0===i)throw Error(s(407));i=i()}else{if(i=t(),null===tc)throw Error(s(349));0!==(60&rc)||Do(r,t,i)}n.memoizedState=i;var o={value:i,getSnapshot:t};return n.queue=o,Jo(Ao.bind(null,r,o,e),[e]),r.flags|=2048,qo(9,ko.bind(null,r,o,i,t),{destroy:void 0},null),i},useId:function(){var e=wo(),t=tc.identifierPrefix;if(Qr){var i=_r;t=":"+t+"R"+(i=(Vr&~(1<<32-be(Vr)-1)).toString(32)+i),0<(i=oo++)&&(t+="H"+i.toString(32)),t+=":"}else t=":"+t+"r"+(i=lo++).toString(32)+":";return e.memoizedState=t},useCacheRefresh:function(){return wo().memoizedState=vs.bind(null,Zn)}};Ts.useMemoCache=Ro,Ts.useHostTransitionStatus=ps,Ts.useFormState=Wo,Ts.useActionState=Wo,Ts.useOptimistic=function(e){var t=wo();t.memoizedState=t.baseState=e;var i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=i,t=Ss.bind(null,Zn,!0,i),i.dispatch=t,[e,t]};var Fs={readContext:xa,use:yo,useCallback:os,useContext:xa,useEffect:Zo,useImperativeHandle:rs,useInsertionEffect:es,useLayoutEffect:ts,useMemo:ss,useReducer:xo,useRef:Qo,useState:function(){return xo(Eo)},useDebugValue:ns,useDeferredValue:function(e,t){return ls(bo(),eo.memoizedState,e,t)},useTransition:function(){var e=xo(Eo)[0],t=bo().memoizedState;return["boolean"===typeof e?e:So(e),t]},useSyncExternalStore:Po,useId:fs};Fs.useCacheRefresh=ms,Fs.useMemoCache=Ro,Fs.useHostTransitionStatus=ps,Fs.useFormState=Uo,Fs.useActionState=Uo,Fs.useOptimistic=function(e,t){return Oo(bo(),0,e,t)};var Ps={readContext:xa,use:yo,useCallback:os,useContext:xa,useEffect:Zo,useImperativeHandle:rs,useInsertionEffect:es,useLayoutEffect:ts,useMemo:ss,useReducer:Fo,useRef:Qo,useState:function(){return Fo(Eo)},useDebugValue:ns,useDeferredValue:function(e,t){var i=bo();return null===eo?as(i,e,t):ls(i,eo.memoizedState,e,t)},useTransition:function(){var e=Fo(Eo)[0],t=bo().memoizedState;return["boolean"===typeof e?e:So(e),t]},useSyncExternalStore:Po,useId:fs};function Ds(e,t,i,r){i=null===(i=i(r,t=e.memoizedState))||void 0===i?t:A({},t,i),e.memoizedState=i,0===e.lanes&&(e.updateQueue.baseState=i)}Ps.useCacheRefresh=ms,Ps.useMemoCache=Ro,Ps.useHostTransitionStatus=ps,Ps.useFormState=Yo,Ps.useActionState=Yo,Ps.useOptimistic=function(e,t){var i=bo();return null!==eo?Oo(i,0,e,t):(i.baseState=e,[e,i.queue.dispatch])};var ks={isMounted:function(e){return!!(e=e._reactInternals)&&B(e)===e},enqueueSetState:function(e,t,i){e=e._reactInternals;var r=kc(),n=Aa(r);n.payload=t,void 0!==i&&null!==i&&(n.callback=i),null!==(t=Ma(e,n,r))&&(Mc(t,e,r),Ia(t,e,r))},enqueueReplaceState:function(e,t,i){e=e._reactInternals;var r=kc(),n=Aa(r);n.tag=1,n.payload=t,void 0!==i&&null!==i&&(n.callback=i),null!==(t=Ma(e,n,r))&&(Mc(t,e,r),Ia(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var i=kc(),r=Aa(i);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),null!==(t=Ma(e,r,i))&&(Mc(t,e,i),Ia(t,e,i))}};function As(e,t,i,r,n,o,s){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,o,s):!t.prototype||!t.prototype.isPureReactComponent||(!qi(i,r)||!qi(n,o))}function Ms(e,t,i,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(i,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(i,r),t.state!==e&&ks.enqueueReplaceState(t,t.state,null)}function Is(e,t){var i=t;if("ref"in t)for(var r in i={},t)"ref"!==r&&(i[r]=t[r]);if(e=e.defaultProps)for(var n in i===t&&(i=A({},i)),e)void 0===i[n]&&(i[n]=e[n]);return i}var Ls="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)};function Os(e){Ls(e)}function Ns(e){console.error(e)}function Bs(e){Ls(e)}function Gs(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(i){setTimeout((function(){throw i}))}}function Hs(e,t,i){try{(0,e.onCaughtError)(i.value,{componentStack:i.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(r){setTimeout((function(){throw r}))}}function zs(e,t,i){return(i=Aa(i)).tag=3,i.payload={element:null},i.callback=function(){Gs(e,t)},i}function Vs(e){return(e=Aa(e)).tag=3,e}function _s(e,t,i,r){var n=i.type.getDerivedStateFromError;if("function"===typeof n){var o=r.value;e.payload=function(){return n(o)},e.callback=function(){Hs(t,i,r)}}var s=i.stateNode;null!==s&&"function"===typeof s.componentDidCatch&&(e.callback=function(){Hs(t,i,r),"function"!==typeof n&&(null===yc?yc=new Set([this]):yc.add(this));var e=r.stack;this.componentDidCatch(r.value,{componentStack:null!==e?e:""})})}var Ws=Error(s(461)),Us=!1;function js(e,t,i,r){t.child=null===e?yn(t,null,i,r):Sn(t,e.child,i,r)}function Ks(e,t,i,r,n){i=i.render;var o=t.ref;if("ref"in r){var s={};for(var a in r)"ref"!==a&&(s[a]=r[a])}else s=r;return Ea(t),r=ho(e,t,i,s,o,n),a=mo(),null===e||Us?(Qr&&a&&jr(t),t.flags|=1,js(e,t,r,n),t.child):(vo(e,t,n),ha(e,t,n))}function Ys(e,t,i,r,n){if(null===e){var o=i.type;return"function"!==typeof o||Nl(o)||void 0!==o.defaultProps||null!==i.compare?((e=Hl(i.type,null,r,t,t.mode,n)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,qs(e,t,o,r,n))}if(o=e.child,!ga(e,n)){var s=o.memoizedProps;if((i=null!==(i=i.compare)?i:qi)(s,r)&&e.ref===t.ref)return ha(e,t,n)}return t.flags|=1,(e=Bl(o,r)).ref=t.ref,e.return=t,t.child=e}function qs(e,t,i,r,n){if(null!==e){var o=e.memoizedProps;if(qi(o,r)&&e.ref===t.ref){if(Us=!1,t.pendingProps=r=o,!ga(e,n))return t.lanes=e.lanes,ha(e,t,n);0!==(131072&e.flags)&&(Us=!0)}}return Js(e,t,i,r,n)}function Qs(e,t,i){var r=t.pendingProps,n=r.children,o=0!==(2&t.stateNode._pendingVisibility),s=null!==e?e.memoizedState:null;if(Xs(e,t),"hidden"===r.mode||o){if(0!==(128&t.flags)){if(r=null!==s?s.baseLanes|i:i,null!==e){for(n=t.child=e.child,o=0;null!==n;)o=o|n.lanes|n.childLanes,n=n.sibling;t.childLanes=o&~r}else t.childLanes=0,t.child=null;return $s(e,t,r,i)}if(0===(536870912&i))return t.lanes=t.childLanes=536870912,$s(e,t,null!==s?s.baseLanes|i:i,i);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&$n(0,null!==s?s.cachePool:null),null!==s?xn(t,s):Tn(),An(t)}else null!==s?($n(0,s.cachePool),xn(t,s),Mn(),t.memoizedState=null):(null!==e&&$n(0,null),Tn(),Mn());return js(e,t,n,i),t.child}function $s(e,t,i,r){var n=Qn();return n=null===n?null:{parent:Hn._currentValue,pool:n},t.memoizedState={baseLanes:i,cachePool:n},null!==e&&$n(0,null),Tn(),An(t),null!==e&&ya(e,t,r,!0),null}function Xs(e,t){var i=t.ref;if(null===i)null!==e&&null!==e.ref&&(t.flags|=2097664);else{if("function"!==typeof i&&"object"!==typeof i)throw Error(s(284));null!==e&&e.ref===i||(t.flags|=2097664)}}function Js(e,t,i,r,n){return Ea(t),i=ho(e,t,i,r,void 0,n),r=mo(),null===e||Us?(Qr&&r&&jr(t),t.flags|=1,js(e,t,i,n),t.child):(vo(e,t,n),ha(e,t,n))}function Zs(e,t,i,r,n,o){return Ea(t),t.updateQueue=null,i=po(t,r,i,n),go(e),r=mo(),null===e||Us?(Qr&&r&&jr(t),t.flags|=1,js(e,t,i,o),t.child):(vo(e,t,o),ha(e,t,o))}function ea(e,t,i,r,n){if(Ea(t),null===t.stateNode){var o=Ar,s=i.contextType;"object"===typeof s&&null!==s&&(o=xa(s)),o=new i(r,o),t.memoizedState=null!==o.state&&void 0!==o.state?o.state:null,o.updater=ks,t.stateNode=o,o._reactInternals=t,(o=t.stateNode).props=r,o.state=t.memoizedState,o.refs={},Da(t),s=i.contextType,o.context="object"===typeof s&&null!==s?xa(s):Ar,o.state=t.memoizedState,"function"===typeof(s=i.getDerivedStateFromProps)&&(Ds(t,i,s,r),o.state=t.memoizedState),"function"===typeof i.getDerivedStateFromProps||"function"===typeof o.getSnapshotBeforeUpdate||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||(s=o.state,"function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount(),s!==o.state&&ks.enqueueReplaceState(o,o.state,null),Ba(t,r,o,n),Na(),o.state=t.memoizedState),"function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!0}else if(null===e){o=t.stateNode;var a=t.memoizedProps,l=Is(i,a);o.props=l;var c=o.context,u=i.contextType;s=Ar,"object"===typeof u&&null!==u&&(s=xa(u));var d=i.getDerivedStateFromProps;u="function"===typeof d||"function"===typeof o.getSnapshotBeforeUpdate,a=t.pendingProps!==a,u||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a||c!==s)&&Ms(t,o,r,s),Pa=!1;var h=t.memoizedState;o.state=h,Ba(t,r,o,n),Na(),c=t.memoizedState,a||h!==c||Pa?("function"===typeof d&&(Ds(t,i,d,r),c=t.memoizedState),(l=Pa||As(t,i,l,r,h,c,s))?(u||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),o.props=r,o.state=c,o.context=s,r=l):("function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,ka(e,t),u=Is(i,s=t.memoizedProps),o.props=u,d=t.pendingProps,h=o.context,c=i.contextType,l=Ar,"object"===typeof c&&null!==c&&(l=xa(c)),(c="function"===typeof(a=i.getDerivedStateFromProps)||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==d||h!==l)&&Ms(t,o,r,l),Pa=!1,h=t.memoizedState,o.state=h,Ba(t,r,o,n),Na();var g=t.memoizedState;s!==d||h!==g||Pa||null!==e&&null!==e.dependencies&&Ra(e.dependencies)?("function"===typeof a&&(Ds(t,i,a,r),g=t.memoizedState),(u=Pa||As(t,i,u,r,h,g,l)||null!==e&&null!==e.dependencies&&Ra(e.dependencies))?(c||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,g,l),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,g,l)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=g),o.props=r,o.state=g,o.context=l,r=u):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return o=r,Xs(e,t),r=0!==(128&t.flags),o||r?(o=t.stateNode,i=r&&"function"!==typeof i.getDerivedStateFromError?null:o.render(),t.flags|=1,null!==e&&r?(t.child=Sn(t,e.child,null,n),t.child=Sn(t,null,i,n)):js(e,t,i,n),t.memoizedState=o.state,e=t.child):e=ha(e,t,n),e}function ta(e,t,i,r){return nn(),t.flags|=256,js(e,t,i,r),t.child}var ia={dehydrated:null,treeContext:null,retryLane:0};function ra(e){return{baseLanes:e,cachePool:Xn()}}function na(e,t,i){return e=null!==e?e.childLanes&~i:0,t&&(e|=pc),e}function oa(e,t,i){var r,n=t.pendingProps,o=!1,a=0!==(128&t.flags);if((r=a)||(r=(null===e||null!==e.memoizedState)&&0!==(2&Ln.current)),r&&(o=!0,t.flags&=-129),r=0!==(32&t.flags),t.flags&=-33,null===e){if(Qr){if(o?kn(t):Mn(),Qr){var l,c=qr;if(l=c){e:{for(l=c,c=Xr;8!==l.nodeType;){if(!c){c=null;break e}if(null===(l=ad(l.nextSibling))){c=null;break e}}c=l}null!==c?(t.memoizedState={dehydrated:c,treeContext:null!==zr?{id:Vr,overflow:_r}:null,retryLane:536870912},(l=Ol(18,null,null,0)).stateNode=c,l.return=t,t.child=l,Yr=t,qr=null,l=!0):l=!1}l||Zr(t)}if(null!==(c=t.memoizedState)&&null!==(c=c.dehydrated))return"$!"===c.data?t.lanes=16:t.lanes=536870912,null;In(t)}return c=n.children,n=n.fallback,o?(Mn(),c=aa({mode:"hidden",children:c},o=t.mode),n=zl(n,o,i,null),c.return=t,n.return=t,c.sibling=n,t.child=c,(o=t.child).memoizedState=ra(i),o.childLanes=na(e,r,i),t.memoizedState=ia,n):(kn(t),sa(t,c))}if(null!==(l=e.memoizedState)&&null!==(c=l.dehydrated)){if(a)256&t.flags?(kn(t),t.flags&=-257,t=la(e,t,i)):null!==t.memoizedState?(Mn(),t.child=e.child,t.flags|=128,t=null):(Mn(),o=n.fallback,c=t.mode,n=aa({mode:"visible",children:n.children},c),(o=zl(o,c,i,null)).flags|=2,n.return=t,o.return=t,n.sibling=o,t.child=n,Sn(t,e.child,null,i),(n=t.child).memoizedState=ra(i),n.childLanes=na(e,r,i),t.memoizedState=ia,t=o);else if(kn(t),"$!"===c.data){if(r=c.nextSibling&&c.nextSibling.dataset)var u=r.dgst;r=u,(n=Error(s(419))).stack="",n.digest=r,on({value:n,source:null,stack:null}),t=la(e,t,i)}else if(Us||ya(e,t,i,!1),r=0!==(i&e.childLanes),Us||r){if(null!==(r=tc)){if(0!==(42&(n=i&-i)))n=1;else switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=64;break;case 268435456:n=134217728;break;default:n=0}if(0!==(n=0!==(n&(r.suspendedLanes|i))?0:n)&&n!==l.retryLane)throw l.retryLane=n,Pr(e,n),Mc(r,e,n),Ws}"$?"===c.data||Uc(),t=la(e,t,i)}else"$?"===c.data?(t.flags|=128,t.child=e.child,t=au.bind(null,e),c._reactRetry=t,t=null):(e=l.treeContext,qr=ad(c.nextSibling),Yr=t,Qr=!0,$r=null,Xr=!1,null!==e&&(Gr[Hr++]=Vr,Gr[Hr++]=_r,Gr[Hr++]=zr,Vr=e.id,_r=e.overflow,zr=t),(t=sa(t,n.children)).flags|=4096);return t}return o?(Mn(),o=n.fallback,c=t.mode,u=(l=e.child).sibling,(n=Bl(l,{mode:"hidden",children:n.children})).subtreeFlags=31457280&l.subtreeFlags,null!==u?o=Bl(u,o):(o=zl(o,c,i,null)).flags|=2,o.return=t,n.return=t,n.sibling=o,t.child=n,n=o,o=t.child,null===(c=e.child.memoizedState)?c=ra(i):(null!==(l=c.cachePool)?(u=Hn._currentValue,l=l.parent!==u?{parent:u,pool:u}:l):l=Xn(),c={baseLanes:c.baseLanes|i,cachePool:l}),o.memoizedState=c,o.childLanes=na(e,r,i),t.memoizedState=ia,n):(kn(t),e=(i=e.child).sibling,(i=Bl(i,{mode:"visible",children:n.children})).return=t,i.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=i,t.memoizedState=null,i)}function sa(e,t){return(t=aa({mode:"visible",children:t},e.mode)).return=e,e.child=t}function aa(e,t){return Vl(e,t,0,null)}function la(e,t,i){return Sn(t,e.child,null,i),(e=sa(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function ca(e,t,i){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),ba(e.return,t,i)}function ua(e,t,i,r,n){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:i,tailMode:n}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=i,o.tailMode=n)}function da(e,t,i){var r=t.pendingProps,n=r.revealOrder,o=r.tail;if(js(e,t,r.children,i),0!==(2&(r=Ln.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&ca(e,i,t);else if(19===e.tag)ca(e,i,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}switch(q(Ln,r),n){case"forwards":for(i=t.child,n=null;null!==i;)null!==(e=i.alternate)&&null===On(e)&&(n=i),i=i.sibling;null===(i=n)?(n=t.child,t.child=null):(n=i.sibling,i.sibling=null),ua(t,!1,n,i,o);break;case"backwards":for(i=null,n=t.child,t.child=null;null!==n;){if(null!==(e=n.alternate)&&null===On(e)){t.child=n;break}e=n.sibling,n.sibling=i,i=n,n=e}ua(t,!0,i,null,o);break;case"together":ua(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function ha(e,t,i){if(null!==e&&(t.dependencies=e.dependencies),dc|=t.lanes,0===(i&t.childLanes)){if(null===e)return null;if(ya(e,t,i,!1),0===(i&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(i=Bl(e=t.child,e.pendingProps),t.child=i,i.return=t;null!==e.sibling;)e=e.sibling,(i=i.sibling=Bl(e,e.pendingProps)).return=t;i.sibling=null}return t.child}function ga(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!Ra(e))}function pa(e,t,i){if(null!==e)if(e.memoizedProps!==t.pendingProps)Us=!0;else{if(!ga(e,i)&&0===(128&t.flags))return Us=!1,function(e,t,i){switch(t.tag){case 3:Z(t,t.stateNode.containerInfo),Ca(t,Hn,e.memoizedState.cache),nn();break;case 27:case 5:te(t);break;case 4:Z(t,t.stateNode.containerInfo);break;case 10:Ca(t,t.type,t.memoizedProps.value);break;case 13:var r=t.memoizedState;if(null!==r)return null!==r.dehydrated?(kn(t),t.flags|=128,null):0!==(i&t.child.childLanes)?oa(e,t,i):(kn(t),null!==(e=ha(e,t,i))?e.sibling:null);kn(t);break;case 19:var n=0!==(128&e.flags);if((r=0!==(i&t.childLanes))||(ya(e,t,i,!1),r=0!==(i&t.childLanes)),n){if(r)return da(e,t,i);t.flags|=128}if(null!==(n=t.memoizedState)&&(n.rendering=null,n.tail=null,n.lastEffect=null),q(Ln,Ln.current),r)break;return null;case 22:case 23:return t.lanes=0,Qs(e,t,i);case 24:Ca(t,Hn,e.memoizedState.cache)}return ha(e,t,i)}(e,t,i);Us=0!==(131072&e.flags)}else Us=!1,Qr&&0!==(1048576&t.flags)&&Ur(t,Br,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var r=t.elementType,n=r._init;if(r=n(r._payload),t.type=r,"function"!==typeof r){if(void 0!==r&&null!==r){if((n=r.$$typeof)===v){t.tag=11,t=Ks(null,t,r,e,i);break e}if(n===b){t.tag=14,t=Ys(null,t,r,e,i);break e}}throw t=F(r)||r,Error(s(306,t,""))}Nl(r)?(e=Is(r,e),t.tag=1,t=ea(null,t,r,e,i)):(t.tag=0,t=Js(null,t,r,e,i))}return t;case 0:return Js(e,t,t.type,t.pendingProps,i);case 1:return ea(e,t,r=t.type,n=Is(r,t.pendingProps),i);case 3:e:{if(Z(t,t.stateNode.containerInfo),null===e)throw Error(s(387));var o=t.pendingProps;r=(n=t.memoizedState).element,ka(e,t),Ba(t,o,null,i);var a=t.memoizedState;if(o=a.cache,Ca(t,Hn,o),o!==n.cache&&Sa(t,[Hn],i,!0),Na(),o=a.element,n.isDehydrated){if(n={element:o,isDehydrated:!1,cache:a.cache},t.updateQueue.baseState=n,t.memoizedState=n,256&t.flags){t=ta(e,t,o,i);break e}if(o!==r){on(r=Ir(Error(s(424)),t)),t=ta(e,t,o,i);break e}for(qr=ad(t.stateNode.containerInfo.firstChild),Yr=t,Qr=!0,$r=null,Xr=!0,i=yn(t,null,o,i),t.child=i;i;)i.flags=-3&i.flags|4096,i=i.sibling}else{if(nn(),o===r){t=ha(e,t,i);break e}js(e,t,o,i)}t=t.child}return t;case 26:return Xs(e,t),null===e?(i=md(t.type,null,t.pendingProps,null))?t.memoizedState=i:Qr||(i=t.type,e=t.pendingProps,(r=Qu(X.current).createElement(i))[Ge]=t,r[He]=e,Ku(r,i,e),Xe(r),t.stateNode=r):t.memoizedState=md(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return te(t),null===e&&Qr&&(r=t.stateNode=cd(t.type,t.pendingProps,X.current),Yr=t,Xr=!0,qr=ad(r.firstChild)),r=t.pendingProps.children,null!==e||Qr?js(e,t,r,i):t.child=Sn(t,null,r,i),Xs(e,t),t.child;case 5:return null===e&&Qr&&((n=r=qr)&&(null!==(r=function(e,t,i,r){for(;1===e.nodeType;){var n=i;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!r&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(r){if(!e[je])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(o=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(o!==n.rel||e.getAttribute("href")!==(null==n.href?null:n.href)||e.getAttribute("crossorigin")!==(null==n.crossOrigin?null:n.crossOrigin)||e.getAttribute("title")!==(null==n.title?null:n.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((o=e.getAttribute("src"))!==(null==n.src?null:n.src)||e.getAttribute("type")!==(null==n.type?null:n.type)||e.getAttribute("crossorigin")!==(null==n.crossOrigin?null:n.crossOrigin))&&o&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var o=null==n.name?null:""+n.name;if("hidden"===n.type&&e.getAttribute("name")===o)return e}if(null===(e=ad(e.nextSibling)))break}return null}(r,t.type,t.pendingProps,Xr))?(t.stateNode=r,Yr=t,qr=ad(r.firstChild),Xr=!1,n=!0):n=!1),n||Zr(t)),te(t),n=t.type,o=t.pendingProps,a=null!==e?e.memoizedProps:null,r=o.children,Ju(n,o)?r=null:null!==a&&Ju(n,a)&&(t.flags|=32),null!==t.memoizedState&&(n=ho(e,t,fo,null,null,i),Nd._currentValue=n),Xs(e,t),js(e,t,r,i),t.child;case 6:return null===e&&Qr&&((e=i=qr)&&(null!==(i=function(e,t,i){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!i)return null;if(null===(e=ad(e.nextSibling)))return null}return e}(i,t.pendingProps,Xr))?(t.stateNode=i,Yr=t,qr=null,e=!0):e=!1),e||Zr(t)),null;case 13:return oa(e,t,i);case 4:return Z(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Sn(t,null,r,i):js(e,t,r,i),t.child;case 11:return Ks(e,t,t.type,t.pendingProps,i);case 7:return js(e,t,t.pendingProps,i),t.child;case 8:case 12:return js(e,t,t.pendingProps.children,i),t.child;case 10:return r=t.pendingProps,Ca(t,t.type,r.value),js(e,t,r.children,i),t.child;case 9:return n=t.type._context,r=t.pendingProps.children,Ea(t),r=r(n=xa(n)),t.flags|=1,js(e,t,r,i),t.child;case 14:return Ys(e,t,t.type,t.pendingProps,i);case 15:return qs(e,t,t.type,t.pendingProps,i);case 19:return da(e,t,i);case 22:return Qs(e,t,i);case 24:return Ea(t),r=xa(Hn),null===e?(null===(n=Qn())&&(n=tc,o=zn(),n.pooledCache=o,o.refCount++,null!==o&&(n.pooledCacheLanes|=i),n=o),t.memoizedState={parent:r,cache:n},Da(t),Ca(t,Hn,n)):(0!==(e.lanes&i)&&(ka(e,t),Ba(t,null,null,i),Na()),n=e.memoizedState,o=t.memoizedState,n.parent!==r?(n={parent:r,cache:r},t.memoizedState=n,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=n),Ca(t,Hn,r)):(r=o.cache,Ca(t,Hn,r),r!==n.cache&&Sa(t,[Hn],i,!0))),js(e,t,t.pendingProps.children,i),t.child;case 29:throw t.pendingProps}throw Error(s(156,t.tag))}var fa=K(null),ma=null,va=null;function Ca(e,t,i){q(fa,t._currentValue),t._currentValue=i}function wa(e){e._currentValue=fa.current,Y(fa)}function ba(e,t,i){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===i)break;e=e.return}}function Sa(e,t,i,r){var n=e.child;for(null!==n&&(n.return=e);null!==n;){var o=n.dependencies;if(null!==o){var a=n.child;o=o.firstContext;e:for(;null!==o;){var l=o;o=n;for(var c=0;c<t.length;c++)if(l.context===t[c]){o.lanes|=i,null!==(l=o.alternate)&&(l.lanes|=i),ba(o.return,i,e),r||(a=null);break e}o=l.next}}else if(18===n.tag){if(null===(a=n.return))throw Error(s(341));a.lanes|=i,null!==(o=a.alternate)&&(o.lanes|=i),ba(a,i,e),a=null}else a=n.child;if(null!==a)a.return=n;else for(a=n;null!==a;){if(a===e){a=null;break}if(null!==(n=a.sibling)){n.return=a.return,a=n;break}a=a.return}n=a}}function ya(e,t,i,r){e=null;for(var n=t,o=!1;null!==n;){if(!o)if(0!==(524288&n.flags))o=!0;else if(0!==(262144&n.flags))break;if(10===n.tag){var a=n.alternate;if(null===a)throw Error(s(387));if(null!==(a=a.memoizedProps)){var l=n.type;Yi(n.pendingProps.value,a.value)||(null!==e?e.push(l):e=[l])}}else if(n===J.current){if(null===(a=n.alternate))throw Error(s(387));a.memoizedState.memoizedState!==n.memoizedState.memoizedState&&(null!==e?e.push(Nd):e=[Nd])}n=n.return}null!==e&&Sa(t,e,i,r),t.flags|=262144}function Ra(e){for(e=e.firstContext;null!==e;){if(!Yi(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Ea(e){ma=e,va=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function xa(e){return Fa(ma,e)}function Ta(e,t){return null===ma&&Ea(e),Fa(e,t)}function Fa(e,t){var i=t._currentValue;if(t={context:t,memoizedValue:i,next:null},null===va){if(null===e)throw Error(s(308));va=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else va=va.next=t;return i}var Pa=!1;function Da(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ka(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function Aa(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function Ma(e,t,i){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&ec)){var n=r.pending;return null===n?t.next=t:(t.next=n.next,n.next=t),r.pending=t,t=kr(e),Dr(e,null,i),t}return Tr(e,r,t,i),kr(e)}function Ia(e,t,i){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194176&i))){var r=t.lanes;i|=r&=e.pendingLanes,t.lanes=i,Le(e,i)}}function La(e,t){var i=e.updateQueue,r=e.alternate;if(null!==r&&i===(r=r.updateQueue)){var n=null,o=null;if(null!==(i=i.firstBaseUpdate)){do{var s={lane:i.lane,tag:i.tag,payload:i.payload,callback:null,next:null};null===o?n=o=s:o=o.next=s,i=i.next}while(null!==i);null===o?n=o=t:o=o.next=t}else n=o=t;return i={baseState:r.baseState,firstBaseUpdate:n,lastBaseUpdate:o,shared:r.shared,callbacks:r.callbacks},void(e.updateQueue=i)}null===(e=i.lastBaseUpdate)?i.firstBaseUpdate=t:e.next=t,i.lastBaseUpdate=t}var Oa=!1;function Na(){if(Oa){if(null!==jn)throw jn}}function Ba(e,t,i,r){Oa=!1;var n=e.updateQueue;Pa=!1;var o=n.firstBaseUpdate,s=n.lastBaseUpdate,a=n.shared.pending;if(null!==a){n.shared.pending=null;var l=a,c=l.next;l.next=null,null===s?o=c:s.next=c,s=l;var u=e.alternate;null!==u&&((a=(u=u.updateQueue).lastBaseUpdate)!==s&&(null===a?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(null!==o){var d=n.baseState;for(s=0,u=c=l=null,a=o;;){var h=-536870913&a.lane,g=h!==a.lane;if(g?(rc&h)===h:(r&h)===h){0!==h&&h===Un&&(Oa=!0),null!==u&&(u=u.next={lane:0,tag:a.tag,payload:a.payload,callback:null,next:null});e:{var p=e,f=a;h=t;var m=i;switch(f.tag){case 1:if("function"===typeof(p=f.payload)){d=p.call(m,d,h);break e}d=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(h="function"===typeof(p=f.payload)?p.call(m,d,h):p)||void 0===h)break e;d=A({},d,h);break e;case 2:Pa=!0}}null!==(h=a.callback)&&(e.flags|=64,g&&(e.flags|=8192),null===(g=n.callbacks)?n.callbacks=[h]:g.push(h))}else g={lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(c=u=g,l=d):u=u.next=g,s|=h;if(null===(a=a.next)){if(null===(a=n.shared.pending))break;a=(g=a).next,g.next=null,n.lastBaseUpdate=g,n.shared.pending=null}}null===u&&(l=d),n.baseState=l,n.firstBaseUpdate=c,n.lastBaseUpdate=u,null===o&&(n.shared.lanes=0),dc|=s,e.lanes=s,e.memoizedState=d}}function Ga(e,t){if("function"!==typeof e)throw Error(s(191,e));e.call(t)}function Ha(e,t){var i=e.callbacks;if(null!==i)for(e.callbacks=null,e=0;e<i.length;e++)Ga(i[e],t)}function za(e,t){try{var i=t.updateQueue,r=null!==i?i.lastEffect:null;if(null!==r){var n=r.next;i=n;do{if((i.tag&e)===e){r=void 0;var o=i.create,s=i.inst;r=o(),s.destroy=r}i=i.next}while(i!==n)}}catch(a){ru(t,t.return,a)}}function Va(e,t,i){try{var r=t.updateQueue,n=null!==r?r.lastEffect:null;if(null!==n){var o=n.next;r=o;do{if((r.tag&e)===e){var s=r.inst,a=s.destroy;if(void 0!==a){s.destroy=void 0,n=t;var l=i;try{a()}catch(c){ru(n,l,c)}}}r=r.next}while(r!==o)}}catch(c){ru(t,t.return,c)}}function _a(e){var t=e.updateQueue;if(null!==t){var i=e.stateNode;try{Ha(t,i)}catch(r){ru(e,e.return,r)}}}function Wa(e,t,i){i.props=Is(e.type,e.memoizedProps),i.state=e.memoizedState;try{i.componentWillUnmount()}catch(r){ru(e,t,r)}}function Ua(e,t){try{var i=e.ref;if(null!==i){var r=e.stateNode;switch(e.tag){case 26:case 27:case 5:var n=r;break;default:n=r}"function"===typeof i?e.refCleanup=i(n):i.current=n}}catch(o){ru(e,t,o)}}function ja(e,t){var i=e.ref,r=e.refCleanup;if(null!==i)if("function"===typeof r)try{r()}catch(n){ru(e,t,n)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"===typeof i)try{i(null)}catch(o){ru(e,t,o)}else i.current=null}function Ka(e){var t=e.type,i=e.memoizedProps,r=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":i.autoFocus&&r.focus();break e;case"img":i.src?r.src=i.src:i.srcSet&&(r.srcset=i.srcSet)}}catch(n){ru(e,e.return,n)}}function Ya(e,t,i){try{var r=e.stateNode;!function(e,t,i,r){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var n=null,o=null,a=null,l=null,c=null,u=null,d=null;for(p in i){var h=i[p];if(i.hasOwnProperty(p)&&null!=h)switch(p){case"checked":case"value":break;case"defaultValue":c=h;default:r.hasOwnProperty(p)||Uu(e,t,p,null,r,h)}}for(var g in r){var p=r[g];if(h=i[g],r.hasOwnProperty(g)&&(null!=p||null!=h))switch(g){case"type":o=p;break;case"name":n=p;break;case"checked":u=p;break;case"defaultChecked":d=p;break;case"value":a=p;break;case"defaultValue":l=p;break;case"children":case"dangerouslySetInnerHTML":if(null!=p)throw Error(s(137,t));break;default:p!==h&&Uu(e,t,g,p,r,h)}}return void mt(e,a,l,c,u,d,o,n);case"select":for(o in p=a=l=g=null,i)if(c=i[o],i.hasOwnProperty(o)&&null!=c)switch(o){case"value":break;case"multiple":p=c;default:r.hasOwnProperty(o)||Uu(e,t,o,null,r,c)}for(n in r)if(o=r[n],c=i[n],r.hasOwnProperty(n)&&(null!=o||null!=c))switch(n){case"value":g=o;break;case"defaultValue":l=o;break;case"multiple":a=o;default:o!==c&&Uu(e,t,n,o,r,c)}return t=l,i=a,r=p,void(null!=g?wt(e,!!i,g,!1):!!r!==!!i&&(null!=t?wt(e,!!i,t,!0):wt(e,!!i,i?[]:"",!1)));case"textarea":for(l in p=g=null,i)if(n=i[l],i.hasOwnProperty(l)&&null!=n&&!r.hasOwnProperty(l))switch(l){case"value":case"children":break;default:Uu(e,t,l,null,r,n)}for(a in r)if(n=r[a],o=i[a],r.hasOwnProperty(a)&&(null!=n||null!=o))switch(a){case"value":g=n;break;case"defaultValue":p=n;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=n)throw Error(s(91));break;default:n!==o&&Uu(e,t,a,n,r,o)}return void bt(e,g,p);case"option":for(var f in i)if(g=i[f],i.hasOwnProperty(f)&&null!=g&&!r.hasOwnProperty(f))if("selected"===f)e.selected=!1;else Uu(e,t,f,null,r,g);for(c in r)if(g=r[c],p=i[c],r.hasOwnProperty(c)&&g!==p&&(null!=g||null!=p))if("selected"===c)e.selected=g&&"function"!==typeof g&&"symbol"!==typeof g;else Uu(e,t,c,g,r,p);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var m in i)g=i[m],i.hasOwnProperty(m)&&null!=g&&!r.hasOwnProperty(m)&&Uu(e,t,m,null,r,g);for(u in r)if(g=r[u],p=i[u],r.hasOwnProperty(u)&&g!==p&&(null!=g||null!=p))switch(u){case"children":case"dangerouslySetInnerHTML":if(null!=g)throw Error(s(137,t));break;default:Uu(e,t,u,g,r,p)}return;default:if(Tt(t)){for(var v in i)g=i[v],i.hasOwnProperty(v)&&void 0!==g&&!r.hasOwnProperty(v)&&ju(e,t,v,void 0,r,g);for(d in r)g=r[d],p=i[d],!r.hasOwnProperty(d)||g===p||void 0===g&&void 0===p||ju(e,t,d,g,r,p);return}}for(var C in i)g=i[C],i.hasOwnProperty(C)&&null!=g&&!r.hasOwnProperty(C)&&Uu(e,t,C,null,r,g);for(h in r)g=r[h],p=i[h],!r.hasOwnProperty(h)||g===p||null==g&&null==p||Uu(e,t,h,g,r,p)}(r,e.type,i,t),r[He]=t}catch(n){ru(e,e.return,n)}}function qa(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag||4===e.tag}function Qa(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||qa(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&27!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function $a(e,t,i){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===i.nodeType?i.parentNode.insertBefore(e,t):i.insertBefore(e,t):(8===i.nodeType?(t=i.parentNode).insertBefore(e,i):(t=i).appendChild(e),null!==(i=i._reactRootContainer)&&void 0!==i||null!==t.onclick||(t.onclick=Wu));else if(4!==r&&27!==r&&null!==(e=e.child))for($a(e,t,i),e=e.sibling;null!==e;)$a(e,t,i),e=e.sibling}function Xa(e,t,i){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?i.insertBefore(e,t):i.appendChild(e);else if(4!==r&&27!==r&&null!==(e=e.child))for(Xa(e,t,i),e=e.sibling;null!==e;)Xa(e,t,i),e=e.sibling}var Ja=!1,Za=!1,el=!1,tl="function"===typeof WeakSet?WeakSet:Set,il=null,rl=!1;function nl(e,t,i){var r=i.flags;switch(i.tag){case 0:case 11:case 15:vl(e,i),4&r&&za(5,i);break;case 1:if(vl(e,i),4&r)if(e=i.stateNode,null===t)try{e.componentDidMount()}catch(a){ru(i,i.return,a)}else{var n=Is(i.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(n,t,e.__reactInternalSnapshotBeforeUpdate)}catch(l){ru(i,i.return,l)}}64&r&&_a(i),512&r&&Ua(i,i.return);break;case 3:if(vl(e,i),64&r&&null!==(r=i.updateQueue)){if(e=null,null!==i.child)switch(i.child.tag){case 27:case 5:case 1:e=i.child.stateNode}try{Ha(r,e)}catch(a){ru(i,i.return,a)}}break;case 26:vl(e,i),512&r&&Ua(i,i.return);break;case 27:case 5:vl(e,i),null===t&&4&r&&Ka(i),512&r&&Ua(i,i.return);break;case 12:default:vl(e,i);break;case 13:vl(e,i),4&r&&ul(e,i);break;case 22:if(!(n=null!==i.memoizedState||Ja)){t=null!==t&&null!==t.memoizedState||Za;var o=Ja,s=Za;Ja=n,(Za=t)&&!s?wl(e,i,0!==(8772&i.subtreeFlags)):vl(e,i),Ja=o,Za=s}512&r&&("manual"===i.memoizedProps.mode?Ua(i,i.return):ja(i,i.return))}}function ol(e){var t=e.alternate;null!==t&&(e.alternate=null,ol(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&Ke(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var sl=null,al=!1;function ll(e,t,i){for(i=i.child;null!==i;)cl(e,t,i),i=i.sibling}function cl(e,t,i){if(Ce&&"function"===typeof Ce.onCommitFiberUnmount)try{Ce.onCommitFiberUnmount(ve,i)}catch(s){}switch(i.tag){case 26:Za||ja(i,t),ll(e,t,i),i.memoizedState?i.memoizedState.count--:i.stateNode&&(i=i.stateNode).parentNode.removeChild(i);break;case 27:Za||ja(i,t);var r=sl,n=al;for(sl=i.stateNode,ll(e,t,i),t=(i=i.stateNode).attributes;t.length;)i.removeAttributeNode(t[0]);Ke(i),sl=r,al=n;break;case 5:Za||ja(i,t);case 6:n=sl;var o=al;if(sl=null,ll(e,t,i),al=o,null!==(sl=n))if(al)try{e=sl,r=i.stateNode,8===e.nodeType?e.parentNode.removeChild(r):e.removeChild(r)}catch(a){ru(i,t,a)}else try{sl.removeChild(i.stateNode)}catch(a){ru(i,t,a)}break;case 18:null!==sl&&(al?(t=sl,i=i.stateNode,8===t.nodeType?od(t.parentNode,i):1===t.nodeType&&od(t,i),fh(t)):od(sl,i.stateNode));break;case 4:r=sl,n=al,sl=i.stateNode.containerInfo,al=!0,ll(e,t,i),sl=r,al=n;break;case 0:case 11:case 14:case 15:Za||Va(2,i,t),Za||Va(4,i,t),ll(e,t,i);break;case 1:Za||(ja(i,t),"function"===typeof(r=i.stateNode).componentWillUnmount&&Wa(i,t,r)),ll(e,t,i);break;case 21:ll(e,t,i);break;case 22:Za||ja(i,t),Za=(r=Za)||null!==i.memoizedState,ll(e,t,i),Za=r;break;default:ll(e,t,i)}}function ul(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{fh(e)}catch(i){ru(t,t.return,i)}}function dl(e,t){var i=function(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new tl),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new tl),t;default:throw Error(s(435,e.tag))}}(e);t.forEach((function(t){var r=lu.bind(null,e,t);i.has(t)||(i.add(t),t.then(r,r))}))}function hl(e,t){var i=t.deletions;if(null!==i)for(var r=0;r<i.length;r++){var n=i[r],o=e,a=t,l=a;e:for(;null!==l;){switch(l.tag){case 27:case 5:sl=l.stateNode,al=!1;break e;case 3:case 4:sl=l.stateNode.containerInfo,al=!0;break e}l=l.return}if(null===sl)throw Error(s(160));cl(o,a,n),sl=null,al=!1,null!==(o=n.alternate)&&(o.return=null),n.return=null}if(13878&t.subtreeFlags)for(t=t.child;null!==t;)pl(t,e),t=t.sibling}var gl=null;function pl(e,t){var i=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:hl(t,e),fl(e),4&r&&(Va(3,e,e.return),za(3,e),Va(5,e,e.return));break;case 1:hl(t,e),fl(e),512&r&&(Za||null===i||ja(i,i.return)),64&r&&Ja&&(null!==(e=e.updateQueue)&&(null!==(r=e.callbacks)&&(i=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===i?r:i.concat(r))));break;case 26:var n=gl;if(hl(t,e),fl(e),512&r&&(Za||null===i||ja(i,i.return)),4&r){var o=null!==i?i.memoizedState:null;if(r=e.memoizedState,null===i)if(null===r)if(null===e.stateNode){e:{r=e.type,i=e.memoizedProps,n=n.ownerDocument||n;t:switch(r){case"title":(!(o=n.getElementsByTagName("title")[0])||o[je]||o[Ge]||"http://www.w3.org/2000/svg"===o.namespaceURI||o.hasAttribute("itemprop"))&&(o=n.createElement(r),n.head.insertBefore(o,n.querySelector("head > title"))),Ku(o,r,i),o[Ge]=e,Xe(o),r=o;break e;case"link":var a=Fd("link","href",n).get(r+(i.href||""));if(a)for(var l=0;l<a.length;l++)if((o=a[l]).getAttribute("href")===(null==i.href?null:i.href)&&o.getAttribute("rel")===(null==i.rel?null:i.rel)&&o.getAttribute("title")===(null==i.title?null:i.title)&&o.getAttribute("crossorigin")===(null==i.crossOrigin?null:i.crossOrigin)){a.splice(l,1);break t}Ku(o=n.createElement(r),r,i),n.head.appendChild(o);break;case"meta":if(a=Fd("meta","content",n).get(r+(i.content||"")))for(l=0;l<a.length;l++)if((o=a[l]).getAttribute("content")===(null==i.content?null:""+i.content)&&o.getAttribute("name")===(null==i.name?null:i.name)&&o.getAttribute("property")===(null==i.property?null:i.property)&&o.getAttribute("http-equiv")===(null==i.httpEquiv?null:i.httpEquiv)&&o.getAttribute("charset")===(null==i.charSet?null:i.charSet)){a.splice(l,1);break t}Ku(o=n.createElement(r),r,i),n.head.appendChild(o);break;default:throw Error(s(468,r))}o[Ge]=e,Xe(o),r=o}e.stateNode=r}else Pd(n,e.type,e.stateNode);else e.stateNode=yd(n,r,e.memoizedProps);else o!==r?(null===o?null!==i.stateNode&&(i=i.stateNode).parentNode.removeChild(i):o.count--,null===r?Pd(n,e.type,e.stateNode):yd(n,r,e.memoizedProps)):null===r&&null!==e.stateNode&&Ya(e,e.memoizedProps,i.memoizedProps)}break;case 27:if(4&r&&null===e.alternate){n=e.stateNode,o=e.memoizedProps;try{for(var c=n.firstChild;c;){var u=c.nextSibling,d=c.nodeName;c[je]||"HEAD"===d||"BODY"===d||"SCRIPT"===d||"STYLE"===d||"LINK"===d&&"stylesheet"===c.rel.toLowerCase()||n.removeChild(c),c=u}for(var h=e.type,g=n.attributes;g.length;)n.removeAttributeNode(g[0]);Ku(n,h,o),n[Ge]=e,n[He]=o}catch(f){ru(e,e.return,f)}}case 5:if(hl(t,e),fl(e),512&r&&(Za||null===i||ja(i,i.return)),32&e.flags){n=e.stateNode;try{yt(n,"")}catch(f){ru(e,e.return,f)}}4&r&&null!=e.stateNode&&Ya(e,n=e.memoizedProps,null!==i?i.memoizedProps:n),1024&r&&(el=!0);break;case 6:if(hl(t,e),fl(e),4&r){if(null===e.stateNode)throw Error(s(162));r=e.memoizedProps,i=e.stateNode;try{i.nodeValue=r}catch(f){ru(e,e.return,f)}}break;case 3:if(Td=null,n=gl,gl=hd(t.containerInfo),hl(t,e),gl=n,fl(e),4&r&&null!==i&&i.memoizedState.isDehydrated)try{fh(t.containerInfo)}catch(f){ru(e,e.return,f)}el&&(el=!1,ml(e));break;case 4:r=gl,gl=hd(e.stateNode.containerInfo),hl(t,e),fl(e),gl=r;break;case 12:hl(t,e),fl(e);break;case 13:hl(t,e),fl(e),8192&e.child.flags&&null!==e.memoizedState!==(null!==i&&null!==i.memoizedState)&&(wc=le()),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,dl(e,r)));break;case 22:if(512&r&&(Za||null===i||ja(i,i.return)),c=null!==e.memoizedState,u=null!==i&&null!==i.memoizedState,Ja=(d=Ja)||c,Za=(h=Za)||u,hl(t,e),Za=h,Ja=d,fl(e),(t=e.stateNode)._current=e,t._visibility&=-3,t._visibility|=2&t._pendingVisibility,8192&r&&(t._visibility=c?-2&t._visibility:1|t._visibility,c&&(t=Ja||Za,null===i||u||t||Cl(e)),null===e.memoizedProps||"manual"!==e.memoizedProps.mode))e:for(i=null,t=e;;){if(5===t.tag||26===t.tag||27===t.tag){if(null===i){u=i=t;try{if(n=u.stateNode,c)"function"===typeof(o=n.style).setProperty?o.setProperty("display","none","important"):o.display="none";else{a=u.stateNode;var p=void 0!==(l=u.memoizedProps.style)&&null!==l&&l.hasOwnProperty("display")?l.display:null;a.style.display=null==p||"boolean"===typeof p?"":(""+p).trim()}}catch(f){ru(u,u.return,f)}}}else if(6===t.tag){if(null===i){u=t;try{u.stateNode.nodeValue=c?"":u.memoizedProps}catch(f){ru(u,u.return,f)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;i===t&&(i=null),t=t.return}i===t&&(i=null),t.sibling.return=t.return,t=t.sibling}4&r&&(null!==(r=e.updateQueue)&&(null!==(i=r.retryQueue)&&(r.retryQueue=null,dl(e,i))));break;case 19:hl(t,e),fl(e),4&r&&(null!==(r=e.updateQueue)&&(e.updateQueue=null,dl(e,r)));break;case 21:break;default:hl(t,e),fl(e)}}function fl(e){var t=e.flags;if(2&t){try{if(27!==e.tag){e:{for(var i=e.return;null!==i;){if(qa(i)){var r=i;break e}i=i.return}throw Error(s(160))}switch(r.tag){case 27:var n=r.stateNode;Xa(e,Qa(e),n);break;case 5:var o=r.stateNode;32&r.flags&&(yt(o,""),r.flags&=-33),Xa(e,Qa(e),o);break;case 3:case 4:var a=r.stateNode.containerInfo;$a(e,Qa(e),a);break;default:throw Error(s(161))}}}catch(l){ru(e,e.return,l)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function ml(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;ml(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function vl(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)nl(e,t.alternate,t),t=t.sibling}function Cl(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:Va(4,t,t.return),Cl(t);break;case 1:ja(t,t.return);var i=t.stateNode;"function"===typeof i.componentWillUnmount&&Wa(t,t.return,i),Cl(t);break;case 26:case 27:case 5:ja(t,t.return),Cl(t);break;case 22:ja(t,t.return),null===t.memoizedState&&Cl(t);break;default:Cl(t)}e=e.sibling}}function wl(e,t,i){for(i=i&&0!==(8772&t.subtreeFlags),t=t.child;null!==t;){var r=t.alternate,n=e,o=t,s=o.flags;switch(o.tag){case 0:case 11:case 15:wl(n,o,i),za(4,o);break;case 1:if(wl(n,o,i),"function"===typeof(n=(r=o).stateNode).componentDidMount)try{n.componentDidMount()}catch(c){ru(r,r.return,c)}if(null!==(n=(r=o).updateQueue)){var a=r.stateNode;try{var l=n.shared.hiddenCallbacks;if(null!==l)for(n.shared.hiddenCallbacks=null,n=0;n<l.length;n++)Ga(l[n],a)}catch(c){ru(r,r.return,c)}}i&&64&s&&_a(o),Ua(o,o.return);break;case 26:case 27:case 5:wl(n,o,i),i&&null===r&&4&s&&Ka(o),Ua(o,o.return);break;case 12:default:wl(n,o,i);break;case 13:wl(n,o,i),i&&4&s&&ul(n,o);break;case 22:null===o.memoizedState&&wl(n,o,i),Ua(o,o.return)}t=t.sibling}}function bl(e,t){var i=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(i=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==i&&(null!=e&&e.refCount++,null!=i&&Vn(i))}function Sl(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Vn(e))}function yl(e,t,i,r){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)Rl(e,t,i,r),t=t.sibling}function Rl(e,t,i,r){var n=t.flags;switch(t.tag){case 0:case 11:case 15:yl(e,t,i,r),2048&n&&za(9,t);break;case 3:yl(e,t,i,r),2048&n&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Vn(e)));break;case 12:if(2048&n){yl(e,t,i,r),e=t.stateNode;try{var o=t.memoizedProps,s=o.id,a=o.onPostCommit;"function"===typeof a&&a(s,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(l){ru(t,t.return,l)}}else yl(e,t,i,r);break;case 23:break;case 22:o=t.stateNode,null!==t.memoizedState?4&o._visibility?yl(e,t,i,r):xl(e,t):4&o._visibility?yl(e,t,i,r):(o._visibility|=4,El(e,t,i,r,0!==(10256&t.subtreeFlags))),2048&n&&bl(t.alternate,t);break;case 24:yl(e,t,i,r),2048&n&&Sl(t.alternate,t);break;default:yl(e,t,i,r)}}function El(e,t,i,r,n){for(n=n&&0!==(10256&t.subtreeFlags),t=t.child;null!==t;){var o=e,s=t,a=i,l=r,c=s.flags;switch(s.tag){case 0:case 11:case 15:El(o,s,a,l,n),za(8,s);break;case 23:break;case 22:var u=s.stateNode;null!==s.memoizedState?4&u._visibility?El(o,s,a,l,n):xl(o,s):(u._visibility|=4,El(o,s,a,l,n)),n&&2048&c&&bl(s.alternate,s);break;case 24:El(o,s,a,l,n),n&&2048&c&&Sl(s.alternate,s);break;default:El(o,s,a,l,n)}t=t.sibling}}function xl(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var i=e,r=t,n=r.flags;switch(r.tag){case 22:xl(i,r),2048&n&&bl(r.alternate,r);break;case 24:xl(i,r),2048&n&&Sl(r.alternate,r);break;default:xl(i,r)}t=t.sibling}}var Tl=8192;function Fl(e){if(e.subtreeFlags&Tl)for(e=e.child;null!==e;)Pl(e),e=e.sibling}function Pl(e){switch(e.tag){case 26:Fl(e),e.flags&Tl&&null!==e.memoizedState&&function(e,t,i){if(null===kd)throw Error(s(475));var r=kd;if("stylesheet"===t.type&&("string"!==typeof i.media||!1!==matchMedia(i.media).matches)&&0===(4&t.state.loading)){if(null===t.instance){var n=vd(i.href),o=e.querySelector(Cd(n));if(o)return null!==(e=o._p)&&"object"===typeof e&&"function"===typeof e.then&&(r.count++,r=Md.bind(r),e.then(r,r)),t.state.loading|=4,t.instance=o,void Xe(o);o=e.ownerDocument||e,i=wd(i),(n=ud.get(n))&&Ed(i,n),Xe(o=o.createElement("link"));var a=o;a._p=new Promise((function(e,t){a.onload=e,a.onerror=t})),Ku(o,"link",i),t.instance=o}null===r.stylesheets&&(r.stylesheets=new Map),r.stylesheets.set(t,e),(e=t.state.preload)&&0===(3&t.state.loading)&&(r.count++,t=Md.bind(r),e.addEventListener("load",t),e.addEventListener("error",t))}}(gl,e.memoizedState,e.memoizedProps);break;case 5:default:Fl(e);break;case 3:case 4:var t=gl;gl=hd(e.stateNode.containerInfo),Fl(e),gl=t;break;case 22:null===e.memoizedState&&(null!==(t=e.alternate)&&null!==t.memoizedState?(t=Tl,Tl=16777216,Fl(e),Tl=t):Fl(e))}}function Dl(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function kl(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var i=0;i<t.length;i++){var r=t[i];il=r,Il(r,e)}Dl(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)Al(e),e=e.sibling}function Al(e){switch(e.tag){case 0:case 11:case 15:kl(e),2048&e.flags&&Va(9,e,e.return);break;case 3:case 12:default:kl(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&4&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-5,Ml(e)):kl(e)}}function Ml(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var i=0;i<t.length;i++){var r=t[i];il=r,Il(r,e)}Dl(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:Va(8,t,t.return),Ml(t);break;case 22:4&(i=t.stateNode)._visibility&&(i._visibility&=-5,Ml(t));break;default:Ml(t)}e=e.sibling}}function Il(e,t){for(;null!==il;){var i=il;switch(i.tag){case 0:case 11:case 15:Va(8,i,t);break;case 23:case 22:if(null!==i.memoizedState&&null!==i.memoizedState.cachePool){var r=i.memoizedState.cachePool.pool;null!=r&&r.refCount++}break;case 24:Vn(i.memoizedState.cache)}if(null!==(r=i.child))r.return=i,il=r;else e:for(i=e;null!==il;){var n=(r=il).sibling,o=r.return;if(ol(r),r===i){il=null;break e}if(null!==n){n.return=o,il=n;break e}il=o}}}function Ll(e,t,i,r){this.tag=e,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ol(e,t,i,r){return new Ll(e,t,i,r)}function Nl(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Bl(e,t){var i=e.alternate;return null===i?((i=Ol(e.tag,t,e.key,e.mode)).elementType=e.elementType,i.type=e.type,i.stateNode=e.stateNode,i.alternate=e,e.alternate=i):(i.pendingProps=t,i.type=e.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=31457280&e.flags,i.childLanes=e.childLanes,i.lanes=e.lanes,i.child=e.child,i.memoizedProps=e.memoizedProps,i.memoizedState=e.memoizedState,i.updateQueue=e.updateQueue,t=e.dependencies,i.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},i.sibling=e.sibling,i.index=e.index,i.ref=e.ref,i.refCleanup=e.refCleanup,i}function Gl(e,t){e.flags&=31457282;var i=e.alternate;return null===i?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=i.childLanes,e.lanes=i.lanes,e.child=i.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=i.memoizedProps,e.memoizedState=i.memoizedState,e.updateQueue=i.updateQueue,e.type=i.type,t=i.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Hl(e,t,i,r,n,o){var a=0;if(r=e,"function"===typeof e)Nl(e)&&(a=1);else if("string"===typeof e)a=function(e,t,i){if(1===i||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!==typeof t.precedence||"string"!==typeof t.href||""===t.href)break;return!0;case"link":if("string"!==typeof t.rel||"string"!==typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"===typeof t.precedence&&null==e);case"script":if(t.async&&"function"!==typeof t.async&&"symbol"!==typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"===typeof t.src)return!0}return!1}(e,i,Q.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case d:return zl(i.children,n,o,t);case h:a=8,n|=24;break;case g:return(e=Ol(12,i,t,2|n)).elementType=g,e.lanes=o,e;case C:return(e=Ol(13,i,t,n)).elementType=C,e.lanes=o,e;case w:return(e=Ol(19,i,t,n)).elementType=w,e.lanes=o,e;case y:return Vl(i,n,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case p:case m:a=10;break e;case f:a=9;break e;case v:a=11;break e;case b:a=14;break e;case S:a=16,r=null;break e}a=29,i=Error(s(130,null===e?"null":typeof e,"")),r=null}return(t=Ol(a,i,t,n)).elementType=e,t.type=r,t.lanes=o,t}function zl(e,t,i,r){return(e=Ol(7,e,r,t)).lanes=i,e}function Vl(e,t,i,r){(e=Ol(22,e,r,t)).elementType=y,e.lanes=i;var n={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var e=n._current;if(null===e)throw Error(s(456));if(0===(2&n._pendingVisibility)){var t=Pr(e,2);null!==t&&(n._pendingVisibility|=2,Mc(t,e,2))}},attach:function(){var e=n._current;if(null===e)throw Error(s(456));if(0!==(2&n._pendingVisibility)){var t=Pr(e,2);null!==t&&(n._pendingVisibility&=-3,Mc(t,e,2))}}};return e.stateNode=n,e}function _l(e,t,i){return(e=Ol(6,e,null,t)).lanes=i,e}function Wl(e,t,i){return(t=Ol(4,null!==e.children?e.children:[],e.key,t)).lanes=i,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Ul(e){e.flags|=4}function jl(e,t){if("stylesheet"!==t.type||0!==(4&t.state.loading))e.flags&=-16777217;else if(e.flags|=16777216,!Dd(t)){if(null!==(t=Pn.current)&&((4194176&rc)===rc?null!==Dn:(62914560&rc)!==rc&&0===(536870912&rc)||t!==Dn))throw hn=ln,an;e.flags|=8192}}function Kl(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?ke():536870912,e.lanes|=t,fc|=t)}function Yl(e,t){if(!Qr)switch(e.tailMode){case"hidden":t=e.tail;for(var i=null;null!==t;)null!==t.alternate&&(i=t),t=t.sibling;null===i?e.tail=null:i.sibling=null;break;case"collapsed":i=e.tail;for(var r=null;null!==i;)null!==i.alternate&&(r=i),i=i.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function ql(e){var t=null!==e.alternate&&e.alternate.child===e.child,i=0,r=0;if(t)for(var n=e.child;null!==n;)i|=n.lanes|n.childLanes,r|=31457280&n.subtreeFlags,r|=31457280&n.flags,n.return=e,n=n.sibling;else for(n=e.child;null!==n;)i|=n.lanes|n.childLanes,r|=n.subtreeFlags,r|=n.flags,n.return=e,n=n.sibling;return e.subtreeFlags|=r,e.childLanes=i,t}function Ql(e,t,i){var r=t.pendingProps;switch(Kr(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return ql(t),null;case 3:return i=t.stateNode,r=null,null!==e&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),wa(Hn),ee(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),null!==e&&null!==e.child||(rn(t)?Ul(t):null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==$r&&(Lc($r),$r=null))),ql(t),null;case 26:return i=t.memoizedState,null===e?(Ul(t),null!==i?(ql(t),jl(t,i)):(ql(t),t.flags&=-16777217)):i?i!==e.memoizedState?(Ul(t),ql(t),jl(t,i)):(ql(t),t.flags&=-16777217):(e.memoizedProps!==r&&Ul(t),ql(t),t.flags&=-16777217),null;case 27:ie(t),i=X.current;var n=t.type;if(null!==e&&null!=t.stateNode)e.memoizedProps!==r&&Ul(t);else{if(!r){if(null===t.stateNode)throw Error(s(166));return ql(t),null}e=Q.current,rn(t)?en(t):(e=cd(n,r,i),t.stateNode=e,Ul(t))}return ql(t),null;case 5:if(ie(t),i=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==r&&Ul(t);else{if(!r){if(null===t.stateNode)throw Error(s(166));return ql(t),null}if(e=Q.current,rn(t))en(t);else{switch(n=Qu(X.current),e){case 1:e=n.createElementNS("http://www.w3.org/2000/svg",i);break;case 2:e=n.createElementNS("http://www.w3.org/1998/Math/MathML",i);break;default:switch(i){case"svg":e=n.createElementNS("http://www.w3.org/2000/svg",i);break;case"math":e=n.createElementNS("http://www.w3.org/1998/Math/MathML",i);break;case"script":(e=n.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e="string"===typeof r.is?n.createElement("select",{is:r.is}):n.createElement("select"),r.multiple?e.multiple=!0:r.size&&(e.size=r.size);break;default:e="string"===typeof r.is?n.createElement(i,{is:r.is}):n.createElement(i)}}e[Ge]=t,e[He]=r;e:for(n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&27!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break e;for(;null===n.sibling;){if(null===n.return||n.return===t)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}t.stateNode=e;e:switch(Ku(e,i,r),i){case"button":case"input":case"select":case"textarea":e=!!r.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&Ul(t)}}return ql(t),t.flags&=-16777217,null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==r&&Ul(t);else{if("string"!==typeof r&&null===t.stateNode)throw Error(s(166));if(e=X.current,rn(t)){if(e=t.stateNode,i=t.memoizedProps,r=null,null!==(n=Yr))switch(n.tag){case 27:case 5:r=n.memoizedProps}e[Ge]=t,(e=!!(e.nodeValue===i||null!==r&&!0===r.suppressHydrationWarning||_u(e.nodeValue,i)))||Zr(t)}else(e=Qu(e).createTextNode(r))[Ge]=t,t.stateNode=e}return ql(t),null;case 13:if(r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(n=rn(t),null!==r&&null!==r.dehydrated){if(null===e){if(!n)throw Error(s(318));if(!(n=null!==(n=t.memoizedState)?n.dehydrated:null))throw Error(s(317));n[Ge]=t}else nn(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;ql(t),n=!1}else null!==$r&&(Lc($r),$r=null),n=!0;if(!n)return 256&t.flags?(In(t),t):(In(t),null)}if(In(t),0!==(128&t.flags))return t.lanes=i,t;if(i=null!==r,e=null!==e&&null!==e.memoizedState,i){n=null,null!==(r=t.child).alternate&&null!==r.alternate.memoizedState&&null!==r.alternate.memoizedState.cachePool&&(n=r.alternate.memoizedState.cachePool.pool);var o=null;null!==r.memoizedState&&null!==r.memoizedState.cachePool&&(o=r.memoizedState.cachePool.pool),o!==n&&(r.flags|=2048)}return i!==e&&i&&(t.child.flags|=8192),Kl(t,t.updateQueue),ql(t),null;case 4:return ee(),null===e&&Mu(t.stateNode.containerInfo),ql(t),null;case 10:return wa(t.type),ql(t),null;case 19:if(Y(Ln),null===(n=t.memoizedState))return ql(t),null;if(r=0!==(128&t.flags),null===(o=n.rendering))if(r)Yl(n,!1);else{if(0!==uc||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(o=On(e))){for(t.flags|=128,Yl(n,!1),e=o.updateQueue,t.updateQueue=e,Kl(t,e),t.subtreeFlags=0,e=i,i=t.child;null!==i;)Gl(i,e),i=i.sibling;return q(Ln,1&Ln.current|2),t.child}e=e.sibling}null!==n.tail&&le()>bc&&(t.flags|=128,r=!0,Yl(n,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=On(o))){if(t.flags|=128,r=!0,e=e.updateQueue,t.updateQueue=e,Kl(t,e),Yl(n,!0),null===n.tail&&"hidden"===n.tailMode&&!o.alternate&&!Qr)return ql(t),null}else 2*le()-n.renderingStartTime>bc&&536870912!==i&&(t.flags|=128,r=!0,Yl(n,!1),t.lanes=4194304);n.isBackwards?(o.sibling=t.child,t.child=o):(null!==(e=n.last)?e.sibling=o:t.child=o,n.last=o)}return null!==n.tail?(t=n.tail,n.rendering=t,n.tail=t.sibling,n.renderingStartTime=le(),t.sibling=null,e=Ln.current,q(Ln,r?1&e|2:1&e),t):(ql(t),null);case 22:case 23:return In(t),Fn(),r=null!==t.memoizedState,null!==e?null!==e.memoizedState!==r&&(t.flags|=8192):r&&(t.flags|=8192),r?0!==(536870912&i)&&0===(128&t.flags)&&(ql(t),6&t.subtreeFlags&&(t.flags|=8192)):ql(t),null!==(i=t.updateQueue)&&Kl(t,i.retryQueue),i=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(i=e.memoizedState.cachePool.pool),r=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(r=t.memoizedState.cachePool.pool),r!==i&&(t.flags|=2048),null!==e&&Y(qn),null;case 24:return i=null,null!==e&&(i=e.memoizedState.cache),t.memoizedState.cache!==i&&(t.flags|=2048),wa(Hn),ql(t),null;case 25:return null}throw Error(s(156,t.tag))}function $l(e,t){switch(Kr(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return wa(Hn),ee(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return ie(t),null;case 13:if(In(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));nn()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Y(Ln),null;case 4:return ee(),null;case 10:return wa(t.type),null;case 22:case 23:return In(t),Fn(),null!==e&&Y(qn),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return wa(Hn),null;default:return null}}function Xl(e,t){switch(Kr(t),t.tag){case 3:wa(Hn),ee();break;case 26:case 27:case 5:ie(t);break;case 4:ee();break;case 13:In(t);break;case 19:Y(Ln);break;case 10:wa(t.type);break;case 22:case 23:In(t),Fn(),null!==e&&Y(qn);break;case 24:wa(Hn)}}var Jl={getCacheForType:function(e){var t=xa(Hn),i=t.data.get(e);return void 0===i&&(i=e(),t.data.set(e,i)),i}},Zl="function"===typeof WeakMap?WeakMap:Map,ec=0,tc=null,ic=null,rc=0,nc=0,oc=null,sc=!1,ac=!1,lc=!1,cc=0,uc=0,dc=0,hc=0,gc=0,pc=0,fc=0,mc=null,vc=null,Cc=!1,wc=0,bc=1/0,Sc=null,yc=null,Rc=!1,Ec=null,xc=0,Tc=0,Fc=null,Pc=0,Dc=null;function kc(){if(0!==(2&ec)&&0!==rc)return rc&-rc;if(null!==k.T){return 0!==Un?Un:Su()}return Ne()}function Ac(){0===pc&&(pc=0===(536870912&rc)||Qr?De():536870912);var e=Pn.current;return null!==e&&(e.flags|=32),pc}function Mc(e,t,i){(e===tc&&2===nc||null!==e.cancelPendingCommit)&&(zc(e,0),Bc(e,rc,pc,!1)),Me(e,i),0!==(2&ec)&&e===tc||(e===tc&&(0===(2&ec)&&(hc|=i),4===uc&&Bc(e,rc,pc,!1)),fu(e))}function Ic(e,t,i){if(0!==(6&ec))throw Error(s(327));for(var r=!i&&0===(60&t)&&0===(t&e.expiredLanes)||Fe(e,t),n=r?function(e,t){var i=ec;ec|=2;var r=_c(),n=Wc();tc!==e||rc!==t?(Sc=null,bc=le()+500,zc(e,t)):ac=Fe(e,t);e:for(;;)try{if(0!==nc&&null!==ic){t=ic;var o=oc;t:switch(nc){case 1:nc=0,oc=null,$c(e,t,o,1);break;case 2:if(cn(o)){nc=0,oc=null,Qc(t);break}t=function(){2===nc&&tc===e&&(nc=7),fu(e)},o.then(t,t);break e;case 3:nc=7;break e;case 4:nc=5;break e;case 7:cn(o)?(nc=0,oc=null,Qc(t)):(nc=0,oc=null,$c(e,t,o,7));break;case 5:var a=null;switch(ic.tag){case 26:a=ic.memoizedState;case 5:case 27:var l=ic;if(!a||Dd(a)){nc=0,oc=null;var c=l.sibling;if(null!==c)ic=c;else{var u=l.return;null!==u?(ic=u,Xc(u)):ic=null}break t}}nc=0,oc=null,$c(e,t,o,5);break;case 6:nc=0,oc=null,$c(e,t,o,6);break;case 8:Hc(),uc=6;break e;default:throw Error(s(462))}}Yc();break}catch(d){Vc(e,d)}return va=ma=null,k.H=r,k.A=n,ec=i,null!==ic?0:(tc=null,rc=0,xr(),uc)}(e,t):jc(e,t,!0),o=r;;){if(0===n){ac&&!r&&Bc(e,t,0,!1);break}if(6===n)Bc(e,t,0,!sc);else{if(i=e.current.alternate,o&&!Nc(i)){n=jc(e,t,!1),o=!1;continue}if(2===n){if(o=t,e.errorRecoveryDisabledLanes&o)var a=0;else a=0!==(a=-536870913&e.pendingLanes)?a:536870912&a?536870912:0;if(0!==a){t=a;e:{var l=e;n=mc;var c=l.current.memoizedState.isDehydrated;if(c&&(zc(l,a).flags|=256),2!==(a=jc(l,a,!1))){if(lc&&!c){l.errorRecoveryDisabledLanes|=o,hc|=o,n=4;break e}o=vc,vc=n,null!==o&&Lc(o)}n=a}if(o=!1,2!==n)continue}}if(1===n){zc(e,0),Bc(e,t,0,!0);break}e:{switch(r=e,n){case 0:case 1:throw Error(s(345));case 4:if((4194176&t)===t){Bc(r,t,pc,!sc);break e}break;case 2:vc=null;break;case 3:case 5:break;default:throw Error(s(329))}if(r.finishedWork=i,r.finishedLanes=t,(62914560&t)===t&&10<(o=wc+300-le())){if(Bc(r,t,pc,!sc),0!==Te(r,0))break e;r.timeoutHandle=ed(Oc.bind(null,r,i,vc,Sc,Cc,t,pc,hc,fc,sc,2,-0,0),o)}else Oc(r,i,vc,Sc,Cc,t,pc,hc,fc,sc,0,-0,0)}}break}fu(e)}function Lc(e){null===vc?vc=e:vc.push.apply(vc,e)}function Oc(e,t,i,r,n,o,a,l,c,u,d,h,g){var p=t.subtreeFlags;if((8192&p||16785408===(16785408&p))&&(kd={stylesheets:null,count:0,unsuspend:Ad},Pl(t),null!==(t=function(){if(null===kd)throw Error(s(475));var e=kd;return e.stylesheets&&0===e.count&&Ld(e,e.stylesheets),0<e.count?function(t){var i=setTimeout((function(){if(e.stylesheets&&Ld(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}}),6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(i)}}:null}())))return e.cancelPendingCommit=t(Zc.bind(null,e,i,r,n,a,l,c,1,h,g)),void Bc(e,o,a,!u);Zc(e,i,r,n,a,l,c,d,h,g)}function Nc(e){for(var t=e;;){var i=t.tag;if((0===i||11===i||15===i)&&16384&t.flags&&(null!==(i=t.updateQueue)&&null!==(i=i.stores)))for(var r=0;r<i.length;r++){var n=i[r],o=n.getSnapshot;n=n.value;try{if(!Yi(o(),n))return!1}catch(s){return!1}}if(i=t.child,16384&t.subtreeFlags&&null!==i)i.return=t,t=i;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Bc(e,t,i,r){t&=~gc,t&=~hc,e.suspendedLanes|=t,e.pingedLanes&=~t,r&&(e.warmLanes|=t),r=e.expirationTimes;for(var n=t;0<n;){var o=31-be(n),s=1<<o;r[o]=-1,n&=~s}0!==i&&Ie(e,i,t)}function Gc(){return 0!==(6&ec)||(mu(0,!1),!1)}function Hc(){if(null!==ic){if(0===nc)var e=ic.return;else va=ma=null,Co(e=ic),pn=null,fn=0,e=ic;for(;null!==e;)Xl(e.alternate,e),e=e.return;ic=null}}function zc(e,t){e.finishedWork=null,e.finishedLanes=0;var i=e.timeoutHandle;-1!==i&&(e.timeoutHandle=-1,td(i)),null!==(i=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,i()),Hc(),tc=e,ic=i=Bl(e.current,null),rc=t,nc=0,oc=null,sc=!1,ac=Fe(e,t),lc=!1,fc=pc=gc=hc=dc=uc=0,vc=mc=null,Cc=!1,0!==(8&t)&&(t|=32&t);var r=e.entangledLanes;if(0!==r)for(e=e.entanglements,r&=t;0<r;){var n=31-be(r),o=1<<n;t|=e[n],r&=~o}return cc=t,xr(),i}function Vc(e,t){Zn=null,k.H=xs,t===sn?(t=gn(),nc=3):t===an?(t=gn(),nc=4):nc=t===Ws?8:null!==t&&"object"===typeof t&&"function"===typeof t.then?6:1,oc=t,null===ic&&(uc=1,Gs(e,Ir(t,e.current)))}function _c(){var e=k.H;return k.H=xs,null===e?xs:e}function Wc(){var e=k.A;return k.A=Jl,e}function Uc(){uc=4,sc||(4194176&rc)!==rc&&null!==Pn.current||(ac=!0),0===(134217727&dc)&&0===(134217727&hc)||null===tc||Bc(tc,rc,pc,!1)}function jc(e,t,i){var r=ec;ec|=2;var n=_c(),o=Wc();tc===e&&rc===t||(Sc=null,zc(e,t)),t=!1;var s=uc;e:for(;;)try{if(0!==nc&&null!==ic){var a=ic,l=oc;switch(nc){case 8:Hc(),s=6;break e;case 3:case 2:case 6:null===Pn.current&&(t=!0);var c=nc;if(nc=0,oc=null,$c(e,a,l,c),i&&ac){s=0;break e}break;default:c=nc,nc=0,oc=null,$c(e,a,l,c)}}Kc(),s=uc;break}catch(u){Vc(e,u)}return t&&e.shellSuspendCounter++,va=ma=null,ec=r,k.H=n,k.A=o,null===ic&&(tc=null,rc=0,xr()),s}function Kc(){for(;null!==ic;)qc(ic)}function Yc(){for(;null!==ic&&!se();)qc(ic)}function qc(e){var t=pa(e.alternate,e,cc);e.memoizedProps=e.pendingProps,null===t?Xc(e):ic=t}function Qc(e){var t=e,i=t.alternate;switch(t.tag){case 15:case 0:t=Zs(i,t,t.pendingProps,t.type,void 0,rc);break;case 11:t=Zs(i,t,t.pendingProps,t.type.render,t.ref,rc);break;case 5:Co(t);default:Xl(i,t),t=pa(i,t=ic=Gl(t,cc),cc)}e.memoizedProps=e.pendingProps,null===t?Xc(e):ic=t}function $c(e,t,i,r){va=ma=null,Co(t),pn=null,fn=0;var n=t.return;try{if(function(e,t,i,r,n){if(i.flags|=32768,null!==r&&"object"===typeof r&&"function"===typeof r.then){if(null!==(t=i.alternate)&&ya(t,i,n,!0),null!==(i=Pn.current)){switch(i.tag){case 13:return null===Dn?Uc():null===i.alternate&&0===uc&&(uc=3),i.flags&=-257,i.flags|=65536,i.lanes=n,r===ln?i.flags|=16384:(null===(t=i.updateQueue)?i.updateQueue=new Set([r]):t.add(r),nu(e,r,n)),!1;case 22:return i.flags|=65536,r===ln?i.flags|=16384:(null===(t=i.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([r])},i.updateQueue=t):null===(i=t.retryQueue)?t.retryQueue=new Set([r]):i.add(r),nu(e,r,n)),!1}throw Error(s(435,i.tag))}return nu(e,r,n),Uc(),!1}if(Qr)return null!==(t=Pn.current)?(0===(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=n,r!==Jr&&on(Ir(e=Error(s(422),{cause:r}),i))):(r!==Jr&&on(Ir(t=Error(s(423),{cause:r}),i)),(e=e.current.alternate).flags|=65536,n&=-n,e.lanes|=n,r=Ir(r,i),La(e,n=zs(e.stateNode,r,n)),4!==uc&&(uc=2)),!1;var o=Error(s(520),{cause:r});if(o=Ir(o,i),null===mc?mc=[o]:mc.push(o),4!==uc&&(uc=2),null===t)return!0;r=Ir(r,i),i=t;do{switch(i.tag){case 3:return i.flags|=65536,e=n&-n,i.lanes|=e,La(i,e=zs(i.stateNode,r,e)),!1;case 1:if(t=i.type,o=i.stateNode,0===(128&i.flags)&&("function"===typeof t.getDerivedStateFromError||null!==o&&"function"===typeof o.componentDidCatch&&(null===yc||!yc.has(o))))return i.flags|=65536,n&=-n,i.lanes|=n,_s(n=Vs(n),e,i,r),La(i,n),!1}i=i.return}while(null!==i);return!1}(e,n,t,i,rc))return uc=1,Gs(e,Ir(i,e.current)),void(ic=null)}catch(o){if(null!==n)throw ic=n,o;return uc=1,Gs(e,Ir(i,e.current)),void(ic=null)}32768&t.flags?(Qr||1===r?e=!0:ac||0!==(536870912&rc)?e=!1:(sc=e=!0,(2===r||3===r||6===r)&&(null!==(r=Pn.current)&&13===r.tag&&(r.flags|=16384))),Jc(t,e)):Xc(t)}function Xc(e){var t=e;do{if(0!==(32768&t.flags))return void Jc(t,sc);e=t.return;var i=Ql(t.alternate,t,cc);if(null!==i)return void(ic=i);if(null!==(t=t.sibling))return void(ic=t);ic=t=e}while(null!==t);0===uc&&(uc=5)}function Jc(e,t){do{var i=$l(e.alternate,e);if(null!==i)return i.flags&=32767,void(ic=i);if(null!==(i=e.return)&&(i.flags|=32768,i.subtreeFlags=0,i.deletions=null),!t&&null!==(e=e.sibling))return void(ic=e);ic=e=i}while(null!==e);uc=6,ic=null}function Zc(e,t,i,r,n,o,a,l,c,u){var d=k.T,h=_.p;try{_.p=2,k.T=null,function(e,t,i,r,n,o,a,l){do{tu()}while(null!==Ec);if(0!==(6&ec))throw Error(s(327));var c=e.finishedWork;if(r=e.finishedLanes,null===c)return null;if(e.finishedWork=null,e.finishedLanes=0,c===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0,e.cancelPendingCommit=null;var u=c.lanes|c.childLanes;if(function(e,t,i,r,n,o){var s=e.pendingLanes;e.pendingLanes=i,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=i,e.entangledLanes&=i,e.errorRecoveryDisabledLanes&=i,e.shellSuspendCounter=0;var a=e.entanglements,l=e.expirationTimes,c=e.hiddenUpdates;for(i=s&~i;0<i;){var u=31-be(i),d=1<<u;a[u]=0,l[u]=-1;var h=c[u];if(null!==h)for(c[u]=null,u=0;u<h.length;u++){var g=h[u];null!==g&&(g.lane&=-536870913)}i&=~d}0!==r&&Ie(e,r,0),0!==o&&0===n&&0!==e.tag&&(e.suspendedLanes|=o&~(s&~t))}(e,r,u|=Er,o,a,l),e===tc&&(ic=tc=null,rc=0),0===(10256&c.subtreeFlags)&&0===(10256&c.flags)||Rc||(Rc=!0,Tc=u,Fc=i,function(e,t){ne(e,t)}(he,(function(){return tu(),null}))),i=0!==(15990&c.flags),0!==(15990&c.subtreeFlags)||i?(i=k.T,k.T=null,o=_.p,_.p=2,a=ec,ec|=4,function(e,t){if(e=e.containerInfo,Yu=Ud,Zi(e=Ji(e))){if("selectionStart"in e)var i={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(i=(i=e.ownerDocument)&&i.defaultView||window).getSelection&&i.getSelection();if(r&&0!==r.rangeCount){i=r.anchorNode;var n=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{i.nodeType,o.nodeType}catch(m){i=null;break e}var a=0,l=-1,c=-1,u=0,d=0,h=e,g=null;t:for(;;){for(var p;h!==i||0!==n&&3!==h.nodeType||(l=a+n),h!==o||0!==r&&3!==h.nodeType||(c=a+r),3===h.nodeType&&(a+=h.nodeValue.length),null!==(p=h.firstChild);)g=h,h=p;for(;;){if(h===e)break t;if(g===i&&++u===n&&(l=a),g===o&&++d===r&&(c=a),null!==(p=h.nextSibling))break;g=(h=g).parentNode}h=p}i=-1===l||-1===c?null:{start:l,end:c}}else i=null}i=i||{start:0,end:0}}else i=null;for(qu={focusedElem:e,selectionRange:i},Ud=!1,il=t;null!==il;)if(e=(t=il).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,il=e;else for(;null!==il;){switch(o=(t=il).alternate,e=t.flags,t.tag){case 0:case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(0!==(1024&e)&&null!==o){e=void 0,i=t,n=o.memoizedProps,o=o.memoizedState,r=i.stateNode;try{var f=Is(i.type,n,(i.elementType,i.type));e=r.getSnapshotBeforeUpdate(f,o),r.__reactInternalSnapshotBeforeUpdate=e}catch(v){ru(i,i.return,v)}}break;case 3:if(0!==(1024&e))if(9===(i=(e=t.stateNode.containerInfo).nodeType))sd(e);else if(1===i)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":sd(e);break;default:e.textContent=""}break;default:if(0!==(1024&e))throw Error(s(163))}if(null!==(e=t.sibling)){e.return=t.return,il=e;break}il=t.return}f=rl,rl=!1}(e,c),pl(c,e),er(qu,e.containerInfo),Ud=!!Yu,qu=Yu=null,e.current=c,nl(e,c.alternate,c),ae(),ec=a,_.p=o,k.T=i):e.current=c,Rc?(Rc=!1,Ec=e,xc=r):eu(e,u),u=e.pendingLanes,0===u&&(yc=null),function(e){if(Ce&&"function"===typeof Ce.onCommitFiberRoot)try{Ce.onCommitFiberRoot(ve,e,void 0,128===(128&e.current.flags))}catch(t){}}(c.stateNode),fu(e),null!==t)for(n=e.onRecoverableError,c=0;c<t.length;c++)u=t[c],n(u.value,{componentStack:u.stack});0!==(3&xc)&&tu(),u=e.pendingLanes,0!==(4194218&r)&&0!==(42&u)?e===Dc?Pc++:(Pc=0,Dc=e):Pc=0,mu(0,!1)}(e,t,i,r,h,n,o,a)}finally{k.T=d,_.p=h}}function eu(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,Vn(t)))}function tu(){if(null!==Ec){var e=Ec,t=Tc;Tc=0;var i=Oe(xc),r=k.T,n=_.p;try{if(_.p=32>i?32:i,k.T=null,null===Ec)var o=!1;else{i=Fc,Fc=null;var a=Ec,l=xc;if(Ec=null,xc=0,0!==(6&ec))throw Error(s(331));var c=ec;if(ec|=4,Al(a.current),Rl(a,a.current,l,i),ec=c,mu(0,!1),Ce&&"function"===typeof Ce.onPostCommitFiberRoot)try{Ce.onPostCommitFiberRoot(ve,a)}catch(u){}o=!0}return o}finally{_.p=n,k.T=r,eu(e,t)}}return!1}function iu(e,t,i){t=Ir(i,t),null!==(e=Ma(e,t=zs(e.stateNode,t,2),2))&&(Me(e,2),fu(e))}function ru(e,t,i){if(3===e.tag)iu(e,e,i);else for(;null!==t;){if(3===t.tag){iu(t,e,i);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===yc||!yc.has(r))){e=Ir(i,e),null!==(r=Ma(t,i=Vs(2),2))&&(_s(i,r,t,e),Me(r,2),fu(r));break}}t=t.return}}function nu(e,t,i){var r=e.pingCache;if(null===r){r=e.pingCache=new Zl;var n=new Set;r.set(t,n)}else void 0===(n=r.get(t))&&(n=new Set,r.set(t,n));n.has(i)||(lc=!0,n.add(i),e=ou.bind(null,e,t,i),t.then(e,e))}function ou(e,t,i){var r=e.pingCache;null!==r&&r.delete(t),e.pingedLanes|=e.suspendedLanes&i,e.warmLanes&=~i,tc===e&&(rc&i)===i&&(4===uc||3===uc&&(62914560&rc)===rc&&300>le()-wc?0===(2&ec)&&zc(e,0):gc|=i,fc===rc&&(fc=0)),fu(e)}function su(e,t){0===t&&(t=ke()),null!==(e=Pr(e,t))&&(Me(e,t),fu(e))}function au(e){var t=e.memoizedState,i=0;null!==t&&(i=t.retryLane),su(e,i)}function lu(e,t){var i=0;switch(e.tag){case 13:var r=e.stateNode,n=e.memoizedState;null!==n&&(i=n.retryLane);break;case 19:r=e.stateNode;break;case 22:r=e.stateNode._retryCache;break;default:throw Error(s(314))}null!==r&&r.delete(t),su(e,i)}var cu=null,uu=null,du=!1,hu=!1,gu=!1,pu=0;function fu(e){var t;e!==uu&&null===e.next&&(null===uu?cu=uu=e:uu=uu.next=e),hu=!0,du||(du=!0,t=vu,rd((function(){0!==(6&ec)?ne(ue,t):t()})))}function mu(e,t){if(!gu&&hu){gu=!0;do{for(var i=!1,r=cu;null!==r;){if(!t)if(0!==e){var n=r.pendingLanes;if(0===n)var o=0;else{var s=r.suspendedLanes,a=r.pingedLanes;o=(1<<31-be(42|e)+1)-1,o=201326677&(o&=n&~(s&~a))?201326677&o|1:o?2|o:0}0!==o&&(i=!0,bu(r,o))}else o=rc,0===(3&(o=Te(r,r===tc?o:0)))||Fe(r,o)||(i=!0,bu(r,o));r=r.next}}while(i);gu=!1}}function vu(){hu=du=!1;var e=0;0!==pu&&(function(){var e=window.event;if(e&&"popstate"===e.type)return e!==Zu&&(Zu=e,!0);return Zu=null,!1}()&&(e=pu),pu=0);for(var t=le(),i=null,r=cu;null!==r;){var n=r.next,o=Cu(r,t);0===o?(r.next=null,null===i?cu=n:i.next=n,null===n&&(uu=i)):(i=r,(0!==e||0!==(3&o))&&(hu=!0)),r=n}mu(e,!1)}function Cu(e,t){for(var i=e.suspendedLanes,r=e.pingedLanes,n=e.expirationTimes,o=-62914561&e.pendingLanes;0<o;){var s=31-be(o),a=1<<s,l=n[s];-1===l?0!==(a&i)&&0===(a&r)||(n[s]=Pe(a,t)):l<=t&&(e.expiredLanes|=a),o&=~a}if(i=rc,i=Te(e,e===(t=tc)?i:0),r=e.callbackNode,0===i||e===t&&2===nc||null!==e.cancelPendingCommit)return null!==r&&null!==r&&oe(r),e.callbackNode=null,e.callbackPriority=0;if(0===(3&i)||Fe(e,i)){if((t=i&-i)===e.callbackPriority)return t;switch(null!==r&&oe(r),Oe(i)){case 2:case 8:i=de;break;case 32:default:i=he;break;case 268435456:i=pe}return r=wu.bind(null,e),i=ne(i,r),e.callbackPriority=t,e.callbackNode=i,t}return null!==r&&null!==r&&oe(r),e.callbackPriority=2,e.callbackNode=null,2}function wu(e,t){var i=e.callbackNode;if(tu()&&e.callbackNode!==i)return null;var r=rc;return 0===(r=Te(e,e===tc?r:0))?null:(Ic(e,r,t),Cu(e,le()),null!=e.callbackNode&&e.callbackNode===i?wu.bind(null,e):null)}function bu(e,t){if(tu())return null;Ic(e,t,!0)}function Su(){return 0===pu&&(pu=De()),pu}function yu(e){return null==e||"symbol"===typeof e||"boolean"===typeof e?null:"function"===typeof e?e:Dt(""+e)}function Ru(e,t){var i=t.ownerDocument.createElement("input");return i.name=t.name,i.value=t.value,e.id&&i.setAttribute("form",e.id),t.parentNode.insertBefore(i,t),e=new FormData(e),i.parentNode.removeChild(i),e}for(var Eu=0;Eu<br.length;Eu++){var xu=br[Eu];Sr(xu.toLowerCase(),"on"+(xu[0].toUpperCase()+xu.slice(1)))}Sr(hr,"onAnimationEnd"),Sr(gr,"onAnimationIteration"),Sr(pr,"onAnimationStart"),Sr("dblclick","onDoubleClick"),Sr("focusin","onFocus"),Sr("focusout","onBlur"),Sr(fr,"onTransitionRun"),Sr(mr,"onTransitionStart"),Sr(vr,"onTransitionCancel"),Sr(Cr,"onTransitionEnd"),tt("onMouseEnter",["mouseout","mouseover"]),tt("onMouseLeave",["mouseout","mouseover"]),tt("onPointerEnter",["pointerout","pointerover"]),tt("onPointerLeave",["pointerout","pointerover"]),et("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),et("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),et("onBeforeInput",["compositionend","keypress","textInput","paste"]),et("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),et("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),et("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Tu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Fu=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Tu));function Pu(e,t){t=0!==(4&t);for(var i=0;i<e.length;i++){var r=e[i],n=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var s=r.length-1;0<=s;s--){var a=r[s],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==o&&n.isPropagationStopped())break e;o=a,n.currentTarget=c;try{o(n)}catch(u){Ls(u)}n.currentTarget=null,o=l}else for(s=0;s<r.length;s++){if(l=(a=r[s]).instance,c=a.currentTarget,a=a.listener,l!==o&&n.isPropagationStopped())break e;o=a,n.currentTarget=c;try{o(n)}catch(u){Ls(u)}n.currentTarget=null,o=l}}}}function Du(e,t){var i=t[Ve];void 0===i&&(i=t[Ve]=new Set);var r=e+"__bubble";i.has(r)||(Iu(t,e,2,!1),i.add(r))}function ku(e,t,i){var r=0;t&&(r|=4),Iu(i,e,r,t)}var Au="_reactListening"+Math.random().toString(36).slice(2);function Mu(e){if(!e[Au]){e[Au]=!0,Je.forEach((function(t){"selectionchange"!==t&&(Fu.has(t)||ku(t,!1,e),ku(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Au]||(t[Au]=!0,ku("selectionchange",!1,t))}}function Iu(e,t,i,r){switch(Xd(t)){case 2:var n=jd;break;case 8:n=Kd;break;default:n=Yd}i=n.bind(null,t,i,e),n=void 0,!Gt||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(n=!0),r?void 0!==n?e.addEventListener(t,i,{capture:!0,passive:n}):e.addEventListener(t,i,!0):void 0!==n?e.addEventListener(t,i,{passive:n}):e.addEventListener(t,i,!1)}function Lu(e,t,i,r,n){var o=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var s=r.tag;if(3===s||4===s){var a=r.stateNode.containerInfo;if(a===n||8===a.nodeType&&a.parentNode===n)break;if(4===s)for(s=r.return;null!==s;){var l=s.tag;if((3===l||4===l)&&((l=s.stateNode.containerInfo)===n||8===l.nodeType&&l.parentNode===n))return;s=s.return}for(;null!==a;){if(null===(s=Ye(a)))return;if(5===(l=s.tag)||6===l||26===l||27===l){r=o=s;continue e}a=a.parentNode}}r=r.return}Nt((function(){var r=o,n=At(i),s=[];e:{var a=wr.get(e);if(void 0!==a){var l=Jt,c=e;switch(e){case"keypress":if(0===Ut(i))break e;case"keydown":case"keyup":l=gi;break;case"focusin":c="focus",l=ni;break;case"focusout":c="blur",l=ni;break;case"beforeblur":case"afterblur":l=ni;break;case"click":if(2===i.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=ii;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=ri;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=fi;break;case hr:case gr:case pr:l=oi;break;case Cr:l=mi;break;case"scroll":case"scrollend":l=ei;break;case"wheel":l=vi;break;case"copy":case"cut":case"paste":l=si;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=pi;break;case"toggle":case"beforetoggle":l=Ci}var u=0!==(4&t),d=!u&&("scroll"===e||"scrollend"===e),h=u?null!==a?a+"Capture":null:a;u=[];for(var g,p=r;null!==p;){var f=p;if(g=f.stateNode,5!==(f=f.tag)&&26!==f&&27!==f||null===g||null===h||null!=(f=Bt(p,h))&&u.push(Ou(p,f,g)),d)break;p=p.return}0<u.length&&(a=new l(a,c,null,i,n),s.push({event:a,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||i===kt||!(c=i.relatedTarget||i.fromElement)||!Ye(c)&&!c[ze])&&(l||a)&&(a=n.window===n?n:(a=n.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=r,null!==(c=(c=i.relatedTarget||i.toElement)?Ye(c):null)&&(d=B(c),u=c.tag,c!==d||5!==u&&27!==u&&6!==u)&&(c=null)):(l=null,c=r),l!==c)){if(u=ii,f="onMouseLeave",h="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(u=pi,f="onPointerLeave",h="onPointerEnter",p="pointer"),d=null==l?a:Qe(l),g=null==c?a:Qe(c),(a=new u(f,p+"leave",l,i,n)).target=d,a.relatedTarget=g,f=null,Ye(n)===r&&((u=new u(h,p+"enter",c,i,n)).target=g,u.relatedTarget=d,f=u),d=f,l&&c)e:{for(h=c,p=0,g=u=l;g;g=Bu(g))p++;for(g=0,f=h;f;f=Bu(f))g++;for(;0<p-g;)u=Bu(u),p--;for(;0<g-p;)h=Bu(h),g--;for(;p--;){if(u===h||null!==h&&u===h.alternate)break e;u=Bu(u),h=Bu(h)}u=null}else u=null;null!==l&&Gu(s,a,l,u,!1),null!==c&&null!==d&&Gu(s,d,c,u,!0)}if("select"===(l=(a=r?Qe(r):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var m=Ni;else if(ki(a))if(Bi)m=Ki;else{m=Ui;var v=Wi}else!(l=a.nodeName)||"input"!==l.toLowerCase()||"checkbox"!==a.type&&"radio"!==a.type?r&&Tt(r.elementType)&&(m=Ni):m=ji;switch(m&&(m=m(e,r))?Ai(s,m,i,n):(v&&v(e,a,r),"focusout"===e&&r&&"number"===a.type&&null!=r.memoizedProps.value&&Ct(a,"number",a.value)),v=r?Qe(r):window,e){case"focusin":(ki(v)||"true"===v.contentEditable)&&(ir=v,rr=r,nr=null);break;case"focusout":nr=rr=ir=null;break;case"mousedown":or=!0;break;case"contextmenu":case"mouseup":case"dragend":or=!1,sr(s,i,n);break;case"selectionchange":if(tr)break;case"keydown":case"keyup":sr(s,i,n)}var C;if(bi)e:{switch(e){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else Pi?Ti(e,i)&&(w="onCompositionEnd"):"keydown"===e&&229===i.keyCode&&(w="onCompositionStart");w&&(Ri&&"ko"!==i.locale&&(Pi||"onCompositionStart"!==w?"onCompositionEnd"===w&&Pi&&(C=Wt()):(Vt="value"in(zt=n)?zt.value:zt.textContent,Pi=!0)),0<(v=Nu(r,w)).length&&(w=new ai(w,e,null,i,n),s.push({event:w,listeners:v}),C?w.data=C:null!==(C=Fi(i))&&(w.data=C))),(C=yi?function(e,t){switch(e){case"compositionend":return Fi(t);case"keypress":return 32!==t.which?null:(xi=!0,Ei);case"textInput":return(e=t.data)===Ei&&xi?null:e;default:return null}}(e,i):function(e,t){if(Pi)return"compositionend"===e||!bi&&Ti(e,t)?(e=Wt(),_t=Vt=zt=null,Pi=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ri&&"ko"!==t.locale?null:t.data}}(e,i))&&(0<(w=Nu(r,"onBeforeInput")).length&&(v=new ai("onBeforeInput","beforeinput",null,i,n),s.push({event:v,listeners:w}),v.data=C)),function(e,t,i,r,n){if("submit"===t&&i&&i.stateNode===n){var o=yu((n[He]||null).action),s=r.submitter;s&&null!==(t=(t=s[He]||null)?yu(t.formAction):s.getAttribute("formAction"))&&(o=t,s=null);var a=new Jt("action","action",null,r,n);e.push({event:a,listeners:[{instance:null,listener:function(){if(r.defaultPrevented){if(0!==pu){var e=s?Ru(n,s):new FormData(n);ds(i,{pending:!0,data:e,method:n.method,action:o},null,e)}}else"function"===typeof o&&(a.preventDefault(),e=s?Ru(n,s):new FormData(n),ds(i,{pending:!0,data:e,method:n.method,action:o},o,e))},currentTarget:n}]})}}(s,e,r,i,n)}Pu(s,t)}))}function Ou(e,t,i){return{instance:e,listener:t,currentTarget:i}}function Nu(e,t){for(var i=t+"Capture",r=[];null!==e;){var n=e,o=n.stateNode;5!==(n=n.tag)&&26!==n&&27!==n||null===o||(null!=(n=Bt(e,i))&&r.unshift(Ou(e,n,o)),null!=(n=Bt(e,t))&&r.push(Ou(e,n,o))),e=e.return}return r}function Bu(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function Gu(e,t,i,r,n){for(var o=t._reactName,s=[];null!==i&&i!==r;){var a=i,l=a.alternate,c=a.stateNode;if(a=a.tag,null!==l&&l===r)break;5!==a&&26!==a&&27!==a||null===c||(l=c,n?null!=(c=Bt(i,o))&&s.unshift(Ou(i,c,l)):n||null!=(c=Bt(i,o))&&s.push(Ou(i,c,l))),i=i.return}0!==s.length&&e.push({event:t,listeners:s})}var Hu=/\r\n?/g,zu=/\u0000|\uFFFD/g;function Vu(e){return("string"===typeof e?e:""+e).replace(Hu,"\n").replace(zu,"")}function _u(e,t){return t=Vu(t),Vu(e)===t}function Wu(){}function Uu(e,t,i,r,n,o){switch(i){case"children":"string"===typeof r?"body"===t||"textarea"===t&&""===r||yt(e,r):("number"===typeof r||"bigint"===typeof r)&&"body"!==t&&yt(e,""+r);break;case"className":at(e,"class",r);break;case"tabIndex":at(e,"tabindex",r);break;case"dir":case"role":case"viewBox":case"width":case"height":at(e,i,r);break;case"style":xt(e,r,o);break;case"data":if("object"!==t){at(e,"data",r);break}case"src":case"href":if(""===r&&("a"!==t||"href"!==i)){e.removeAttribute(i);break}if(null==r||"function"===typeof r||"symbol"===typeof r||"boolean"===typeof r){e.removeAttribute(i);break}r=Dt(""+r),e.setAttribute(i,r);break;case"action":case"formAction":if("function"===typeof r){e.setAttribute(i,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"===typeof o&&("formAction"===i?("input"!==t&&Uu(e,t,"name",n.name,n,null),Uu(e,t,"formEncType",n.formEncType,n,null),Uu(e,t,"formMethod",n.formMethod,n,null),Uu(e,t,"formTarget",n.formTarget,n,null)):(Uu(e,t,"encType",n.encType,n,null),Uu(e,t,"method",n.method,n,null),Uu(e,t,"target",n.target,n,null))),null==r||"symbol"===typeof r||"boolean"===typeof r){e.removeAttribute(i);break}r=Dt(""+r),e.setAttribute(i,r);break;case"onClick":null!=r&&(e.onclick=Wu);break;case"onScroll":null!=r&&Du("scroll",e);break;case"onScrollEnd":null!=r&&Du("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!==typeof r||!("__html"in r))throw Error(s(61));if(null!=(i=r.__html)){if(null!=n.children)throw Error(s(60));e.innerHTML=i}}break;case"multiple":e.multiple=r&&"function"!==typeof r&&"symbol"!==typeof r;break;case"muted":e.muted=r&&"function"!==typeof r&&"symbol"!==typeof r;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==r||"function"===typeof r||"boolean"===typeof r||"symbol"===typeof r){e.removeAttribute("xlink:href");break}i=Dt(""+r),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",i);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(i,""+r):e.removeAttribute(i);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(i,""):e.removeAttribute(i);break;case"capture":case"download":!0===r?e.setAttribute(i,""):!1!==r&&null!=r&&"function"!==typeof r&&"symbol"!==typeof r?e.setAttribute(i,r):e.removeAttribute(i);break;case"cols":case"rows":case"size":case"span":null!=r&&"function"!==typeof r&&"symbol"!==typeof r&&!isNaN(r)&&1<=r?e.setAttribute(i,r):e.removeAttribute(i);break;case"rowSpan":case"start":null==r||"function"===typeof r||"symbol"===typeof r||isNaN(r)?e.removeAttribute(i):e.setAttribute(i,r);break;case"popover":Du("beforetoggle",e),Du("toggle",e),st(e,"popover",r);break;case"xlinkActuate":lt(e,"http://www.w3.org/1999/xlink","xlink:actuate",r);break;case"xlinkArcrole":lt(e,"http://www.w3.org/1999/xlink","xlink:arcrole",r);break;case"xlinkRole":lt(e,"http://www.w3.org/1999/xlink","xlink:role",r);break;case"xlinkShow":lt(e,"http://www.w3.org/1999/xlink","xlink:show",r);break;case"xlinkTitle":lt(e,"http://www.w3.org/1999/xlink","xlink:title",r);break;case"xlinkType":lt(e,"http://www.w3.org/1999/xlink","xlink:type",r);break;case"xmlBase":lt(e,"http://www.w3.org/XML/1998/namespace","xml:base",r);break;case"xmlLang":lt(e,"http://www.w3.org/XML/1998/namespace","xml:lang",r);break;case"xmlSpace":lt(e,"http://www.w3.org/XML/1998/namespace","xml:space",r);break;case"is":st(e,"is",r);break;case"innerText":case"textContent":break;default:(!(2<i.length)||"o"!==i[0]&&"O"!==i[0]||"n"!==i[1]&&"N"!==i[1])&&st(e,i=Ft.get(i)||i,r)}}function ju(e,t,i,r,n,o){switch(i){case"style":xt(e,r,o);break;case"dangerouslySetInnerHTML":if(null!=r){if("object"!==typeof r||!("__html"in r))throw Error(s(61));if(null!=(i=r.__html)){if(null!=n.children)throw Error(s(60));e.innerHTML=i}}break;case"children":"string"===typeof r?yt(e,r):("number"===typeof r||"bigint"===typeof r)&&yt(e,""+r);break;case"onScroll":null!=r&&Du("scroll",e);break;case"onScrollEnd":null!=r&&Du("scrollend",e);break;case"onClick":null!=r&&(e.onclick=Wu);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:Ze.hasOwnProperty(i)||("o"!==i[0]||"n"!==i[1]||(n=i.endsWith("Capture"),t=i.slice(2,n?i.length-7:void 0),"function"===typeof(o=null!=(o=e[He]||null)?o[i]:null)&&e.removeEventListener(t,o,n),"function"!==typeof r)?i in e?e[i]=r:!0===r?e.setAttribute(i,""):st(e,i,r):("function"!==typeof o&&null!==o&&(i in e?e[i]=null:e.hasAttribute(i)&&e.removeAttribute(i)),e.addEventListener(t,r,n)))}}function Ku(e,t,i){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Du("error",e),Du("load",e);var r,n=!1,o=!1;for(r in i)if(i.hasOwnProperty(r)){var a=i[r];if(null!=a)switch(r){case"src":n=!0;break;case"srcSet":o=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,t));default:Uu(e,t,r,a,i,null)}}return o&&Uu(e,t,"srcSet",i.srcSet,i,null),void(n&&Uu(e,t,"src",i.src,i,null));case"input":Du("invalid",e);var l=r=a=o=null,c=null,u=null;for(n in i)if(i.hasOwnProperty(n)){var d=i[n];if(null!=d)switch(n){case"name":o=d;break;case"type":a=d;break;case"checked":c=d;break;case"defaultChecked":u=d;break;case"value":r=d;break;case"defaultValue":l=d;break;case"children":case"dangerouslySetInnerHTML":if(null!=d)throw Error(s(137,t));break;default:Uu(e,t,n,d,i,null)}}return vt(e,r,l,c,u,a,o,!1),void dt(e);case"select":for(o in Du("invalid",e),n=a=r=null,i)if(i.hasOwnProperty(o)&&null!=(l=i[o]))switch(o){case"value":r=l;break;case"defaultValue":a=l;break;case"multiple":n=l;default:Uu(e,t,o,l,i,null)}return t=r,i=a,e.multiple=!!n,void(null!=t?wt(e,!!n,t,!1):null!=i&&wt(e,!!n,i,!0));case"textarea":for(a in Du("invalid",e),r=o=n=null,i)if(i.hasOwnProperty(a)&&null!=(l=i[a]))switch(a){case"value":n=l;break;case"defaultValue":o=l;break;case"children":r=l;break;case"dangerouslySetInnerHTML":if(null!=l)throw Error(s(91));break;default:Uu(e,t,a,l,i,null)}return St(e,n,o,r),void dt(e);case"option":for(c in i)if(i.hasOwnProperty(c)&&null!=(n=i[c]))if("selected"===c)e.selected=n&&"function"!==typeof n&&"symbol"!==typeof n;else Uu(e,t,c,n,i,null);return;case"dialog":Du("cancel",e),Du("close",e);break;case"iframe":case"object":Du("load",e);break;case"video":case"audio":for(n=0;n<Tu.length;n++)Du(Tu[n],e);break;case"image":Du("error",e),Du("load",e);break;case"details":Du("toggle",e);break;case"embed":case"source":case"link":Du("error",e),Du("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(u in i)if(i.hasOwnProperty(u)&&null!=(n=i[u]))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,t));default:Uu(e,t,u,n,i,null)}return;default:if(Tt(t)){for(d in i)i.hasOwnProperty(d)&&(void 0!==(n=i[d])&&ju(e,t,d,n,i,void 0));return}}for(l in i)i.hasOwnProperty(l)&&(null!=(n=i[l])&&Uu(e,t,l,n,i,null))}var Yu=null,qu=null;function Qu(e){return 9===e.nodeType?e:e.ownerDocument}function $u(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Xu(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function Ju(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"bigint"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var Zu=null;var ed="function"===typeof setTimeout?setTimeout:void 0,td="function"===typeof clearTimeout?clearTimeout:void 0,id="function"===typeof Promise?Promise:void 0,rd="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof id?function(e){return id.resolve(null).then(e).catch(nd)}:ed;function nd(e){setTimeout((function(){throw e}))}function od(e,t){var i=t,r=0;do{var n=i.nextSibling;if(e.removeChild(i),n&&8===n.nodeType)if("/$"===(i=n.data)){if(0===r)return e.removeChild(n),void fh(t);r--}else"$"!==i&&"$?"!==i&&"$!"!==i||r++;i=n}while(i);fh(t)}function sd(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var i=t;switch(t=t.nextSibling,i.nodeName){case"HTML":case"HEAD":case"BODY":sd(i),Ke(i);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===i.rel.toLowerCase())continue}e.removeChild(i)}}function ad(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"F!"===t||"F"===t)break;if("/$"===t)return null}}return e}function ld(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var i=e.data;if("$"===i||"$!"===i||"$?"===i){if(0===t)return e;t--}else"/$"===i&&t++}e=e.previousSibling}return null}function cd(e,t,i){switch(t=Qu(i),e){case"html":if(!(e=t.documentElement))throw Error(s(452));return e;case"head":if(!(e=t.head))throw Error(s(453));return e;case"body":if(!(e=t.body))throw Error(s(454));return e;default:throw Error(s(451))}}var ud=new Map,dd=new Set;function hd(e){return"function"===typeof e.getRootNode?e.getRootNode():e.ownerDocument}var gd=_.d;_.d={f:function(){var e=gd.f(),t=Gc();return e||t},r:function(e){var t=qe(e);null!==t&&5===t.tag&&"form"===t.type?gs(t):gd.r(e)},D:function(e){gd.D(e),fd("dns-prefetch",e,null)},C:function(e,t){gd.C(e,t),fd("preconnect",e,t)},L:function(e,t,i){gd.L(e,t,i);var r=pd;if(r&&e&&t){var n='link[rel="preload"][as="'+ft(t)+'"]';"image"===t&&i&&i.imageSrcSet?(n+='[imagesrcset="'+ft(i.imageSrcSet)+'"]',"string"===typeof i.imageSizes&&(n+='[imagesizes="'+ft(i.imageSizes)+'"]')):n+='[href="'+ft(e)+'"]';var o=n;switch(t){case"style":o=vd(e);break;case"script":o=bd(e)}ud.has(o)||(e=A({rel:"preload",href:"image"===t&&i&&i.imageSrcSet?void 0:e,as:t},i),ud.set(o,e),null!==r.querySelector(n)||"style"===t&&r.querySelector(Cd(o))||"script"===t&&r.querySelector(Sd(o))||(Ku(t=r.createElement("link"),"link",e),Xe(t),r.head.appendChild(t)))}},m:function(e,t){gd.m(e,t);var i=pd;if(i&&e){var r=t&&"string"===typeof t.as?t.as:"script",n='link[rel="modulepreload"][as="'+ft(r)+'"][href="'+ft(e)+'"]',o=n;switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":o=bd(e)}if(!ud.has(o)&&(e=A({rel:"modulepreload",href:e},t),ud.set(o,e),null===i.querySelector(n))){switch(r){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(i.querySelector(Sd(o)))return}Ku(r=i.createElement("link"),"link",e),Xe(r),i.head.appendChild(r)}}},X:function(e,t){gd.X(e,t);var i=pd;if(i&&e){var r=$e(i).hoistableScripts,n=bd(e),o=r.get(n);o||((o=i.querySelector(Sd(n)))||(e=A({src:e,async:!0},t),(t=ud.get(n))&&xd(e,t),Xe(o=i.createElement("script")),Ku(o,"link",e),i.head.appendChild(o)),o={type:"script",instance:o,count:1,state:null},r.set(n,o))}},S:function(e,t,i){gd.S(e,t,i);var r=pd;if(r&&e){var n=$e(r).hoistableStyles,o=vd(e);t=t||"default";var s=n.get(o);if(!s){var a={loading:0,preload:null};if(s=r.querySelector(Cd(o)))a.loading=5;else{e=A({rel:"stylesheet",href:e,"data-precedence":t},i),(i=ud.get(o))&&Ed(e,i);var l=s=r.createElement("link");Xe(l),Ku(l,"link",e),l._p=new Promise((function(e,t){l.onload=e,l.onerror=t})),l.addEventListener("load",(function(){a.loading|=1})),l.addEventListener("error",(function(){a.loading|=2})),a.loading|=4,Rd(s,t,r)}s={type:"stylesheet",instance:s,count:1,state:a},n.set(o,s)}}},M:function(e,t){gd.M(e,t);var i=pd;if(i&&e){var r=$e(i).hoistableScripts,n=bd(e),o=r.get(n);o||((o=i.querySelector(Sd(n)))||(e=A({src:e,async:!0,type:"module"},t),(t=ud.get(n))&&xd(e,t),Xe(o=i.createElement("script")),Ku(o,"link",e),i.head.appendChild(o)),o={type:"script",instance:o,count:1,state:null},r.set(n,o))}}};var pd="undefined"===typeof document?null:document;function fd(e,t,i){var r=pd;if(r&&"string"===typeof t&&t){var n=ft(t);n='link[rel="'+e+'"][href="'+n+'"]',"string"===typeof i&&(n+='[crossorigin="'+i+'"]'),dd.has(n)||(dd.add(n),e={rel:e,crossOrigin:i,href:t},null===r.querySelector(n)&&(Ku(t=r.createElement("link"),"link",e),Xe(t),r.head.appendChild(t)))}}function md(e,t,i,r){var n,o,a,l,c=(c=X.current)?hd(c):null;if(!c)throw Error(s(446));switch(e){case"meta":case"title":return null;case"style":return"string"===typeof i.precedence&&"string"===typeof i.href?(t=vd(i.href),(r=(i=$e(c).hoistableStyles).get(t))||(r={type:"style",instance:null,count:0,state:null},i.set(t,r)),r):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===i.rel&&"string"===typeof i.href&&"string"===typeof i.precedence){e=vd(i.href);var u=$e(c).hoistableStyles,d=u.get(e);if(d||(c=c.ownerDocument||c,d={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},u.set(e,d),(u=c.querySelector(Cd(e)))&&!u._p&&(d.instance=u,d.state.loading=5),ud.has(e)||(i={rel:"preload",as:"style",href:i.href,crossOrigin:i.crossOrigin,integrity:i.integrity,media:i.media,hrefLang:i.hrefLang,referrerPolicy:i.referrerPolicy},ud.set(e,i),u||(n=c,o=e,a=i,l=d.state,n.querySelector('link[rel="preload"][as="style"]['+o+"]")?l.loading=1:(o=n.createElement("link"),l.preload=o,o.addEventListener("load",(function(){return l.loading|=1})),o.addEventListener("error",(function(){return l.loading|=2})),Ku(o,"link",a),Xe(o),n.head.appendChild(o))))),t&&null===r)throw Error(s(528,""));return d}if(t&&null!==r)throw Error(s(529,""));return null;case"script":return t=i.async,"string"===typeof(i=i.src)&&t&&"function"!==typeof t&&"symbol"!==typeof t?(t=bd(i),(r=(i=$e(c).hoistableScripts).get(t))||(r={type:"script",instance:null,count:0,state:null},i.set(t,r)),r):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,e))}}function vd(e){return'href="'+ft(e)+'"'}function Cd(e){return'link[rel="stylesheet"]['+e+"]"}function wd(e){return A({},e,{"data-precedence":e.precedence,precedence:null})}function bd(e){return'[src="'+ft(e)+'"]'}function Sd(e){return"script[async]"+e}function yd(e,t,i){if(t.count++,null===t.instance)switch(t.type){case"style":var r=e.querySelector('style[data-href~="'+ft(i.href)+'"]');if(r)return t.instance=r,Xe(r),r;var n=A({},i,{"data-href":i.href,"data-precedence":i.precedence,href:null,precedence:null});return Xe(r=(e.ownerDocument||e).createElement("style")),Ku(r,"style",n),Rd(r,i.precedence,e),t.instance=r;case"stylesheet":n=vd(i.href);var o=e.querySelector(Cd(n));if(o)return t.state.loading|=4,t.instance=o,Xe(o),o;r=wd(i),(n=ud.get(n))&&Ed(r,n),Xe(o=(e.ownerDocument||e).createElement("link"));var a=o;return a._p=new Promise((function(e,t){a.onload=e,a.onerror=t})),Ku(o,"link",r),t.state.loading|=4,Rd(o,i.precedence,e),t.instance=o;case"script":return o=bd(i.src),(n=e.querySelector(Sd(o)))?(t.instance=n,Xe(n),n):(r=i,(n=ud.get(o))&&xd(r=A({},i),n),Xe(n=(e=e.ownerDocument||e).createElement("script")),Ku(n,"link",r),e.head.appendChild(n),t.instance=n);case"void":return null;default:throw Error(s(443,t.type))}else"stylesheet"===t.type&&0===(4&t.state.loading)&&(r=t.instance,t.state.loading|=4,Rd(r,i.precedence,e));return t.instance}function Rd(e,t,i){for(var r=i.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),n=r.length?r[r.length-1]:null,o=n,s=0;s<r.length;s++){var a=r[s];if(a.dataset.precedence===t)o=a;else if(o!==n)break}o?o.parentNode.insertBefore(e,o.nextSibling):(t=9===i.nodeType?i.head:i).insertBefore(e,t.firstChild)}function Ed(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function xd(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var Td=null;function Fd(e,t,i){if(null===Td){var r=new Map,n=Td=new Map;n.set(i,r)}else(r=(n=Td).get(i))||(r=new Map,n.set(i,r));if(r.has(e))return r;for(r.set(e,null),i=i.getElementsByTagName(e),n=0;n<i.length;n++){var o=i[n];if(!(o[je]||o[Ge]||"link"===e&&"stylesheet"===o.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==o.namespaceURI){var s=o.getAttribute(t)||"";s=e+s;var a=r.get(s);a?a.push(o):r.set(s,[o])}}return r}function Pd(e,t,i){(e=e.ownerDocument||e).head.insertBefore(i,"title"===t?e.querySelector("head > title"):null)}function Dd(e){return"stylesheet"!==e.type||0!==(3&e.state.loading)}var kd=null;function Ad(){}function Md(){if(this.count--,0===this.count)if(this.stylesheets)Ld(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var Id=null;function Ld(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,Id=new Map,t.forEach(Od,e),Id=null,Md.call(e))}function Od(e,t){if(!(4&t.state.loading)){var i=Id.get(e);if(i)var r=i.get(null);else{i=new Map,Id.set(e,i);for(var n=e.querySelectorAll("link[data-precedence],style[data-precedence]"),o=0;o<n.length;o++){var s=n[o];"LINK"!==s.nodeName&&"not all"===s.getAttribute("media")||(i.set(s.dataset.precedence,s),r=s)}r&&i.set(null,r)}s=(n=t.instance).getAttribute("data-precedence"),(o=i.get(s)||r)===r&&i.set(null,n),i.set(s,n),this.count++,r=Md.bind(this),n.addEventListener("load",r),n.addEventListener("error",r),o?o.parentNode.insertBefore(n,o.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(n,e.firstChild),t.state.loading|=4}}var Nd={$$typeof:m,Provider:null,Consumer:null,_currentValue:W,_currentValue2:W,_threadCount:0};function Bd(e,t,i,r,n,o,s,a){this.tag=1,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ae(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ae(0),this.hiddenUpdates=Ae(null),this.identifierPrefix=r,this.onUncaughtError=n,this.onCaughtError=o,this.onRecoverableError=s,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=a,this.incompleteTransitions=new Map}function Gd(e,t,i,r,n,o,s,a,l,c,u,d){return e=new Bd(e,t,i,s,a,l,c,d),t=1,!0===o&&(t|=24),o=Ol(3,null,null,t),e.current=o,o.stateNode=e,(t=zn()).refCount++,e.pooledCache=t,t.refCount++,o.memoizedState={element:r,isDehydrated:i,cache:t},Da(o),e}function Hd(e){return e?e=Ar:Ar}function zd(e,t,i,r,n,o){n=Hd(n),null===r.context?r.context=n:r.pendingContext=n,(r=Aa(t)).payload={element:i},null!==(o=void 0===o?null:o)&&(r.callback=o),null!==(i=Ma(e,r,t))&&(Mc(i,0,t),Ia(i,e,t))}function Vd(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var i=e.retryLane;e.retryLane=0!==i&&i<t?i:t}}function _d(e,t){Vd(e,t),(e=e.alternate)&&Vd(e,t)}function Wd(e){if(13===e.tag){var t=Pr(e,67108864);null!==t&&Mc(t,0,67108864),_d(e,67108864)}}var Ud=!0;function jd(e,t,i,r){var n=k.T;k.T=null;var o=_.p;try{_.p=2,Yd(e,t,i,r)}finally{_.p=o,k.T=n}}function Kd(e,t,i,r){var n=k.T;k.T=null;var o=_.p;try{_.p=8,Yd(e,t,i,r)}finally{_.p=o,k.T=n}}function Yd(e,t,i,r){if(Ud){var n=qd(r);if(null===n)Lu(e,t,r,Qd,i),sh(e,r);else if(function(e,t,i,r,n){switch(t){case"focusin":return Zd=ah(Zd,e,t,i,r,n),!0;case"dragenter":return eh=ah(eh,e,t,i,r,n),!0;case"mouseover":return th=ah(th,e,t,i,r,n),!0;case"pointerover":var o=n.pointerId;return ih.set(o,ah(ih.get(o)||null,e,t,i,r,n)),!0;case"gotpointercapture":return o=n.pointerId,rh.set(o,ah(rh.get(o)||null,e,t,i,r,n)),!0}return!1}(n,e,t,i,r))r.stopPropagation();else if(sh(e,r),4&t&&-1<oh.indexOf(e)){for(;null!==n;){var o=qe(n);if(null!==o)switch(o.tag){case 3:if((o=o.stateNode).current.memoizedState.isDehydrated){var s=xe(o.pendingLanes);if(0!==s){var a=o;for(a.pendingLanes|=2,a.entangledLanes|=2;s;){var l=1<<31-be(s);a.entanglements[1]|=l,s&=~l}fu(o),0===(6&ec)&&(bc=le()+500,mu(0,!1))}}break;case 13:null!==(a=Pr(o,2))&&Mc(a,0,2),Gc(),_d(o,2)}if(null===(o=qd(r))&&Lu(e,t,r,Qd,i),o===n)break;n=o}null!==n&&r.stopPropagation()}else Lu(e,t,r,null,i)}}function qd(e){return $d(e=At(e))}var Qd=null;function $d(e){if(Qd=null,null!==(e=Ye(e))){var t=B(e);if(null===t)e=null;else{var i=t.tag;if(13===i){if(null!==(e=G(t)))return e;e=null}else if(3===i){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return Qd=e,null}function Xd(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ce()){case ue:return 2;case de:return 8;case he:case ge:return 32;case pe:return 268435456;default:return 32}default:return 32}}var Jd=!1,Zd=null,eh=null,th=null,ih=new Map,rh=new Map,nh=[],oh="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function sh(e,t){switch(e){case"focusin":case"focusout":Zd=null;break;case"dragenter":case"dragleave":eh=null;break;case"mouseover":case"mouseout":th=null;break;case"pointerover":case"pointerout":ih.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":rh.delete(t.pointerId)}}function ah(e,t,i,r,n,o){return null===e||e.nativeEvent!==o?(e={blockedOn:t,domEventName:i,eventSystemFlags:r,nativeEvent:o,targetContainers:[n]},null!==t&&(null!==(t=qe(t))&&Wd(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==n&&-1===t.indexOf(n)&&t.push(n),e)}function lh(e){var t=Ye(e.target);if(null!==t){var i=B(t);if(null!==i)if(13===(t=i.tag)){if(null!==(t=G(i)))return e.blockedOn=t,void function(e,t){var i=_.p;try{return _.p=e,t()}finally{_.p=i}}(e.priority,(function(){if(13===i.tag){var e=kc(),t=Pr(i,e);null!==t&&Mc(t,0,e),_d(i,e)}}))}else if(3===t&&i.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===i.tag?i.stateNode.containerInfo:null)}e.blockedOn=null}function ch(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var i=qd(e.nativeEvent);if(null!==i)return null!==(t=qe(i))&&Wd(t),e.blockedOn=i,!1;var r=new(i=e.nativeEvent).constructor(i.type,i);kt=r,i.target.dispatchEvent(r),kt=null,t.shift()}return!0}function uh(e,t,i){ch(e)&&i.delete(t)}function dh(){Jd=!1,null!==Zd&&ch(Zd)&&(Zd=null),null!==eh&&ch(eh)&&(eh=null),null!==th&&ch(th)&&(th=null),ih.forEach(uh),rh.forEach(uh)}function hh(e,t){e.blockedOn===t&&(e.blockedOn=null,Jd||(Jd=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,dh)))}var gh=null;function ph(e){gh!==e&&(gh=e,r.unstable_scheduleCallback(r.unstable_NormalPriority,(function(){gh===e&&(gh=null);for(var t=0;t<e.length;t+=3){var i=e[t],r=e[t+1],n=e[t+2];if("function"!==typeof r){if(null===$d(r||i))continue;break}var o=qe(i);null!==o&&(e.splice(t,3),t-=3,ds(o,{pending:!0,data:n,method:i.method,action:r},r,n))}})))}function fh(e){function t(t){return hh(t,e)}null!==Zd&&hh(Zd,e),null!==eh&&hh(eh,e),null!==th&&hh(th,e),ih.forEach(t),rh.forEach(t);for(var i=0;i<nh.length;i++){var r=nh[i];r.blockedOn===e&&(r.blockedOn=null)}for(;0<nh.length&&null===(i=nh[0]).blockedOn;)lh(i),null===i.blockedOn&&nh.shift();if(null!=(i=(e.ownerDocument||e).$$reactFormReplay))for(r=0;r<i.length;r+=3){var n=i[r],o=i[r+1],s=n[He]||null;if("function"===typeof o)s||ph(i);else if(s){var a=null;if(o&&o.hasAttribute("formAction")){if(n=o,s=o[He]||null)a=s.formAction;else if(null!==$d(n))continue}else a=s.action;"function"===typeof a?i[r+1]=a:(i.splice(r,3),r-=3),ph(i)}}}function mh(e){this._internalRoot=e}function vh(e){this._internalRoot=e}vh.prototype.render=mh.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));zd(t.current,kc(),e,t,null,null)},vh.prototype.unmount=mh.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;0===e.tag&&tu(),zd(e.current,2,null,e,null,null),Gc(),t[ze]=null}},vh.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ne();e={blockedOn:null,target:e,priority:t};for(var i=0;i<nh.length&&0!==t&&t<nh[i].priority;i++);nh.splice(i,0,e),0===i&&lh(e)}};var Ch=n.version;if("19.0.0"!==Ch)throw Error(s(527,Ch,"19.0.0"));_.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=B(e)))throw Error(s(188));return t!==e?null:e}for(var i=e,r=t;;){var n=i.return;if(null===n)break;var o=n.alternate;if(null===o){if(null!==(r=n.return)){i=r;continue}break}if(n.child===o.child){for(o=n.child;o;){if(o===i)return H(n),e;if(o===r)return H(n),t;o=o.sibling}throw Error(s(188))}if(i.return!==r.return)i=n,r=o;else{for(var a=!1,l=n.child;l;){if(l===i){a=!0,i=n,r=o;break}if(l===r){a=!0,r=n,i=o;break}l=l.sibling}if(!a){for(l=o.child;l;){if(l===i){a=!0,i=o,r=n;break}if(l===r){a=!0,r=o,i=n;break}l=l.sibling}if(!a)throw Error(s(189))}}if(i.alternate!==r)throw Error(s(190))}if(3!==i.tag)throw Error(s(188));return i.stateNode.current===i?e:t}(t),e=null===(e=null!==e?z(e):null)?null:e.stateNode};var wh={bundleType:0,version:"19.0.0",rendererPackageName:"react-dom",currentDispatcherRef:k,findFiberByHostInstance:Ye,reconcilerVersion:"19.0.0"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var bh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!bh.isDisabled&&bh.supportsFiber)try{ve=bh.inject(wh),Ce=bh}catch(yh){}}t.createRoot=function(e,t){if(!a(e))throw Error(s(299));var i=!1,r="",n=Os,o=Ns,l=Bs;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(i=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onUncaughtError&&(n=t.onUncaughtError),void 0!==t.onCaughtError&&(o=t.onCaughtError),void 0!==t.onRecoverableError&&(l=t.onRecoverableError),void 0!==t.unstable_transitionCallbacks&&t.unstable_transitionCallbacks),t=Gd(e,1,!1,null,0,i,r,n,o,l,0,null),e[ze]=t.current,Mu(8===e.nodeType?e.parentNode:e),new mh(t)},t.hydrateRoot=function(e,t,i){if(!a(e))throw Error(s(299));var r=!1,n="",o=Os,l=Ns,c=Bs,u=null;return null!==i&&void 0!==i&&(!0===i.unstable_strictMode&&(r=!0),void 0!==i.identifierPrefix&&(n=i.identifierPrefix),void 0!==i.onUncaughtError&&(o=i.onUncaughtError),void 0!==i.onCaughtError&&(l=i.onCaughtError),void 0!==i.onRecoverableError&&(c=i.onRecoverableError),void 0!==i.unstable_transitionCallbacks&&i.unstable_transitionCallbacks,void 0!==i.formState&&(u=i.formState)),(t=Gd(e,1,!0,t,0,r,n,o,l,c,0,u)).context=Hd(null),i=t.current,(n=Aa(r=kc())).callback=null,Ma(i,n,r),t.current.lanes=r,Me(t,r),fu(t),e[ze]=t.current,Mu(e),new vh(t)},t.version="19.0.0"},672:(e,t,i)=>{var r=i(43);function n(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var i=2;i<arguments.length;i++)t+="&args[]="+encodeURIComponent(arguments[i])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(){}var s={d:{f:o,r:function(){throw Error(n(522))},D:o,C:o,L:o,m:o,X:o,S:o,M:o},p:0,findDOMNode:null},a=Symbol.for("react.portal");var l=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(e,t){return"font"===e?"":"string"===typeof t?"use-credentials"===t?t:"":void 0}t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,t.createPortal=function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)throw Error(n(299));return function(e,t,i){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:a,key:null==r?null:""+r,children:e,containerInfo:t,implementation:i}}(e,t,null,i)},t.flushSync=function(e){var t=l.T,i=s.p;try{if(l.T=null,s.p=2,e)return e()}finally{l.T=t,s.p=i,s.d.f()}},t.preconnect=function(e,t){"string"===typeof e&&(t?t="string"===typeof(t=t.crossOrigin)?"use-credentials"===t?t:"":void 0:t=null,s.d.C(e,t))},t.prefetchDNS=function(e){"string"===typeof e&&s.d.D(e)},t.preinit=function(e,t){if("string"===typeof e&&t&&"string"===typeof t.as){var i=t.as,r=c(i,t.crossOrigin),n="string"===typeof t.integrity?t.integrity:void 0,o="string"===typeof t.fetchPriority?t.fetchPriority:void 0;"style"===i?s.d.S(e,"string"===typeof t.precedence?t.precedence:void 0,{crossOrigin:r,integrity:n,fetchPriority:o}):"script"===i&&s.d.X(e,{crossOrigin:r,integrity:n,fetchPriority:o,nonce:"string"===typeof t.nonce?t.nonce:void 0})}},t.preinitModule=function(e,t){if("string"===typeof e)if("object"===typeof t&&null!==t){if(null==t.as||"script"===t.as){var i=c(t.as,t.crossOrigin);s.d.M(e,{crossOrigin:i,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0})}}else null==t&&s.d.M(e)},t.preload=function(e,t){if("string"===typeof e&&"object"===typeof t&&null!==t&&"string"===typeof t.as){var i=t.as,r=c(i,t.crossOrigin);s.d.L(e,i,{crossOrigin:r,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0,type:"string"===typeof t.type?t.type:void 0,fetchPriority:"string"===typeof t.fetchPriority?t.fetchPriority:void 0,referrerPolicy:"string"===typeof t.referrerPolicy?t.referrerPolicy:void 0,imageSrcSet:"string"===typeof t.imageSrcSet?t.imageSrcSet:void 0,imageSizes:"string"===typeof t.imageSizes?t.imageSizes:void 0,media:"string"===typeof t.media?t.media:void 0})}},t.preloadModule=function(e,t){if("string"===typeof e)if(t){var i=c(t.as,t.crossOrigin);s.d.m(e,{as:"string"===typeof t.as&&"script"!==t.as?t.as:void 0,crossOrigin:i,integrity:"string"===typeof t.integrity?t.integrity:void 0})}else s.d.m(e)},t.requestFormReset=function(e){s.d.r(e)},t.unstable_batchedUpdates=function(e,t){return e(t)},t.useFormState=function(e,t,i){return l.H.useFormState(e,t,i)},t.useFormStatus=function(){return l.H.useHostTransitionStatus()},t.version="19.0.0"},391:(e,t,i)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=i(4)},950:(e,t,i)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=i(672)},799:(e,t)=>{var i=Symbol.for("react.transitional.element");function r(e,t,r){var n=null;if(void 0!==r&&(n=""+r),void 0!==t.key&&(n=""+t.key),"key"in t)for(var o in r={},t)"key"!==o&&(r[o]=t[o]);else r=t;return t=r.ref,{$$typeof:i,type:e,key:n,ref:void 0!==t?t:null,props:r}}Symbol.for("react.fragment"),t.jsx=r,t.jsxs=r},288:(e,t)=>{var i=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),g=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},f=Object.assign,m={};function v(e,t,i){this.props=e,this.context=t,this.refs=m,this.updater=i||p}function C(){}function w(e,t,i){this.props=e,this.context=t,this.refs=m,this.updater=i||p}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},C.prototype=v.prototype;var b=w.prototype=new C;b.constructor=w,f(b,v.prototype),b.isPureReactComponent=!0;var S=Array.isArray,y={H:null,A:null,T:null,S:null},R=Object.prototype.hasOwnProperty;function E(e,t,r,n,o,s){return r=s.ref,{$$typeof:i,type:e,key:t,ref:void 0!==r?r:null,props:s}}function x(e){return"object"===typeof e&&null!==e&&e.$$typeof===i}var T=/\/+/g;function F(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function P(){}function D(e,t,n,o,s){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var l,c,u=!1;if(null===e)u=!0;else switch(a){case"bigint":case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case i:case r:u=!0;break;case h:return D((u=e._init)(e._payload),t,n,o,s)}}if(u)return s=s(e),u=""===o?"."+F(e,0):o,S(s)?(n="",null!=u&&(n=u.replace(T,"$&/")+"/"),D(s,t,n,"",(function(e){return e}))):null!=s&&(x(s)&&(l=s,c=n+(null==s.key||e&&e.key===s.key?"":(""+s.key).replace(T,"$&/")+"/")+u,s=E(l.type,c,void 0,0,0,l.props)),t.push(s)),1;u=0;var d,p=""===o?".":o+":";if(S(e))for(var f=0;f<e.length;f++)u+=D(o=e[f],t,n,a=p+F(o,f),s);else if("function"===typeof(f=null===(d=e)||"object"!==typeof d?null:"function"===typeof(d=g&&d[g]||d["@@iterator"])?d:null))for(e=f.call(e),f=0;!(o=e.next()).done;)u+=D(o=o.value,t,n,a=p+F(o,f++),s);else if("object"===a){if("function"===typeof e.then)return D(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"===typeof e.status?e.then(P,P):(e.status="pending",e.then((function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)}),(function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)}))),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(e),t,n,o,s);throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return u}function k(e,t,i){if(null==e)return e;var r=[],n=0;return D(e,r,"","",(function(e){return t.call(i,e,n++)})),r}function A(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var M="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)};function I(){}t.Children={map:k,forEach:function(e,t,i){k(e,(function(){t.apply(this,arguments)}),i)},count:function(e){var t=0;return k(e,(function(){t++})),t},toArray:function(e){return k(e,(function(e){return e}))||[]},only:function(e){if(!x(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=n,t.Profiler=s,t.PureComponent=w,t.StrictMode=o,t.Suspense=u,t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=y,t.act=function(){throw Error("act(...) is not supported in production builds of React.")},t.cache=function(e){return function(){return e.apply(null,arguments)}},t.cloneElement=function(e,t,i){if(null===e||void 0===e)throw Error("The argument must be a React element, but you passed "+e+".");var r=f({},e.props),n=e.key;if(null!=t)for(o in void 0!==t.ref&&void 0,void 0!==t.key&&(n=""+t.key),t)!R.call(t,o)||"key"===o||"__self"===o||"__source"===o||"ref"===o&&void 0===t.ref||(r[o]=t[o]);var o=arguments.length-2;if(1===o)r.children=i;else if(1<o){for(var s=Array(o),a=0;a<o;a++)s[a]=arguments[a+2];r.children=s}return E(e.type,n,void 0,0,0,r)},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:a,_context:e},e},t.createElement=function(e,t,i){var r,n={},o=null;if(null!=t)for(r in void 0!==t.key&&(o=""+t.key),t)R.call(t,r)&&"key"!==r&&"__self"!==r&&"__source"!==r&&(n[r]=t[r]);var s=arguments.length-2;if(1===s)n.children=i;else if(1<s){for(var a=Array(s),l=0;l<s;l++)a[l]=arguments[l+2];n.children=a}if(e&&e.defaultProps)for(r in s=e.defaultProps)void 0===n[r]&&(n[r]=s[r]);return E(e,o,void 0,0,0,n)},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=x,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:A}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=y.T,i={};y.T=i;try{var r=e(),n=y.S;null!==n&&n(i,r),"object"===typeof r&&null!==r&&"function"===typeof r.then&&r.then(I,M)}catch(o){M(o)}finally{y.T=t}},t.unstable_useCacheRefresh=function(){return y.H.useCacheRefresh()},t.use=function(e){return y.H.use(e)},t.useActionState=function(e,t,i){return y.H.useActionState(e,t,i)},t.useCallback=function(e,t){return y.H.useCallback(e,t)},t.useContext=function(e){return y.H.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e,t){return y.H.useDeferredValue(e,t)},t.useEffect=function(e,t){return y.H.useEffect(e,t)},t.useId=function(){return y.H.useId()},t.useImperativeHandle=function(e,t,i){return y.H.useImperativeHandle(e,t,i)},t.useInsertionEffect=function(e,t){return y.H.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return y.H.useLayoutEffect(e,t)},t.useMemo=function(e,t){return y.H.useMemo(e,t)},t.useOptimistic=function(e,t){return y.H.useOptimistic(e,t)},t.useReducer=function(e,t,i){return y.H.useReducer(e,t,i)},t.useRef=function(e){return y.H.useRef(e)},t.useState=function(e){return y.H.useState(e)},t.useSyncExternalStore=function(e,t,i){return y.H.useSyncExternalStore(e,t,i)},t.useTransition=function(){return y.H.useTransition()},t.version="19.0.0"},43:(e,t,i)=>{e.exports=i(288)},579:(e,t,i)=>{e.exports=i(799)},896:(e,t)=>{function i(e,t){var i=e.length;e.push(t);e:for(;0<i;){var r=i-1>>>1,n=e[r];if(!(0<o(n,t)))break e;e[r]=t,e[i]=n,i=r}}function r(e){return 0===e.length?null:e[0]}function n(e){if(0===e.length)return null;var t=e[0],i=e.pop();if(i!==t){e[0]=i;e:for(var r=0,n=e.length,s=n>>>1;r<s;){var a=2*(r+1)-1,l=e[a],c=a+1,u=e[c];if(0>o(l,i))c<n&&0>o(u,l)?(e[r]=u,e[c]=i,r=c):(e[r]=l,e[a]=i,r=a);else{if(!(c<n&&0>o(u,i)))break e;e[r]=u,e[c]=i,r=c}}}return t}function o(e,t){var i=e.sortIndex-t.sortIndex;return 0!==i?i:e.id-t.id}if(t.unstable_now=void 0,"object"===typeof performance&&"function"===typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],u=[],d=1,h=null,g=3,p=!1,f=!1,m=!1,v="function"===typeof setTimeout?setTimeout:null,C="function"===typeof clearTimeout?clearTimeout:null,w="undefined"!==typeof setImmediate?setImmediate:null;function b(e){for(var t=r(u);null!==t;){if(null===t.callback)n(u);else{if(!(t.startTime<=e))break;n(u),t.sortIndex=t.expirationTime,i(c,t)}t=r(u)}}function S(e){if(m=!1,b(e),!f)if(null!==r(c))f=!0,A();else{var t=r(u);null!==t&&M(S,t.startTime-e)}}var y,R=!1,E=-1,x=5,T=-1;function F(){return!(t.unstable_now()-T<x)}function P(){if(R){var e=t.unstable_now();T=e;var i=!0;try{e:{f=!1,m&&(m=!1,C(E),E=-1),p=!0;var o=g;try{t:{for(b(e),h=r(c);null!==h&&!(h.expirationTime>e&&F());){var s=h.callback;if("function"===typeof s){h.callback=null,g=h.priorityLevel;var a=s(h.expirationTime<=e);if(e=t.unstable_now(),"function"===typeof a){h.callback=a,b(e),i=!0;break t}h===r(c)&&n(c),b(e)}else n(c);h=r(c)}if(null!==h)i=!0;else{var l=r(u);null!==l&&M(S,l.startTime-e),i=!1}}break e}finally{h=null,g=o,p=!1}i=void 0}}finally{i?y():R=!1}}}if("function"===typeof w)y=function(){w(P)};else if("undefined"!==typeof MessageChannel){var D=new MessageChannel,k=D.port2;D.port1.onmessage=P,y=function(){k.postMessage(null)}}else y=function(){v(P,0)};function A(){R||(R=!0,y())}function M(e,i){E=v((function(){e(t.unstable_now())}),i)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){f||p||(f=!0,A())},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):x=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(g){case 1:case 2:case 3:var t=3;break;default:t=g}var i=g;g=t;try{return e()}finally{g=i}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var i=g;g=e;try{return t()}finally{g=i}},t.unstable_scheduleCallback=function(e,n,o){var s=t.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?s+o:s:o=s,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:d++,callback:n,priorityLevel:e,startTime:o,expirationTime:a=o+a,sortIndex:-1},o>s?(e.sortIndex=o,i(u,e),null===r(c)&&e===r(u)&&(m?(C(E),E=-1):m=!0,M(S,o-s))):(e.sortIndex=a,i(c,e),f||p||(f=!0,A())),e},t.unstable_shouldYield=F,t.unstable_wrapCallback=function(e){var t=g;return function(){var i=g;g=t;try{return e.apply(this,arguments)}finally{g=i}}}},853:(e,t,i)=>{e.exports=i(896)}},t={};function i(r){var n=t[r];if(void 0!==n)return n.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,i),o.exports}var r=i(43),n=i(391);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function s(e){var t=function(e,t){if("object"!=o(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==o(t)?t:t+""}function a(e,t,i){return(t=s(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function l(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function c(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?l(Object(i),!0).forEach((function(t){a(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):l(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function u(e,t){if(null==e)return{};var i,r,n=function(e,t){if(null==e)return{};var i={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;i[r]=e[r]}return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)i=o[r],t.includes(i)||{}.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}const d=["key"];var h=class{constructor(){this.allSyncListeners=new Map,this.allAsyncListeners=new Map,this.globalSyncListeners=new Set,this.globalAsyncListeners=new Set,this.asyncFunctionsQueue=[],this.scheduled=!1,this.firedEvents={}}setFrameworkOverrides(e){this.frameworkOverrides=e}getListeners(e,t,i){const r=t?this.allAsyncListeners:this.allSyncListeners;let n=r.get(e);return!n&&i&&(n=new Set,r.set(e,n)),n}noRegisteredListenersExist(){return 0===this.allSyncListeners.size&&0===this.allAsyncListeners.size&&0===this.globalSyncListeners.size&&0===this.globalAsyncListeners.size}addEventListener(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.getListeners(e,i,!0).add(t)}removeEventListener(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=this.getListeners(e,i,!1);if(r&&(r.delete(t),0===r.size)){(i?this.allAsyncListeners:this.allSyncListeners).delete(e)}}addGlobalListener(e){(arguments.length>1&&void 0!==arguments[1]&&arguments[1]?this.globalAsyncListeners:this.globalSyncListeners).add(e)}removeGlobalListener(e){(arguments.length>1&&void 0!==arguments[1]&&arguments[1]?this.globalAsyncListeners:this.globalSyncListeners).delete(e)}dispatchEvent(e){const t=e;this.dispatchToListeners(t,!0),this.dispatchToListeners(t,!1),this.firedEvents[t.type]=!0}dispatchEventOnce(e){this.firedEvents[e.type]||this.dispatchEvent(e)}dispatchToListeners(e,t){var i;const r=e.type;if(t&&"event"in e){const t=e.event;t instanceof Event&&(e.eventPath=t.composedPath())}const n=(i,r)=>i.forEach((i=>{if(!r.has(i))return;const n=this.frameworkOverrides?()=>this.frameworkOverrides.wrapIncoming((()=>i(e))):()=>i(e);t?this.dispatchAsync(n):n()})),o=null!==(i=this.getListeners(r,t,!1))&&void 0!==i?i:new Set,s=new Set(o);s.size>0&&n(s,o);new Set(t?this.globalAsyncListeners:this.globalSyncListeners).forEach((i=>{const n=this.frameworkOverrides?()=>this.frameworkOverrides.wrapIncoming((()=>i(r,e))):()=>i(r,e);t?this.dispatchAsync(n):n()}))}dispatchAsync(e){if(this.asyncFunctionsQueue.push(e),!this.scheduled){const e=()=>{window.setTimeout(this.flushAsyncQueue.bind(this),0)};this.frameworkOverrides?this.frameworkOverrides.wrapIncoming(e):e(),this.scheduled=!0}}flushAsyncQueue(){this.scheduled=!1;const e=this.asyncFunctionsQueue.slice();this.asyncFunctionsQueue=[],e.forEach((e=>e()))}},g=(e=>(e.CommunityCoreModule="@ag-grid-community/core",e.InfiniteRowModelModule="@ag-grid-community/infinite-row-model",e.ClientSideRowModelModule="@ag-grid-community/client-side-row-model",e.CsvExportModule="@ag-grid-community/csv-export",e.EnterpriseCoreModule="@ag-grid-enterprise/core",e.RowGroupingModule="@ag-grid-enterprise/row-grouping",e.ColumnsToolPanelModule="@ag-grid-enterprise/column-tool-panel",e.FiltersToolPanelModule="@ag-grid-enterprise/filter-tool-panel",e.MenuModule="@ag-grid-enterprise/menu",e.SetFilterModule="@ag-grid-enterprise/set-filter",e.MultiFilterModule="@ag-grid-enterprise/multi-filter",e.StatusBarModule="@ag-grid-enterprise/status-bar",e.SideBarModule="@ag-grid-enterprise/side-bar",e.RangeSelectionModule="@ag-grid-enterprise/range-selection",e.MasterDetailModule="@ag-grid-enterprise/master-detail",e.RichSelectModule="@ag-grid-enterprise/rich-select",e.GridChartsModule="@ag-grid-enterprise/charts",e.ViewportRowModelModule="@ag-grid-enterprise/viewport-row-model",e.ServerSideRowModelModule="@ag-grid-enterprise/server-side-row-model",e.ExcelExportModule="@ag-grid-enterprise/excel-export",e.ClipboardModule="@ag-grid-enterprise/clipboard",e.SparklinesModule="@ag-grid-enterprise/sparklines",e.AdvancedFilterModule="@ag-grid-enterprise/advanced-filter",e.AngularModule="@ag-grid-community/angular",e.ReactModule="@ag-grid-community/react",e.VueModule="@ag-grid-community/vue",e))(g||{}),p={};function f(e,t){p[t]||(e(),p[t]=!0)}function m(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];console.log("AG Grid: "+e,...i)}function v(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];f((()=>console.warn("AG Grid: "+e,...i)),e+(null===i||void 0===i?void 0:i.join("")))}function C(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];f((()=>console.error("AG Grid: "+e,...i)),e+(null===i||void 0===i?void 0:i.join("")))}function w(e){return!!(e&&e.constructor&&e.call&&e.apply)}function b(e){!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;e.length>0&&window.setTimeout((()=>e.forEach((e=>e()))),t)}(e,400)}var S=[],y=!1;function R(e){S.push(e),y||(y=!0,window.setTimeout((()=>{const e=S.slice();S.length=0,y=!1,e.forEach((e=>e()))}),0))}function E(e,t){let i;return function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];const s=this;window.clearTimeout(i),i=window.setTimeout((function(){e.apply(s,n)}),t)}}function x(e,t){let i=0;return function(){const r=(new Date).getTime();if(!(r-i<t)){i=r;for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];e.apply(this,o)}}}function T(e){return null==e||""===e?null:e}function F(e){return null!=e&&(""!==e||arguments.length>1&&void 0!==arguments[1]&&arguments[1])}function P(e){return!F(e)}function D(e){return null==e||0===e.length}function k(e){return null!=e&&"function"===typeof e.toString?e.toString():null}function A(e){if(void 0===e)return;if(null===e||""===e)return null;if("number"===typeof e)return isNaN(e)?void 0:e;const t=parseInt(e,10);return isNaN(t)?void 0:t}function M(e){if(void 0!==e)return null!==e&&""!==e&&I(e)}function I(e){return"boolean"===typeof e?e:"string"===typeof e&&("TRUE"===e.toUpperCase()||""==e)}function L(e,t){return(e?JSON.stringify(e):null)===(t?JSON.stringify(t):null)}function O(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=null==e,n=null==t;if(e&&e.toNumber&&(e=e.toNumber()),t&&t.toNumber&&(t=t.toNumber()),r&&n)return 0;if(r)return-1;if(n)return 1;function o(e,t){return e>t?1:e<t?-1:0}if("string"!==typeof e)return o(e,t);if(!i)return o(e,t);try{return e.localeCompare(t)}catch(s){return o(e,t)}}function N(e){if(e instanceof Set||e instanceof Map){const t=[];return e.forEach((e=>t.push(e))),t}return Object.values(e)}function B(e,t){return e.get("rowModelType")===t}function G(e){return B(e,"clientSide")}function H(e){return B(e,"serverSide")}function z(e,t){return e.get("domLayout")===t}function V(e){return void 0!==ve(e)}function _(e){return!e.get("suppressAsyncEvents")}function W(e){return"function"===typeof e.get("getRowHeight")}function U(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0;if(null==r&&(r=e.environment.getDefaultRowHeight()),W(e)){if(i)return{height:r,estimated:!0};const n={node:t,data:t.data},o=e.getCallback("getRowHeight")(n);if(K(o))return 0===o&&v("The return of `getRowHeight` cannot be zero. If the intention is to hide rows, use a filter instead."),{height:Math.max(1,o),estimated:!1}}if(t.detail&&e.get("masterDetail"))return function(e){if(e.get("detailRowAutoHeight"))return{height:1,estimated:!1};const t=e.get("detailRowHeight");if(K(t))return{height:t,estimated:!1};return{height:300,estimated:!1}}(e);const n=e.get("rowHeight");return{height:n&&K(n)?n:r,estimated:!1}}function j(e){const{environment:t}=e,i=e.get("rowHeight");if(!i||P(i))return t.getDefaultRowHeight();const r=t.refreshRowHeightVariable();return-1!==r?r:(v("row height must be a number if not using standard row model"),t.getDefaultRowHeight())}function K(e){return!isNaN(e)&&"number"===typeof e&&isFinite(e)}function Y(e,t,i){const r=t[e.getDomDataKey()];return r?r[i]:void 0}function q(e,t,i,r){const n=e.getDomDataKey();let o=t[n];P(o)&&(o={},t[n]=o),o[i]=r}function Q(e){let t=null;const i=e.get("getDocument");return i&&F(i)?t=i():e.eGridDiv&&(t=e.eGridDiv.ownerDocument),t&&F(t)?t:document}function X(e){return Q(e).defaultView||window}function J(e){return e.eGridDiv.getRootNode()}function Z(e){return J(e).activeElement}function ee(e){const t=Q(e),i=Z(e);return null===i||i===t.body}function te(e){return!e.get("ensureDomOrder")&&e.get("animateRows")}function ie(e){return!(e.get("paginateChildRows")||e.get("groupHideOpenParents")||z(e,"print"))}function re(e){const t=e.get("autoGroupColumnDef");return!(null!==t&&void 0!==t&&t.comparator)&&!e.get("treeData")}function ne(e){const t=e.get("groupAggFiltering");return"function"===typeof t?e.getCallback("groupAggFiltering"):!0===t?()=>!0:void 0}function oe(e){const t=e.get("grandTotalRow");if(t)return t;return e.get("groupIncludeTotalFooter")?"bottom":void 0}function se(e){const t=e.get("groupTotalRow");if("function"===typeof t)return e.getCallback("groupTotalRow");if(t)return()=>t;const i=e.get("groupIncludeFooter");if("function"===typeof i){const t=e.getCallback("groupIncludeFooter");return e=>t(e)?"bottom":void 0}return()=>i?"bottom":void 0}function ae(e){return e.exists("groupDisplayType")?"multipleColumns"===e.get("groupDisplayType"):e.get("groupHideOpenParents")}function le(e,t){return!t&&"groupRows"===e.get("groupDisplayType")}function ce(e){const t=e.getCallback("getRowId");return void 0===t?t:e=>{let i=t(e);return"string"!==typeof i&&(v("The getRowId callback must return a string. The ID ",i," is being cast to a string."),i=String(i)),i}}function ue(e){var t;return null===(t=null===e||void 0===e?void 0:e.checkboxes)||void 0===t||t}function de(e){var t;return"multiRow"===(null===e||void 0===e?void 0:e.mode)&&(null===(t=e.headerCheckbox)||void 0===t||t)}function he(e){const t=e.get("cellSelection");return void 0!==t?!!t:e.get("enableRangeSelection")}function ge(e){var t;const i=e.get("cellSelection");return void 0!==i?"boolean"!==typeof i&&"fill"===(null===(t=i.handle)||void 0===t?void 0:t.mode):e.get("enableFillHandle")}function pe(e){var t,i;const r=null!==(t=e.get("rowSelection"))&&void 0!==t?t:"single";if("string"===typeof r){const t=e.get("suppressRowClickSelection"),i=e.get("suppressRowDeselection");return(!t||!i)&&(t?"enableDeselection":!i||"enableSelection")}return("singleRow"===r.mode||"multiRow"===r.mode)&&(null!==(i=r.enableClickSelection)&&void 0!==i&&i)}function fe(e){const t=pe(e);return!0===t||"enableDeselection"===t}function me(e){const t=e.get("rowSelection");return"string"===typeof t?e.get("isRowSelectable"):null===t||void 0===t?void 0:t.isRowSelectable}function ve(e){const t=e.get("rowSelection");if("string"===typeof t)switch(t){case"multiple":return"multiRow";case"single":return"singleRow";default:return}return null===t||void 0===t?void 0:t.mode}function Ce(e){return"multiRow"===ve(e)}function we(e){const t=e.get("rowSelection");if("string"===typeof t){const t=e.get("groupSelectsChildren"),i=e.get("groupSelectsFiltered");return t&&i?"filteredDescendants":t?"descendants":"self"}return"multiRow"===(null===t||void 0===t?void 0:t.mode)?t.groupSelects:void 0}function be(e){const t=we(e);return"descendants"===t||"filteredDescendants"===t}function Se(e){return e.isModuleRegistered("@ag-grid-enterprise/set-filter")&&!e.get("suppressSetFilterByDefault")}function ye(e){if(e&&e.length)return e[e.length-1]}function Re(e,t,i){return null==e&&null==t||null!=e&&null!=t&&e.length===t.length&&e.every(((e,r)=>i?i(e,t[r]):t[r]===e))}function Ee(e,t){const i=e.indexOf(t);i>=0&&(e[i]=e[e.length-1],e.pop())}function xe(e,t){const i=e.indexOf(t);i>=0&&e.splice(i,1)}function Te(e,t,i){e.splice(i,0,t)}function Fe(e,t,i){!function(e,t){for(let i=0;i<t.length;i++)xe(e,t[i])}(e,t),t.slice().reverse().forEach((t=>Te(e,t,i)))}function Pe(e,t){return e.indexOf(t)>-1}function De(e){var t;return null!==(t=null===e||void 0===e?void 0:e.flatMap((e=>e)))&&void 0!==t?t:[]}function ke(e,t){null!=t&&null!=e&&t.forEach((t=>e.push(t)))}var Ae="__ag_Grid_Stop_Propagation",Me=["touchstart","touchend","touchmove","touchcancel","scroll"],Ie={};function Le(e){e[Ae]=!0}function Oe(e){return!0===e[Ae]}var Ne=(()=>{const e={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return t=>{if("boolean"===typeof Ie[t])return Ie[t];const i=document.createElement(e[t]||"div");return Ie[t="on"+t]=t in i}})();function Be(e,t,i){let r=t;for(;r;){const t=Y(e,r,i);if(t)return t;r=r.parentElement}return null}function Ge(e,t){return!(!t||!e)&&function(e){const t=e;if(t.path)return t.path;if(t.composedPath)return t.composedPath();return function(e){const t=[];let i=e.target;for(;i;)t.push(i),i=i.parentElement;return t}(t)}(t).indexOf(e)>=0}var He=class{constructor(){this.destroyFunctions=[],this.destroyed=!1,this.__v_skip=!0,this.propertyListenerId=0,this.lastChangeSetIdLookup={},this.isAlive=()=>!this.destroyed}preWireBeans(e){this.frameworkOverrides=e.frameworkOverrides,this.stubContext=e.context,this.eventService=e.eventService,this.gos=e.gos,this.localeService=e.localeService}getFrameworkOverrides(){return this.frameworkOverrides}destroy(){for(let e=0;e<this.destroyFunctions.length;e++)this.destroyFunctions[e]();this.destroyFunctions.length=0,this.destroyed=!0,this.dispatchLocalEvent({type:"destroyed"})}addEventListener(e,t,i){this.localEventService||(this.localEventService=new h),this.localEventService.addEventListener(e,t,i)}removeEventListener(e,t,i){this.localEventService&&this.localEventService.removeEventListener(e,t,i)}dispatchLocalEvent(e){this.localEventService&&this.localEventService.dispatchEvent(e)}addManagedElementListeners(e,t){return this._setupListeners(e,t)}addManagedEventListeners(e){return this._setupListeners(this.eventService,e)}addManagedListeners(e,t){return this._setupListeners(e,t)}_setupListeners(e,t){const i=[];for(const r in t){const n=t[r];n&&i.push(this._setupListener(e,r,n))}return i}_setupListener(e,t,i){if(this.destroyed)return()=>null;e instanceof HTMLElement?function(e,t,i,r){const n=Pe(Me,i)?{passive:!0}:void 0;e&&e.addEventListener&&e.addEventListener(t,i,r,n)}(this.getFrameworkOverrides(),e,t,i):e.addEventListener(t,i);const r=()=>(e.removeEventListener(t,i),null);return this.destroyFunctions.push(r),()=>(r(),this.destroyFunctions=this.destroyFunctions.filter((e=>e!==r)),null)}setupGridOptionListener(e,t){this.gos.addPropertyEventListener(e,t);const i=()=>(this.gos.removePropertyEventListener(e,t),null);return this.destroyFunctions.push(i),()=>(i(),this.destroyFunctions=this.destroyFunctions.filter((e=>e!==i)),null)}addManagedPropertyListener(e,t){return this.destroyed?()=>null:this.setupGridOptionListener(e,t)}addManagedPropertyListeners(e,t){if(this.destroyed)return;const i=e.join("-")+this.propertyListenerId++,r=e=>{if(e.changeSet){if(e.changeSet&&e.changeSet.id===this.lastChangeSetIdLookup[i])return;this.lastChangeSetIdLookup[i]=e.changeSet.id}const r={type:"gridPropertyChanged",changeSet:e.changeSet,source:e.source};t(r)};e.forEach((e=>this.setupGridOptionListener(e,r)))}addDestroyFunc(e){this.isAlive()?this.destroyFunctions.push(e):e()}createManagedBean(e,t){const i=this.createBean(e,t);return this.addDestroyFunc(this.destroyBean.bind(this,e,t)),i}createBean(e,t,i){return(t||this.stubContext).createBean(e,i)}destroyBean(e,t){return(t||this.stubContext).destroyBean(e)}destroyBeans(e,t){return(t||this.stubContext).destroyBeans(e)}};function ze(e){return e instanceof Ve}var Ve=class extends He{constructor(e,t,i,r){super(),this.isColumn=!1,this.expandable=!1,this.instanceId=lt(),this.expandableListenerRemoveCallback=null,this.colGroupDef=e,this.groupId=t,this.expanded=!!e&&!!e.openByDefault,this.padding=i,this.level=r}destroy(){this.expandableListenerRemoveCallback&&this.reset(null,void 0),super.destroy()}reset(e,t){this.colGroupDef=e,this.level=t,this.originalParent=null,this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback(),this.children=void 0,this.expandable=void 0}getInstanceId(){return this.instanceId}setOriginalParent(e){this.originalParent=e}getOriginalParent(){return this.originalParent}getLevel(){return this.level}isVisible(){return!!this.children&&this.children.some((e=>e.isVisible()))}isPadding(){return this.padding}setExpanded(e){this.expanded=void 0!==e&&e,this.dispatchLocalEvent({type:"expandedChanged"})}isExpandable(){return this.expandable}isExpanded(){return this.expanded}getGroupId(){return this.groupId}getId(){return this.getGroupId()}setChildren(e){this.children=e}getChildren(){return this.children}getColGroupDef(){return this.colGroupDef}getLeafColumns(){const e=[];return this.addLeafColumns(e),e}addLeafColumns(e){this.children&&this.children.forEach((t=>{ct(t)?e.push(t):ze(t)&&t.addLeafColumns(e)}))}getColumnGroupShow(){const e=this.colGroupDef;if(e)return e.columnGroupShow}setupExpandable(){this.setExpandable(),this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback();const e=this.onColumnVisibilityChanged.bind(this);this.getLeafColumns().forEach((t=>t.addEventListener("visibleChanged",e))),this.expandableListenerRemoveCallback=()=>{this.getLeafColumns().forEach((t=>t.removeEventListener("visibleChanged",e))),this.expandableListenerRemoveCallback=null}}setExpandable(){if(this.isPadding())return;let e=!1,t=!1,i=!1;const r=this.findChildrenRemovingPadding();for(let o=0,s=r.length;o<s;o++){const n=r[o];if(!n.isVisible())continue;const s=n.getColumnGroupShow();"open"===s?(e=!0,i=!0):"closed"===s?(t=!0,i=!0):(e=!0,t=!0)}const n=e&&t&&i;this.expandable!==n&&(this.expandable=n,this.dispatchLocalEvent({type:"expandableChanged"}))}findChildrenRemovingPadding(){const e=[],t=i=>{i.forEach((i=>{ze(i)&&i.isPadding()?t(i.children):e.push(i)}))};return t(this.children),e}onColumnVisibilityChanged(){this.setExpandable()}},_e="ag-Grid-ControlsColumn",We=class extends He{constructor(){super(...arguments),this.beanName="controlsColService"}createControlsCols(){const{gos:e}=this,t=e.get("rowSelection");if(!t||"object"!==typeof t)return[];const i=ue(t),r=de(t);if(i||r){const t=e.get("selectionColumnDef"),i=c(c({maxWidth:50,resizable:!1,suppressHeaderMenuButton:!0,sortable:!1,suppressMovable:!0,lockPosition:e.get("enableRtl")?"right":"left",comparator(e,t,i,r){const n=i.isSelected(),o=r.isSelected();return n&&o?0:n?1:-1},editable:!1,suppressFillHandle:!0},t),{},{colId:"".concat(_e)}),r=new ut(i,null,i.colId,!1);return this.createBean(r),[r]}return[]}},Ue="ag-Grid-AutoColumn";function je(e){const t=[],i=e=>{for(let r=0;r<e.length;r++){const n=e[r];ct(n)?t.push(n):ze(n)&&i(n.getChildren())}};return i(e),t}function Ke(e){return e.reduce(((e,t)=>e+t.getActualWidth()),0)}function Ye(e,t,i){const r={};if(!t)return;pt(null,t,(e=>{r[e.getInstanceId()]=e})),i&&pt(null,i,(e=>{r[e.getInstanceId()]=null}));const n=Object.values(r).filter((e=>null!=e));e.destroyBeans(n)}function qe(e){return e.getId().startsWith(Ue)}function Qe(e){return e.getColId().startsWith(_e)}function $e(e){let t=[];if(e instanceof Array){e.some((e=>"string"!==typeof e))?v("if colDef.type is supplied an array it should be of type 'string[]'"):t=e}else"string"===typeof e?t=e.split(","):v("colDef.type should be of type 'string' | 'string[]'");return t}var Xe=class{constructor(e){this.frameworkOverrides=e,this.wrappedListeners=new Map,this.wrappedGlobalListeners=new Map}wrap(e){let t=e;return this.frameworkOverrides.shouldWrapOutgoing&&(t=t=>{this.frameworkOverrides.wrapOutgoing((()=>e(t)))},this.wrappedListeners.set(e,t)),t}wrapGlobal(e){let t=e;return this.frameworkOverrides.shouldWrapOutgoing&&(t=(t,i)=>{this.frameworkOverrides.wrapOutgoing((()=>e(t,i)))},this.wrappedGlobalListeners.set(e,t)),t}unwrap(e){var t;return null!==(t=this.wrappedListeners.get(e))&&void 0!==t?t:e}unwrapGlobal(e){var t;return null!==(t=this.wrappedGlobalListeners.get(e))&&void 0!==t?t:e}},Je=new Set(["__proto__","constructor","prototype"]);function Ze(e,t){if(null!=e)if(Array.isArray(e))for(let i=0;i<e.length;i++)t(i.toString(),e[i]);else for(const[i,r]of Object.entries(e))t(i,r)}function et(e){const t={},i=Object.keys(e);for(let r=0;r<i.length;r++){if(Je.has(i[r]))continue;const n=i[r],o=e[n];t[n]=o}return t}function tt(e,t){if(!e)return;const i=e,r={};return Object.keys(i).forEach((e=>{if(t&&t.indexOf(e)>=0||Je.has(e))return;const n=i[e],o=ot(n)&&n.constructor===Object;r[e]=o?tt(n):n})),r}function it(e){if(!e)return[];const t=Object;if("function"===typeof t.values)return t.values(e);const i=[];for(const r in e)e.hasOwnProperty(r)&&e.propertyIsEnumerable(r)&&i.push(e[r]);return i}function rt(e,t){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];F(t)&&Ze(t,((t,n)=>{if(Je.has(t))return;let o=e[t];if(o!==n){if(r){if(null==o&&null!=n){"object"===typeof n&&n.constructor===Object&&(o={},e[t]=o)}}ot(n)&&ot(o)&&!Array.isArray(o)?rt(o,n,i,r):(i||void 0!==n)&&(e[t]=n)}}))}function nt(e,t,i){if(!t||!e)return;if(!i)return e[t];const r=t.split(".");let n=e;for(let o=0;o<r.length;o++){if(null==n)return;n=n[r[o]]}return n}function ot(e){return"object"===typeof e&&null!==e}var st={resizable:!0,sortable:!0},at=0;function lt(){return at++}function ct(e){return e instanceof ut}var ut=class extends He{constructor(e,t,i,r){super(),this.isColumn=!0,this.instanceId=lt(),this.autoHeaderHeight=null,this.moving=!1,this.menuVisible=!1,this.lastLeftPinned=!1,this.firstRightPinned=!1,this.filterActive=!1,this.columnEventService=new h,this.tooltipEnabled=!1,this.rowGroupActive=!1,this.pivotActive=!1,this.aggregationActive=!1,this.colDef=e,this.userProvidedColDef=t,this.colId=i,this.primary=r,this.setState(e)}wireBeans(e){this.columnHoverService=e.columnHoverService}getInstanceId(){return this.instanceId}setState(e){void 0!==e.sort?"asc"!==e.sort&&"desc"!==e.sort||(this.sort=e.sort):"asc"!==e.initialSort&&"desc"!==e.initialSort||(this.sort=e.initialSort);const t=e.sortIndex,i=e.initialSortIndex;void 0!==t?null!==t&&(this.sortIndex=t):null!==i&&(this.sortIndex=i);const r=e.hide,n=e.initialHide;this.visible=void 0!==r?!r:!n,void 0!==e.pinned?this.setPinned(e.pinned):this.setPinned(e.initialPinned);const o=e.flex,s=e.initialFlex;void 0!==o?this.flex=o:void 0!==s&&(this.flex=s)}setColDef(e,t,i){this.colDef=e,this.userProvidedColDef=t,this.initMinAndMaxWidths(),this.initDotNotation(),this.initTooltip(),this.columnEventService.dispatchEvent(this.createColumnEvent("colDefChanged",i))}getUserProvidedColDef(){return this.userProvidedColDef}setParent(e){this.parent=e}getParent(){return this.parent}setOriginalParent(e){this.originalParent=e}getOriginalParent(){return this.originalParent}postConstruct(){this.initMinAndMaxWidths(),this.resetActualWidth("gridInitializing"),this.initDotNotation(),this.initTooltip()}initDotNotation(){const e=this.gos.get("suppressFieldDotNotation");this.fieldContainsDots=F(this.colDef.field)&&this.colDef.field.indexOf(".")>=0&&!e,this.tooltipFieldContainsDots=F(this.colDef.tooltipField)&&this.colDef.tooltipField.indexOf(".")>=0&&!e}initMinAndMaxWidths(){var e,t;const i=this.colDef;this.minWidth=null!==(e=i.minWidth)&&void 0!==e?e:this.gos.environment.getDefaultColumnMinWidth(),this.maxWidth=null!==(t=i.maxWidth)&&void 0!==t?t:Number.MAX_SAFE_INTEGER}initTooltip(){this.tooltipEnabled=F(this.colDef.tooltipField)||F(this.colDef.tooltipValueGetter)||F(this.colDef.tooltipComponent)}resetActualWidth(e){const t=this.calculateColInitialWidth(this.colDef);this.setActualWidth(t,e,!0)}calculateColInitialWidth(e){let t;const i=A(e.width),r=A(e.initialWidth);return t=null!=i?i:null!=r?r:200,Math.max(Math.min(t,this.maxWidth),this.minWidth)}isEmptyGroup(){return!1}isRowGroupDisplayed(e){if(P(this.colDef)||P(this.colDef.showRowGroup))return!1;const t=!0===this.colDef.showRowGroup,i=this.colDef.showRowGroup===e;return t||i}isPrimary(){return this.primary}isFilterAllowed(){return!!this.colDef.filter}isFieldContainsDots(){return this.fieldContainsDots}isTooltipEnabled(){return this.tooltipEnabled}isTooltipFieldContainsDots(){return this.tooltipFieldContainsDots}getHighlighted(){return this.highlighted}addEventListener(e,t){var i,r;this.frameworkOverrides.shouldWrapOutgoing&&!this.frameworkEventListenerService&&(this.columnEventService.setFrameworkOverrides(this.frameworkOverrides),this.frameworkEventListenerService=new Xe(this.frameworkOverrides));const n=null!==(i=null===(r=this.frameworkEventListenerService)||void 0===r?void 0:r.wrap(t))&&void 0!==i?i:t;this.columnEventService.addEventListener(e,n)}removeEventListener(e,t){var i,r;const n=null!==(i=null===(r=this.frameworkEventListenerService)||void 0===r?void 0:r.unwrap(t))&&void 0!==i?i:t;this.columnEventService.removeEventListener(e,n)}createColumnFunctionCallbackParams(e){return this.gos.addGridCommonParams({node:e,data:e.data,column:this,colDef:this.colDef})}isSuppressNavigable(e){if("boolean"===typeof this.colDef.suppressNavigable)return this.colDef.suppressNavigable;if("function"===typeof this.colDef.suppressNavigable){const t=this.createColumnFunctionCallbackParams(e);return(0,this.colDef.suppressNavigable)(t)}return!1}isCellEditable(e){if(e.group)if(this.gos.get("treeData")){if(!e.data&&!this.gos.get("enableGroupEdit"))return!1}else if(!this.gos.get("enableGroupEdit"))return!1;return this.isColumnFunc(e,this.colDef.editable)}isSuppressFillHandle(){return!!this.colDef.suppressFillHandle}isAutoHeight(){return!!this.colDef.autoHeight}isAutoHeaderHeight(){return!!this.colDef.autoHeaderHeight}isRowDrag(e){return this.isColumnFunc(e,this.colDef.rowDrag)}isDndSource(e){return this.isColumnFunc(e,this.colDef.dndSource)}isCellCheckboxSelection(e){const t=this.gos.get("rowSelection");if(t&&"string"!==typeof t){const i=Qe(this)&&ue(t);return this.isColumnFunc(e,i)}return this.isColumnFunc(e,this.colDef.checkboxSelection)}isSuppressPaste(e){return this.isColumnFunc(e,this.colDef?this.colDef.suppressPaste:null)}isResizable(){return!!this.getColDefValue("resizable")}getColDefValue(e){var t;return null!==(t=this.colDef[e])&&void 0!==t?t:st[e]}isColumnFunc(e,t){if("boolean"===typeof t)return t;if("function"===typeof t){return t(this.createColumnFunctionCallbackParams(e))}return!1}setHighlighted(e){this.highlighted!==e&&(this.highlighted=e,this.columnEventService.dispatchEvent(this.createColumnEvent("headerHighlightChanged","uiColumnMoved")))}setMoving(e,t){this.moving=e,this.columnEventService.dispatchEvent(this.createColumnEvent("movingChanged",t))}createColumnEvent(e,t){return this.gos.addGridCommonParams({type:e,column:this,columns:[this],source:t})}isMoving(){return this.moving}getSort(){return this.sort}setSort(e,t){this.sort!==e&&(this.sort=e,this.columnEventService.dispatchEvent(this.createColumnEvent("sortChanged",t))),this.dispatchStateUpdatedEvent("sort")}isSortable(){return!!this.getColDefValue("sortable")}isSortAscending(){return"asc"===this.sort}isSortDescending(){return"desc"===this.sort}isSortNone(){return P(this.sort)}isSorting(){return F(this.sort)}getSortIndex(){return this.sortIndex}setSortIndex(e){this.sortIndex=e,this.dispatchStateUpdatedEvent("sortIndex")}setMenuVisible(e,t){this.menuVisible!==e&&(this.menuVisible=e,this.columnEventService.dispatchEvent(this.createColumnEvent("menuVisibleChanged",t)))}isMenuVisible(){return this.menuVisible}setAggFunc(e){this.aggFunc=e,this.dispatchStateUpdatedEvent("aggFunc")}getAggFunc(){return this.aggFunc}getLeft(){return this.left}getOldLeft(){return this.oldLeft}getRight(){return this.left+this.actualWidth}setLeft(e,t){this.oldLeft=this.left,this.left!==e&&(this.left=e,this.columnEventService.dispatchEvent(this.createColumnEvent("leftChanged",t)))}isFilterActive(){return this.filterActive}setFilterActive(e,t,i){this.filterActive!==e&&(this.filterActive=e,this.columnEventService.dispatchEvent(this.createColumnEvent("filterActiveChanged",t)));const r=this.createColumnEvent("filterChanged",t);i&&rt(r,i),this.columnEventService.dispatchEvent(r)}isHovered(){return this.columnHoverService.isHovered(this)}setPinned(e){this.pinned=!0===e||"left"===e?"left":"right"===e?"right":null,this.dispatchStateUpdatedEvent("pinned")}setFirstRightPinned(e,t){this.firstRightPinned!==e&&(this.firstRightPinned=e,this.columnEventService.dispatchEvent(this.createColumnEvent("firstRightPinnedChanged",t)))}setLastLeftPinned(e,t){this.lastLeftPinned!==e&&(this.lastLeftPinned=e,this.columnEventService.dispatchEvent(this.createColumnEvent("lastLeftPinnedChanged",t)))}isFirstRightPinned(){return this.firstRightPinned}isLastLeftPinned(){return this.lastLeftPinned}isPinned(){return"left"===this.pinned||"right"===this.pinned}isPinnedLeft(){return"left"===this.pinned}isPinnedRight(){return"right"===this.pinned}getPinned(){return this.pinned}setVisible(e,t){const i=!0===e;this.visible!==i&&(this.visible=i,this.columnEventService.dispatchEvent(this.createColumnEvent("visibleChanged",t))),this.dispatchStateUpdatedEvent("hide")}isVisible(){return this.visible}isSpanHeaderHeight(){return!this.getColDef().suppressSpanHeaderHeight}getColumnGroupPaddingInfo(){let e=this.getParent();if(!e||!e.isPadding())return{numberOfParents:0,isSpanningTotal:!1};const t=e.getPaddingLevel()+1;let i=!0;for(;e;){if(!e.isPadding()){i=!1;break}e=e.getParent()}return{numberOfParents:t,isSpanningTotal:i}}getColDef(){return this.colDef}getDefinition(){return this.colDef}getColumnGroupShow(){return this.colDef.columnGroupShow}getColId(){return this.colId}getId(){return this.colId}getUniqueId(){return this.colId}getActualWidth(){return this.actualWidth}getAutoHeaderHeight(){return this.autoHeaderHeight}setAutoHeaderHeight(e){const t=e!==this.autoHeaderHeight;return this.autoHeaderHeight=e,t}createBaseColDefParams(e){return this.gos.addGridCommonParams({node:e,data:e.data,colDef:this.colDef,column:this})}getColSpan(e){if(P(this.colDef.colSpan))return 1;const t=this.createBaseColDefParams(e),i=this.colDef.colSpan(t);return Math.max(i,1)}getRowSpan(e){if(P(this.colDef.rowSpan))return 1;const t=this.createBaseColDefParams(e),i=this.colDef.rowSpan(t);return Math.max(i,1)}setActualWidth(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e=Math.max(e,this.minWidth),e=Math.min(e,this.maxWidth),this.actualWidth!==e&&(this.actualWidth=e,this.flex&&"flex"!==t&&"gridInitializing"!==t&&(this.flex=null),i||this.fireColumnWidthChangedEvent(t)),this.dispatchStateUpdatedEvent("width")}fireColumnWidthChangedEvent(e){this.columnEventService.dispatchEvent(this.createColumnEvent("widthChanged",e))}isGreaterThanMax(e){return e>this.maxWidth}getMinWidth(){return this.minWidth}getMaxWidth(){return this.maxWidth}getFlex(){return this.flex||0}setFlex(e){this.flex!==e&&(this.flex=e),this.dispatchStateUpdatedEvent("flex")}setMinimum(e){this.setActualWidth(this.minWidth,e)}setRowGroupActive(e,t){this.rowGroupActive!==e&&(this.rowGroupActive=e,this.columnEventService.dispatchEvent(this.createColumnEvent("columnRowGroupChanged",t))),this.dispatchStateUpdatedEvent("rowGroup")}isRowGroupActive(){return this.rowGroupActive}setPivotActive(e,t){this.pivotActive!==e&&(this.pivotActive=e,this.columnEventService.dispatchEvent(this.createColumnEvent("columnPivotChanged",t))),this.dispatchStateUpdatedEvent("pivot")}isPivotActive(){return this.pivotActive}isAnyFunctionActive(){return this.isPivotActive()||this.isRowGroupActive()||this.isValueActive()}isAnyFunctionAllowed(){return this.isAllowPivot()||this.isAllowRowGroup()||this.isAllowValue()}setValueActive(e,t){this.aggregationActive!==e&&(this.aggregationActive=e,this.columnEventService.dispatchEvent(this.createColumnEvent("columnValueChanged",t)))}isValueActive(){return this.aggregationActive}isAllowPivot(){return!0===this.colDef.enablePivot}isAllowValue(){return!0===this.colDef.enableValue}isAllowRowGroup(){return!0===this.colDef.enableRowGroup}dispatchStateUpdatedEvent(e){this.columnEventService.dispatchEvent({type:"columnStateUpdated",key:e})}},dt={numericColumn:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"},rightAligned:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"}},ht=class{constructor(){this.existingKeys={}}addExistingKeys(e){for(let t=0;t<e.length;t++)this.existingKeys[e[t]]=!0}getUniqueKey(e,t){e=k(e);let i=0;for(;;){let r;if(e?(r=e,0!==i&&(r+="_"+i)):t?(r=t,0!==i&&(r+="_"+i)):r=i,!this.existingKeys[r])return this.existingKeys[r]=!0,String(r);i++}}},gt=class extends He{constructor(){super(...arguments),this.beanName="columnFactory"}wireBeans(e){this.dataTypeService=e.dataTypeService}createColumnTree(e,t,i,r){const n=new ht,{existingCols:o,existingGroups:s,existingColKeys:a}=this.extractExistingTreeData(i);n.addExistingKeys(a);const l=this.recursivelyCreateColumns(e,0,t,o,n,s,r),c=this.findMaxDept(l,0),u=this.balanceColumnTree(l,0,c,n);return pt(null,u,((e,t)=>{ze(e)&&e.setupExpandable(),e.setOriginalParent(t)})),{columnTree:u,treeDept:c}}extractExistingTreeData(e){const t=[],i=[],r=[];return e&&pt(null,e,(e=>{if(ze(e)){const t=e;i.push(t)}else{const i=e;r.push(i.getId()),t.push(i)}})),{existingCols:t,existingGroups:i,existingColKeys:r}}balanceTreeForAutoCols(e,t){const i=[],r=this.findDepth(t);return e.forEach((e=>{let t=e;for(let i=r-1;i>=0;i--){const r=new Ve(null,"FAKE_PATH_".concat(e.getId(),"}_").concat(i),!0,i);this.createBean(r),r.setChildren([t]),t.setOriginalParent(r),t=r}0===r&&e.setOriginalParent(null),i.push(t)})),[i,r]}findDepth(e){let t=0,i=e;for(;i&&i[0]&&ze(i[0]);)t++,i=i[0].getChildren();return t}balanceColumnTree(e,t,i,r){const n=[];for(let o=0;o<e.length;o++){const s=e[o];if(ze(s)){const e=s,o=this.balanceColumnTree(e.getChildren(),t+1,i,r);e.setChildren(o),n.push(e)}else{let o,a;for(let e=i-1;e>=t;e--){const e=r.getUniqueKey(null,null),i=this.createMergedColGroupDef(null),n=new Ve(i,e,!0,t);this.createBean(n),a&&a.setChildren([n]),a=n,o||(o=a)}if(o&&a){n.push(o);if(e.some((e=>ze(e)))){a.setChildren([s]);continue}a.setChildren(e);break}n.push(s)}}return n}findMaxDept(e,t){let i=t;for(let r=0;r<e.length;r++){const n=e[r];if(ze(n)){const e=n,r=this.findMaxDept(e.getChildren(),t+1);i<r&&(i=r)}}return i}recursivelyCreateColumns(e,t,i,r,n,o,s){if(!e)return[];const a=new Array(e.length);for(let l=0;l<a.length;l++){const c=e[l];this.isColumnGroup(c)?a[l]=this.createColumnGroup(i,c,t,r,n,o,s):a[l]=this.createColumn(i,c,r,n,s)}return a}createColumnGroup(e,t,i,r,n,o,s){const a=this.createMergedColGroupDef(t),l=n.getUniqueKey(a.groupId||null,null),c=new Ve(a,l,!1,i);this.createBean(c);const u=this.findExistingGroup(t,o);u&&o.splice(u.idx,1);const d=null===u||void 0===u?void 0:u.group;d&&c.setExpanded(d.isExpanded());const h=this.recursivelyCreateColumns(a.children,i+1,e,r,n,o,s);return c.setChildren(h),c}createMergedColGroupDef(e){const t={};return Object.assign(t,this.gos.get("defaultColGroupDef")),Object.assign(t,e),t}createColumn(e,t,i,r,n){var o;const s=this.findExistingColumn(t,i);s&&(null===i||void 0===i||i.splice(s.idx,1));let a=null===s||void 0===s?void 0:s.column;if(a){const e=this.addColumnDefaultAndTypes(t,a.getColId());a.setColDef(e,t,n),this.applyColumnState(a,e,n)}else{const i=r.getUniqueKey(t.colId,t.field),n=this.addColumnDefaultAndTypes(t,i);a=new ut(n,t,i,e),this.createBean(a)}return null===(o=this.dataTypeService)||void 0===o||o.addColumnListeners(a),a}applyColumnState(e,t,i){const r=A(t.flex);void 0!==r&&e.setFlex(r);if(e.getFlex()<=0){const r=A(t.width);if(null!=r)e.setActualWidth(r,i);else{const t=e.getActualWidth();e.setActualWidth(t,i)}}void 0!==t.sort&&("asc"==t.sort||"desc"==t.sort?e.setSort(t.sort,i):e.setSort(void 0,i));const n=A(t.sortIndex);void 0!==n&&e.setSortIndex(n);const o=M(t.hide);void 0!==o&&e.setVisible(!o,i),void 0!==t.pinned&&e.setPinned(t.pinned)}findExistingColumn(e,t){if(t)for(let i=0;i<t.length;i++){const r=t[i].getUserProvidedColDef();if(!r)continue;if(null!=e.colId){if(t[i].getId()===e.colId)return{idx:i,column:t[i]};continue}if(null!=e.field){if(r.field===e.field)return{idx:i,column:t[i]}}else if(r===e)return{idx:i,column:t[i]}}}findExistingGroup(e,t){if(null!=e.groupId)for(let i=0;i<t.length;i++){const r=t[i];if(r.getColGroupDef()&&r.getId()===e.groupId)return{idx:i,group:r}}}addColumnDefaultAndTypes(e,t){var i;const r={};rt(r,this.gos.get("defaultColDef"),!1,!0);const n=this.updateColDefAndGetColumnType(r,e,t);n&&this.assignColumnTypes(n,r),rt(r,e,!1,!0);const o=this.gos.get("autoGroupColumnDef"),s=re(this.gos);return e.rowGroup&&o&&s&&rt(r,{sort:o.sort,initialSort:o.initialSort},!1,!0),null===(i=this.dataTypeService)||void 0===i||i.validateColDef(r),r}updateColDefAndGetColumnType(e,t,i){var r,n,o;const s=null===(r=this.dataTypeService)||void 0===r?void 0:r.updateColDefAndGetColumnType(e,t,i),a=null!==(n=null!==(o=t.type)&&void 0!==o?o:s)&&void 0!==n?n:e.type;return e.type=a,a?$e(a):void 0}assignColumnTypes(e,t){if(!e.length)return;const i=Object.assign({},dt);Ze(this.gos.get("columnTypes")||{},((e,t)=>{if(e in i)v("the column type '".concat(e,"' is a default column type and cannot be overridden."));else{t.type&&v("Column type definitions 'columnTypes' with a 'type' attribute are not supported because a column type cannot refer to another column type. Only column definitions 'columnDefs' can use the 'type' attribute to refer to a column type."),i[e]=t}})),e.forEach((e=>{const r=i[e.trim()];r?rt(t,r,!1,!0):v("colDef.type '"+e+"' does not correspond to defined gridOptions.columnTypes")}))}isColumnGroup(e){return void 0!==e.children}};function pt(e,t,i){if(t)for(let r=0;r<t.length;r++){const n=t[r];ze(n)&&pt(n,n.getChildren(),i),i(n,e)}}var ft=class extends He{constructor(){super(...arguments),this.beanName="columnModel",this.pivotMode=!1,this.autoHeightActiveAtLeastOnce=!1,this.ready=!1,this.changeEventsDispatching=!1,this.shouldQueueResizeOperations=!1,this.resizeOperationQueue=[]}wireBeans(e){this.context=e.context,this.ctrlsService=e.ctrlsService,this.columnFactory=e.columnFactory,this.columnSizeService=e.columnSizeService,this.visibleColsService=e.visibleColsService,this.columnViewportService=e.columnViewportService,this.pivotResultColsService=e.pivotResultColsService,this.columnAnimationService=e.columnAnimationService,this.autoColService=e.autoColService,this.controlsColService=e.controlsColService,this.valueCache=e.valueCache,this.columnDefFactory=e.columnDefFactory,this.columnApplyStateService=e.columnApplyStateService,this.columnGroupStateService=e.columnGroupStateService,this.eventDispatcher=e.columnEventDispatcher,this.columnMoveService=e.columnMoveService,this.columnAutosizeService=e.columnAutosizeService,this.funcColsService=e.funcColsService,this.quickFilterService=e.quickFilterService,this.showRowGroupColsService=e.showRowGroupColsService,this.environment=e.environment}postConstruct(){const e=this.gos.get("pivotMode");this.isPivotSettingAllowed(e)&&(this.pivotMode=e),this.addManagedPropertyListeners(["groupDisplayType","treeData","treeDataDisplayType","groupHideOpenParents"],(e=>this.refreshAll(mt(e.source)))),this.addManagedPropertyListener("rowSelection",(e=>{this.onSelectionOptionsChanged(e.currentValue,e.previousValue,mt(e.source))})),this.addManagedPropertyListener("autoGroupColumnDef",(e=>this.onAutoGroupColumnDefChanged(mt(e.source)))),this.addManagedPropertyListeners(["defaultColDef","defaultColGroupDef","columnTypes","suppressFieldDotNotation"],(e=>this.recreateColumnDefs(mt(e.source)))),this.addManagedPropertyListener("pivotMode",(e=>this.setPivotMode(this.gos.get("pivotMode"),mt(e.source)))),this.addManagedEventListeners({firstDataRendered:()=>this.onFirstDataRendered()})}createColsFromColDefs(e){var t,i,r;const n=this.colDefs?this.columnApplyStateService.compareColumnStatesAndDispatchEvents(e):void 0;this.valueCache.expire();const o=null===(t=this.colDefCols)||void 0===t?void 0:t.list,s=null===(i=this.colDefCols)||void 0===i?void 0:i.tree,a=this.columnFactory.createColumnTree(this.colDefs,!0,s,e);Ye(this.context,null===(r=this.colDefCols)||void 0===r?void 0:r.tree,a.columnTree);const l=a.columnTree,c=a.treeDept,u=je(l),d={};u.forEach((e=>d[e.getId()]=e)),this.colDefCols={tree:l,treeDepth:c,list:u,map:d},this.funcColsService.extractCols(e,o),this.ready=!0,this.refreshCols(!0),this.visibleColsService.refresh(e),this.columnViewportService.checkViewportColumns(),this.eventDispatcher.everythingChanged(e),n&&(this.changeEventsDispatching=!0,n(),this.changeEventsDispatching=!1),this.eventDispatcher.newColumnsLoaded(e),"gridInitializing"===e&&this.columnSizeService.applyAutosizeStrategy()}refreshCols(e){var t,i,r;if(!this.colDefCols)return;const n=null===(t=this.cols)||void 0===t?void 0:t.tree;this.saveColOrder(),this.selectCols(),this.createAutoCols(),this.addAutoCols(),this.createControlsCols(),this.addControlsCols();const o=(s=this.gos,this.showingPivotResult?!s.get("enableStrictPivotColumnOrder"):s.get("maintainColumnOrder"));var s;e&&!o||this.restoreColOrder(),this.positionLockedCols(),null===(i=this.showRowGroupColsService)||void 0===i||i.refresh(),null===(r=this.quickFilterService)||void 0===r||r.refreshQuickFilterCols(),this.setColSpanActive(),this.setAutoHeightActive(),this.visibleColsService.clear(),this.columnViewportService.clear();!Re(n,this.cols.tree)&&this.eventDispatcher.gridColumns()}selectCols(){const e=this.pivotResultColsService.getPivotResultCols();if(this.showingPivotResult=null!=e,e){const{map:t,list:i,tree:r,treeDepth:n}=e;this.cols={list:i.slice(),map:c({},t),tree:r.slice(),treeDepth:n};e.list.some((e=>{var t;return void 0!==(null===(t=this.cols)||void 0===t?void 0:t.map[e.getColId()])}))||(this.lastPivotOrder=null)}else{const{map:e,list:t,tree:i,treeDepth:r}=this.colDefCols;this.cols={list:t.slice(),map:c({},e),tree:i.slice(),treeDepth:r}}}getColsToShow(){const e=this.isPivotMode()&&!this.isShowingPivotResult(),t=this.funcColsService.getValueColumns();return this.cols.list.filter((i=>{const r=qe(i);if(e){const e=t&&Pe(t,i);return r||e}return r||i.isVisible()}))}addAutoCols(){null!=this.autoCols&&(this.cols.list=this.autoCols.list.concat(this.cols.list),this.cols.tree=this.autoCols.tree.concat(this.cols.tree),vt(this.cols))}createAutoCols(){var e,t;const i=le(this.gos,this.pivotMode),r=this.pivotMode?this.gos.get("pivotSuppressAutoColumn"):this.isSuppressAutoCol(),n=this.funcColsService.getRowGroupColumns(),o=()=>{this.autoCols&&(Ye(this.context,this.autoCols.tree),this.autoCols=null)};if(!(n.length>0||this.gos.get("treeData"))||r||i||!this.autoColService)return void o();const s=null!==(e=this.autoColService.createAutoCols(n))&&void 0!==e?e:[],a=wt(s,(null===(t=this.autoCols)||void 0===t?void 0:t.list)||null),l=this.cols.treeDepth,c=this.autoCols?this.autoCols.treeDepth:-1;if(a&&c==l)return;o();const[u,d]=this.columnFactory.balanceTreeForAutoCols(s,this.cols.tree);this.autoCols={list:s,tree:u,treeDepth:d,map:{}};const h=e=>{if(!e)return null;const t=e.filter((e=>!qe(e)));return[...s,...t]};this.lastOrder=h(this.lastOrder),this.lastPivotOrder=h(this.lastPivotOrder)}createControlsCols(){var e,t,i,r,n,o;const s=()=>{var e;Ye(this.context,null===(e=this.controlsCols)||void 0===e?void 0:e.tree),this.controlsCols=null};this.controlsColService||s();const a=this.cols.treeDepth,l=(null!==(e=null===(t=this.controlsCols)||void 0===t?void 0:t.treeDepth)&&void 0!==e?e:-1)==a,c=null!==(i=null===(r=this.controlsColService)||void 0===r?void 0:r.createControlsCols())&&void 0!==i?i:[];if(wt(c,null!==(n=null===(o=this.controlsCols)||void 0===o?void 0:o.list)&&void 0!==n?n:[])&&l)return;s();const[u,d]=this.columnFactory.balanceTreeForAutoCols(c,this.cols.tree);this.controlsCols={list:c,tree:u,treeDepth:d,map:{}};const h=e=>{if(!e)return null;const t=e.filter((e=>!Qe(e)));return[...c,...t]};this.lastOrder=h(this.lastOrder),this.lastPivotOrder=h(this.lastPivotOrder)}addControlsCols(){null!=this.controlsCols&&(this.cols.list=this.controlsCols.list.concat(this.cols.list),this.cols.tree=this.controlsCols.tree.concat(this.cols.tree),vt(this.cols))}refreshAll(e){this.isReady()&&(this.refreshCols(!1),this.visibleColsService.refresh(e))}setColsVisible(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0;this.columnApplyStateService.applyColumnState({state:e.map((e=>({colId:"string"===typeof e?e:e.getColId(),hide:!t})))},i)}setColsPinned(e,t,i){if(!this.cols)return;if(D(e))return;if(z(this.gos,"print"))return void v("Changing the column pinning status is not allowed with domLayout='print'");let r;this.columnAnimationService.start(),r=!0===t||"left"===t?"left":"right"===t?"right":null;const n=[];e.forEach((e=>{if(!e)return;const t=this.getCol(e);t&&t.getPinned()!==r&&(t.setPinned(r),n.push(t))})),n.length&&(this.visibleColsService.refresh(i),this.eventDispatcher.columnPinned(n,i)),this.columnAnimationService.finish()}setColumnGroupOpened(e,t,i){let r;r=ze(e)?e.getId():e||"",this.columnGroupStateService.setColumnGroupState([{groupId:r,open:t}],i)}getProvidedColGroup(e){var t;let i=null;return pt(null,null===(t=this.cols)||void 0===t?void 0:t.tree,(t=>{ze(t)&&t.getId()===e&&(i=t)})),i}isColGroupLocked(e){const t=this.gos.get("groupLockGroupColumns");if(!e.isRowGroupActive()||0===t)return!1;if(-1===t)return!0;return t>this.funcColsService.getRowGroupColumns().findIndex((t=>t.getColId()===e.getColId()))}isSuppressAutoCol(){if("custom"===this.gos.get("groupDisplayType"))return!0;return"custom"===this.gos.get("treeDataDisplayType")}setAutoHeightActive(){if(this.autoHeightActive=this.cols.list.some((e=>e.isVisible()&&e.isAutoHeight())),this.autoHeightActive){this.autoHeightActiveAtLeastOnce=!0;G(this.gos)||H(this.gos)||v("autoHeight columns only work with Client Side Row Model and Server Side Row Model.")}}restoreColOrder(){const e=this.showingPivotResult?this.lastPivotOrder:this.lastOrder;if(!e)return;const t=new Map(e.map(((e,t)=>[e,t])));if(!this.cols.list.some((e=>t.has(e))))return;const i=new Map(this.cols.list.map((e=>[e,!0]))),r=e.filter((e=>i.has(e))),n=new Map(r.map((e=>[e,!0]))),o=this.cols.list.filter((e=>!n.has(e))),s=r.slice();o.forEach((e=>{let t=e.getOriginalParent();if(!t)return void s.push(e);const i=[];for(;!i.length&&t;){t.getLeafColumns().forEach((e=>{const t=s.indexOf(e)>=0,r=i.indexOf(e)<0;t&&r&&i.push(e)})),t=t.getOriginalParent()}if(!i.length)return void s.push(e);const r=i.map((e=>s.indexOf(e))),n=Math.max(...r);Te(s,e,n+1)})),this.cols.list=s}sortColsLikeKeys(e){if(null==this.cols)return;let t=[];const i={};e.forEach((e=>{if(i[e])return;const r=this.cols.map[e];r&&(t.push(r),i[e]=!0)}));let r=0;this.cols.list.forEach((e=>{const n=e.getColId();if(null!=i[n])return;n.startsWith(Ue)?Te(t,e,r++):t.push(e)})),t=this.columnMoveService.placeLockedColumns(t),this.columnMoveService.doesMovePassMarryChildren(t)?this.cols.list=t:v("Applying column order broke a group where columns should be married together. Applying new order has been discarded.")}sortColsLikeCols(e){if(!e||e.length<=1)return;e.filter((e=>this.cols.list.indexOf(e)<0)).length>0||e.sort(((e,t)=>this.cols.list.indexOf(e)-this.cols.list.indexOf(t)))}resetColDefIntoCol(e,t){const i=e.getUserProvidedColDef();if(!i)return!1;const r=this.columnFactory.addColumnDefaultAndTypes(i,e.getColId());return e.setColDef(r,i,t),!0}queueResizeOperations(){this.shouldQueueResizeOperations=!0}isShouldQueueResizeOperations(){return this.shouldQueueResizeOperations}processResizeOperations(){this.shouldQueueResizeOperations=!1,this.resizeOperationQueue.forEach((e=>e())),this.resizeOperationQueue=[]}pushResizeOperation(e){this.resizeOperationQueue.push(e)}moveInCols(e,t,i){var r;Fe(null===(r=this.cols)||void 0===r?void 0:r.list,e,t),this.visibleColsService.refresh(i)}positionLockedCols(){this.cols.list=this.columnMoveService.placeLockedColumns(this.cols.list)}saveColOrder(){var e,t;this.showingPivotResult?this.lastPivotOrder=null===(e=this.cols)||void 0===e?void 0:e.list:this.lastOrder=null===(t=this.cols)||void 0===t?void 0:t.list}getColumnDefs(){if(!this.colDefCols)return;const e=this.colDefCols.list.slice();this.showingPivotResult?e.sort(((e,t)=>this.lastOrder.indexOf(e)-this.lastOrder.indexOf(t))):this.lastOrder&&e.sort(((e,t)=>this.cols.list.indexOf(e)-this.cols.list.indexOf(t)));const t=this.funcColsService.getRowGroupColumns(),i=this.funcColsService.getPivotColumns();return this.columnDefFactory.buildColumnDefs(e,t,i)}isShowingPivotResult(){return this.showingPivotResult}isChangeEventsDispatching(){return this.changeEventsDispatching}isColSpanActive(){return this.colSpanActive}isProvidedColGroupsPresent(){var e;return(null===(e=this.colDefCols)||void 0===e?void 0:e.treeDepth)>0}setColSpanActive(){this.colSpanActive=this.cols.list.some((e=>null!=e.getColDef().colSpan))}isAutoRowHeightActive(){return this.autoHeightActive}wasAutoRowHeightEverActive(){return this.autoHeightActiveAtLeastOnce}getHeaderRowCount(){return this.cols?this.cols.treeDepth+1:-1}isReady(){return this.ready}isPivotMode(){return this.pivotMode}setPivotMode(e,t){e!==this.pivotMode&&this.isPivotSettingAllowed(this.pivotMode)&&(this.pivotMode=e,this.ready&&(this.refreshCols(!1),this.visibleColsService.refresh(t),this.eventDispatcher.pivotModeChanged()))}isPivotSettingAllowed(e){return!e||!this.gos.get("treeData")||(v("Pivot mode not available with treeData."),!1)}isPivotActive(){const e=this.funcColsService.getPivotColumns();return this.pivotMode&&!D(e)}recreateColumnDefs(e){this.cols&&(this.autoCols&&this.autoColService.updateAutoCols(this.autoCols.list,e),this.createColsFromColDefs(e))}setColumnDefs(e,t){this.colDefs=e,this.createColsFromColDefs(t)}destroy(){var e,t,i;Ye(this.context,null===(e=this.colDefCols)||void 0===e?void 0:e.tree),Ye(this.context,null===(t=this.autoCols)||void 0===t?void 0:t.tree),Ye(this.context,null===(i=this.controlsCols)||void 0===i?void 0:i.tree),super.destroy()}getColTree(){return this.cols.tree}getColDefColTree(){return this.colDefCols.tree}getColDefCols(){var e;return null!==(e=this.colDefCols)&&void 0!==e&&e.list?this.colDefCols.list:null}getCols(){var e,t;return null!==(e=null===(t=this.cols)||void 0===t?void 0:t.list)&&void 0!==e?e:[]}getAllCols(){var e,t,i,r,n,o;const s=this.pivotResultColsService.getPivotResultCols(),a=null===s||void 0===s?void 0:s.list;return[null!==(e=null===(t=this.colDefCols)||void 0===t?void 0:t.list)&&void 0!==e?e:[],null!==(i=null===(r=this.autoCols)||void 0===r?void 0:r.list)&&void 0!==i?i:[],null!==(n=null===(o=this.controlsCols)||void 0===o?void 0:o.list)&&void 0!==n?n:[],null!==a&&void 0!==a?a:[]].flat()}getColsForKeys(e){return e?e.map((e=>this.getCol(e))).filter((e=>null!=e)):[]}getColDefCol(e){var t;return null!==(t=this.colDefCols)&&void 0!==t&&t.list?this.getColFromCollection(e,this.colDefCols):null}getCol(e){return null==e?null:this.getColFromCollection(e,this.cols)}getColFromCollection(e,t){if(null==t)return null;const{map:i,list:r}=t;if("string"==typeof e&&i[e])return i[e];for(let n=0;n<r.length;n++)if(Ct(r[n],e))return r[n];return this.getAutoCol(e)}getAutoCol(e){var t,i;return null!==(t=null===(i=this.autoCols)||void 0===i?void 0:i.list.find((t=>Ct(t,e))))&&void 0!==t?t:null}getAutoCols(){var e,t;return null!==(e=null===(t=this.autoCols)||void 0===t?void 0:t.list)&&void 0!==e?e:null}setColHeaderHeight(e,t){e.setAutoHeaderHeight(t)&&(e.isColumn?this.eventDispatcher.headerHeight(e):this.eventDispatcher.groupHeaderHeight(e))}getGroupRowsHeight(){const e=[],t=this.ctrlsService.getHeaderRowContainerCtrls();for(const i of t){if(!i)continue;const t=i.getGroupRowCount()||0;for(let r=0;r<t;r++){const t=i.getGroupRowCtrlAtIndex(r),n=e[r];if(t){const i=this.getColumnGroupHeaderRowHeight(t);(null==n||i>n)&&(e[r]=i)}}}return e}getColumnGroupHeaderRowHeight(e){const t=this.isPivotMode()?this.getPivotGroupHeaderHeight():this.getGroupHeaderHeight();let i=0;const r=e.getHeaderCtrls();for(const n of r){const e=n.getColumn();if(e.isAutoHeaderHeight()){const t=e.getAutoHeaderHeight();null!=t&&t>i&&(i=t)}}return Math.max(t,i)}getColumnHeaderRowHeight(){const e=this.isPivotMode()?this.getPivotHeaderHeight():this.getHeaderHeight(),t=this.visibleColsService.getAllCols().filter((e=>e.isAutoHeaderHeight())).map((e=>e.getAutoHeaderHeight()||0));return Math.max(e,...t)}getHeaderHeight(){var e;return null!==(e=this.gos.get("headerHeight"))&&void 0!==e?e:this.environment.getDefaultHeaderHeight()}getFloatingFiltersHeight(){var e;return null!==(e=this.gos.get("floatingFiltersHeight"))&&void 0!==e?e:this.getHeaderHeight()}getGroupHeaderHeight(){var e;return null!==(e=this.gos.get("groupHeaderHeight"))&&void 0!==e?e:this.getHeaderHeight()}getPivotHeaderHeight(){var e;return null!==(e=this.gos.get("pivotHeaderHeight"))&&void 0!==e?e:this.getHeaderHeight()}getPivotGroupHeaderHeight(){var e;return null!==(e=this.gos.get("pivotGroupHeaderHeight"))&&void 0!==e?e:this.getGroupHeaderHeight()}onFirstDataRendered(){const e=this.gos.get("autoSizeStrategy");if("fitCellContents"!==(null===e||void 0===e?void 0:e.type))return;const{colIds:t,skipHeader:i}=e;setTimeout((()=>{t?this.columnAutosizeService.autoSizeCols({colKeys:t,skipHeader:i,source:"autosizeColumns"}):this.columnAutosizeService.autoSizeAllColumns("autosizeColumns",i)}))}onAutoGroupColumnDefChanged(e){this.autoCols&&this.autoColService.updateAutoCols(this.autoCols.list,e)}onSelectionOptionsChanged(e,t,i){const r=(t&&"string"!==typeof t?ue(t):void 0)!==(e&&"string"!==typeof e?ue(e):void 0),n=t&&"string"!==typeof t?de(t):void 0,o=e&&"string"!==typeof e?de(e):void 0;(r||n!==o)&&this.refreshAll(i)}};function mt(e){return"gridOptionsUpdated"===e?"gridOptionsChanged":e}function vt(e){e.map={},e.list.forEach((t=>e.map[t.getId()]=t))}function Ct(e,t){const i=e===t,r=e.getColDef()===t,n=e.getColId()==t;return i||r||n}function wt(e,t){return Re(e,t,((e,t)=>e.getColId()===t.getColId()))}var bt=class extends He{constructor(){super(...arguments),this.beanName="columnAutosizeService",this.timesDelayed=0}wireBeans(e){this.columnModel=e.columnModel,this.visibleColsService=e.visibleColsService,this.animationFrameService=e.animationFrameService,this.autoWidthCalculator=e.autoWidthCalculator,this.eventDispatcher=e.columnEventDispatcher,this.ctrlsService=e.ctrlsService,this.renderStatusService=e.renderStatusService}autoSizeCols(e){if(this.columnModel.isShouldQueueResizeOperations())return void this.columnModel.pushResizeOperation((()=>this.autoSizeCols(e)));const{colKeys:t,skipHeader:i,skipHeaderGroups:r,stopAtGroup:n,source:o="api"}=e;if(this.animationFrameService.flushAllFrames(),this.timesDelayed<5&&this.renderStatusService&&!this.renderStatusService.areHeaderCellsRendered())return this.timesDelayed++,void setTimeout((()=>this.autoSizeCols(e)));this.timesDelayed=0;const s=[];let a=-1;const l=null!=i?i:this.gos.get("skipHeaderOnAutoSize"),c=null!=r?r:l;for(;0!==a;){a=0;const e=[];t.forEach((t=>{if(!t)return;const i=this.columnModel.getCol(t);if(!i)return;if(s.indexOf(i)>=0)return;const r=this.autoWidthCalculator.getPreferredWidthForColumn(i,l);if(r>0){const e=this.normaliseColumnWidth(i,r);i.setActualWidth(e,o),s.push(i),a++}e.push(i)})),e.length&&this.visibleColsService.refresh(o)}c||this.autoSizeColumnGroupsByColumns(t,o,n),this.eventDispatcher.columnResized(s,!0,"autosizeColumns")}autoSizeColumn(e,t,i){e&&this.autoSizeCols({colKeys:[e],skipHeader:i,skipHeaderGroups:!0,source:t})}autoSizeColumnGroupsByColumns(e,t,i){const r=new Set;let n;this.columnModel.getColsForKeys(e).forEach((e=>{let t=e.getParent();for(;t&&t!=i;)t.isPadding()||r.add(t),t=t.getParent()}));for(const o of r){for(const e of this.ctrlsService.getHeaderRowContainerCtrls())if(n=e.getHeaderCtrlForColumn(o),n)break;n&&n.resizeLeafColumnsToFit(t)}return[]}autoSizeAllColumns(e,t){if(this.columnModel.isShouldQueueResizeOperations())return void this.columnModel.pushResizeOperation((()=>this.autoSizeAllColumns(e,t)));const i=this.visibleColsService.getAllCols();this.autoSizeCols({colKeys:i,skipHeader:t,source:e})}normaliseColumnWidth(e,t){const i=e.getMinWidth();t<i&&(t=i);const r=e.getMaxWidth();return e.isGreaterThanMax(t)&&(t=r),t}},St=class extends He{constructor(){super(...arguments),this.beanName="funcColsService",this.rowGroupCols=[],this.valueCols=[],this.pivotCols=[]}wireBeans(e){this.columnModel=e.columnModel,this.eventDispatcher=e.columnEventDispatcher,this.aggFuncService=e.aggFuncService,this.visibleColsService=e.visibleColsService}getModifyColumnsNoEventsCallbacks(){return{addGroupCol:e=>this.rowGroupCols.push(e),removeGroupCol:e=>xe(this.rowGroupCols,e),addPivotCol:e=>this.pivotCols.push(e),removePivotCol:e=>xe(this.pivotCols,e),addValueCol:e=>this.valueCols.push(e),removeValueCol:e=>xe(this.valueCols,e)}}getSourceColumnsForGroupColumn(e){const t=e.getColDef().showRowGroup;if(!t)return null;if(!0===t)return this.rowGroupCols.slice(0);const i=this.columnModel.getColDefCol(t);return i?[i]:null}sortRowGroupColumns(e){this.rowGroupCols.sort(e)}sortPivotColumns(e){this.pivotCols.sort(e)}getValueColumns(){return this.valueCols?this.valueCols:[]}getPivotColumns(){return this.pivotCols?this.pivotCols:[]}getRowGroupColumns(){return this.rowGroupCols?this.rowGroupCols:[]}isRowGroupEmpty(){return D(this.rowGroupCols)}setColumnAggFunc(e,t,i){if(!e)return;const r=this.columnModel.getColDefCol(e);r&&(r.setAggFunc(t),this.eventDispatcher.columnChanged("columnValueChanged",[r],i))}setRowGroupColumns(e,t){this.setColList(e,this.rowGroupCols,"columnRowGroupChanged",!0,!0,((e,i)=>this.setRowGroupActive(e,i,t)),t)}setRowGroupActive(e,t,i){e!==t.isRowGroupActive()&&(t.setRowGroupActive(e,i),e&&!this.gos.get("suppressRowGroupHidesColumns")&&this.columnModel.setColsVisible([t],!1,i),e||this.gos.get("suppressMakeColumnVisibleAfterUnGroup")||this.columnModel.setColsVisible([t],!0,i))}addRowGroupColumns(e,t){this.updateColList(e,this.rowGroupCols,!0,!0,(e=>this.setRowGroupActive(!0,e,t)),"columnRowGroupChanged",t)}removeRowGroupColumns(e,t){this.updateColList(e,this.rowGroupCols,!1,!0,(e=>this.setRowGroupActive(!1,e,t)),"columnRowGroupChanged",t)}addPivotColumns(e,t){this.updateColList(e,this.pivotCols,!0,!1,(e=>e.setPivotActive(!0,t)),"columnPivotChanged",t)}setPivotColumns(e,t){this.setColList(e,this.pivotCols,"columnPivotChanged",!0,!1,((e,i)=>{i.setPivotActive(e,t)}),t)}removePivotColumns(e,t){this.updateColList(e,this.pivotCols,!1,!1,(e=>e.setPivotActive(!1,t)),"columnPivotChanged",t)}setValueColumns(e,t){this.setColList(e,this.valueCols,"columnValueChanged",!1,!1,((e,i)=>this.setValueActive(e,i,t)),t)}setValueActive(e,t,i){if(e!==t.isValueActive()&&(t.setValueActive(e,i),e&&!t.getAggFunc()&&this.aggFuncService)){const e=this.aggFuncService.getDefaultAggFunc(t);t.setAggFunc(e)}}addValueColumns(e,t){this.updateColList(e,this.valueCols,!0,!1,(e=>this.setValueActive(!0,e,t)),"columnValueChanged",t)}removeValueColumns(e,t){this.updateColList(e,this.valueCols,!1,!1,(e=>this.setValueActive(!1,e,t)),"columnValueChanged",t)}moveRowGroupColumn(e,t,i){if(this.isRowGroupEmpty())return;const r=this.rowGroupCols[e],n=this.rowGroupCols.slice(e,t);this.rowGroupCols.splice(e,1),this.rowGroupCols.splice(t,0,r),this.eventDispatcher.rowGroupChanged(n,i)}setColList(e,t,i,r,n,o,s){if(!this.columnModel.getCols())return;const a=new Map;t.forEach(((e,t)=>a.set(e,t))),t.length=0,F(e)&&e.forEach((e=>{const i=this.columnModel.getColDefCol(e);i&&t.push(i)})),t.forEach(((e,t)=>{const i=a.get(e);void 0!==i?r&&i!==t||a.delete(e):a.set(e,0)}));(this.columnModel.getColDefCols()||[]).forEach((e=>{const i=t.indexOf(e)>=0;o(i,e)})),n&&this.columnModel.refreshCols(!1),this.visibleColsService.refresh(s),this.eventDispatcher.columnChanged(i,[...a.keys()],s)}updateColList(e,t,i,r,n,o,s){if(!e||D(e))return;let a=!1;const l=new Set;e.forEach((e=>{if(!e)return;const r=this.columnModel.getColDefCol(e);if(r){if(l.add(r),i){if(t.indexOf(r)>=0)return;t.push(r)}else{const e=t.indexOf(r);if(e<0)return;for(let i=e+1;i<t.length;i++)l.add(t[i]);xe(t,r)}n(r),a=!0}})),a&&(r&&this.columnModel.refreshCols(!1),this.visibleColsService.refresh(s),this.eventDispatcher.genericColumnEvent(o,Array.from(l),s))}extractCols(e,t){this.extractRowGroupCols(e,t),this.extractPivotCols(e,t),this.extractValueCols(e,t)}extractValueCols(e,t){this.valueCols=this.extractColsCommon(t,this.valueCols,((t,i)=>t.setValueActive(i,e)),(()=>{}),(()=>{}),(e=>{const t=e.aggFunc;return null===t||""===t?null:void 0!==t?!!t:void 0}),(e=>null!=e.initialAggFunc&&""!=e.initialAggFunc)),this.valueCols.forEach((e=>{const t=e.getColDef();null!=t.aggFunc&&""!=t.aggFunc?e.setAggFunc(t.aggFunc):e.getAggFunc()||e.setAggFunc(t.initialAggFunc)}))}extractRowGroupCols(e,t){this.rowGroupCols=this.extractColsCommon(t,this.rowGroupCols,((t,i)=>t.setRowGroupActive(i,e)),(e=>e.rowGroupIndex),(e=>e.initialRowGroupIndex),(e=>e.rowGroup),(e=>e.initialRowGroup))}extractPivotCols(e,t){this.pivotCols=this.extractColsCommon(t,this.pivotCols,((t,i)=>t.setPivotActive(i,e)),(e=>e.pivotIndex),(e=>e.initialPivotIndex),(e=>e.pivot),(e=>e.initialPivot))}extractColsCommon(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,n=arguments.length>4?arguments[4]:void 0,o=arguments.length>5?arguments[5]:void 0,s=arguments.length>6?arguments[6]:void 0;const a=[],l=[];(this.columnModel.getColDefCols()||[]).forEach((i=>{const c=e.indexOf(i)<0,u=i.getColDef(),d=M(o(u)),h=M(s(u)),g=A(r(u)),p=A(n(u));let f;if(f=void 0!==d?d:void 0!==g?null!==g&&g>=0:c?void 0!==h?h:!!(void 0!==p)&&(null!=p&&p>=0):t.indexOf(i)>=0,f){(c?null!=g||null!=p:null!=g)?a.push(i):l.push(i)}}));const c=e=>{const t=r(e.getColDef()),i=n(e.getColDef());return null!=t?t:i};a.sort(((e,t)=>{const i=c(e),r=c(t);return i===r?0:i<r?-1:1}));const u=[].concat(a);return t.forEach((e=>{l.indexOf(e)>=0&&u.push(e)})),l.forEach((e=>{u.indexOf(e)<0&&u.push(e)})),t.forEach((e=>{u.indexOf(e)<0&&i(e,!1)})),u.forEach((e=>{t.indexOf(e)<0&&i(e,!0)})),u}generateColumnStateForRowGroupAndPivotIndexes(e,t){const i={},r=(e,t,r,n,o,s)=>{const a=this.columnModel.getColDefCols();if(!t.length||!a)return[];const l=Object.keys(e),c=new Set(l),u=new Set(l),d=new Set(t.map((e=>{const t=e.getColId();return u.delete(t),t})).concat(l)),h=[],g={};let p=0;for(let i=0;i<a.length;i++){const e=a[i].getColId();d.has(e)&&(h.push(e),g[e]=p++)}let f=1e3,m=!1,v=0;const C=t=>{const i=g[t];for(let r=v;r<i;r++){const t=h[r];u.has(t)&&(e[t][o]=f++,u.delete(t))}v=i};t.forEach((t=>{const a=t.getColId();if(c.has(a))C(a),e[a][o]=f++;else{const l=t.getColDef();if(null===l[o]||void 0===l[o]&&null==l[s]){if(!m){l[r]||void 0===l[r]&&l[n]?C(a):(u.forEach((t=>{e[t][o]=f+g[t]})),f+=h.length,m=!0)}i[a]||(i[a]={colId:a}),i[a][o]=f++}}}))};return r(e,this.rowGroupCols,"rowGroup","initialRowGroup","rowGroupIndex","initialRowGroupIndex"),r(t,this.pivotCols,"pivot","initialPivot","pivotIndex","initialPivotIndex"),Object.values(i)}},yt=class extends He{constructor(){super(...arguments),this.beanName="columnApplyStateService"}wireBeans(e){this.columnModel=e.columnModel,this.eventDispatcher=e.columnEventDispatcher,this.sortController=e.sortController,this.columnGetStateService=e.columnGetStateService,this.funcColsService=e.funcColsService,this.visibleColsService=e.visibleColsService,this.columnAnimationService=e.columnAnimationService,this.pivotResultColsService=e.pivotResultColsService}applyColumnState(e,t){const i=this.columnModel.getColDefCols()||[];if(D(i))return!1;if(e&&e.state&&!e.state.forEach)return v("applyColumnState() - the state attribute should be an array, however an array was not found. Please provide an array of items (one for each col you want to change) for state."),!1;const r=this.funcColsService.getModifyColumnsNoEventsCallbacks(),n=(i,n,o)=>{const s=this.compareColumnStatesAndDispatchEvents(t),a=n.slice(),l={},c={},u=[],d=[];let h=0;const g=this.funcColsService.getRowGroupColumns().slice(),p=this.funcColsService.getPivotColumns().slice();i.forEach((i=>{const n=i.colId||"";if(n.startsWith(Ue))return u.push(i),void d.push(i);const s=o(n);s?(this.syncColumnWithStateItem(s,i,e.defaultState,l,c,!1,t,r),xe(a,s)):(d.push(i),h+=1)}));const f=i=>this.syncColumnWithStateItem(i,null,e.defaultState,l,c,!1,t,r);a.forEach(f),this.funcColsService.sortRowGroupColumns(Rt.bind(this,l,g)),this.funcColsService.sortPivotColumns(Rt.bind(this,c,p)),this.columnModel.refreshCols(!1);const m=(this.columnModel.getAutoCols()||[]).slice();return u.forEach((i=>{const n=this.columnModel.getAutoCol(i.colId);xe(m,n),this.syncColumnWithStateItem(n,i,e.defaultState,null,null,!0,t,r)})),m.forEach(f),this.orderLiveColsLikeState(e),this.visibleColsService.refresh(t),this.eventDispatcher.everythingChanged(t),s(),{unmatchedAndAutoStates:d,unmatchedCount:h}};this.columnAnimationService.start();let{unmatchedAndAutoStates:o,unmatchedCount:s}=n(e.state||[],i,(e=>this.columnModel.getColDefCol(e)));if(o.length>0||F(e.defaultState)){const e=this.pivotResultColsService.getPivotResultCols();s=n(o,(null===e||void 0===e?void 0:e.list)||[],(e=>this.pivotResultColsService.getPivotResultCol(e))).unmatchedCount}return this.columnAnimationService.finish(),0===s}resetColumnState(e){if(D(this.columnModel.getColDefCols()))return;const t=je(this.columnModel.getColDefColTree()),i=[];let r=1e3,n=1e3,o=[];const s=this.columnModel.getAutoCols();s&&(o=o.concat(s)),t&&(o=o.concat(t)),o.forEach((e=>{const t=this.getColumnStateFromColDef(e);P(t.rowGroupIndex)&&t.rowGroup&&(t.rowGroupIndex=r++),P(t.pivotIndex)&&t.pivot&&(t.pivotIndex=n++),i.push(t)})),this.applyColumnState({state:i,applyOrder:!0},e)}getColumnStateFromColDef(e){const t=(e,t)=>null!=e?e:null!=t?t:null,i=e.getColDef(),r=t(i.sort,i.initialSort),n=t(i.sortIndex,i.initialSortIndex),o=t(i.hide,i.initialHide),s=t(i.pinned,i.initialPinned),a=t(i.width,i.initialWidth),l=t(i.flex,i.initialFlex);let c=t(i.rowGroupIndex,i.initialRowGroupIndex),u=t(i.rowGroup,i.initialRowGroup);null!=c||null!=u&&0!=u||(c=null,u=null);let d=t(i.pivotIndex,i.initialPivotIndex),h=t(i.pivot,i.initialPivot);null!=d||null!=h&&0!=h||(d=null,h=null);const g=t(i.aggFunc,i.initialAggFunc);return{colId:e.getColId(),sort:r,sortIndex:n,hide:o,pinned:s,width:a,flex:l,rowGroup:u,rowGroupIndex:c,pivot:h,pivotIndex:d,aggFunc:g}}syncColumnWithStateItem(e,t,i,r,n,o,s,a){var l;if(!e)return;const c=(e,r)=>{const n={value1:void 0,value2:void 0};let o=!1;return t&&(void 0!==t[e]&&(n.value1=t[e],o=!0),F(r)&&void 0!==t[r]&&(n.value2=t[r],o=!0)),!o&&i&&(void 0!==i[e]&&(n.value1=i[e]),F(r)&&void 0!==i[r]&&(n.value2=i[r])),n},u=c("hide").value1;void 0!==u&&e.setVisible(!u,s);const d=c("pinned").value1;void 0!==d&&e.setPinned(d);const h=null!==(l=e.getColDef().minWidth)&&void 0!==l?l:this.gos.environment.getDefaultColumnMinWidth(),g=c("flex").value1;if(void 0!==g&&e.setFlex(g),null==g){const t=c("width").value1;null!=t&&null!=h&&t>=h&&e.setActualWidth(t,s)}const p=c("sort").value1;void 0!==p&&("desc"===p||"asc"===p?e.setSort(p,s):e.setSort(void 0,s));const f=c("sortIndex").value1;if(void 0!==f&&e.setSortIndex(f),o||!e.isPrimary())return;const m=c("aggFunc").value1;void 0!==m&&("string"===typeof m?(e.setAggFunc(m),e.isValueActive()||(e.setValueActive(!0,s),a.addValueCol(e))):(F(m)&&v("stateItem.aggFunc must be a string. if using your own aggregation functions, register the functions first before using them in get/set state. This is because it is intended for the column state to be stored and retrieved as simple JSON."),e.isValueActive()&&(e.setValueActive(!1,s),a.removeValueCol(e))));const{value1:C,value2:w}=c("rowGroup","rowGroupIndex");void 0===C&&void 0===w||("number"===typeof w||C?(e.isRowGroupActive()||(e.setRowGroupActive(!0,s),a.addGroupCol(e)),r&&"number"===typeof w&&(r[e.getId()]=w)):e.isRowGroupActive()&&(e.setRowGroupActive(!1,s),a.removeGroupCol(e)));const{value1:b,value2:S}=c("pivot","pivotIndex");void 0===b&&void 0===S||("number"===typeof S||b?(e.isPivotActive()||(e.setPivotActive(!0,s),a.addPivotCol(e)),n&&"number"===typeof S&&(n[e.getId()]=S)):e.isPivotActive()&&(e.setPivotActive(!1,s),a.removePivotCol(e)))}orderLiveColsLikeState(e){if(!e.applyOrder||!e.state)return;const t=[];e.state.forEach((e=>{null!=e.colId&&t.push(e.colId)})),this.columnModel.sortColsLikeKeys(t)}compareColumnStatesAndDispatchEvents(e){const t={rowGroupColumns:this.funcColsService.getRowGroupColumns().slice(),pivotColumns:this.funcColsService.getPivotColumns().slice(),valueColumns:this.funcColsService.getValueColumns().slice()},i=this.columnGetStateService.getColumnState(),r={};return i.forEach((e=>{r[e.colId]=e})),()=>{const n=this.columnModel.getAllCols(),o=(t,i,r,n)=>{if(Re(i.map(n),r.map(n)))return;const o=new Set(i);r.forEach((e=>{o.delete(e)||o.add(e)}));const s=[...o];this.eventService.dispatchEvent({type:t,columns:s,column:1===s.length?s[0]:null,source:e})},s=e=>{const t=[];return n.forEach((i=>{const n=r[i.getColId()];n&&e(n,i)&&t.push(i)})),t},a=e=>e.getColId();o("columnRowGroupChanged",t.rowGroupColumns,this.funcColsService.getRowGroupColumns(),a),o("columnPivotChanged",t.pivotColumns,this.funcColsService.getPivotColumns(),a);const l=s(((e,t)=>{const i=null!=e.aggFunc,r=i!=t.isValueActive(),n=i&&e.aggFunc!=t.getAggFunc();return r||n}));l.length>0&&this.eventDispatcher.columnChanged("columnValueChanged",l,e);this.eventDispatcher.columnResized(s(((e,t)=>e.width!=t.getActualWidth())),!0,e);this.eventDispatcher.columnPinned(s(((e,t)=>e.pinned!=t.getPinned())),e);this.eventDispatcher.columnVisible(s(((e,t)=>e.hide==t.isVisible())),e);const c=s(((e,t)=>e.sort!=t.getSort()||e.sortIndex!=t.getSortIndex()));c.length>0&&this.sortController.dispatchSortChangedEvents(e,c),this.normaliseColumnMovedEventForColumnState(i,e)}}normaliseColumnMovedEventForColumnState(e,t){const i=this.columnGetStateService.getColumnState(),r={};i.forEach((e=>r[e.colId]=e));const n={};e.forEach((e=>{r[e.colId]&&(n[e.colId]=!0)}));const o=e.filter((e=>n[e.colId])),s=i.filter((e=>n[e.colId])),a=[];s.forEach(((e,t)=>{const i=o&&o[t];if(i&&i.colId!==e.colId){const e=this.columnModel.getCol(i.colId);e&&a.push(e)}})),a.length&&this.eventDispatcher.columnMoved({movedColumns:a,source:t,finished:!0})}},Rt=(e,t,i,r)=>{const n=e[i.getId()],o=e[r.getId()],s=null!=n,a=null!=o;if(s&&a)return n-o;if(s)return-1;if(a)return 1;const l=t.indexOf(i),c=t.indexOf(r),u=l>=0;return u&&c>=0?l-c:u?-1:1},Et=class extends He{constructor(){super(...arguments),this.beanName="columnMoveService"}wireBeans(e){this.columnModel=e.columnModel,this.columnAnimationService=e.columnAnimationService,this.eventDispatcher=e.columnEventDispatcher}moveColumnByIndex(e,t,i){const r=this.columnModel.getCols();if(!r)return;const n=r[e];this.moveColumns([n],t,i)}moveColumns(e,t,i){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const n=this.columnModel.getCols();if(!n)return;if(t>n.length-e.length)return v("tried to insert columns in invalid location, toIndex = ",t),void v("remember that you should not count the moving columns when calculating the new index");this.columnAnimationService.start();const o=this.columnModel.getColsForKeys(e);this.doesMovePassRules(o,t)&&(this.columnModel.moveInCols(o,t,i),this.eventDispatcher.columnMoved({movedColumns:o,source:i,toIndex:t,finished:r})),this.columnAnimationService.finish()}doesMovePassRules(e,t){const i=this.getProposedColumnOrder(e,t);return this.doesOrderPassRules(i)}doesOrderPassRules(e){return!!this.doesMovePassMarryChildren(e)&&!!this.doesMovePassLockedPositions(e)}getProposedColumnOrder(e,t){const i=this.columnModel.getCols().slice();return Fe(i,e,t),i}doesMovePassLockedPositions(e){const t=this.gos.get("enableRtl");let i=t?1:-1,r=!0;return e.forEach((e=>{const n=(o=e.getColDef().lockPosition)?"left"===o||!0===o?-1:1:0;var o;t?n>i&&(r=!1):n<i&&(r=!1),i=n})),r}doesMovePassMarryChildren(e){let t=!0;return pt(null,this.columnModel.getColTree(),(i=>{if(!ze(i))return;const r=i,n=r.getColGroupDef();if(!(n&&n.marryChildren))return;const o=[];r.getLeafColumns().forEach((t=>{const i=e.indexOf(t);o.push(i)}));Math.max.apply(Math,o)-Math.min.apply(Math,o)>r.getLeafColumns().length-1&&(t=!1)})),t}placeLockedColumns(e){const t=[],i=[],r=[];e.forEach((e=>{const n=e.getColDef().lockPosition;"right"===n?r.push(e):"left"===n||!0===n?t.push(e):i.push(e)}));return this.gos.get("enableRtl")?[...r,...i,...t]:[...t,...i,...r]}},xt=/[&<>"']/g,Tt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function Ft(e){const t=String.fromCharCode;function i(e,i){return t(e>>i&63|128)}function r(e){if(0==(4294967168&e))return t(e);let r="";return 0==(4294965248&e)?r=t(e>>6&31|192):0==(4294901760&e)?(!function(e){if(e>=55296&&e<=57343)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value")}(e),r=t(e>>12&15|224),r+=i(e,6)):0==(4292870144&e)&&(r=t(e>>18&7|240),r+=i(e,12),r+=i(e,6)),r+=t(63&e|128),r}const n=function(e){const t=[];if(!e)return[];const i=e.length;let r,n,o=0;for(;o<i;)r=e.charCodeAt(o++),r>=55296&&r<=56319&&o<i?(n=e.charCodeAt(o++),56320==(64512&n)?t.push(((1023&r)<<10)+(1023&n)+65536):(t.push(r),o--)):t.push(r);return t}(e),o=n.length;let s,a=-1,l="";for(;++a<o;)s=n[a],l+=r(s);return l}function Pt(e,t){if(null==e)return null;const i=e.toString().toString();return t?i:i.replace(xt,(e=>Tt[e]))}var Dt=class extends He{constructor(){super(...arguments),this.beanName="columnNameService"}wireBeans(e){this.expressionService=e.expressionService,this.funcColsService=e.funcColsService,this.columnModel=e.columnModel}getDisplayNameForColumn(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e)return null;const r=this.getHeaderName(e.getColDef(),e,null,null,t);return i?this.wrapHeaderNameWithAggFunc(e,r):r}getDisplayNameForProvidedColumnGroup(e,t,i){const r=t?t.getColGroupDef():null;return r?this.getHeaderName(r,null,e,t,i):null}getDisplayNameForColumnGroup(e,t){return this.getDisplayNameForProvidedColumnGroup(e,e.getProvidedColumnGroup(),t)}getHeaderName(e,t,i,r,n){const o=e.headerValueGetter;if(o){const s=this.gos.addGridCommonParams({colDef:e,column:t,columnGroup:i,providedColumnGroup:r,location:n});return"function"===typeof o?o(s):"string"===typeof o?this.expressionService.evaluate(o,s):(v("headerValueGetter must be a function or a string"),"")}return null!=e.headerName?e.headerName:e.field?(s=e.field)&&null!=s?s.replace(/([a-z])([A-Z])/g,"$1 $2").replace(/([A-Z]+)([A-Z])([a-z])/g,"$1 $2$3").replace(/\./g," ").split(" ").map((e=>e.substring(0,1).toUpperCase()+(e.length>1?e.substring(1,e.length):""))).join(" "):null:"";var s}wrapHeaderNameWithAggFunc(e,t){if(this.gos.get("suppressAggFuncInHeader"))return t;const i=e.getColDef().pivotValueColumn;let r,n=null;if(F(i)){const o=this.funcColsService.getValueColumns(),s=this.gos.get("removePivotHeaderRowWhenSingleValueColumn")&&1===o.length,a=void 0!==e.getColDef().pivotTotalColumnIds;if(s&&!a)return t;n=i?i.getAggFunc():null,r=!0}else{const t=e.isValueActive(),i=this.columnModel.isPivotMode()||!this.funcColsService.isRowGroupEmpty();t&&i?(n=e.getAggFunc(),r=!0):r=!1}if(r){const e="string"===typeof n?n:"func",i=this.localeService.getLocaleTextFunc()(e,e);return"".concat(i,"(").concat(t,")")}return t}},kt=class extends He{constructor(){super(...arguments),this.beanName="pivotResultColsService"}wireBeans(e){this.context=e.context,this.columnModel=e.columnModel,this.columnFactory=e.columnFactory,this.visibleColsService=e.visibleColsService}destroy(){var e;Ye(this.context,null===(e=this.pivotResultCols)||void 0===e?void 0:e.tree),super.destroy()}isPivotResultColsPresent(){return null!=this.pivotResultCols}lookupPivotResultCol(e,t){if(null==this.pivotResultCols)return null;const i=this.columnModel.getColDefCol(t);let r=null;return this.pivotResultCols.list.forEach((t=>{const n=t.getColDef().pivotKeys,o=t.getColDef().pivotValueColumn;Re(n,e)&&o===i&&(r=t)})),r}getPivotResultCols(){return this.pivotResultCols}getPivotResultCol(e){return this.pivotResultCols?this.columnModel.getColFromCollection(e,this.pivotResultCols):null}setPivotResultCols(e,t){if(this.columnModel.isReady()&&(null!=e||null!=this.pivotResultCols)){if(e){var i,r;this.processPivotResultColDef(e);const n=this.columnFactory.createColumnTree(e,!1,(null===(i=this.pivotResultCols)||void 0===i?void 0:i.tree)||this.previousPivotResultCols||void 0,t);Ye(this.context,null===(r=this.pivotResultCols)||void 0===r?void 0:r.tree,n.columnTree);const o=n.columnTree,s=n.treeDept,a=je(o),l={};this.pivotResultCols={tree:o,treeDepth:s,list:a,map:l},this.pivotResultCols.list.forEach((e=>this.pivotResultCols.map[e.getId()]=e));const c=!!this.previousPivotResultCols;this.previousPivotResultCols=null,this.columnModel.refreshCols(!c)}else this.previousPivotResultCols=this.pivotResultCols?this.pivotResultCols.tree:null,this.pivotResultCols=null,this.columnModel.refreshCols(!1);this.visibleColsService.refresh(t)}}processPivotResultColDef(e){const t=this.gos.get("processPivotResultColDef"),i=this.gos.get("processPivotResultColGroupDef");if(!t&&!i)return;const r=e=>{e.forEach((e=>{if(F(e.children)){const t=e;i&&i(t),r(t.children)}else{t&&t(e)}}))};e&&r(e)}},At=class extends He{constructor(){super(...arguments),this.beanName="columnSizeService"}wireBeans(e){this.columnModel=e.columnModel,this.columnViewportService=e.columnViewportService,this.eventDispatcher=e.columnEventDispatcher,this.visibleColsService=e.visibleColsService,this.ctrlsService=e.ctrlsService}setColumnWidths(e,t,i,r){const n=[];e.forEach((e=>{const i=this.columnModel.getColDefCol(e.key)||this.columnModel.getCol(e.key);if(!i)return;n.push({width:e.newWidth,ratios:[1],columns:[i]});if("shift"===this.gos.get("colResizeDefault")&&(t=!t),t){const t=this.visibleColsService.getColAfter(i);if(!t)return;const r=i.getActualWidth()-e.newWidth,o=t.getActualWidth()+r;n.push({width:o,ratios:[1],columns:[t]})}})),0!==n.length&&this.resizeColumnSets({resizeSets:n,finished:i,source:r})}resizeColumnSets(e){const{resizeSets:t,finished:i,source:r}=e;if(!(!t||t.every((e=>this.checkMinAndMaxWidthsForSet(e))))){if(i){const e=t&&t.length>0?t[0].columns:null;this.eventDispatcher.columnResized(e,i,r)}return}const n=[],o=[];t.forEach((e=>{const{width:t,columns:i,ratios:s}=e,a={},l={};i.forEach((e=>o.push(e)));let c=!0,u=0;for(;c;){if(u++,u>1e3){C("infinite loop in resizeColumnSets");break}c=!1;const e=[];let r=0,n=t;i.forEach(((t,i)=>{if(l[t.getId()])n-=a[t.getId()];else{e.push(t);const n=s[i];r+=n}}));const o=1/r;e.forEach(((i,r)=>{let u;r===e.length-1?u=n:(u=Math.round(s[r]*t*o),n-=u);const d=i.getMinWidth(),h=i.getMaxWidth();u<d?(u=d,l[i.getId()]=!0,c=!0):h>0&&u>h&&(u=h,l[i.getId()]=!0,c=!0),a[i.getId()]=u}))}i.forEach((e=>{const t=a[e.getId()];e.getActualWidth()!==t&&(e.setActualWidth(t,r),n.push(e))}))}));const s=n.length>0;let a=[];s&&(a=this.refreshFlexedColumns({resizingCols:o,skipSetLeft:!0}),this.visibleColsService.setLeftValues(r),this.visibleColsService.updateBodyWidths(),this.columnViewportService.checkViewportColumns());const l=o.concat(a);(s||i)&&this.eventDispatcher.columnResized(l,i,r,a)}checkMinAndMaxWidthsForSet(e){const{columns:t,width:i}=e;let r=0,n=0,o=!0;t.forEach((e=>{const t=e.getMinWidth();r+=t||0;const i=e.getMaxWidth();i>0?n+=i:o=!1}));return i>=r&&(!o||i<=n)}refreshFlexedColumns(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=e.source?e.source:"flex";if(null!=e.viewportWidth&&(this.flexViewportWidth=e.viewportWidth),!this.flexViewportWidth)return[];const i=this.visibleColsService.getCenterCols();let r=-1;if(e.resizingCols){const t=new Set(e.resizingCols);for(let e=i.length-1;e>=0;e--)if(t.has(i[e])){r=e;break}}let n=0,o=[],s=0,a=0;for(let h=0;h<i.length;h++){i[h].getFlex()&&h>r?(o.push(i[h]),a+=i[h].getFlex(),s+=i[h].getMinWidth()):n+=i[h].getActualWidth()}if(!o.length)return[];let l=[];n+s>this.flexViewportWidth&&(o.forEach((e=>e.setActualWidth(e.getMinWidth(),t))),l=o,o=[]);const c=[];let u;e:for(;;){u=this.flexViewportWidth-n;const e=u/a;for(let i=0;i<o.length;i++){const r=o[i],s=e*r.getFlex();let u=0;const d=r.getMinWidth(),h=r.getMaxWidth();if(s<d?u=d:s>h&&(u=h),u){r.setActualWidth(u,t),Ee(o,r),a-=r.getFlex(),l.push(r),n+=r.getActualWidth();continue e}c[i]=Math.floor(s)}break}let d=u;return o.forEach(((e,i)=>{const r=i<o.length-1?Math.min(c[i],d):Math.max(c[i],d);e.setActualWidth(r,t),l.push(e),d-=c[i]})),e.skipSetLeft||this.visibleColsService.setLeftValues(t),e.updateBodyWidths&&this.visibleColsService.updateBodyWidths(),e.fireResizedEvent&&this.eventDispatcher.columnResized(l,!0,t,o),o}sizeColumnsToFit(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"sizeColumnsToFit",i=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(this.columnModel.isShouldQueueResizeOperations())return void this.columnModel.pushResizeOperation((()=>this.sizeColumnsToFit(e,t,i,r)));const n={};var o;r&&(null===r||void 0===r||null===(o=r.columnLimits)||void 0===o||o.forEach((e=>{let{key:t}=e,i=u(e,d);n["string"===typeof t?t:t.getColId()]=i})));const s=this.visibleColsService.getAllCols(),a=e===Ke(s);if(e<=0||!s.length||a)return;const l=[],c=[];s.forEach((e=>{!0===e.getColDef().suppressSizeToFit?c.push(e):l.push(e)}));const h=l.slice(0);let g=!1;const p=e=>{xe(l,e),c.push(e)};for(l.forEach((e=>{var i,o;e.resetActualWidth(t);const s=null===n||void 0===n?void 0:n[e.getId()],a=null!==(i=null===s||void 0===s?void 0:s.minWidth)&&void 0!==i?i:null===r||void 0===r?void 0:r.defaultMinWidth,l=null!==(o=null===s||void 0===s?void 0:s.maxWidth)&&void 0!==o?o:null===r||void 0===r?void 0:r.defaultMaxWidth,c=e.getActualWidth();"number"===typeof a&&c<a?e.setActualWidth(a,t,!0):"number"===typeof l&&c>l&&e.setActualWidth(l,t,!0)}));!g;){g=!0;const i=e-Ke(c);if(i<=0)l.forEach((e=>{var i,o;const s=null!==(i=null===n||void 0===n||null===(o=n[e.getId()])||void 0===o?void 0:o.minWidth)&&void 0!==i?i:null===r||void 0===r?void 0:r.defaultMinWidth;"number"!==typeof s?e.setMinimum(t):e.setActualWidth(s,t,!0)}));else{const e=i/Ke(l);let o=i;for(let i=l.length-1;i>=0;i--){var f,m;const s=l[i],a=null===n||void 0===n?void 0:n[s.getId()],c=null!==(f=null===a||void 0===a?void 0:a.minWidth)&&void 0!==f?f:null===r||void 0===r?void 0:r.defaultMinWidth,u=null!==(m=null===a||void 0===a?void 0:a.maxWidth)&&void 0!==m?m:null===r||void 0===r?void 0:r.defaultMaxWidth,d=s.getMinWidth(),h=s.getMaxWidth(),v="number"===typeof c&&c>d?c:d,C="number"===typeof u&&u<h?u:h;let w=Math.round(s.getActualWidth()*e);w<v?(w=v,p(s),g=!1):w>C?(w=C,p(s),g=!1):0===i&&(w=o),s.setActualWidth(w,t,!0),o-=w}}}h.forEach((e=>{e.fireColumnWidthChangedEvent(t)})),this.visibleColsService.setLeftValues(t),this.visibleColsService.updateBodyWidths(),i||this.eventDispatcher.columnResized(h,!0,t)}applyAutosizeStrategy(){const e=this.gos.get("autoSizeStrategy");if(!e)return;const{type:t}=e;setTimeout((()=>{if("fitGridWidth"===t){const{columnLimits:t,defaultMinWidth:i,defaultMaxWidth:r}=e,n=null===t||void 0===t?void 0:t.map((e=>{let{colId:t,minWidth:i,maxWidth:r}=e;return{key:t,minWidth:i,maxWidth:r}}));this.ctrlsService.getGridBodyCtrl().sizeColumnsToFit({defaultMinWidth:i,defaultMaxWidth:r,columnLimits:n})}else"fitProvidedWidth"===t&&this.sizeColumnsToFit(e.width,"sizeColumnsToFit")}))}};function Mt(e,t){return e+"_"+t}function It(e){return e instanceof Lt}var Lt=class extends He{constructor(e,t,i,r){super(),this.isColumn=!1,this.displayedChildren=[],this.autoHeaderHeight=null,this.parent=null,this.groupId=t,this.partId=i,this.providedColumnGroup=e,this.pinned=r}reset(){this.parent=null,this.children=null,this.displayedChildren=null}getParent(){return this.parent}setParent(e){this.parent=e}getUniqueId(){return Mt(this.groupId,this.partId)}isEmptyGroup(){return 0===this.displayedChildren.length}isMoving(){const e=this.getProvidedColumnGroup().getLeafColumns();return!(!e||0===e.length)&&e.every((e=>e.isMoving()))}checkLeft(){if(this.displayedChildren.forEach((e=>{It(e)&&e.checkLeft()})),this.displayedChildren.length>0)if(this.gos.get("enableRtl")){const e=ye(this.displayedChildren).getLeft();this.setLeft(e)}else{const e=this.displayedChildren[0].getLeft();this.setLeft(e)}else this.setLeft(null)}getLeft(){return this.left}getOldLeft(){return this.oldLeft}setLeft(e){this.oldLeft=this.left,this.left!==e&&(this.left=e,this.dispatchLocalEvent({type:"leftChanged"}))}getPinned(){return this.pinned}getGroupId(){return this.groupId}getPartId(){return this.partId}getActualWidth(){let e=0;return this.displayedChildren&&this.displayedChildren.forEach((t=>{e+=t.getActualWidth()})),e}isResizable(){if(!this.displayedChildren)return!1;let e=!1;return this.displayedChildren.forEach((t=>{t.isResizable()&&(e=!0)})),e}getMinWidth(){let e=0;return this.displayedChildren.forEach((t=>{e+=t.getMinWidth()})),e}addChild(e){this.children||(this.children=[]),this.children.push(e)}getDisplayedChildren(){return this.displayedChildren}getLeafColumns(){const e=[];return this.addLeafColumns(e),e}getDisplayedLeafColumns(){const e=[];return this.addDisplayedLeafColumns(e),e}getDefinition(){return this.providedColumnGroup.getColGroupDef()}getColGroupDef(){return this.providedColumnGroup.getColGroupDef()}isPadding(){return this.providedColumnGroup.isPadding()}isExpandable(){return this.providedColumnGroup.isExpandable()}isExpanded(){return this.providedColumnGroup.isExpanded()}setExpanded(e){this.providedColumnGroup.setExpanded(e)}isAutoHeaderHeight(){var e;return!(null===(e=this.getColGroupDef())||void 0===e||!e.autoHeaderHeight)}getAutoHeaderHeight(){return this.autoHeaderHeight}setAutoHeaderHeight(e){const t=e!==this.autoHeaderHeight;return this.autoHeaderHeight=e,t}addDisplayedLeafColumns(e){this.displayedChildren.forEach((t=>{ct(t)?e.push(t):It(t)&&t.addDisplayedLeafColumns(e)}))}addLeafColumns(e){this.children.forEach((t=>{ct(t)?e.push(t):It(t)&&t.addLeafColumns(e)}))}getChildren(){return this.children}getColumnGroupShow(){return this.providedColumnGroup.getColumnGroupShow()}getProvidedColumnGroup(){return this.providedColumnGroup}getPaddingLevel(){const e=this.getParent();return this.isPadding()&&e&&e.isPadding()?1+e.getPaddingLevel():0}calculateDisplayedColumns(){this.displayedChildren=[];let e=this;for(;null!=e&&e.isPadding();)e=e.getParent();if(!(!!e&&e.getProvidedColumnGroup().isExpandable()))return this.displayedChildren=this.children,void this.dispatchLocalEvent({type:"displayedChildrenChanged"});this.children.forEach((t=>{if(It(t)&&(!t.displayedChildren||!t.displayedChildren.length))return;switch(t.getColumnGroupShow()){case"open":e.getProvidedColumnGroup().isExpanded()&&this.displayedChildren.push(t);break;case"closed":e.getProvidedColumnGroup().isExpanded()||this.displayedChildren.push(t);break;default:this.displayedChildren.push(t)}})),this.dispatchLocalEvent({type:"displayedChildrenChanged"})}},Ot=class{constructor(){this.existingIds={}}getInstanceIdForKey(e){const t=this.existingIds[e];let i;return i="number"!==typeof t?0:t+1,this.existingIds[e]=i,i}},Nt=class extends He{constructor(){super(...arguments),this.beanName="visibleColsService",this.colsAndGroupsMap={},this.columnsLeft=[],this.columnsRight=[],this.columnsCenter=[],this.columns=[],this.bodyWidth=0,this.leftWidth=0,this.rightWidth=0,this.bodyWidthDirty=!0}wireBeans(e){this.columnModel=e.columnModel,this.columnSizeService=e.columnSizeService,this.columnViewportService=e.columnViewportService,this.eventDispatcher=e.columnEventDispatcher}refresh(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]||this.buildTrees(),this.updateOpenClosedVisibilityInColumnGroups(),this.columnsLeft=Gt(this.treeLeft),this.columnsCenter=Gt(this.treeCenter),this.columnsRight=Gt(this.treeRight),this.joinColsAriaOrder(),this.joinCols(),this.setLeftValues(e),this.autoHeightCols=this.columns.filter((e=>e.isAutoHeight())),this.columnSizeService.refreshFlexedColumns(),this.updateBodyWidths(),this.columnViewportService.checkViewportColumns(!1),this.setFirstRightAndLastLeftPinned(e),this.eventDispatcher.visibleCols(e)}updateBodyWidths(){const e=Ke(this.columnsCenter),t=Ke(this.columnsLeft),i=Ke(this.columnsRight);this.bodyWidthDirty=this.bodyWidth!==e;(this.bodyWidth!==e||this.leftWidth!==t||this.rightWidth!==i)&&(this.bodyWidth=e,this.leftWidth=t,this.rightWidth=i,this.eventService.dispatchEvent({type:"columnContainerWidthChanged"}),this.eventService.dispatchEvent({type:"displayedColumnsWidthChanged"}))}setLeftValues(e){this.setLeftValuesOfCols(e),this.setLeftValuesOfGroups()}setFirstRightAndLastLeftPinned(e){let t,i;this.gos.get("enableRtl")?(t=this.columnsLeft?this.columnsLeft[0]:null,i=this.columnsRight?ye(this.columnsRight):null):(t=this.columnsLeft?ye(this.columnsLeft):null,i=this.columnsRight?this.columnsRight[0]:null),this.columnModel.getCols().forEach((r=>{r.setLastLeftPinned(r===t,e),r.setFirstRightPinned(r===i,e)}))}buildTrees(){const e=this.columnModel.getColsToShow(),t=e.filter((e=>"left"==e.getPinned())),i=e.filter((e=>"right"==e.getPinned())),r=e.filter((e=>"left"!=e.getPinned()&&"right"!=e.getPinned())),n=new Ot;this.treeLeft=this.createGroups({columns:t,idCreator:n,pinned:"left",oldDisplayedGroups:this.treeLeft}),this.treeRight=this.createGroups({columns:i,idCreator:n,pinned:"right",oldDisplayedGroups:this.treeRight}),this.treeCenter=this.createGroups({columns:r,idCreator:n,pinned:null,oldDisplayedGroups:this.treeCenter}),this.updateColsAndGroupsMap()}clear(){this.columnsLeft=[],this.columnsRight=[],this.columnsCenter=[],this.columns=[],this.ariaOrderColumns=[]}joinColsAriaOrder(){const e=this.columnModel.getCols(),t=[],i=[],r=[];for(const n of e){const e=n.getPinned();e?!0===e||"left"===e?t.push(n):r.push(n):i.push(n)}this.ariaOrderColumns=t.concat(i).concat(r)}getAriaColIndex(e){let t;return t=It(e)?e.getLeafColumns()[0]:e,this.ariaOrderColumns.indexOf(t)+1}getAllAutoHeightCols(){return this.autoHeightCols}setLeftValuesOfGroups(){[this.treeLeft,this.treeRight,this.treeCenter].forEach((e=>{e.forEach((e=>{if(It(e)){e.checkLeft()}}))}))}setLeftValuesOfCols(e){if(!this.columnModel.getColDefCols())return;const t=this.columnModel.getCols().slice(0),i=this.gos.get("enableRtl");[this.columnsLeft,this.columnsRight,this.columnsCenter].forEach((r=>{if(i){let t=Ke(r);r.forEach((i=>{t-=i.getActualWidth(),i.setLeft(t,e)}))}else{let t=0;r.forEach((i=>{i.setLeft(t,e),t+=i.getActualWidth()}))}!function(e,t){for(let i=0;i<t.length;i++)Ee(e,t[i])}(t,r)})),t.forEach((t=>{t.setLeft(null,e)}))}joinCols(){this.gos.get("enableRtl")?this.columns=this.columnsRight.concat(this.columnsCenter).concat(this.columnsLeft):this.columns=this.columnsLeft.concat(this.columnsCenter).concat(this.columnsRight)}getColsCenter(){return this.columnsCenter}getAllTrees(){return this.treeLeft&&this.treeRight&&this.treeCenter?this.treeLeft.concat(this.treeCenter).concat(this.treeRight):null}getTreeLeft(){return this.treeLeft}getTreeRight(){return this.treeRight}getTreeCenter(){return this.treeCenter}getAllCols(){return this.columns}isColDisplayed(e){return this.getAllCols().indexOf(e)>=0}getLeftColsForRow(e){return this.columnModel.isColSpanActive()?this.getColsForRow(e,this.columnsLeft):this.columnsLeft}getRightColsForRow(e){return this.columnModel.isColSpanActive()?this.getColsForRow(e,this.columnsRight):this.columnsRight}getColsForRow(e,t,i,r){const n=[];let o=null;for(let s=0;s<t.length;s++){const a=t[s],l=t.length-s,c=Math.min(a.getColSpan(e),l),u=[a];if(c>1){const e=c-1;for(let i=1;i<=e;i++)u.push(t[s+i]);s+=e}let d;if(i?(d=!1,u.forEach((e=>{i(e)&&(d=!0)}))):d=!0,d){if(0===n.length&&o){!!r&&r(a)&&n.push(o)}n.push(a)}o=a}return n}getBodyContainerWidth(){return this.bodyWidth}getContainerWidth(e){switch(e){case"left":return this.leftWidth;case"right":return this.rightWidth;default:return this.bodyWidth}}getCenterCols(){return this.columnsCenter}getLeftCols(){return this.columnsLeft}getRightCols(){return this.columnsRight}getColBefore(e){const t=this.getAllCols(),i=t.indexOf(e);return i>0?t[i-1]:null}getGroupAtDirection(e,t){const i=e.getProvidedColumnGroup().getLevel()+e.getPaddingLevel(),r=e.getDisplayedLeafColumns(),n="After"===t?ye(r):r[0],o="getCol".concat(t);for(;;){const t=this[o](n);if(!t)return null;const r=this.getColGroupAtLevel(t,i);if(r!==e)return r}}getColGroupAtLevel(e,t){let i,r,n=e.getParent();for(;;){if(i=n.getProvidedColumnGroup().getLevel(),r=n.getPaddingLevel(),i+r<=t)break;n=n.getParent()}return n}isPinningLeft(){return this.columnsLeft.length>0}isPinningRight(){return this.columnsRight.length>0}updateColsAndGroupsMap(){this.colsAndGroupsMap={};const e=e=>{this.colsAndGroupsMap[e.getUniqueId()]=e};Bt(this.treeCenter,!1,e),Bt(this.treeLeft,!1,e),Bt(this.treeRight,!1,e)}isVisible(e){return this.colsAndGroupsMap[e.getUniqueId()]===e}updateOpenClosedVisibilityInColumnGroups(){Bt(this.getAllTrees(),!1,(e=>{It(e)&&e.calculateDisplayedColumns()}))}getFirstColumn(){const e=this.gos.get("enableRtl"),t=["getLeftCols","getCenterCols","getRightCols"];e&&t.reverse();for(let i=0;i<t.length;i++){const r=this[t[i]]();if(r.length)return e?ye(r):r[0]}return null}getColumnGroup(e,t){if(!e)return null;if(It(e))return e;const i=this.getAllTrees(),r="number"===typeof t;let n=null;return Bt(i,!1,(i=>{if(It(i)){const o=i;let s;s=r?e===o.getGroupId()&&t===o.getPartId():e===o.getGroupId(),s&&(n=o)}})),n}getColAfter(e){const t=this.getAllCols(),i=t.indexOf(e);return i<t.length-1?t[i+1]:null}isBodyWidthDirty(){return this.bodyWidthDirty}setBodyWidthDirty(){this.bodyWidthDirty=!0}getColsLeftWidth(){return Ke(this.columnsLeft)}getDisplayedColumnsRightWidth(){return Ke(this.columnsRight)}isColAtEdge(e,t){const i=this.getAllCols();if(!i.length)return!1;const r="first"===t;let n;if(It(e)){const t=e.getDisplayedLeafColumns();if(!t.length)return!1;n=r?t[0]:ye(t)}else n=e;return(r?i[0]:ye(i))===n}createGroups(e){const{columns:t,idCreator:i,pinned:r,oldDisplayedGroups:n,isStandaloneStructure:o}=e,s=this.mapOldGroupsById(n),a=[];let l=t;for(;l.length;){const e=l;l=[];let t=0;const n=n=>{const c=t;t=n;const u=e[c],d=(It(u)?u.getProvidedColumnGroup():u).getOriginalParent();if(null==d){for(let t=c;t<n;t++)a.push(e[t]);return}const h=this.createColGroup(d,i,s,r,o);for(let t=c;t<n;t++)h.addChild(e[t]);l.push(h)};for(let i=1;i<e.length;i++){const r=e[i],o=(It(r)?r.getProvidedColumnGroup():r).getOriginalParent(),s=e[t];o!==(It(s)?s.getProvidedColumnGroup():s).getOriginalParent()&&n(i)}t<e.length&&n(e.length)}return o||this.setupParentsIntoCols(a,null),a}createColGroup(e,t,i,r,n){const o=e.getGroupId(),s=t.getInstanceIdForKey(o);let a=i[Mt(o,s)];return a&&a.getProvidedColumnGroup()!==e&&(a=null),F(a)?a.reset():(a=new Lt(e,o,s,r),n||this.createBean(a)),a}mapOldGroupsById(e){const t={},i=e=>{e.forEach((e=>{if(It(e)){const r=e;t[e.getUniqueId()]=r,i(r.getChildren())}}))};return e&&i(e),t}setupParentsIntoCols(e,t){e.forEach((e=>{if(e.setParent(t),It(e)){const t=e;this.setupParentsIntoCols(t.getChildren(),t)}}))}};function Bt(e,t,i){if(e)for(let r=0;r<e.length;r++){const n=e[r];if(It(n)){Bt(t?n.getDisplayedChildren():n.getChildren(),t,i)}i(n)}}function Gt(e){const t=[];return Bt(e,!0,(e=>{ct(e)&&t.push(e)})),t}var Ht=["columnEverythingChanged","newColumnsLoaded","columnPivotModeChanged","pivotMaxColumnsExceeded","columnRowGroupChanged","expandOrCollapseAll","columnPivotChanged","gridColumnsChanged","columnValueChanged","columnMoved","columnVisible","columnPinned","columnGroupOpened","columnResized","displayedColumnsChanged","virtualColumnsChanged","columnHeaderMouseOver","columnHeaderMouseLeave","columnHeaderClicked","columnHeaderContextMenu","asyncTransactionsFlushed","rowGroupOpened","rowDataUpdated","pinnedRowDataChanged","rangeSelectionChanged","cellSelectionChanged","chartCreated","chartRangeSelectionChanged","chartOptionsChanged","chartDestroyed","toolPanelVisibleChanged","toolPanelSizeChanged","modelUpdated","cutStart","cutEnd","pasteStart","pasteEnd","fillStart","fillEnd","cellSelectionDeleteStart","cellSelectionDeleteEnd","rangeDeleteStart","rangeDeleteEnd","undoStarted","undoEnded","redoStarted","redoEnded","cellClicked","cellDoubleClicked","cellMouseDown","cellContextMenu","cellValueChanged","cellEditRequest","rowValueChanged","headerFocused","cellFocused","rowSelected","selectionChanged","tooltipShow","tooltipHide","cellKeyDown","cellMouseOver","cellMouseOut","filterChanged","filterModified","filterOpened","advancedFilterBuilderVisibleChanged","sortChanged","virtualRowRemoved","rowClicked","rowDoubleClicked","gridReady","gridPreDestroyed","gridSizeChanged","viewportChanged","firstDataRendered","dragStarted","dragStopped","dragCancelled","rowEditingStarted","rowEditingStopped","cellEditingStarted","cellEditingStopped","bodyScroll","bodyScrollEnd","paginationChanged","componentStateChanged","storeRefreshed","stateUpdated","columnMenuVisibleChanged","contextMenuVisibleChanged","rowDragEnter","rowDragMove","rowDragLeave","rowDragEnd","rowDragCancel"],zt=[...Ht,"scrollbarWidthChanged","keyShortcutChangedCellStart","keyShortcutChangedCellEnd","pinnedHeightChanged","cellFocusCleared","fullWidthRowFocused","checkboxChanged","heightScaleChanged","suppressMovableColumns","suppressMenuHide","suppressFieldDotNotation","columnPanelItemDragStart","columnPanelItemDragEnd","bodyHeightChanged","columnContainerWidthChanged","displayedColumnsWidthChanged","scrollVisibilityChanged","scrollGapChanged","columnHoverChanged","flashCells","paginationPixelOffsetChanged","displayedRowsChanged","leftPinnedWidthChanged","rightPinnedWidthChanged","rowContainerHeightChanged","headerHeightChanged","columnGroupHeaderHeightChanged","columnHeaderHeightChanged","gridStylesChanged","storeUpdated","filterDestroyed","rowDataUpdateStarted","rowCountReady","advancedFilterEnabledChanged","dataTypesInferred","fieldValueChanged","fieldPickerValueSelected","richSelectListRowSelected","sideBarUpdated","alignedGridScroll","alignedGridColumn","gridOptionsChanged","chartTitleEdit","recalculateRowBounds","stickyTopOffsetChanged","overlayExclusiveChanged"],Vt={enableBrowserTooltips:!0,tooltipTrigger:!0,tooltipMouseTrack:!0,tooltipShowMode:!0,tooltipInteraction:!0,defaultColGroupDef:!0,suppressAutoSize:!0,skipHeaderOnAutoSize:!0,autoSizeStrategy:!0,components:!0,stopEditingWhenCellsLoseFocus:!0,undoRedoCellEditing:!0,undoRedoCellEditingLimit:!0,excelStyles:!0,cacheQuickFilter:!0,advancedFilterModel:!0,customChartThemes:!0,chartThemeOverrides:!0,chartToolPanelsDef:!0,loadingCellRendererSelector:!0,localeText:!0,keepDetailRows:!0,keepDetailRowsCount:!0,detailRowHeight:!0,detailRowAutoHeight:!0,tabIndex:!0,valueCache:!0,valueCacheNeverExpires:!0,enableCellExpressions:!0,suppressTouch:!0,suppressAsyncEvents:!0,suppressBrowserResizeObserver:!0,suppressPropertyNamesCheck:!0,debug:!0,dragAndDropImageComponent:!0,loadingOverlayComponent:!0,suppressLoadingOverlay:!0,noRowsOverlayComponent:!0,paginationPageSizeSelector:!0,paginateChildRows:!0,pivotPanelShow:!0,pivotSuppressAutoColumn:!0,suppressExpandablePivotGroups:!0,aggFuncs:!0,suppressAggFuncInHeader:!0,allowShowChangeAfterFilter:!0,ensureDomOrder:!0,enableRtl:!0,suppressColumnVirtualisation:!0,suppressMaxRenderedRowRestriction:!0,suppressRowVirtualisation:!0,rowDragText:!0,suppressGroupMaintainValueType:!0,groupLockGroupColumns:!0,rowGroupPanelSuppressSort:!0,suppressGroupRowsSticky:!0,rowModelType:!0,cacheOverflowSize:!0,infiniteInitialRowCount:!0,serverSideInitialRowCount:!0,suppressServerSideInfiniteScroll:!0,maxBlocksInCache:!0,maxConcurrentDatasourceRequests:!0,blockLoadDebounceMillis:!0,serverSideOnlyRefreshFilteredGroups:!0,serverSidePivotResultFieldSeparator:!0,viewportRowModelPageSize:!0,viewportRowModelBufferSize:!0,debounceVerticalScrollbar:!0,suppressAnimationFrame:!0,suppressPreventDefaultOnMouseWheel:!0,scrollbarWidth:!0,icons:!0,suppressRowTransform:!0,gridId:!0,enableGroupEdit:!0,initialState:!0,processUnpinnedColumns:!0,createChartContainer:!0,getLocaleText:!0,getRowId:!0,reactiveCustomComponents:!0,columnMenu:!0,suppressSetFilterByDefault:!0},_t=class{};_t.STRING_PROPERTIES=["overlayLoadingTemplate","overlayNoRowsTemplate","gridId","quickFilterText","rowModelType","editType","domLayout","clipboardDelimiter","rowGroupPanelShow","multiSortKey","pivotColumnGroupTotals","pivotRowTotals","pivotPanelShow","fillHandleDirection","groupDisplayType","treeDataDisplayType","colResizeDefault","tooltipTrigger","serverSidePivotResultFieldSeparator","columnMenu","tooltipShowMode","grandTotalRow"],_t.OBJECT_PROPERTIES=["components","rowStyle","context","autoGroupColumnDef","localeText","icons","datasource","dragAndDropImageComponentParams","serverSideDatasource","viewportDatasource","groupRowRendererParams","aggFuncs","fullWidthCellRendererParams","defaultColGroupDef","defaultColDef","defaultCsvExportParams","defaultExcelExportParams","columnTypes","rowClassRules","detailCellRendererParams","loadingCellRendererParams","loadingOverlayComponentParams","noRowsOverlayComponentParams","popupParent","statusBar","sideBar","theme","chartThemeOverrides","customChartThemes","chartToolPanelsDef","dataTypeDefinitions","advancedFilterModel","advancedFilterParent","advancedFilterBuilderParams","initialState","autoSizeStrategy","cellSelection","selectionColumnDef"],_t.ARRAY_PROPERTIES=["sortingOrder","alignedGrids","rowData","columnDefs","excelStyles","pinnedTopRowData","pinnedBottomRowData","chartThemes","rowClass","paginationPageSizeSelector"],_t.NUMBER_PROPERTIES=["rowHeight","detailRowHeight","rowBuffer","headerHeight","groupHeaderHeight","groupLockGroupColumns","floatingFiltersHeight","pivotHeaderHeight","pivotGroupHeaderHeight","groupDefaultExpanded","pivotDefaultExpanded","viewportRowModelPageSize","viewportRowModelBufferSize","autoSizePadding","maxBlocksInCache","maxConcurrentDatasourceRequests","tooltipShowDelay","tooltipHideDelay","cacheOverflowSize","paginationPageSize","cacheBlockSize","infiniteInitialRowCount","serverSideInitialRowCount","scrollbarWidth","asyncTransactionWaitMillis","blockLoadDebounceMillis","keepDetailRowsCount","undoRedoCellEditingLimit","cellFlashDelay","cellFadeDelay","cellFlashDuration","cellFadeDuration","tabIndex","pivotMaxGeneratedColumns"],_t.BOOLEAN_PROPERTIES=["suppressMakeColumnVisibleAfterUnGroup","suppressRowClickSelection","suppressCellFocus","suppressHeaderFocus","suppressHorizontalScroll","groupSelectsChildren","alwaysShowHorizontalScroll","alwaysShowVerticalScroll","debug","enableBrowserTooltips","enableCellExpressions","groupIncludeTotalFooter","groupSuppressBlankHeader","suppressMenuHide","suppressRowDeselection","unSortIcon","suppressMultiSort","alwaysMultiSort","singleClickEdit","suppressLoadingOverlay","suppressNoRowsOverlay","suppressAutoSize","skipHeaderOnAutoSize","suppressColumnMoveAnimation","suppressMoveWhenColumnDragging","suppressMovableColumns","suppressFieldDotNotation","enableRangeSelection","enableRangeHandle","enableFillHandle","suppressClearOnFillReduction","deltaSort","suppressTouch","suppressAsyncEvents","allowContextMenuWithControlKey","suppressContextMenu","enableCellChangeFlash","suppressDragLeaveHidesColumns","suppressRowGroupHidesColumns","suppressMiddleClickScrolls","suppressPreventDefaultOnMouseWheel","suppressCopyRowsToClipboard","copyHeadersToClipboard","copyGroupHeadersToClipboard","pivotMode","suppressAggFuncInHeader","suppressColumnVirtualisation","alwaysAggregateAtRootLevel","suppressFocusAfterRefresh","functionsReadOnly","animateRows","groupSelectsFiltered","groupRemoveSingleChildren","groupRemoveLowestSingleChildren","enableRtl","suppressClickEdit","rowDragEntireRow","rowDragManaged","suppressRowDrag","suppressMoveWhenRowDragging","rowDragMultiRow","enableGroupEdit","embedFullWidthRows","suppressPaginationPanel","groupHideOpenParents","groupAllowUnbalanced","pagination","paginationAutoPageSize","suppressScrollOnNewData","suppressScrollWhenPopupsAreOpen","purgeClosedRowNodes","cacheQuickFilter","includeHiddenColumnsInQuickFilter","ensureDomOrder","accentedSort","suppressChangeDetection","valueCache","valueCacheNeverExpires","aggregateOnlyChangedColumns","suppressAnimationFrame","suppressExcelExport","suppressCsvExport","includeHiddenColumnsInAdvancedFilter","suppressMultiRangeSelection","enterNavigatesVerticallyAfterEdit","enterNavigatesVertically","suppressPropertyNamesCheck","rowMultiSelectWithClick","suppressRowHoverHighlight","suppressRowTransform","suppressClipboardPaste","suppressLastEmptyLineOnPaste","enableCharts","suppressMaintainUnsortedOrder","enableCellTextSelection","suppressBrowserResizeObserver","suppressMaxRenderedRowRestriction","excludeChildrenWhenTreeDataFiltering","tooltipMouseTrack","tooltipInteraction","keepDetailRows","paginateChildRows","preventDefaultOnContextMenu","undoRedoCellEditing","allowDragFromColumnsToolPanel","pivotSuppressAutoColumn","suppressExpandablePivotGroups","debounceVerticalScrollbar","detailRowAutoHeight","serverSideSortAllLevels","serverSideEnableClientSideSort","serverSideOnlyRefreshFilteredGroups","serverSideSortOnServer","serverSideFilterOnServer","suppressAggFilteredOnly","showOpenedGroup","suppressClipboardApi","suppressModelUpdateAfterUpdateTransaction","stopEditingWhenCellsLoseFocus","groupMaintainOrder","columnHoverHighlight","readOnlyEdit","suppressRowVirtualisation","enableCellEditingOnBackspace","resetRowDataOnUpdate","removePivotHeaderRowWhenSingleValueColumn","suppressCopySingleCellRanges","suppressGroupRowsSticky","suppressCutToClipboard","suppressServerSideInfiniteScroll","rowGroupPanelSuppressSort","allowShowChangeAfterFilter","enableAdvancedFilter","masterDetail","treeData","suppressGroupMaintainValueType","reactiveCustomComponents","applyQuickFilterBeforePivotOrAgg","suppressServerSideFullWidthLoadingRow","suppressAdvancedFilterEval","loading","maintainColumnOrder","enableStrictPivotColumnOrder","suppressSetFilterByDefault"],_t.OTHER_PROPERTIES=["suppressStickyTotalRow","loadThemeGoogleFonts","rowSelection"],_t.FUNCTION_PROPERTIES=["doesExternalFilterPass","processPivotResultColDef","processPivotResultColGroupDef","getBusinessKeyForNode","isRowSelectable","rowDragText","groupRowRenderer","dragAndDropImageComponent","fullWidthCellRenderer","loadingCellRenderer","loadingOverlayComponent","noRowsOverlayComponent","detailCellRenderer","quickFilterParser","quickFilterMatcher","getLocaleText","isExternalFilterPresent","getRowHeight","getRowClass","getRowStyle","getContextMenuItems","getMainMenuItems","processRowPostCreate","processCellForClipboard","getGroupRowAgg","isFullWidthRow","sendToClipboard","focusGridInnerElement","navigateToNextHeader","tabToNextHeader","navigateToNextCell","tabToNextCell","processCellFromClipboard","getDocument","postProcessPopup","getChildCount","getDataPath","isRowMaster","postSortRows","processHeaderForClipboard","processUnpinnedColumns","processGroupHeaderForClipboard","paginationNumberFormatter","processDataFromClipboard","getServerSideGroupKey","isServerSideGroup","createChartContainer","getChartToolbarItems","fillOperation","isApplyServerSideTransaction","getServerSideGroupLevelParams","isServerSideGroupOpenByDefault","isGroupOpenByDefault","initialGroupOrderComparator","groupIncludeFooter","loadingCellRendererSelector","getRowId","groupAggFiltering","chartMenuItems","groupTotalRow"],_t.ALL_PROPERTIES=[..._t.ARRAY_PROPERTIES,..._t.OBJECT_PROPERTIES,..._t.STRING_PROPERTIES,..._t.NUMBER_PROPERTIES,..._t.FUNCTION_PROPERTIES,..._t.BOOLEAN_PROPERTIES,..._t.OTHER_PROPERTIES];var Wt=_t,Ut=class{static getCallbackForEvent(e){return!e||e.length<2?e:"on"+e[0].toUpperCase()+e.substring(1)}};Ut.VUE_OMITTED_PROPERTY="AG-VUE-OMITTED-PROPERTY",Ut.PUBLIC_EVENTS=Ht,Ut.EVENT_CALLBACKS=zt.map((e=>Ut.getCallbackForEvent(e))),Ut.BOOLEAN_PROPERTIES=Wt.BOOLEAN_PROPERTIES,Ut.ALL_PROPERTIES=Wt.ALL_PROPERTIES,Ut.ALL_PROPERTIES_AND_CALLBACKS=[...Ut.ALL_PROPERTIES,...Ut.EVENT_CALLBACKS],Ut.ALL_PROPERTIES_AND_CALLBACKS_SET=new Set(Ut.ALL_PROPERTIES_AND_CALLBACKS);var jt=Ut;var Kt=class extends He{};function Yt(e,t,i){return i&&e.addDestroyFunc((()=>t.destroyBean(i))),null!==i&&void 0!==i?i:e}var qt,Qt,$t,Xt,Jt,Zt,ei,ti,ii,ri,ni=class{constructor(e){this.cssClassStates={},this.getGui=e}addCssClass(e){const t=(e||"").split(" ");if(t.length>1)return void t.forEach((e=>this.addCssClass(e)));if(!0!==this.cssClassStates[e]&&e.length){const t=this.getGui();t&&t.classList.add(e),this.cssClassStates[e]=!0}}removeCssClass(e){const t=(e||"").split(" ");if(t.length>1)return void t.forEach((e=>this.removeCssClass(e)));if(!1!==this.cssClassStates[e]&&e.length){const t=this.getGui();t&&t.classList.remove(e),this.cssClassStates[e]=!1}}containsCssClass(e){const t=this.getGui();return!!t&&t.classList.contains(e)}addOrRemoveCssClass(e,t){if(!e)return;if(e.indexOf(" ")>=0){const i=(e||"").split(" ");if(i.length>1)return void i.forEach((e=>this.addOrRemoveCssClass(e,t)))}if(this.cssClassStates[e]!==t&&e.length){const i=this.getGui();i&&i.classList.toggle(e,t),this.cssClassStates[e]=t}}};function oi(e,t,i){null==i||"string"===typeof i&&""==i?ai(e,t):si(e,t,i)}function si(e,t,i){e.setAttribute(li(t),i.toString())}function ai(e,t){e.removeAttribute(li(t))}function li(e){return"aria-".concat(e)}function ci(e,t){t?e.setAttribute("role",t):e.removeAttribute("role")}function ui(e,t){oi(e,"label",t)}function di(e,t){oi(e,"labelledby",t)}function hi(e,t){oi(e,"live",t)}function gi(e,t){oi(e,"hidden",t)}function pi(e,t){si(e,"expanded",t)}function fi(e,t){si(e,"rowcount",t)}function mi(e,t){si(e,"rowindex",t)}function vi(e,t){si(e,"colcount",t)}function Ci(e,t){si(e,"colindex",t)}function wi(e,t){si(e,"sort",t)}function bi(e){ai(e,"sort")}function Si(e,t){oi(e,"selected",t)}function yi(e,t){return void 0===t?e("ariaIndeterminate","indeterminate"):!0===t?e("ariaChecked","checked"):e("ariaUnchecked","unchecked")}function Ri(){return void 0===qt&&(qt=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)),qt}function Ei(){if(void 0===Qt)if(Ri()){const e=navigator.userAgent.match(/version\/(\d+)/i);e&&(Qt=null!=e[1]?parseFloat(e[1]):0)}else Qt=0;return Qt}function xi(){if(void 0===$t){const e=window;$t=!!e.chrome&&(!!e.chrome.webstore||!!e.chrome.runtime)||/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}return $t}function Ti(){return void 0===Xt&&(Xt=/(firefox)/i.test(navigator.userAgent)),Xt}function Fi(){return void 0===Jt&&(Jt=/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)),Jt}function Pi(){return void 0===Zt&&(Zt=/iPad|iPhone|iPod/.test(navigator.platform)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1),Zt}function Di(){return!Ri()||Ei()>=15}function ki(e){if(!e)return null;const t=e.tabIndex,i=e.getAttribute("tabIndex");return-1!==t||null!==i&&(""!==i||Ti())?t.toString():null}function Ai(){const e=document.body,t=document.createElement("div");t.style.width=t.style.height="100px",t.style.opacity="0",t.style.overflow="scroll",t.style.msOverflowStyle="scrollbar",t.style.position="absolute",e.appendChild(t);let i=t.offsetWidth-t.clientWidth;0===i&&0===t.clientWidth&&(i=null),t.parentNode&&t.parentNode.removeChild(t),null!=i&&(ti=i,ei=0===i)}function Mi(){return null==ei&&Ai(),ei}var Ii="[disabled], .ag-disabled:not(.ag-button), .ag-disabled *";function Li(e){const t=Element.prototype.matches||Element.prototype.msMatchesSelector,i=t.call(e,"input, select, button, textarea"),r=t.call(e,Ii),n=$i(e);return i&&!r&&n}function Oi(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{skipAriaHidden:r}=i;e.classList.toggle("ag-hidden",!t),r||gi(e,!t)}function Ni(e,t){const i="disabled",r=t?e=>e.setAttribute(i,""):e=>e.removeAttribute(i);r(e),nr(e.querySelectorAll("input"),(e=>r(e)))}function Bi(e,t,i){let r=0;for(;e;){if(e.classList.contains(t))return!0;if(e=e.parentElement,"number"==typeof i){if(++r>i)break}else if(e===i)break}return!1}function Gi(e){const{height:t,width:i,borderTopWidth:r,borderRightWidth:n,borderBottomWidth:o,borderLeftWidth:s,paddingTop:a,paddingRight:l,paddingBottom:c,paddingLeft:u,marginTop:d,marginRight:h,marginBottom:g,marginLeft:p,boxSizing:f}=window.getComputedStyle(e);return{height:parseFloat(t||"0"),width:parseFloat(i||"0"),borderTopWidth:parseFloat(r||"0"),borderRightWidth:parseFloat(n||"0"),borderBottomWidth:parseFloat(o||"0"),borderLeftWidth:parseFloat(s||"0"),paddingTop:parseFloat(a||"0"),paddingRight:parseFloat(l||"0"),paddingBottom:parseFloat(c||"0"),paddingLeft:parseFloat(u||"0"),marginTop:parseFloat(d||"0"),marginRight:parseFloat(h||"0"),marginBottom:parseFloat(g||"0"),marginLeft:parseFloat(p||"0"),boxSizing:f}}function Hi(e){const t=Gi(e);return"border-box"===t.boxSizing?t.height-t.paddingTop-t.paddingBottom:t.height}function zi(e){const t=Gi(e);return"border-box"===t.boxSizing?t.width-t.paddingLeft-t.paddingRight:t.width}function Vi(e){const{height:t,marginBottom:i,marginTop:r}=Gi(e);return Math.floor(t+i+r)}function _i(e){const{width:t,marginLeft:i,marginRight:r}=Gi(e);return Math.floor(t+i+r)}function Wi(e){const t=e.getBoundingClientRect(),{borderTopWidth:i,borderLeftWidth:r,borderRightWidth:n,borderBottomWidth:o}=Gi(e);return{top:t.top+(i||0),left:t.left+(r||0),right:t.right+(n||0),bottom:t.bottom+(o||0)}}function Ui(){if("boolean"===typeof ri)return ri;const e=document.createElement("div");return e.style.direction="rtl",e.style.width="1px",e.style.height="1px",e.style.position="fixed",e.style.top="0px",e.style.overflow="hidden",e.dir="rtl",e.innerHTML='<div style="width: 2px">\n            <span style="display: inline-block; width: 1px"></span>\n            <span style="display: inline-block; width: 1px"></span>\n        </div>',document.body.appendChild(e),e.scrollLeft=1,ri=0===Math.floor(e.scrollLeft),document.body.removeChild(e),ri}function ji(e,t){let i=e.scrollLeft;return t&&(i=Math.abs(i),xi()&&!Ui()&&(i=e.scrollWidth-e.getBoundingClientRect().width-i)),i}function Ki(e,t,i){i&&(Ui()?t*=-1:(Ri()||xi())&&(t=e.scrollWidth-e.getBoundingClientRect().width-t)),e.scrollLeft=t}function Yi(e){for(;e&&e.firstChild;)e.removeChild(e.firstChild)}function qi(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function Qi(e){return!!e.offsetParent}function $i(e){const t=e;if(t.checkVisibility)return t.checkVisibility({checkVisibilityCSS:!0});return!(!Qi(e)||"visible"!==window.getComputedStyle(e).visibility)}function Xi(e){const t=document.createElement("div");return t.innerHTML=(e||"").trim(),t.firstChild}function Ji(e,t){"flex"===t?(e.style.removeProperty("width"),e.style.removeProperty("minWidth"),e.style.removeProperty("maxWidth"),e.style.flex="1 1 auto"):Zi(e,t)}function Zi(e,t){t=tr(t),e.style.width=t.toString(),e.style.maxWidth=t.toString(),e.style.minWidth=t.toString()}function er(e,t){t=tr(t),e.style.height=t.toString(),e.style.maxHeight=t.toString(),e.style.minHeight=t.toString()}function tr(e){return"number"===typeof e?"".concat(e,"px"):e}function ir(e){return e instanceof Node||e instanceof HTMLElement}function rr(e,t,i){null==i||""===i?e.removeAttribute(t):e.setAttribute(t,i.toString())}function nr(e,t){if(null!=e)for(let i=0;i<e.length;i++)t(e[i])}var or=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.nextValue=e,this.step=t}next(){const e=this.nextValue;return this.nextValue+=this.step,e}peek(){return this.nextValue}skip(e){this.nextValue+=e}},sr=class e extends He{constructor(e,t,i,r){super(),this.parentComp=e,this.tooltipShowDelayOverride=t,this.tooltipHideDelayOverride=i,this.shouldDisplayTooltip=r,this.interactionEnabled=!1,this.isInteractingWithTooltip=!1,this.state=0,this.tooltipInstanceCount=0,this.tooltipMouseTrack=!1}wireBeans(e){this.popupService=e.popupService,this.userComponentFactory=e.userComponentFactory}postConstruct(){this.gos.get("tooltipInteraction")&&(this.interactionEnabled=!0),this.tooltipTrigger=this.getTooltipTrigger(),this.tooltipMouseTrack=this.gos.get("tooltipMouseTrack");const e=this.parentComp.getGui();0===this.tooltipTrigger&&this.addManagedListeners(e,{mouseenter:this.onMouseEnter.bind(this),mouseleave:this.onMouseLeave.bind(this)}),1===this.tooltipTrigger&&this.addManagedListeners(e,{focusin:this.onFocusIn.bind(this),focusout:this.onFocusOut.bind(this)}),this.addManagedListeners(e,{mousemove:this.onMouseMove.bind(this)}),this.interactionEnabled||this.addManagedListeners(e,{mousedown:this.onMouseDown.bind(this),keydown:this.onKeyDown.bind(this)})}getGridOptionsTooltipDelay(e){const t=this.gos.get(e);return t<0&&v("".concat(e," should not be lower than 0")),Math.max(200,t)}getTooltipDelay(e){var t,i;return"show"===e?null!==(i=this.tooltipShowDelayOverride)&&void 0!==i?i:this.getGridOptionsTooltipDelay("tooltipShowDelay"):null!==(t=this.tooltipHideDelayOverride)&&void 0!==t?t:this.getGridOptionsTooltipDelay("tooltipHideDelay")}destroy(){this.setToDoNothing(),super.destroy()}getTooltipTrigger(){const e=this.gos.get("tooltipTrigger");return e&&"hover"!==e?1:0}onMouseEnter(t){this.interactionEnabled&&this.interactiveTooltipTimeoutId&&(this.unlockService(),this.startHideTimeout()),Pi()||(e.isLocked?this.showTooltipTimeoutId=window.setTimeout((()=>{this.prepareToShowTooltip(t)}),100):this.prepareToShowTooltip(t))}onMouseMove(e){this.lastMouseEvent&&(this.lastMouseEvent=e),this.tooltipMouseTrack&&2===this.state&&this.tooltipComp&&this.positionTooltip()}onMouseDown(){this.setToDoNothing()}onMouseLeave(){this.interactionEnabled?this.lockService():this.setToDoNothing()}onFocusIn(){this.prepareToShowTooltip()}onFocusOut(e){var t;const i=e.relatedTarget,r=this.parentComp.getGui(),n=null===(t=this.tooltipComp)||void 0===t?void 0:t.getGui();this.isInteractingWithTooltip||r.contains(i)||this.interactionEnabled&&null!==n&&void 0!==n&&n.contains(i)||this.setToDoNothing()}onKeyDown(){this.isInteractingWithTooltip&&(this.isInteractingWithTooltip=!1),this.setToDoNothing()}prepareToShowTooltip(t){if(0!=this.state||e.isLocked)return;let i=0;t&&(i=this.isLastTooltipHiddenRecently()?200:this.getTooltipDelay("show")),this.lastMouseEvent=t||null,this.showTooltipTimeoutId=window.setTimeout(this.showTooltip.bind(this),i),this.state=1}isLastTooltipHiddenRecently(){return(new Date).getTime()-e.lastTooltipHideTime<1e3}setToDoNothing(e){e||2!==this.state||this.hideTooltip(),this.onBodyScrollEventCallback&&(this.onBodyScrollEventCallback(),this.onBodyScrollEventCallback=void 0),this.onColumnMovedEventCallback&&(this.onColumnMovedEventCallback(),this.onColumnMovedEventCallback=void 0),this.onDocumentKeyDownCallback&&(this.onDocumentKeyDownCallback(),this.onDocumentKeyDownCallback=void 0),this.clearTimeouts(),this.state=0,this.lastMouseEvent=null}showTooltip(){const e=c({},this.parentComp.getTooltipParams());if(!F(e.value)||this.shouldDisplayTooltip&&!this.shouldDisplayTooltip())return void this.setToDoNothing();this.state=2,this.tooltipInstanceCount++;const t=this.newTooltipComponentCallback.bind(this,this.tooltipInstanceCount);this.userComponentFactory.getTooltipCompDetails(e).newAgStackInstance().then(t)}hideTooltip(t){!t&&this.isInteractingWithTooltip||(this.tooltipComp&&(this.destroyTooltipComp(),e.lastTooltipHideTime=(new Date).getTime()),this.eventService.dispatchEvent({type:"tooltipHide",parentGui:this.parentComp.getGui()}),t&&(this.isInteractingWithTooltip=!1),this.setToDoNothing(!0))}newTooltipComponentCallback(e,t){if(2!==this.state||this.tooltipInstanceCount!==e)return void this.destroyBean(t);const i=t.getGui();this.tooltipComp=t,i.classList.contains("ag-tooltip")||i.classList.add("ag-tooltip-custom"),0===this.tooltipTrigger&&i.classList.add("ag-tooltip-animate"),this.interactionEnabled&&i.classList.add("ag-tooltip-interactive");const r=this.localeService.getLocaleTextFunc(),n=this.popupService.addPopup({eChild:i,ariaLabel:r("ariaLabelTooltip","Tooltip")});if(n&&(this.tooltipPopupDestroyFunc=n.hideFunc),this.positionTooltip(),1===this.tooltipTrigger){const e=()=>this.setToDoNothing();[this.onBodyScrollEventCallback,this.onColumnMovedEventCallback]=this.addManagedEventListeners({bodyScroll:e,columnMoved:e})}this.interactionEnabled&&([this.tooltipMouseEnterListener,this.tooltipMouseLeaveListener]=this.addManagedElementListeners(i,{mouseenter:this.onTooltipMouseEnter.bind(this),mouseleave:this.onTooltipMouseLeave.bind(this)}),[this.onDocumentKeyDownCallback]=this.addManagedElementListeners(Q(this.gos),{keydown:e=>{i.contains(null===e||void 0===e?void 0:e.target)||this.onKeyDown()}}),1===this.tooltipTrigger&&([this.tooltipFocusInListener,this.tooltipFocusOutListener]=this.addManagedElementListeners(i,{focusin:this.onTooltipFocusIn.bind(this),focusout:this.onTooltipFocusOut.bind(this)}))),this.eventService.dispatchEvent({type:"tooltipShow",tooltipGui:i,parentGui:this.parentComp.getGui()}),this.startHideTimeout()}onTooltipMouseEnter(){this.isInteractingWithTooltip=!0,this.unlockService()}onTooltipMouseLeave(){this.isTooltipFocused()||(this.isInteractingWithTooltip=!1,this.lockService())}onTooltipFocusIn(){this.isInteractingWithTooltip=!0}isTooltipFocused(){var e;const t=null===(e=this.tooltipComp)||void 0===e?void 0:e.getGui(),i=Z(this.gos);return!!t&&t.contains(i)}onTooltipFocusOut(e){const t=this.parentComp.getGui();this.isTooltipFocused()||(this.isInteractingWithTooltip=!1,t.contains(e.relatedTarget)?this.startHideTimeout():this.hideTooltip())}positionTooltip(){const e={type:"tooltip",ePopup:this.tooltipComp.getGui(),nudgeY:18,skipObserver:this.tooltipMouseTrack};this.lastMouseEvent?this.popupService.positionPopupUnderMouseEvent(c(c({},e),{},{mouseEvent:this.lastMouseEvent})):this.popupService.positionPopupByComponent(c(c({},e),{},{eventSource:this.parentComp.getGui(),position:"under",keepWithinBounds:!0,nudgeY:5}))}destroyTooltipComp(){this.tooltipComp.getGui().classList.add("ag-tooltip-hiding");const e=this.tooltipPopupDestroyFunc,t=this.tooltipComp,i=0===this.tooltipTrigger?1e3:0;window.setTimeout((()=>{e(),this.destroyBean(t)}),i),this.clearTooltipListeners(),this.tooltipPopupDestroyFunc=void 0,this.tooltipComp=void 0}clearTooltipListeners(){[this.tooltipMouseEnterListener,this.tooltipMouseLeaveListener,this.tooltipFocusInListener,this.tooltipFocusOutListener].forEach((e=>{e&&e()})),this.tooltipMouseEnterListener=this.tooltipMouseLeaveListener=this.tooltipFocusInListener=this.tooltipFocusOutListener=null}lockService(){e.isLocked=!0,this.interactiveTooltipTimeoutId=window.setTimeout((()=>{this.unlockService(),this.setToDoNothing()}),100)}unlockService(){e.isLocked=!1,this.clearInteractiveTimeout()}startHideTimeout(){this.clearHideTimeout(),this.hideTooltipTimeoutId=window.setTimeout(this.hideTooltip.bind(this),this.getTooltipDelay("hide"))}clearShowTimeout(){this.showTooltipTimeoutId&&(window.clearTimeout(this.showTooltipTimeoutId),this.showTooltipTimeoutId=void 0)}clearHideTimeout(){this.hideTooltipTimeoutId&&(window.clearTimeout(this.hideTooltipTimeoutId),this.hideTooltipTimeoutId=void 0)}clearInteractiveTimeout(){this.interactiveTooltipTimeoutId&&(window.clearTimeout(this.interactiveTooltipTimeoutId),this.interactiveTooltipTimeoutId=void 0)}clearTimeouts(){this.clearShowTimeout(),this.clearHideTimeout(),this.clearInteractiveTimeout()}};sr.isLocked=!1;var ar=sr,lr=class extends He{constructor(e,t){super(),this.ctrl=e,t&&(this.beans=t)}wireBeans(e){this.beans=e}postConstruct(){this.refreshToolTip()}setBrowserTooltip(e){const t="title",i=this.ctrl.getGui();i&&(null!=e&&""!=e?i.setAttribute(t,e):i.removeAttribute(t))}updateTooltipText(){this.tooltip=this.ctrl.getTooltipValue()}createTooltipFeatureIfNeeded(){var e,t,i,r;if(null!=this.tooltipManager)return;const n={getTooltipParams:()=>this.getTooltipParams(),getGui:()=>this.ctrl.getGui()};this.tooltipManager=this.createBean(new ar(n,null===(e=(t=this.ctrl).getTooltipShowDelayOverride)||void 0===e?void 0:e.call(t),null===(i=(r=this.ctrl).getTooltipHideDelayOverride)||void 0===i?void 0:i.call(r),this.ctrl.shouldDisplayTooltip),this.beans.context)}refreshToolTip(){this.browserTooltips=this.beans.gos.get("enableBrowserTooltips"),this.updateTooltipText(),this.browserTooltips?(this.setBrowserTooltip(this.tooltip),this.tooltipManager&&(this.tooltipManager=this.destroyBean(this.tooltipManager,this.beans.context))):(this.setBrowserTooltip(null),this.createTooltipFeatureIfNeeded())}getTooltipParams(){var e,t,i,r,n;const o=this.ctrl,s=null===(e=o.getColumn)||void 0===e?void 0:e.call(o),a=null===(t=o.getColDef)||void 0===t?void 0:t.call(o),l=null===(i=o.getRowNode)||void 0===i?void 0:i.call(o);return{location:o.getLocation(),colDef:a,column:s,rowIndex:null===(r=o.getRowIndex)||void 0===r?void 0:r.call(o),node:l,data:null===l||void 0===l?void 0:l.data,value:this.getTooltipText(),valueFormatted:null===(n=o.getValueFormatted)||void 0===n?void 0:n.call(o),hideTooltipCallback:()=>{var e;return null===(e=this.tooltipManager)||void 0===e?void 0:e.hideTooltip(!0)}}}getTooltipText(){return this.tooltip}destroy(){this.tooltipManager&&(this.tooltipManager=this.destroyBean(this.tooltipManager,this.beans.context)),super.destroy()}},cr=new or,ur=null,dr=class e extends He{constructor(e,t){super(),this.suppressDataRefValidation=!1,this.displayed=!0,this.visible=!0,this.compId=cr.next(),this.cssClassManager=new ni((()=>this.eGui)),this.componentSelectors=new Map((null!==t&&void 0!==t?t:[]).map((e=>[e.selector,e]))),e&&this.setTemplate(e)}preWireBeans(e){super.preWireBeans(e)}preConstruct(){this.usingBrowserTooltips=this.gos.get("enableBrowserTooltips"),this.wireTemplate(this.getGui())}wireTemplate(e,t){e&&this.gos&&(this.applyElementsToComponent(e),this.createChildComponentsFromTags(e,t))}getCompId(){return this.compId}getTooltipParams(){return{value:this.tooltipText,location:"UNKNOWN"}}setTooltip(e){const{newTooltipText:t,showDelayOverride:i,hideDelayOverride:r,location:n,shouldDisplayTooltip:o}=e||{};this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature)),this.tooltipText!==t&&(this.tooltipText=t);const s=()=>this.tooltipText;null!=t&&(this.tooltipFeature=this.createBean(new lr({getTooltipValue:s,getGui:()=>this.getGui(),getLocation:()=>null!==n&&void 0!==n?n:"UNKNOWN",getColDef:null===e||void 0===e?void 0:e.getColDef,getColumn:null===e||void 0===e?void 0:e.getColumn,getTooltipShowDelayOverride:null!=i?()=>i:void 0,getTooltipHideDelayOverride:null!=r?()=>r:void 0,shouldDisplayTooltip:o})))}getDataRefAttribute(e){return e.getAttribute?e.getAttribute("data-ref"):null}applyElementsToComponent(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(void 0===t&&(t=this.getDataRefAttribute(e)),t){const n=this[t];if(n===ur)this[t]=null!==r&&void 0!==r?r:e;else{const e=i&&i[t];this.suppressDataRefValidation||e||v("Issue with data-ref: ".concat(t," on ").concat(this.constructor.name," with ").concat(n))}}}createChildComponentsFromTags(e,t){(function(e){if(null==e)return[];const t=[];return nr(e,(e=>t.push(e))),t})(e.childNodes).forEach((i=>{if(!(i instanceof HTMLElement))return;const r=this.createComponentFromElement(i,(e=>{e.getGui()&&this.copyAttributesFromNode(i,e.getGui())}),t);if(r){if(r.addItems&&i.children.length){this.createChildComponentsFromTags(i,t);const e=Array.prototype.slice.call(i.children);r.addItems(e)}this.swapComponentForNode(r,e,i)}else i.childNodes&&this.createChildComponentsFromTags(i,t)}))}createComponentFromElement(t,i,r){const n=t.nodeName,o=this.getDataRefAttribute(t),s=0===n.indexOf("AG-"),a=s?this.componentSelectors.get(n):null;let l=null;if(a){e.elementGettingCreated=t;const n=r&&o?r[o]:void 0;l=new a.component(n),l.setParentComponent(this),this.createBean(l,null,i)}else s&&v("Missing selector: ".concat(n));return this.applyElementsToComponent(t,o,r,l),l}copyAttributesFromNode(e,t){!function(e,t){if(e)for(let i=0;i<e.length;i++){const r=e[i];t(r.name,r.value)}}(e.attributes,((e,i)=>t.setAttribute(e,i)))}swapComponentForNode(e,t,i){const r=e.getGui();t.replaceChild(r,i),t.insertBefore(document.createComment(i.nodeName),r),this.addDestroyFunc(this.destroyBean.bind(this,e))}activateTabIndex(e){const t=this.gos.get("tabIndex");e||(e=[]),e.length||e.push(this.getGui()),e.forEach((e=>e.setAttribute("tabindex",t.toString())))}setTemplate(e,t,i){const r=Xi(e);this.setTemplateFromElement(r,t,i)}setTemplateFromElement(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.eGui=e,this.suppressDataRefValidation=r,t)for(let n=0;n<t.length;n++){const e=t[n];this.componentSelectors.set(e.selector,e)}this.wireTemplate(e,i)}getGui(){return this.eGui}getFocusableElement(){return this.eGui}getAriaElement(){return this.getFocusableElement()}setParentComponent(e){this.parentComponent=e}getParentComponent(){return this.parentComponent}setGui(e){this.eGui=e}queryForHtmlElement(e){return this.eGui.querySelector(e)}getContainerAndElement(e,t){let i=t;return null==e?null:(i||(i=this.eGui),ir(e)?{element:e,parent:i}:{element:e.getGui(),parent:i})}prependChild(e,t){const{element:i,parent:r}=this.getContainerAndElement(e,t)||{};i&&r&&r.insertAdjacentElement("afterbegin",i)}appendChild(e,t){const{element:i,parent:r}=this.getContainerAndElement(e,t)||{};i&&r&&r.appendChild(i)}isDisplayed(){return this.displayed}setVisible(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e!==this.visible){this.visible=e;const{skipAriaHidden:i}=t;!function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{skipAriaHidden:r}=i;e.classList.toggle("ag-invisible",!t),r||gi(e,!t)}(this.eGui,e,{skipAriaHidden:i})}}setDisplayed(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e!==this.displayed){this.displayed=e;const{skipAriaHidden:i}=t;Oi(this.eGui,e,{skipAriaHidden:i});const r={type:"displayChanged",visible:this.displayed};this.dispatchLocalEvent(r)}}destroy(){this.parentComponent&&(this.parentComponent=void 0),this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature)),super.destroy()}addGuiEventListener(e,t,i){this.eGui.addEventListener(e,t,i),this.addDestroyFunc((()=>this.eGui.removeEventListener(e,t)))}addCssClass(e){this.cssClassManager.addCssClass(e)}removeCssClass(e){this.cssClassManager.removeCssClass(e)}containsCssClass(e){return this.cssClassManager.containsCssClass(e)}addOrRemoveCssClass(e,t){this.cssClassManager.addOrRemoveCssClass(e,t)}},hr={columnGroupOpened:"expanded",columnGroupClosed:"contracted",columnSelectClosed:"tree-closed",columnSelectOpen:"tree-open",columnSelectIndeterminate:"tree-indeterminate",columnMovePin:"pin",columnMoveHide:"eye-slash",columnMoveMove:"arrows",columnMoveLeft:"left",columnMoveRight:"right",columnMoveGroup:"group",columnMoveValue:"aggregation",columnMovePivot:"pivot",dropNotAllowed:"not-allowed",groupContracted:"tree-closed",groupExpanded:"tree-open",setFilterGroupClosed:"tree-closed",setFilterGroupOpen:"tree-open",setFilterGroupIndeterminate:"tree-indeterminate",chart:"chart",close:"cross",cancel:"cancel",check:"tick",first:"first",previous:"previous",next:"next",last:"last",linked:"linked",unlinked:"unlinked",colorPicker:"color-picker",groupLoading:"loading",menu:"menu",menuAlt:"menu-alt",filter:"filter",columns:"columns",maximize:"maximize",minimize:"minimize",menuPin:"pin",menuValue:"aggregation",menuAddRowGroup:"group",menuRemoveRowGroup:"group",clipboardCopy:"copy",clipboardCut:"cut",clipboardPaste:"paste",pivotPanel:"pivot",rowGroupPanel:"group",valuePanel:"aggregation",columnDrag:"grip",rowDrag:"grip",save:"save",csvExport:"csv",excelExport:"excel",smallDown:"small-down",smallLeft:"small-left",smallRight:"small-right",smallUp:"small-up",sortAscending:"asc",sortDescending:"desc",sortUnSort:"none",advancedFilterBuilder:"group",advancedFilterBuilderDrag:"grip",advancedFilterBuilderInvalid:"not-allowed",advancedFilterBuilderMoveUp:"up",advancedFilterBuilderMoveDown:"down",advancedFilterBuilderAdd:"plus",advancedFilterBuilderRemove:"minus",chartsMenuEdit:"chart",chartsMenuAdvancedSettings:"settings",chartsMenuAdd:"plus",checkboxChecked:"checkbox-checked",checkboxIndeterminate:"checkbox-indeterminate",checkboxUnchecked:"checkbox-unchecked",radioButtonOn:"radio-button-on",radioButtonOff:"radio-button-off"},gr=(()=>{const e=new Set(Object.values(hr));return e.add("eye"),e})();function pr(e,t,i,r){let n=null;const o=i&&i.getColDef().icons;if(o&&(n=o[e]),t&&!n){const i=t.get("icons");i&&(n=i[e])}if(!n){var s;const t=document.createElement("span");let i=null!==(s=hr[e])&&void 0!==s?s:gr.has(e)?e:void 0;return i||(r?i=e:(v("Did not find icon ".concat(e)),i="")),t.setAttribute("class","ag-icon ag-icon-".concat(i)),t.setAttribute("unselectable","on"),ci(t,"presentation"),t}{let e;if("function"===typeof n)e=n();else{if("string"!==typeof n)throw new Error("icon from grid options needs to be a string or a function");e=n}if("string"===typeof e)return Xi(e);if(ir(e))return e;v("iconRenderer should return back a string or a dom object")}}var fr=class extends dr{constructor(){super(...arguments),this.dragSource=null,this.eIcon=ur,this.eLabel=ur}postConstruct(){const e=e=>function(e,t,i){const r=pr(e,t,i);if(r){const{className:e}=r;if("string"===typeof e&&e.indexOf("ag-icon")>-1||"object"===typeof e&&e["ag-icon"])return r}const n=document.createElement("span");return n.appendChild(r),n}(e,this.gos,null);this.dropIconMap={pinned:e("columnMovePin"),hide:e("columnMoveHide"),move:e("columnMoveMove"),left:e("columnMoveLeft"),right:e("columnMoveRight"),group:e("columnMoveGroup"),aggregate:e("columnMoveValue"),pivot:e("columnMovePivot"),notAllowed:e("dropNotAllowed")}}init(e){this.dragSource=e.dragSource,this.setTemplate('<div class="ag-dnd-ghost ag-unselectable">\n                <span data-ref="eIcon" class="ag-dnd-ghost-icon ag-shake-left-to-right"></span>\n                <div data-ref="eLabel" class="ag-dnd-ghost-label"></div>\n            </div>')}destroy(){this.dragSource=null,super.destroy()}setIcon(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Yi(this.eIcon);let i=null;var r,n;e||(e=null!==(r=this.dragSource)&&void 0!==r&&r.getDefaultIconName?null===(n=this.dragSource)||void 0===n?void 0:n.getDefaultIconName():"notAllowed");i=this.dropIconMap[e],this.eIcon.classList.toggle("ag-shake-left-to-right",t),i===this.dropIconMap.hide&&this.gos.get("suppressDragLeaveHidesColumns")||i&&this.eIcon.appendChild(i)}setLabel(e){this.eLabel.textContent=Pt(e)}};function mr(e,t,i){if(0===i)return!1;const r=Math.abs(e.clientX-t.clientX),n=Math.abs(e.clientY-t.clientY);return Math.max(r,n)<=i}var vr=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.DOUBLE_TAP_MILLIS=500,this.destroyFuncs=[],this.touching=!1,this.localEventService=new h,this.eElement=e,this.preventMouseClick=t;const i=this.onTouchStart.bind(this),r=this.onTouchMove.bind(this),n=this.onTouchEnd.bind(this);this.eElement.addEventListener("touchstart",i,{passive:!0}),this.eElement.addEventListener("touchmove",r,{passive:!0}),this.eElement.addEventListener("touchend",n,{passive:!1}),this.destroyFuncs.push((()=>{this.eElement.removeEventListener("touchstart",i,{passive:!0}),this.eElement.removeEventListener("touchmove",r,{passive:!0}),this.eElement.removeEventListener("touchend",n,{passive:!1})}))}getActiveTouch(e){for(let t=0;t<e.length;t++){if(e[t].identifier===this.touchStart.identifier)return e[t]}return null}addEventListener(e,t){this.localEventService.addEventListener(e,t)}removeEventListener(e,t){this.localEventService.removeEventListener(e,t)}onTouchStart(e){if(this.touching)return;this.touchStart=e.touches[0],this.touching=!0,this.moved=!1;const t=this.touchStart;window.setTimeout((()=>{const i=this.touchStart===t;if(this.touching&&i&&!this.moved){this.moved=!0;const t={type:"longTap",touchStart:this.touchStart,touchEvent:e};this.localEventService.dispatchEvent(t)}}),500)}onTouchMove(e){if(!this.touching)return;const t=this.getActiveTouch(e.touches);if(!t)return;!mr(t,this.touchStart,4)&&(this.moved=!0)}onTouchEnd(e){if(this.touching){if(!this.moved){const e={type:"tap",touchStart:this.touchStart};this.localEventService.dispatchEvent(e),this.checkForDoubleTap()}this.preventMouseClick&&e.cancelable&&e.preventDefault(),this.touching=!1}}checkForDoubleTap(){const e=(new Date).getTime();if(this.lastTapTime&&this.lastTapTime>0){if(e-this.lastTapTime>this.DOUBLE_TAP_MILLIS){const e={type:"doubleTap",touchStart:this.touchStart};this.localEventService.dispatchEvent(e),this.lastTapTime=null}else this.lastTapTime=e}else this.lastTapTime=e}destroy(){this.destroyFuncs.forEach((e=>e()))}};function Cr(e,t){return'<span data-ref="eSort'.concat(e,'" class="ag-sort-indicator-icon ag-sort-').concat(t,' ag-hidden" aria-hidden="true"></span>')}var wr='<span class="ag-sort-indicator-container">\n        '.concat(Cr("Order","order"),"\n        ").concat(Cr("Asc","ascending-icon"),"\n        ").concat(Cr("Desc","descending-icon"),"\n        ").concat(Cr("Mixed","mixed-icon"),"\n        ").concat(Cr("None","none-icon"),"\n    </span>"),br=class extends dr{constructor(e){super(),this.eSortOrder=ur,this.eSortAsc=ur,this.eSortDesc=ur,this.eSortMixed=ur,this.eSortNone=ur,e||this.setTemplate(wr)}wireBeans(e){this.sortController=e.sortController}attachCustomElements(e,t,i,r,n){this.eSortOrder=e,this.eSortAsc=t,this.eSortDesc=i,this.eSortMixed=r,this.eSortNone=n}setupSort(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.column=e,this.suppressOrder=t,this.setupMultiSortIndicator(),!this.column.isSortable()&&!this.column.getColDef().showRowGroup)return;this.addInIcon("sortAscending",this.eSortAsc,e),this.addInIcon("sortDescending",this.eSortDesc,e),this.addInIcon("sortUnSort",this.eSortNone,e);const i=this.updateIcons.bind(this),r=this.onSortChanged.bind(this);this.addManagedPropertyListener("unSortIcon",i),this.addManagedEventListeners({newColumnsLoaded:i,sortChanged:r,columnRowGroupChanged:r}),this.onSortChanged()}addInIcon(e,t,i){if(null==t)return;const r=pr(e,this.gos,i);r&&t.appendChild(r)}onSortChanged(){this.updateIcons(),this.suppressOrder||this.updateSortOrder()}updateIcons(){const e=this.sortController.getDisplaySortForColumn(this.column);if(this.eSortAsc){const t="asc"===e;Oi(this.eSortAsc,t,{skipAriaHidden:!0})}if(this.eSortDesc){const t="desc"===e;Oi(this.eSortDesc,t,{skipAriaHidden:!0})}if(this.eSortNone){const t=!this.column.getColDef().unSortIcon&&!this.gos.get("unSortIcon"),i=null===e||void 0===e;Oi(this.eSortNone,!t&&i,{skipAriaHidden:!0})}}setupMultiSortIndicator(){this.addInIcon("sortUnSort",this.eSortMixed,this.column);const e=this.column.getColDef().showRowGroup;re(this.gos)&&e&&(this.addManagedEventListeners({sortChanged:this.updateMultiSortIndicator.bind(this),columnRowGroupChanged:this.updateMultiSortIndicator.bind(this)}),this.updateMultiSortIndicator())}updateMultiSortIndicator(){if(this.eSortMixed){const e="mixed"===this.sortController.getDisplaySortForColumn(this.column);Oi(this.eSortMixed,e,{skipAriaHidden:!0})}}updateSortOrder(){var e;if(!this.eSortOrder)return;const t=this.sortController.getColumnsWithSortingOrdered(),i=null!==(e=this.sortController.getDisplaySortIndexForColumn(this.column))&&void 0!==e?e:-1,r=t.some((e=>{var t;return null!==(t=this.sortController.getDisplaySortIndexForColumn(e))&&void 0!==t&&t})),n=i>=0&&r;Oi(this.eSortOrder,n,{skipAriaHidden:!0}),i>=0?this.eSortOrder.textContent=(i+1).toString():Yi(this.eSortOrder)}},Sr={selector:"AG-SORT-INDICATOR",component:br},yr=class extends dr{constructor(){super(...arguments),this.eFilter=ur,this.eFilterButton=ur,this.eSortIndicator=ur,this.eMenu=ur,this.eLabel=ur,this.eText=ur,this.eSortOrder=ur,this.eSortAsc=ur,this.eSortDesc=ur,this.eSortMixed=ur,this.eSortNone=ur,this.lastMovingChanged=0}wireBeans(e){this.sortController=e.sortController,this.menuService=e.menuService,this.funcColsService=e.funcColsService}destroy(){super.destroy()}refresh(e){const t=this.params;return this.params=e,this.workOutTemplate()==this.currentTemplate&&this.workOutShowMenu()==this.currentShowMenu&&this.workOutSort()==this.currentSort&&this.shouldSuppressMenuHide()==this.currentSuppressMenuHide&&t.enableFilterButton==e.enableFilterButton&&t.enableFilterIcon==e.enableFilterIcon&&(this.setDisplayName(e),!0)}workOutTemplate(){var e;let t=null!==(e=this.params.template)&&void 0!==e?e:'<div class="ag-cell-label-container" role="presentation">\n        <span data-ref="eMenu" class="ag-header-icon ag-header-cell-menu-button" aria-hidden="true"></span>\n        <span data-ref="eFilterButton" class="ag-header-icon ag-header-cell-filter-button" aria-hidden="true"></span>\n        <div data-ref="eLabel" class="ag-header-cell-label" role="presentation">\n            <span data-ref="eText" class="ag-header-cell-text"></span>\n            <span data-ref="eFilter" class="ag-header-icon ag-header-label-icon ag-filter-icon" aria-hidden="true"></span>\n            <ag-sort-indicator data-ref="eSortIndicator"></ag-sort-indicator>\n        </div>\n    </div>';return t=t&&t.trim?t.trim():t,t}init(e){this.params=e,this.currentTemplate=this.workOutTemplate(),this.setTemplate(this.currentTemplate,[Sr]),this.setupTap(),this.setMenu(),this.setupSort(),this.setupFilterIcon(),this.setupFilterButton(),this.setDisplayName(e)}setDisplayName(e){if(this.currentDisplayName!=e.displayName){this.currentDisplayName=e.displayName;const t=Pt(this.currentDisplayName,!0);this.eText&&(this.eText.textContent=t)}}addInIcon(e,t,i){if(null==t)return;const r=pr(e,this.gos,i);r&&t.appendChild(r)}setupTap(){const{gos:e}=this;if(e.get("suppressTouch"))return;const t=new vr(this.getGui(),!0),i=this.shouldSuppressMenuHide(),r=i&&F(this.eMenu),n=r?new vr(this.eMenu,!0):t;if(this.params.enableMenu){const e=r?"tap":"longTap",t=e=>this.params.showColumnMenuAfterMouseClick(e.touchStart);this.addManagedListeners(n,{[e]:t})}if(this.params.enableSorting){const e=e=>{var t,r;const n=e.touchStart.target;i&&(null!==(t=this.eMenu)&&void 0!==t&&t.contains(n)||null!==(r=this.eFilterButton)&&void 0!==r&&r.contains(n))||this.sortController.progressSort(this.params.column,!1,"uiColumnSorted")};this.addManagedListeners(t,{tap:e})}if(this.params.enableFilterButton){const e=new vr(this.eFilterButton,!0);this.addManagedListeners(e,{tap:()=>this.params.showFilter(this.eFilterButton)}),this.addDestroyFunc((()=>e.destroy()))}this.addDestroyFunc((()=>t.destroy())),r&&this.addDestroyFunc((()=>n.destroy()))}workOutShowMenu(){return this.params.enableMenu&&this.menuService.isHeaderMenuButtonEnabled()}shouldSuppressMenuHide(){return this.menuService.isHeaderMenuButtonAlwaysShowEnabled()}setMenu(){if(!this.eMenu)return;if(this.currentShowMenu=this.workOutShowMenu(),!this.currentShowMenu)return qi(this.eMenu),void(this.eMenu=void 0);const e=this.menuService.isLegacyMenuEnabled();this.addInIcon(e?"menu":"menuAlt",this.eMenu,this.params.column),this.eMenu.classList.toggle("ag-header-menu-icon",!e),this.currentSuppressMenuHide=this.shouldSuppressMenuHide(),this.addManagedElementListeners(this.eMenu,{click:()=>this.params.showColumnMenu(this.eMenu)}),this.eMenu.classList.toggle("ag-header-menu-always-show",this.currentSuppressMenuHide)}onMenuKeyboardShortcut(e){const t=this.params.column,i=this.menuService.isLegacyMenuEnabled();var r,n;if(e&&!i){if(this.menuService.isFilterMenuInHeaderEnabled(t))return this.params.showFilter(null!==(r=null!==(n=this.eFilterButton)&&void 0!==n?n:this.eMenu)&&void 0!==r?r:this.getGui()),!0}else if(this.params.enableMenu){var o,s;return this.params.showColumnMenu(null!==(o=null!==(s=this.eMenu)&&void 0!==s?s:this.eFilterButton)&&void 0!==o?o:this.getGui()),!0}return!1}workOutSort(){return this.params.enableSorting}setupSort(){if(this.currentSort=this.params.enableSorting,this.eSortIndicator||(this.eSortIndicator=this.createBean(new br(!0)),this.eSortIndicator.attachCustomElements(this.eSortOrder,this.eSortAsc,this.eSortDesc,this.eSortMixed,this.eSortNone)),this.eSortIndicator.setupSort(this.params.column),!this.currentSort)return;this.addManagedListeners(this.params.column,{movingChanged:()=>{this.lastMovingChanged=(new Date).getTime()}}),this.eLabel&&this.addManagedElementListeners(this.eLabel,{click:e=>{const t=this.params.column.isMoving(),i=(new Date).getTime()-this.lastMovingChanged<50;if(!(t||i)){const t="ctrl"===this.gos.get("multiSortKey")?e.ctrlKey||e.metaKey:e.shiftKey;this.params.progressSort(t)}}});const e=()=>{const e=this.params.column.getSort();if(this.addOrRemoveCssClass("ag-header-cell-sorted-asc","asc"===e),this.addOrRemoveCssClass("ag-header-cell-sorted-desc","desc"===e),this.addOrRemoveCssClass("ag-header-cell-sorted-none",!e),this.params.column.getColDef().showRowGroup){const e=this.funcColsService.getSourceColumnsForGroupColumn(this.params.column),t=!(null===e||void 0===e?void 0:e.every((e=>this.params.column.getSort()==e.getSort())));this.addOrRemoveCssClass("ag-header-cell-sorted-mixed",t)}};this.addManagedEventListeners({sortChanged:e,columnRowGroupChanged:e})}setupFilterIcon(){this.eFilter&&this.configureFilter(this.params.enableFilterIcon,this.eFilter,this.onFilterChangedIcon.bind(this))}setupFilterButton(){if(!this.eFilterButton)return;this.configureFilter(this.params.enableFilterButton,this.eFilterButton,this.onFilterChangedButton.bind(this))?this.addManagedElementListeners(this.eFilterButton,{click:()=>this.params.showFilter(this.eFilterButton)}):this.eFilterButton=void 0}configureFilter(e,t,i){if(!e)return qi(t),!1;const r=this.params.column;return this.addInIcon("filter",t,r),this.addManagedListeners(r,{filterChanged:i}),i(),!0}onFilterChangedIcon(){const e=this.params.column.isFilterActive();Oi(this.eFilter,e,{skipAriaHidden:!0})}onFilterChangedButton(){const e=this.params.column.isFilterActive();this.eFilterButton.classList.toggle("ag-filter-active",e)}getAnchorElementForMenu(e){var t,i,r,n;return e?null!==(r=null!==(n=this.eFilterButton)&&void 0!==n?n:this.eMenu)&&void 0!==r?r:this.getGui():null!==(t=null!==(i=this.eMenu)&&void 0!==i?i:this.eFilterButton)&&void 0!==t?t:this.getGui()}},Rr=class extends dr{constructor(){super('<div class="ag-header-group-cell-label" role="presentation">\n            <span data-ref="agLabel" class="ag-header-group-text" role="presentation"></span>\n            <span data-ref="agOpened" class="ag-header-icon ag-header-expand-icon ag-header-expand-icon-expanded"></span>\n            <span data-ref="agClosed" class="ag-header-icon ag-header-expand-icon ag-header-expand-icon-collapsed"></span>\n        </div>'),this.agOpened=ur,this.agClosed=ur,this.agLabel=ur}wireBeans(e){this.columnModel=e.columnModel}destroy(){super.destroy()}init(e){this.params=e,this.checkWarnings(),this.setupLabel(),this.addGroupExpandIcon(),this.setupExpandIcons()}checkWarnings(){this.params.template&&v("A template was provided for Header Group Comp - templates are only supported for Header Comps (not groups)")}setupExpandIcons(){this.addInIcon("columnGroupOpened",this.agOpened),this.addInIcon("columnGroupClosed",this.agClosed);const e=e=>{if(Oe(e))return;const t=!this.params.columnGroup.isExpanded();this.columnModel.setColumnGroupOpened(this.params.columnGroup.getProvidedColumnGroup(),t,"uiColumnExpanded")};this.addTouchAndClickListeners(this.agClosed,e),this.addTouchAndClickListeners(this.agOpened,e);const t=e=>{Le(e)};this.addManagedElementListeners(this.agClosed,{dblclick:t}),this.addManagedElementListeners(this.agOpened,{dblclick:t}),this.addManagedElementListeners(this.getGui(),{dblclick:e}),this.updateIconVisibility();const i=this.params.columnGroup.getProvidedColumnGroup(),r=this.updateIconVisibility.bind(this);this.addManagedListeners(i,{expandedChanged:r,expandableChanged:r})}addTouchAndClickListeners(e,t){const i=new vr(e,!0);this.addManagedListeners(i,{tap:t}),this.addDestroyFunc((()=>i.destroy())),this.addManagedElementListeners(e,{click:t})}updateIconVisibility(){if(this.params.columnGroup.isExpandable()){const e=this.params.columnGroup.isExpanded();Oi(this.agOpened,e),Oi(this.agClosed,!e)}else Oi(this.agOpened,!1),Oi(this.agClosed,!1)}addInIcon(e,t){const i=pr(e,this.gos,null);i&&t.appendChild(i)}addGroupExpandIcon(){if(!this.params.columnGroup.isExpandable())return Oi(this.agOpened,!1),void Oi(this.agClosed,!1)}setupLabel(){var e;const{displayName:t,columnGroup:i}=this.params;if(F(t)){const e=Pt(t,!0);this.agLabel.textContent=e}this.addOrRemoveCssClass("ag-sticky-label",!(null!==(e=i.getColGroupDef())&&void 0!==e&&e.suppressStickyLabel))}},Er=class extends dr{constructor(){super(),this.refreshCount=0;const e=document.createElement("span"),t=document.createElement("span");t.setAttribute("class","ag-value-change-delta");const i=document.createElement("span");i.setAttribute("class","ag-value-change-value"),e.appendChild(t),e.appendChild(i),this.setTemplateFromElement(e)}wireBeans(e){this.filterManager=e.filterManager}init(e){this.eValue=this.queryForHtmlElement(".ag-value-change-value"),this.eDelta=this.queryForHtmlElement(".ag-value-change-delta"),this.refresh(e,!0)}showDelta(e,t){const i=Math.abs(t),r=e.formatValue(i),n=F(r)?r:i,o=t>=0;this.eDelta.textContent=o?"\u2191"+n:"\u2193"+n,this.eDelta.classList.toggle("ag-value-change-delta-up",o),this.eDelta.classList.toggle("ag-value-change-delta-down",!o)}setTimerToRemoveDelta(){this.refreshCount++;const e=this.refreshCount;this.getFrameworkOverrides().wrapIncoming((()=>{window.setTimeout((()=>{e===this.refreshCount&&this.hideDeltaValue()}),2e3)}))}hideDeltaValue(){this.eValue.classList.remove("ag-value-change-value-highlight"),Yi(this.eDelta)}refresh(e){var t;let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=e.value;if(r===this.lastValue)return!1;if(F(e.valueFormatted)?this.eValue.textContent=e.valueFormatted:F(e.value)?this.eValue.textContent=r:Yi(this.eValue),null!==(t=this.filterManager)&&void 0!==t&&t.isSuppressFlashingCellsBecauseFiltering())return!1;if("number"===typeof r&&"number"===typeof this.lastValue){const t=r-this.lastValue;this.showDelta(e,t)}return this.lastValue&&this.eValue.classList.add("ag-value-change-value-highlight"),i||this.setTimerToRemoveDelta(),this.lastValue=r,!0}},xr=class extends dr{constructor(){super(),this.refreshCount=0;const e=document.createElement("span"),t=document.createElement("span");t.setAttribute("class","ag-value-slide-current"),e.appendChild(t),this.setTemplateFromElement(e),this.eCurrent=this.queryForHtmlElement(".ag-value-slide-current")}wireBeans(e){this.filterManager=e.filterManager}init(e){this.refresh(e,!0)}addSlideAnimation(){this.refreshCount++;const e=this.refreshCount;this.ePrevious&&this.getGui().removeChild(this.ePrevious);const t=document.createElement("span");t.setAttribute("class","ag-value-slide-previous ag-value-slide-out"),this.ePrevious=t,this.ePrevious.textContent=this.eCurrent.textContent,this.getGui().insertBefore(this.ePrevious,this.eCurrent),this.getFrameworkOverrides().wrapIncoming((()=>{window.setTimeout((()=>{e===this.refreshCount&&this.ePrevious.classList.add("ag-value-slide-out-end")}),50),window.setTimeout((()=>{e===this.refreshCount&&(this.getGui().removeChild(this.ePrevious),this.ePrevious=null)}),3e3)}))}refresh(e){var t;let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=e.value;return P(r)&&(r=""),r!==this.lastValue&&((null===(t=this.filterManager)||void 0===t||!t.isSuppressFlashingCellsBecauseFiltering())&&(i||this.addSlideAnimation(),this.lastValue=r,F(e.valueFormatted)?this.eCurrent.textContent=e.valueFormatted:F(e.value)?this.eCurrent.textContent=r:Yi(this.eCurrent),!0))}},Tr=class{};Tr.BACKSPACE="Backspace",Tr.TAB="Tab",Tr.ENTER="Enter",Tr.ESCAPE="Escape",Tr.SPACE=" ",Tr.LEFT="ArrowLeft",Tr.UP="ArrowUp",Tr.RIGHT="ArrowRight",Tr.DOWN="ArrowDown",Tr.DELETE="Delete",Tr.F2="F2",Tr.PAGE_UP="PageUp",Tr.PAGE_DOWN="PageDown",Tr.PAGE_HOME="Home",Tr.PAGE_END="End",Tr.A="KeyA",Tr.C="KeyC",Tr.D="KeyD",Tr.V="KeyV",Tr.X="KeyX",Tr.Y="KeyY",Tr.Z="KeyZ";var Fr=class extends dr{constructor(e,t,i){super(t,i),this.labelSeparator="",this.labelAlignment="left",this.disabled=!1,this.label="",this.config=e||{}}postConstruct(){this.addCssClass("ag-labeled"),this.eLabel.classList.add("ag-label");const{labelSeparator:e,label:t,labelWidth:i,labelAlignment:r,disabled:n}=this.config;null!=n&&this.setDisabled(n),null!=e&&this.setLabelSeparator(e),null!=t&&this.setLabel(t),null!=i&&this.setLabelWidth(i),this.setLabelAlignment(r||this.labelAlignment),this.refreshLabel()}refreshLabel(){Yi(this.eLabel),"string"===typeof this.label?this.eLabel.innerText=this.label+this.labelSeparator:this.label&&this.eLabel.appendChild(this.label),""===this.label?(Oi(this.eLabel,!1),ci(this.eLabel,"presentation")):(Oi(this.eLabel,!0),ci(this.eLabel,null))}setLabelSeparator(e){return this.labelSeparator===e||(this.labelSeparator=e,null!=this.label&&this.refreshLabel()),this}getLabelId(){return this.eLabel.id=this.eLabel.id||"ag-".concat(this.getCompId(),"-label"),this.eLabel.id}getLabel(){return this.label}setLabel(e){return this.label===e||(this.label=e,this.refreshLabel()),this}setLabelAlignment(e){const t=this.getGui().classList;return t.toggle("ag-label-align-left","left"===e),t.toggle("ag-label-align-right","right"===e),t.toggle("ag-label-align-top","top"===e),this}setLabelEllipsis(e){return this.eLabel.classList.toggle("ag-label-ellipsis",e),this}setLabelWidth(e){return null==this.label||Ji(this.eLabel,e),this}setDisabled(e){e=!!e;const t=this.getGui();return Ni(t,e),t.classList.toggle("ag-disabled",e),this.disabled=e,this}isDisabled(){return!!this.disabled}},Pr=class extends Fr{constructor(e,t,i,r){super(e,t,i),this.className=r}postConstruct(){super.postConstruct();const{width:e,value:t,onValueChange:i}=this.config;null!=e&&this.setWidth(e),null!=t&&this.setValue(t),null!=i&&this.onValueChange(i),this.className&&this.addCssClass(this.className),this.refreshAriaLabelledBy()}setLabel(e){return super.setLabel(e),this.refreshAriaLabelledBy(),this}refreshAriaLabelledBy(){const e=this.getAriaElement(),t=this.getLabelId(),i=this.getLabel();null==i||""==i||null!==e.getAttribute("aria-label")?di(e,""):di(e,null!==t&&void 0!==t?t:"")}setAriaLabel(e){return ui(this.getAriaElement(),e),this.refreshAriaLabelledBy(),this}onValueChange(e){return this.addManagedListeners(this,{fieldValueChanged:()=>e(this.getValue())}),this}getWidth(){return this.getGui().clientWidth}setWidth(e){return Zi(this.getGui(),e),this}getPreviousValue(){return this.previousValue}getValue(){return this.value}setValue(e,t){return this.value===e||(this.previousValue=this.value,this.value=e,t||this.dispatchLocalEvent({type:"fieldValueChanged"})),this}},Dr=class extends Pr{constructor(e,t){var i;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"text",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"input";super(e,null!==(i=null===e||void 0===e?void 0:e.template)&&void 0!==i?i:'\n            <div role="presentation">\n                <div data-ref="eLabel" class="ag-input-field-label"></div>\n                <div data-ref="eWrapper" class="ag-wrapper ag-input-wrapper" role="presentation">\n                    <'.concat(n,' data-ref="eInput" class="ag-input-field-input"></').concat(n,">\n                </div>\n            </div>"),[],t),this.inputType=r,this.displayFieldTag=n,this.eLabel=ur,this.eWrapper=ur,this.eInput=ur}postConstruct(){super.postConstruct(),this.setInputType(),this.eLabel.classList.add("".concat(this.className,"-label")),this.eWrapper.classList.add("".concat(this.className,"-input-wrapper")),this.eInput.classList.add("".concat(this.className,"-input")),this.addCssClass("ag-input-field"),this.eInput.id=this.eInput.id||"ag-".concat(this.getCompId(),"-input");const{inputName:e,inputWidth:t}=this.config;null!=e&&this.setInputName(e),null!=t&&this.setInputWidth(t),this.addInputListeners(),this.activateTabIndex([this.eInput])}addInputListeners(){this.addManagedElementListeners(this.eInput,{input:e=>this.setValue(e.target.value)})}setInputType(){"input"===this.displayFieldTag&&this.eInput.setAttribute("type",this.inputType)}getInputElement(){return this.eInput}setInputWidth(e){return Ji(this.eWrapper,e),this}setInputName(e){return this.getInputElement().setAttribute("name",e),this}getFocusableElement(){return this.eInput}setMaxLength(e){return this.eInput.maxLength=e,this}setInputPlaceholder(e){return rr(this.eInput,"placeholder",e),this}setInputAriaLabel(e){return ui(this.eInput,e),this.refreshAriaLabelledBy(),this}setDisabled(e){return Ni(this.eInput,e),super.setDisabled(e)}setAutoComplete(e){if(!0===e)rr(this.eInput,"autocomplete",null);else{const t="string"===typeof e?e:"off";rr(this.eInput,"autocomplete",t)}return this}},kr=class extends Dr{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ag-checkbox",arguments.length>2&&void 0!==arguments[2]?arguments[2]:"checkbox"),this.labelAlignment="right",this.selected=!1,this.readOnly=!1,this.passive=!1}postConstruct(){super.postConstruct();const{readOnly:e,passive:t}=this.config;"boolean"===typeof e&&this.setReadOnly(e),"boolean"===typeof t&&this.setPassive(t)}addInputListeners(){this.addManagedElementListeners(this.eInput,{click:this.onCheckboxClick.bind(this)}),this.addManagedElementListeners(this.eLabel,{click:this.toggle.bind(this)})}getNextValue(){return void 0===this.selected||!this.selected}setPassive(e){this.passive=e}isReadOnly(){return this.readOnly}setReadOnly(e){this.eWrapper.classList.toggle("ag-disabled",e),this.eInput.disabled=e,this.readOnly=e}setDisabled(e){return this.eWrapper.classList.toggle("ag-disabled",e),super.setDisabled(e)}toggle(){if(this.eInput.disabled)return;const e=this.isSelected(),t=this.getNextValue();this.passive?this.dispatchChange(t,e):this.setValue(t)}getValue(){return this.isSelected()}setValue(e,t){return this.refreshSelectedClass(e),this.setSelected(e,t),this}setName(e){return this.getInputElement().name=e,this}isSelected(){return this.selected}setSelected(e,t){this.isSelected()!==e&&(this.previousValue=this.isSelected(),e=this.selected="boolean"===typeof e?e:void 0,this.eInput.checked=e,this.eInput.indeterminate=void 0===e,t||this.dispatchChange(this.selected,this.previousValue))}dispatchChange(e,t,i){this.dispatchLocalEvent({type:"fieldValueChanged",selected:e,previousValue:t,event:i});const r=this.getInputElement();this.eventService.dispatchEvent({type:"checkboxChanged",id:r.id,name:r.name,selected:e,previousValue:t})}onCheckboxClick(e){if(this.passive||this.eInput.disabled)return;const t=this.isSelected(),i=this.selected=e.target.checked;this.refreshSelectedClass(i),this.dispatchChange(i,t,e)}refreshSelectedClass(e){this.eWrapper.classList.toggle("ag-checked",!0===e),this.eWrapper.classList.toggle("ag-indeterminate",null==e)}},Ar={selector:"AG-CHECKBOX",component:kr},Mr=class extends dr{constructor(){super('\n            <div class="ag-cell-wrapper ag-checkbox-cell" role="presentation">\n                <ag-checkbox role="presentation" data-ref="eCheckbox"></ag-checkbox>\n            </div>',[Ar]),this.eCheckbox=ur}init(e){this.refresh(e);const t=this.eCheckbox.getInputElement();t.setAttribute("tabindex","-1"),hi(t,"polite"),this.addManagedListeners(t,{click:e=>{if(Le(e),this.eCheckbox.isDisabled())return;const t=this.eCheckbox.getValue();this.onCheckboxChanged(t)},dblclick:e=>{Le(e)}}),this.addManagedElementListeners(this.params.eGridCell,{keydown:e=>{if(e.key===Tr.SPACE&&!this.eCheckbox.isDisabled()){this.params.eGridCell===Z(this.gos)&&this.eCheckbox.toggle();const t=this.eCheckbox.getValue();this.onCheckboxChanged(t),e.preventDefault()}}})}refresh(e){return this.params=e,this.updateCheckbox(e),!0}updateCheckbox(e){var t;let i,r=!0;var n;if(e.node.group&&e.column)if("boolean"===typeof e.value)i=e.value;else{const t=e.column.getColId();if(t.startsWith(Ue))i=null==e.value||""===e.value?void 0:"true"===e.value;else if(e.node.aggData&&void 0!==e.node.aggData[t]){var o;i=null!==(o=e.value)&&void 0!==o?o:void 0}else r=!1}else i=null!==(n=e.value)&&void 0!==n?n:void 0;if(!r)return void this.eCheckbox.setDisplayed(!1);this.eCheckbox.setValue(i);const s=null!=e.disabled?e.disabled:!(null!==(t=e.column)&&void 0!==t&&t.isCellEditable(e.node));this.eCheckbox.setDisabled(s);const a=this.localeService.getLocaleTextFunc(),l=yi(a,i),c=s?l:"".concat(a("ariaToggleCellValue","Press SPACE to toggle cell value")," (").concat(l,")");this.eCheckbox.setInputAriaLabel(c)}onCheckboxChanged(e){const{column:t,node:i,value:r}=this.params;this.eventService.dispatchEvent({type:"cellEditingStarted",column:t,colDef:null===t||void 0===t?void 0:t.getColDef(),data:i.data,node:i,rowIndex:i.rowIndex,rowPinned:i.rowPinned,value:r});const n=this.params.node.setDataValue(this.params.column,e,"edit");this.eventService.dispatchEvent({type:"cellEditingStopped",column:t,colDef:null===t||void 0===t?void 0:t.getColDef(),data:i.data,node:i,rowIndex:i.rowIndex,rowPinned:i.rowPinned,value:r,oldValue:r,newValue:e,valueChanged:n}),n||this.updateCheckbox(this.params)}},Ir=class extends dr{constructor(){super('<div class="ag-loading">\n            <span class="ag-loading-icon" data-ref="eLoadingIcon"></span>\n            <span class="ag-loading-text" data-ref="eLoadingText"></span>\n        </div>'),this.eLoadingIcon=ur,this.eLoadingText=ur}init(e){e.node.failedLoad?this.setupFailed():this.setupLoading()}setupFailed(){const e=this.localeService.getLocaleTextFunc();this.eLoadingText.innerText=e("loadingError","ERR")}setupLoading(){const e=pr("groupLoading",this.gos,null);e&&this.eLoadingIcon.appendChild(e);const t=this.localeService.getLocaleTextFunc();this.eLoadingText.innerText=t("loadingOoo","Loading")}refresh(e){return!1}destroy(){super.destroy()}},Lr=class extends dr{constructor(){super('<div class="ag-skeleton-container"></div>')}init(e){const t="ag-cell-skeleton-renderer-".concat(this.getCompId());this.getGui().setAttribute("id",t),this.addDestroyFunc((()=>di(e.eParentOfValue))),di(e.eParentOfValue,t),e.node.failedLoad?this.setupFailed():this.setupLoading(e)}setupFailed(){const e=this.localeService.getLocaleTextFunc();this.getGui().innerText=e("loadingError","ERR");const t=e("ariaSkeletonCellLoadingFailed","Row failed to load");ui(this.getGui(),t)}setupLoading(e){const t=Q(this.gos).createElement("div");t.classList.add("ag-skeleton-effect");const i=e.node.rowIndex;if(null!=i){const e=75+25*(i%2===0?Math.sin(i):Math.cos(i));t.style.width="".concat(e,"%")}this.getGui().appendChild(t);const r=this.localeService.getLocaleTextFunc()("ariaSkeletonCellLoading","Row data is loading");ui(this.getGui(),r)}refresh(e){return!1}destroy(){super.destroy()}},Or=class extends dr{constructor(){super()}destroy(){super.destroy()}},Nr=class extends Or{init(){var e;const t=T(null===(e=this.gos.get("overlayLoadingTemplate"))||void 0===e?void 0:e.trim());if(this.setTemplate(null!==t&&void 0!==t?t:'<span aria-live="polite" aria-atomic="true" class="ag-overlay-loading-center"></span>'),!t){const e=this.localeService.getLocaleTextFunc();setTimeout((()=>{this.getGui().textContent=e("loadingOoo","Loading...")}))}}},Br=class extends Or{init(){var e;const t=T(null===(e=this.gos.get("overlayNoRowsTemplate"))||void 0===e?void 0:e.trim());if(this.setTemplate(null!==t&&void 0!==t?t:'<span class="ag-overlay-no-rows-center"></span>'),!t){const e=this.localeService.getLocaleTextFunc();setTimeout((()=>{this.getGui().textContent=e("noRowsToShow","No Rows To Show")}))}}},Gr=class extends dr{isPopup(){return!0}setParentComponent(e){e.addCssClass("ag-has-popup"),super.setParentComponent(e)}destroy(){const e=this.parentComponent;e&&e.isAlive()&&e.getGui().classList.remove("ag-has-popup"),super.destroy()}},Hr=class extends Gr{constructor(){super('<div class="ag-tooltip"></div>')}init(e){const{value:t}=e;this.getGui().textContent=Pt(t,!0)}};function zr(e){const{inputValue:t,allSuggestions:i,hideIrrelevant:r,filterByPercentageOfBestMatch:n,addSequentialWeight:o}=e;let s=i.map(((e,i)=>({value:e,relevance:Vr(t.toLowerCase(),e.toLocaleLowerCase(),o),idx:i})));if(s.sort(((e,t)=>t.relevance-e.relevance)),r&&(s=s.filter((e=>0!==e.relevance))),s.length>0&&n&&n>0){const e=s[0].relevance*n;s=s.filter((t=>e-t.relevance<0))}const a=[],l=[];for(const c of s)a.push(c.value),l.push(c.idx);return{values:a,indices:l}}function Vr(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=e.replace(/\s/g,""),n=t.replace(/\s/g,""),o=r.length,s=n.length,a=new Array(o+1).fill(null).map((()=>new Array(s+1).fill(0)));for(let u=0;u<=o;u+=1)a[u][0]=u;for(let u=0;u<=s;u+=1)a[0][u]=u;for(let u=1;u<=o;u++)for(let e=1;e<=s;e++)r[u-1]===n[e-1]?a[u][e]=a[u-1][e-1]:a[u][e]=1+Math.min(a[u][e-1],Math.min(a[u-1][e],a[u-1][e-1]));const l=a[o][s];let c=Math.max(o,s)-l;if(i){const e=function(e){const t=[],i=e.length;for(let r=1;r<=i;r++)for(let n=0;n<=i-r;n++){const i=n+r-1;t.push(e.slice(n,i+1))}return t}(r);for(let t=0;t<e.length;t++){const i=e[t];-1!==n.indexOf(i)&&(c+=1,c*=i.length)}}return c}var _r=class extends He{constructor(){super(...arguments),this.beanName="userComponentRegistry",this.agGridDefaults={agDragAndDropImage:fr,agColumnHeader:yr,agColumnGroupHeader:Rr,agSortIndicator:br,agAnimateShowChangeCellRenderer:Er,agAnimateSlideCellRenderer:xr,agLoadingCellRenderer:Ir,agSkeletonCellRenderer:Lr,agCheckboxCellRenderer:Mr,agLoadingOverlay:Nr,agNoRowsOverlay:Br,agTooltipComponent:Hr},this.agGridDefaultParams={},this.enterpriseAgDefaultCompsModule={agSetColumnFilter:"@ag-grid-enterprise/set-filter",agSetColumnFloatingFilter:"@ag-grid-enterprise/set-filter",agMultiColumnFilter:"@ag-grid-enterprise/multi-filter",agMultiColumnFloatingFilter:"@ag-grid-enterprise/multi-filter",agGroupColumnFilter:"@ag-grid-enterprise/row-grouping",agGroupColumnFloatingFilter:"@ag-grid-enterprise/row-grouping",agGroupCellRenderer:"@ag-grid-enterprise/row-grouping",agGroupRowRenderer:"@ag-grid-enterprise/row-grouping",agRichSelect:"@ag-grid-enterprise/rich-select",agRichSelectCellEditor:"@ag-grid-enterprise/rich-select",agDetailCellRenderer:"@ag-grid-enterprise/master-detail",agSparklineCellRenderer:"@ag-grid-enterprise/sparklines"},this.jsComps={}}postConstruct(){const e=this.gos.get("components");null!=e&&Ze(e,((e,t)=>this.registerJsComponent(e,t)))}registerDefaultComponent(e,t,i){this.agGridDefaults[e]=t,i&&(this.agGridDefaultParams[e]=i)}registerJsComponent(e,t){this.jsComps[e]=t}retrieve(e,t){const i=(e,t,i)=>({componentFromFramework:t,component:e,params:i}),r=this.getFrameworkOverrides().frameworkComponent(t,this.gos.get("components"));if(null!=r)return i(r,!0);const n=this.jsComps[t];if(n){return i(n,this.getFrameworkOverrides().isFrameworkComponent(n))}const o=this.agGridDefaults[t];if(o)return i(o,!1,this.agGridDefaultParams[t]);const s=this.enterpriseAgDefaultCompsModule[t];return s?this.gos.assertModuleRegistered(s,"AG Grid '".concat(e,"' component: ").concat(t)):f((()=>{this.warnAboutMissingComponent(e,t)}),"MissingComp"+t),null}warnAboutMissingComponent(e,t){const i=zr({inputValue:t,allSuggestions:[...Object.keys(this.agGridDefaults).filter((e=>!["agCellEditor","agGroupRowRenderer","agSortIndicator"].includes(e))),...Object.keys(this.jsComps)],hideIrrelevant:!0,filterByPercentageOfBestMatch:.8}).values;v("Could not find '".concat(t,"' component. It was configured as \"").concat(e,": '").concat(t,"'\" but it wasn't found in the list of registered components.")),i.length>0&&v("         Did you mean: [".concat(i.slice(0,3),"]?")),v("If using a custom component check it has been registered as described in: ".concat(this.getFrameworkOverrides().getDocLink("components/")))}},Wr=class e{constructor(e){this.status=0,this.resolution=null,this.waiters=[],e((e=>this.onDone(e)),(e=>this.onReject(e)))}static all(t){return t.length?new e((e=>{let i=t.length;const r=new Array(i);t.forEach(((t,n)=>{t.then((t=>{r[n]=t,i--,0===i&&e(r)}))}))})):e.resolve()}static resolve(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return new e((e=>e(t)))}then(t){return new e((e=>{1===this.status?e(t(this.resolution)):this.waiters.push((i=>e(t(i))))}))}onDone(e){this.status=1,this.resolution=e,this.waiters.forEach((t=>t(e)))}onReject(e){}},Ur={propertyName:"dateComponent",cellRenderer:!1},jr={propertyName:"dragAndDropImageComponent",cellRenderer:!1},Kr={propertyName:"headerComponent",cellRenderer:!1},Yr={propertyName:"headerGroupComponent",cellRenderer:!1},qr={propertyName:"cellRenderer",cellRenderer:!0},Qr={propertyName:"cellRenderer",cellRenderer:!1},$r={propertyName:"loadingCellRenderer",cellRenderer:!0},Xr={propertyName:"cellEditor",cellRenderer:!1},Jr={propertyName:"innerRenderer",cellRenderer:!0},Zr={propertyName:"loadingOverlayComponent",cellRenderer:!1},en={propertyName:"noRowsOverlayComponent",cellRenderer:!1},tn={propertyName:"tooltipComponent",cellRenderer:!1},rn={propertyName:"filter",cellRenderer:!1},nn={propertyName:"floatingFilterComponent",cellRenderer:!1},on={propertyName:"toolPanel",cellRenderer:!1},sn={propertyName:"statusPanel",cellRenderer:!1},an={propertyName:"fullWidthCellRenderer",cellRenderer:!0},ln={propertyName:"loadingCellRenderer",cellRenderer:!0},cn={propertyName:"groupRowRenderer",cellRenderer:!0},un={propertyName:"detailCellRenderer",cellRenderer:!0},dn={propertyName:"menuItem",cellRenderer:!1},hn=class e extends He{constructor(){super(...arguments),this.beanName="userComponentFactory"}wireBeans(e){this.agComponentUtils=e.agComponentUtils,this.componentMetadataProvider=e.componentMetadataProvider,this.userComponentRegistry=e.userComponentRegistry,this.frameworkComponentWrapper=e.frameworkComponentWrapper,this.gridOptions=e.gridOptions}getDragAndDropImageCompDetails(e){return this.getCompDetails(this.gridOptions,jr,"agDragAndDropImage",e,!0)}getHeaderCompDetails(e,t){return this.getCompDetails(e,Kr,"agColumnHeader",t)}getHeaderGroupCompDetails(e){const t=e.columnGroup.getColGroupDef();return this.getCompDetails(t,Yr,"agColumnGroupHeader",e)}getFullWidthCellRendererDetails(e){return this.getCompDetails(this.gridOptions,an,null,e,!0)}getFullWidthLoadingCellRendererDetails(e){return this.getCompDetails(this.gridOptions,ln,"agLoadingCellRenderer",e,!0)}getFullWidthGroupCellRendererDetails(e){return this.getCompDetails(this.gridOptions,cn,"agGroupRowRenderer",e,!0)}getFullWidthDetailCellRendererDetails(e){return this.getCompDetails(this.gridOptions,un,"agDetailCellRenderer",e,!0)}getInnerRendererDetails(e,t){return this.getCompDetails(e,Jr,null,t)}getFullWidthGroupRowInnerCellRenderer(e,t){return this.getCompDetails(e,Jr,null,t)}getCellRendererDetails(e,t){return this.getCompDetails(e,qr,null,t)}getEditorRendererDetails(e,t){return this.getCompDetails(e,Qr,null,t)}getLoadingCellRendererDetails(e,t){return this.getCompDetails(e,$r,"agSkeletonCellRenderer",t,!0)}getCellEditorDetails(e,t){return this.getCompDetails(e,Xr,"agCellEditor",t,!0)}getFilterDetails(e,t,i){return this.getCompDetails(e,rn,i,t,!0)}getDateCompDetails(e){return this.getCompDetails(this.gridOptions,Ur,"agDateInput",e,!0)}getLoadingOverlayCompDetails(e){return this.getCompDetails(this.gridOptions,Zr,"agLoadingOverlay",e,!0)}getNoRowsOverlayCompDetails(e){return this.getCompDetails(this.gridOptions,en,"agNoRowsOverlay",e,!0)}getTooltipCompDetails(e){return this.getCompDetails(e.colDef,tn,"agTooltipComponent",e,!0)}getSetFilterCellRendererDetails(e,t){return this.getCompDetails(e,qr,null,t)}getFloatingFilterCompDetails(e,t,i){return this.getCompDetails(e,nn,i,t)}getToolPanelCompDetails(e,t){return this.getCompDetails(e,on,null,t,!0)}getStatusPanelCompDetails(e,t){return this.getCompDetails(e,sn,null,t,!0)}getMenuItemCompDetails(e,t){return this.getCompDetails(e,dn,"agMenuItem",t,!0)}getCompDetails(t,i,r,n){let o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const{propertyName:s,cellRenderer:a}=i;let l,{compName:c,jsComp:u,fwComp:d,paramsFromSelector:h,popupFromSelector:g,popupPositionFromSelector:p}=e.getCompKeys(this.frameworkOverrides,t,i,n);const f=e=>{const t=this.userComponentRegistry.retrieve(s,e);t&&(u=t.componentFromFramework?void 0:t.component,d=t.componentFromFramework?t.component:void 0,l=t.params)};if(null!=c&&f(c),null==u&&null==d&&null!=r&&f(r),u&&a&&!this.agComponentUtils.doesImplementIComponent(u)&&(u=this.agComponentUtils.adaptFunction(s,u)),!u&&!d)return void(o&&C("Could not find component ".concat(c,", did you forget to configure this component?")));const m=this.mergeParamsWithApplicationProvidedParams(t,i,n,h,l),v=null==u,w=u||d;return{componentFromFramework:v,componentClass:w,params:m,type:i,popupFromSelector:g,popupPositionFromSelector:p,newAgStackInstance:()=>this.newAgStackInstance(w,v,m,i)}}static getCompKeys(e,t,i,r){const{propertyName:n}=i;let o,s,a,l,c,u;if(t){const i=t,d=i[n+"Selector"],h=d?d(r):null,g=t=>{if("string"===typeof t)o=t;else if(null!=t&&!0!==t){e.isFrameworkComponent(t)?a=t:s=t}};h?(g(h.component),l=h.params,c=h.popup,u=h.popupPosition):g(i[n])}return{compName:o,jsComp:s,fwComp:a,paramsFromSelector:l,popupFromSelector:c,popupPositionFromSelector:u}}newAgStackInstance(e,t,i,r){const n=r.propertyName;let o;if(!t)o=new e;else{const t=this.componentMetadataProvider.retrieve(n);o=this.frameworkComponentWrapper.wrap(e,t.mandatoryMethodList,t.optionalMethodList,r)}const s=this.initComponent(o,i);return null==s?Wr.resolve(o):s.then((()=>o))}mergeParamsWithApplicationProvidedParams(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=arguments.length>4?arguments[4]:void 0;const o=this.gos.getGridCommonParams();rt(o,i),n&&rt(o,n);const s=e&&e[t.propertyName+"Params"];if("function"===typeof s){rt(o,s(i))}else"object"===typeof s&&rt(o,s);return rt(o,r),o}initComponent(e,t){if(this.createBean(e),null!=e.init)return e.init(t)}};function gn(e){const t=e;return null!=t&&null!=t.getFrameworkComponentInstance?t.getFrameworkComponentInstance():e}var pn=class e{static register(t){e.__register(t,!0,void 0)}static registerModules(t){e.__registerModules(t,!0,void 0)}static __register(t,i,r){e.runVersionChecks(t),void 0!==r?(e.areGridScopedModules=!0,void 0===e.gridModulesMap[r]&&(e.gridModulesMap[r]={}),e.gridModulesMap[r][t.moduleName]=t):e.globalModulesMap[t.moduleName]=t,e.setModuleBased(i)}static __unRegisterGridModules(t){delete e.gridModulesMap[t]}static __registerModules(t,i,r){e.setModuleBased(i),t&&t.forEach((t=>e.__register(t,i,r)))}static isValidModuleVersion(t){const[i,r]=t.version.split(".")||[],[n,o]=e.currentModuleVersion.split(".")||[];return i===n&&r===o}static runVersionChecks(t){e.currentModuleVersion||(e.currentModuleVersion=t.version);const i=e=>"You are using incompatible versions of AG Grid modules. Major and minor versions should always match across modules. ".concat(e," Please update all modules to the same version.");if(t.version?e.isValidModuleVersion(t)||C(i("'".concat(t.moduleName,"' is version ").concat(t.version," but the other modules are version ").concat(e.currentModuleVersion,"."))):C(i("'".concat(t.moduleName,"' is incompatible."))),t.validate){const e=t.validate();if(!e.isValid){C("".concat(e.message))}}}static setModuleBased(t){void 0===e.moduleBased?e.moduleBased=t:e.moduleBased!==t&&(C("AG Grid: You are mixing modules (i.e. @ag-grid-community/core) and packages (ag-grid-community) - you can only use one or the other of these mechanisms."),C("Please see https://www.ag-grid.com/javascript-grid/modules/ for more information."))}static __setIsBundled(){e.isBundled=!0}static __assertRegistered(t,i,r){if(this.__isRegistered(t,r))return!0;let n;if(e.isBundled)n="AG Grid: unable to use ".concat(i," as 'ag-grid-enterprise' has not been loaded. Check you are using the Enterprise bundle:\n        \n        <script src=\"https://cdn.jsdelivr.net/npm/ag-grid-enterprise@AG_GRID_VERSION/dist/ag-grid-enterprise.min.js\"><\/script>\n        \nFor more info see: https://ag-grid.com/javascript-data-grid/getting-started/#getting-started-with-ag-grid-enterprise");else if(e.moduleBased||void 0===e.moduleBased){var o;const s=null===(o=Object.entries(g).find((e=>{let[i,r]=e;return r===t})))||void 0===o?void 0:o[0];n="AG Grid: unable to use ".concat(i," as the ").concat(s," is not registered").concat(e.areGridScopedModules?" for gridId: ".concat(r):"",". Check if you have registered the module:\n           \n    import { ModuleRegistry } from '@ag-grid-community/core';\n    import { ").concat(s," } from '").concat(t,"';\n    \n    ModuleRegistry.registerModules([ ").concat(s," ]);\n\nFor more info see: https://www.ag-grid.com/javascript-grid/modules/")}else n="AG Grid: unable to use ".concat(i," as package 'ag-grid-enterprise' has not been imported. Check that you have imported the package:\n            \n    import 'ag-grid-enterprise';");return C(n),!1}static __isRegistered(t,i){var r;return!!e.globalModulesMap[t]||!(null===(r=e.gridModulesMap[i])||void 0===r||!r[t])}static __getRegisteredModules(t){return[...N(e.globalModulesMap),...N(e.gridModulesMap[t]||{})]}static __getGridRegisteredModules(t){var i;return N(null!==(i=e.gridModulesMap[t])&&void 0!==i?i:{})||[]}static __isPackageBased(){return!e.moduleBased}};pn.globalModulesMap={},pn.gridModulesMap={},pn.areGridScopedModules=!1;var fn=pn,mn=class{constructor(e){this.beans={},this.createdBeans=[],this.destroyed=!1,e&&e.beanClasses&&(this.beanDestroyComparator=e.beanDestroyComparator,this.init(e))}init(e){var t;Object.entries(e.providedBeanInstances).forEach((e=>{let[t,i]=e;this.beans[t]=i})),e.beanClasses.forEach((e=>{const t=new e;t.beanName?this.beans[t.beanName]=t:console.error("Bean ".concat(e.name," is missing beanName")),this.createdBeans.push(t)})),null===(t=e.derivedBeans)||void 0===t||t.forEach((e=>{const{beanName:t,bean:i}=e(this);this.beans[t]=i,this.createdBeans.push(i)})),e.beanInitComparator&&this.createdBeans.sort(e.beanInitComparator),this.initBeans(this.createdBeans)}getBeanInstances(){return Object.values(this.beans)}createBean(e,t){if(!e)throw Error("Can't wire to bean since it is null");return this.initBeans([e],t),e}initBeans(e,t){e.forEach((e=>{var t,i;null===(t=e.preWireBeans)||void 0===t||t.call(e,this.beans),null===(i=e.wireBeans)||void 0===i||i.call(e,this.beans)})),e.forEach((e=>{var t;return null===(t=e.preConstruct)||void 0===t?void 0:t.call(e)})),t&&e.forEach(t),e.forEach((e=>{var t;return null===(t=e.postConstruct)||void 0===t?void 0:t.call(e)}))}getBeans(){return this.beans}getBean(e){return this.beans[e]}destroy(){if(this.destroyed)return;this.destroyed=!0;const e=this.getBeanInstances();this.beanDestroyComparator&&e.sort(this.beanDestroyComparator),this.destroyBeans(e),this.beans={},this.createdBeans=[]}destroyBean(e){var t;null===e||void 0===e||null===(t=e.destroy)||void 0===t||t.call(e)}destroyBeans(e){if(e)for(let t=0;t<e.length;t++)this.destroyBean(e[t]);return[]}isDestroyed(){return this.destroyed}},vn=class extends mn{init(e){this.gridId=e.gridId,this.beans.context=this,super.init(e)}destroy(){super.destroy(),fn.__unRegisterGridModules(this.gridId)}getGridId(){return this.gridId}},Cn=(e=>(e[e.Left=0]="Left",e[e.Right=1]="Right",e))(Cn||{}),wn=class extends He{constructor(){super(...arguments),this.beanName="dragAndDropService",this.dragSourceAndParamsList=[],this.dropTargets=[]}wireBeans(e){this.ctrlsService=e.ctrlsService,this.dragService=e.dragService,this.mouseEventService=e.mouseEventService,this.environment=e.environment,this.userComponentFactory=e.userComponentFactory}addDragSource(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i={eElement:e.eElement,dragStartPixels:e.dragStartPixels,onDragStart:this.onDragStart.bind(this,e),onDragStop:this.onDragStop.bind(this),onDragging:this.onDragging.bind(this),onDragCancel:this.onDragCancel.bind(this),includeTouch:t};this.dragSourceAndParamsList.push({params:i,dragSource:e}),this.dragService.addDragSource(i)}getDragAndDropImageComponent(){const{dragAndDropImageComp:e}=this;return e&&e.comp?e.comp:null}removeDragSource(e){const t=this.dragSourceAndParamsList.find((t=>t.dragSource===e));t&&(this.dragService.removeDragSource(t.params),xe(this.dragSourceAndParamsList,t))}destroy(){this.dragSourceAndParamsList.forEach((e=>this.dragService.removeDragSource(e.params))),this.dragSourceAndParamsList.length=0,this.dropTargets.length=0,this.clearDragAndDropProperties(),super.destroy()}nudge(){this.dragging&&this.onDragging(this.eventLastTime,!0)}onDragStart(e,t){var i,r;this.dragging=!0,this.dragSource=e,this.eventLastTime=t,this.dragItem=this.dragSource.getDragItem(),null===(i=(r=this.dragSource).onDragStarted)||void 0===i||i.call(r),this.createDragAndDropImageComponent()}onDragStop(e){var t,i,r;if(null===(t=this.dragSource)||void 0===t||null===(i=t.onDragStopped)||void 0===i||i.call(t),null!==(r=this.lastDropTarget)&&void 0!==r&&r.onDragStop){const t=this.createDropTargetEvent(this.lastDropTarget,e,null,null,!1);this.lastDropTarget.onDragStop(t)}this.clearDragAndDropProperties()}onDragCancel(){var e,t,i;null===(e=this.dragSource)||void 0===e||null===(t=e.onDragCancelled)||void 0===t||t.call(e),null!==(i=this.lastDropTarget)&&void 0!==i&&i.onDragCancel&&this.lastDropTarget.onDragCancel(this.createDropTargetEvent(this.lastDropTarget,this.eventLastTime,null,null,!1)),this.clearDragAndDropProperties()}clearDragAndDropProperties(){this.eventLastTime=null,this.dragging=!1,this.lastDropTarget=void 0,this.dragItem=null,this.dragSource=null,this.removeDragAndDropImageComponent()}onDragging(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i=this.getHorizontalDirection(e),r=this.getVerticalDirection(e);this.eventLastTime=e,this.positionDragAndDropImageComp(e);const n=this.dropTargets.filter((t=>this.isMouseOnDropTarget(e,t))),o=this.findCurrentDropTarget(e,n);if(o!==this.lastDropTarget){var s,a,l,c;if(this.leaveLastTargetIfExists(e,i,r,t),null!==this.lastDropTarget&&null===o)null===(s=this.dragSource)||void 0===s||null===(a=s.onGridExit)||void 0===a||a.call(s,this.dragItem);if(null===this.lastDropTarget&&null!==o)null===(l=this.dragSource)||void 0===l||null===(c=l.onGridEnter)||void 0===c||c.call(l,this.dragItem);if(this.enterDragTargetIfExists(o,e,i,r,t),o&&this.dragAndDropImageComp){const{comp:e,promise:t}=this.dragAndDropImageComp;e?e.setIcon(o.getIconName?o.getIconName():null):t.then((e=>{e&&e.setIcon(o.getIconName?o.getIconName():null)}))}this.lastDropTarget=o}else if(o&&o.onDragging){const n=this.createDropTargetEvent(o,e,i,r,t);o.onDragging(n)}}getAllContainersFromDropTarget(e){const t=e.getSecondaryContainers?e.getSecondaryContainers():null,i=[[e.getContainer()]];return t?i.concat(t):i}allContainersIntersect(e,t){for(const i of t){const{width:t,height:r,left:n,right:o,top:s,bottom:a}=i.getBoundingClientRect();if(0===t||0===r)return!1;const l=e.clientX>=n&&e.clientX<o,c=e.clientY>=s&&e.clientY<a;if(!l||!c)return!1}return!0}isMouseOnDropTarget(e,t){const i=this.getAllContainersFromDropTarget(t);let r=!1;for(const s of i)if(this.allContainersIntersect(e,s)){r=!0;break}const{eElement:n,type:o}=this.dragSource;return!(t.targetContainsSource&&!t.getContainer().contains(n))&&(r&&t.isInterestedIn(o,n))}findCurrentDropTarget(e,t){const i=t.length;if(0===i)return null;if(1===i)return t[0];const r=J(this.gos).elementsFromPoint(e.clientX,e.clientY);for(const n of r)for(const e of t){if(-1!==De(this.getAllContainersFromDropTarget(e)).indexOf(n))return e}return null}enterDragTargetIfExists(e,t,i,r,n){if(e&&e.onDragEnter){const o=this.createDropTargetEvent(e,t,i,r,n);e.onDragEnter(o)}}leaveLastTargetIfExists(e,t,i,r){if(!this.lastDropTarget)return;if(this.lastDropTarget.onDragLeave){const n=this.createDropTargetEvent(this.lastDropTarget,e,t,i,r);this.lastDropTarget.onDragLeave(n)}const n=this.getDragAndDropImageComponent();n&&n.setIcon(null)}addDropTarget(e){this.dropTargets.push(e)}removeDropTarget(e){this.dropTargets=this.dropTargets.filter((t=>t.getContainer()!==e.getContainer()))}hasExternalDropZones(){return this.dropTargets.some((e=>e.external))}findExternalZone(e){return this.dropTargets.filter((e=>e.external)).find((t=>t.getContainer()===e.getContainer()))||null}isDropZoneWithinThisGrid(e){const t=this.ctrlsService.getGridBodyCtrl().getGui(),{dropZoneTarget:i}=e;return t.contains(i)}getHorizontalDirection(e){const t=this.eventLastTime&&this.eventLastTime.clientX,i=e.clientX;return t===i?null:t>i?0:1}getVerticalDirection(e){const t=this.eventLastTime&&this.eventLastTime.clientY,i=e.clientY;return t===i?null:t>i?0:1}createDropTargetEvent(e,t,i,r,n){const o=e.getContainer(),s=o.getBoundingClientRect(),{dragItem:a,dragSource:l}=this,c=t.clientX-s.left,u=t.clientY-s.top;return this.gos.addGridCommonParams({event:t,x:c,y:u,vDirection:r,hDirection:i,dragSource:l,fromNudge:n,dragItem:a,dropZoneTarget:o})}positionDragAndDropImageComp(e){const t=this.getDragAndDropImageComponent();if(!t)return;const i=t.getGui(),r=i.getBoundingClientRect().height,n=function(){var e,t,i;return null!==(e=null===(t=document.body)||void 0===t?void 0:t.clientWidth)&&void 0!==e?e:window.innerHeight||(null===(i=document.documentElement)||void 0===i?void 0:i.clientWidth)||-1}()-2,o=function(){var e,t,i;return null!==(e=null===(t=document.body)||void 0===t?void 0:t.clientHeight)&&void 0!==e?e:window.innerHeight||(null===(i=document.documentElement)||void 0===i?void 0:i.clientHeight)||-1}()-2;if(!i.offsetParent)return;const s=Wi(i.offsetParent),{clientY:a,clientX:l}=e;let c=a-s.top-r/2,u=l-s.left-10;const d=Q(this.gos),h=d.defaultView||window,g=h.pageYOffset||d.documentElement.scrollTop,p=h.pageXOffset||d.documentElement.scrollLeft;n>0&&u+i.clientWidth>n+p&&(u=n+p-i.clientWidth),u<0&&(u=0),o>0&&c+i.clientHeight>o+g&&(c=o+g-i.clientHeight),c<0&&(c=0),i.style.left="".concat(u,"px"),i.style.top="".concat(c,"px")}removeDragAndDropImageComponent(){if(this.dragAndDropImageComp){const{comp:e}=this.dragAndDropImageComp;if(e){const t=e.getGui();this.dragAndDropImageParent&&this.dragAndDropImageParent.removeChild(t),this.destroyBean(e)}}this.dragAndDropImageComp=null}createDragAndDropImageComponent(){const{dragSource:e}=this;if(!e)return;const t=this.userComponentFactory.getDragAndDropImageCompDetails({dragSource:e}).newAgStackInstance();this.dragAndDropImageComp={promise:t},t.then((e=>{e&&this.isAlive()&&(this.processDragAndDropImageComponent(e),this.dragAndDropImageComp.comp=e)}))}processDragAndDropImageComponent(e){const{dragSource:t,mouseEventService:i,environment:r}=this;if(!t)return;const n=e.getGui();n.style.setProperty("position","absolute"),n.style.setProperty("z-index","9999"),i.stampTopLevelGridCompWithGridInstance(n),r.applyThemeClasses(n),e.setIcon(null);let{dragItemName:o}=t;w(o)&&(o=o()),e.setLabel(o||""),n.style.top="20px",n.style.left="20px";const s=Q(this.gos);let a=null,l=null;try{a=s.fullscreenElement}catch(u){}finally{a||(a=J(this.gos));const e=a.querySelector("body");if(e)l=e;else if(a instanceof ShadowRoot)l=a;else if(a instanceof Document){var c;l=null===(c=a)||void 0===c?void 0:c.documentElement}else l=a}this.dragAndDropImageParent=l,l?l.appendChild(n):v("Could not find document body, it is needed for drag and drop.")}},bn=class{constructor(e){this.tickingInterval=null,this.onScrollCallback=null,this.scrollContainer=e.scrollContainer,this.scrollHorizontally=-1!==e.scrollAxis.indexOf("x"),this.scrollVertically=-1!==e.scrollAxis.indexOf("y"),this.scrollByTick=null!=e.scrollByTick?e.scrollByTick:20,e.onScrollCallback&&(this.onScrollCallback=e.onScrollCallback),this.scrollVertically&&(this.getVerticalPosition=e.getVerticalPosition,this.setVerticalPosition=e.setVerticalPosition),this.scrollHorizontally&&(this.getHorizontalPosition=e.getHorizontalPosition,this.setHorizontalPosition=e.setHorizontalPosition),this.shouldSkipVerticalScroll=e.shouldSkipVerticalScroll||(()=>!1),this.shouldSkipHorizontalScroll=e.shouldSkipHorizontalScroll||(()=>!1)}check(e){const t=arguments.length>1&&void 0!==arguments[1]&&arguments[1]||this.shouldSkipVerticalScroll();if(t&&this.shouldSkipHorizontalScroll())return;const i=this.scrollContainer.getBoundingClientRect(),r=this.scrollByTick;this.tickLeft=e.clientX<i.left+r,this.tickRight=e.clientX>i.right-r,this.tickUp=e.clientY<i.top+r&&!t,this.tickDown=e.clientY>i.bottom-r&&!t,this.tickLeft||this.tickRight||this.tickUp||this.tickDown?this.ensureTickingStarted():this.ensureCleared()}ensureTickingStarted(){null===this.tickingInterval&&(this.tickingInterval=window.setInterval(this.doTick.bind(this),100),this.tickCount=0)}doTick(){this.tickCount++;const e=this.tickCount>20?200:this.tickCount>10?80:40;if(this.scrollVertically){const t=this.getVerticalPosition();this.tickUp&&this.setVerticalPosition(t-e),this.tickDown&&this.setVerticalPosition(t+e)}if(this.scrollHorizontally){const t=this.getHorizontalPosition();this.tickLeft&&this.setHorizontalPosition(t-e),this.tickRight&&this.setHorizontalPosition(t+e)}this.onScrollCallback&&this.onScrollCallback()}ensureCleared(){this.tickingInterval&&(window.clearInterval(this.tickingInterval),this.tickingInterval=null)}},Sn=class extends He{wireBeans(e){this.dragAndDropService=e.dragAndDropService,this.rowModel=e.rowModel,this.pageBoundsService=e.pageBoundsService,this.focusService=e.focusService,this.sortController=e.sortController,this.filterManager=e.filterManager,this.selectionService=e.selectionService,this.mouseEventService=e.mouseEventService,this.ctrlsService=e.ctrlsService,this.funcColsService=e.funcColsService,this.rangeService=e.rangeService}constructor(e){super(),this.eContainer=e}postConstruct(){G(this.gos)&&(this.clientSideRowModel=this.rowModel),this.ctrlsService.whenReady(this,(e=>{const t=e.gridBodyCtrl;this.autoScrollService=new bn({scrollContainer:t.getBodyViewportElement(),scrollAxis:"y",getVerticalPosition:()=>t.getScrollFeature().getVScrollPosition().top,setVerticalPosition:e=>t.getScrollFeature().setVerticalScrollPosition(e),onScrollCallback:()=>{this.onDragging(this.lastDraggingEvent)}})}))}getContainer(){return this.eContainer}isInterestedIn(e){return 2===e}getIconName(){return this.gos.get("rowDragManaged")&&this.shouldPreventRowMove()?"notAllowed":"move"}shouldPreventRowMove(){var e;if(this.funcColsService.getRowGroupColumns().length)return!0;if(null===(e=this.filterManager)||void 0===e?void 0:e.isAnyFilterPresent())return!0;return!!this.sortController.isSortActive()}getRowNodes(e){if(!this.isFromThisGrid(e))return e.dragItem.rowNodes||[];const t=e.dragItem.rowNode;if(this.gos.get("rowDragMultiRow")){const e=[...this.selectionService.getSelectedNodes()].sort(((e,t)=>null==e.rowIndex||null==t.rowIndex?0:this.getRowIndexNumber(e)-this.getRowIndexNumber(t)));if(-1!==e.indexOf(t))return e}return[t]}onDragEnter(e){e.dragItem.rowNodes=this.getRowNodes(e),this.dispatchGridEvent("rowDragEnter",e),this.getRowNodes(e).forEach((e=>{e.setDragging(!0)})),this.onEnterOrDragging(e)}onDragging(e){this.onEnterOrDragging(e)}isFromThisGrid(e){const{dragSourceDomDataKey:t}=e.dragSource;return t===this.gos.getDomDataKey()}onEnterOrDragging(e){this.dispatchGridEvent("rowDragMove",e),this.lastDraggingEvent=e;const t=this.mouseEventService.getNormalisedPosition(e).y;this.gos.get("rowDragManaged")&&this.doManagedDrag(e,t),this.autoScrollService.check(e.event)}doManagedDrag(e,t){const i=this.isFromThisGrid(e),r=this.gos.get("rowDragManaged"),n=e.dragItem.rowNodes;r&&this.shouldPreventRowMove()||(this.gos.get("suppressMoveWhenRowDragging")||!i?this.dragAndDropService.isDropZoneWithinThisGrid(e)&&this.clientSideRowModel.highlightRowAtPixel(n[0],t):this.moveRows(n,t))}getRowIndexNumber(e){const t=e.getRowIndexString();return parseInt(ye(t.split("-")),10)}moveRowAndClearHighlight(e){const t=this.clientSideRowModel.getLastHighlightedRowNode(),i=t&&1===t.highlighted,r=this.mouseEventService.getNormalisedPosition(e).y,n=e.dragItem.rowNodes;let o=i?1:0;if(this.isFromThisGrid(e))n.forEach((e=>{e.rowTop<r&&(o-=1)})),this.moveRows(n,r,o);else{const e=ce(this.gos);let t=this.clientSideRowModel.getRowIndexAtPixel(r)+1;0===this.clientSideRowModel.getHighlightPosition(r)&&t--,this.clientSideRowModel.updateRowData({add:n.filter((t=>{var i;return!this.clientSideRowModel.getRowNode(null!==(i=null===e||void 0===e?void 0:e({data:t.data,level:0,rowPinned:t.rowPinned}))&&void 0!==i?i:t.data.id)})).map((e=>e.data)),addIndex:t})}this.clearRowHighlight()}clearRowHighlight(){this.clientSideRowModel.highlightRowAtPixel(null)}moveRows(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;var r;this.clientSideRowModel.ensureRowsAtPixel(e,t,i)&&(this.focusService.clearFocusedCell(),null===(r=this.rangeService)||void 0===r||r.removeAllCellRanges())}addRowDropZone(e){if(!e.getContainer())return void v("addRowDropZone - A container target needs to be provided");if(this.dragAndDropService.findExternalZone(e))return void v("addRowDropZone - target already exists in the list of DropZones. Use `removeRowDropZone` before adding it again.");let t={getContainer:e.getContainer};e.fromGrid?t=e:(e.onDragEnter&&(t.onDragEnter=t=>{e.onDragEnter(this.draggingToRowDragEvent("rowDragEnter",t))}),e.onDragLeave&&(t.onDragLeave=t=>{e.onDragLeave(this.draggingToRowDragEvent("rowDragLeave",t))}),e.onDragging&&(t.onDragging=t=>{e.onDragging(this.draggingToRowDragEvent("rowDragMove",t))}),e.onDragStop&&(t.onDragStop=t=>{e.onDragStop(this.draggingToRowDragEvent("rowDragEnd",t))}),e.onDragCancel&&(t.onDragCancel=t=>{e.onDragCancel(this.draggingToRowDragEvent("rowDragCancel",t))}));const i=c({isInterestedIn:e=>2===e,getIconName:()=>"move",external:!0},t);this.dragAndDropService.addDropTarget(i),this.addDestroyFunc((()=>this.dragAndDropService.removeDropTarget(i)))}getRowDropZone(e){const t=this.getContainer.bind(this),i=this.onDragEnter.bind(this),r=this.onDragLeave.bind(this),n=this.onDragging.bind(this),o=this.onDragStop.bind(this),s=this.onDragCancel.bind(this);let a;return a=e?{getContainer:t,onDragEnter:e.onDragEnter?t=>{i(t),e.onDragEnter(this.draggingToRowDragEvent("rowDragEnter",t))}:i,onDragLeave:e.onDragLeave?t=>{r(t),e.onDragLeave(this.draggingToRowDragEvent("rowDragLeave",t))}:r,onDragging:e.onDragging?t=>{n(t),e.onDragging(this.draggingToRowDragEvent("rowDragMove",t))}:n,onDragStop:e.onDragStop?t=>{o(t),e.onDragStop(this.draggingToRowDragEvent("rowDragEnd",t))}:o,onDragCancel:e.onDragCancel?t=>{s(t),e.onDragCancel(this.draggingToRowDragEvent("rowDragCancel",t))}:s,fromGrid:!0}:{getContainer:t,onDragEnter:i,onDragLeave:r,onDragging:n,onDragStop:o,onDragCancel:s,fromGrid:!0},a}draggingToRowDragEvent(e,t){const i=this.mouseEventService.getNormalisedPosition(t).y;let r,n,o=-1;switch(i>this.pageBoundsService.getCurrentPageHeight()||(o=this.rowModel.getRowIndexAtPixel(i),r=this.rowModel.getRow(o)),t.vDirection){case 1:n="down";break;case 0:n="up";break;default:n=null}return this.gos.addGridCommonParams({type:e,event:t.event,node:t.dragItem.rowNode,nodes:t.dragItem.rowNodes,overIndex:o,overNode:r,y:i,vDirection:n})}dispatchGridEvent(e,t){const i=this.draggingToRowDragEvent(e,t);this.eventService.dispatchEvent(i)}onDragLeave(e){this.dispatchGridEvent("rowDragLeave",e),this.stopDragging(e),this.gos.get("rowDragManaged")&&this.clearRowHighlight()}onDragStop(e){this.dispatchGridEvent("rowDragEnd",e),this.stopDragging(e),this.gos.get("rowDragManaged")&&(this.gos.get("suppressMoveWhenRowDragging")||!this.isFromThisGrid(e))&&this.dragAndDropService.isDropZoneWithinThisGrid(e)&&this.moveRowAndClearHighlight(e)}onDragCancel(e){this.dispatchGridEvent("rowDragCancel",e),this.stopDragging(e),this.gos.get("rowDragManaged")&&(this.gos.get("suppressMoveWhenRowDragging")||!this.isFromThisGrid(e))&&this.dragAndDropService.isDropZoneWithinThisGrid(e)&&this.clearRowHighlight()}stopDragging(e){this.autoScrollService.ensureCleared(),this.getRowNodes(e).forEach((e=>{e.setDragging(!1)}))}},yn=class extends He{constructor(){super(...arguments),this.beanName="dragService",this.dragEndFunctions=[],this.dragSources=[]}wireBeans(e){this.mouseEventService=e.mouseEventService}destroy(){this.dragSources.forEach(this.removeListener.bind(this)),this.dragSources.length=0,super.destroy()}removeListener(e){const t=e.dragSource.eElement,i=e.mouseDownListener;if(t.removeEventListener("mousedown",i),e.touchEnabled){const i=e.touchStartListener;t.removeEventListener("touchstart",i,{passive:!0})}}removeDragSource(e){const t=this.dragSources.find((t=>t.dragSource===e));t&&(this.removeListener(t),xe(this.dragSources,t))}isDragging(){return this.dragging}addDragSource(e){const t=this.onMouseDown.bind(this,e),{eElement:i,includeTouch:r,stopPropagationForTouch:n}=e;i.addEventListener("mousedown",t);let o=null;const s=this.gos.get("suppressTouch");r&&!s&&(o=t=>{Li(t.target)||(n&&t.stopPropagation(),this.onTouchStart(e,t))},i.addEventListener("touchstart",o,{passive:!1})),this.dragSources.push({dragSource:e,mouseDownListener:t,touchStartListener:o,touchEnabled:!!r})}getStartTarget(){return this.startTarget}onTouchStart(e,t){this.currentDragParams=e,this.dragging=!1;const i=t.touches[0];this.touchLastTime=i,this.touchStart=i;const r=t=>this.onTouchUp(t,e.eElement),n=t.target,o=[{target:J(this.gos),type:"touchmove",listener:e=>{e.cancelable&&e.preventDefault()},options:{passive:!1}},{target:n,type:"touchmove",listener:t=>this.onTouchMove(t,e.eElement),options:{passive:!0}},{target:n,type:"touchend",listener:r,options:{passive:!0}},{target:n,type:"touchcancel",listener:r,options:{passive:!0}}];this.addTemporaryEvents(o),0===e.dragStartPixels&&this.onCommonMove(i,this.touchStart,e.eElement)}onMouseDown(e,t){const i=t;if(e.skipMouseEvent&&e.skipMouseEvent(t))return;if(i._alreadyProcessedByDragService)return;if(i._alreadyProcessedByDragService=!0,0!==t.button)return;this.shouldPreventMouseEvent(t)&&t.preventDefault(),this.currentDragParams=e,this.dragging=!1,this.mouseStartEvent=t,this.startTarget=t.target;const r=J(this.gos),n=[{target:r,type:"mousemove",listener:t=>this.onMouseMove(t,e.eElement)},{target:r,type:"mouseup",listener:t=>this.onMouseUp(t,e.eElement)},{target:r,type:"contextmenu",listener:e=>e.preventDefault()},{target:r,type:"keydown",listener:t=>{t.key===Tr.ESCAPE&&this.cancelDrag(e.eElement)}}];this.addTemporaryEvents(n),0===e.dragStartPixels&&this.onMouseMove(t,e.eElement)}addTemporaryEvents(e){e.forEach((e=>{const{target:t,type:i,listener:r,options:n}=e;t.addEventListener(i,r,n)})),this.dragEndFunctions.push((()=>{e.forEach((e=>{const{target:t,type:i,listener:r,options:n}=e;t.removeEventListener(i,r,n)}))}))}isEventNearStartEvent(e,t){const{dragStartPixels:i}=this.currentDragParams;return mr(e,t,F(i)?i:4)}getFirstActiveTouch(e){for(let t=0;t<e.length;t++)if(e[t].identifier===this.touchStart.identifier)return e[t];return null}onCommonMove(e,t,i){var r;if(!this.dragging){if(this.isEventNearStartEvent(e,t))return;if(this.dragging=!0,this.eventService.dispatchEvent({type:"dragStarted",target:i}),this.currentDragParams.onDragStart(t),!this.currentDragParams)return void(this.dragging=!1);this.currentDragParams.onDragging(t)}null===(r=this.currentDragParams)||void 0===r||r.onDragging(e)}onTouchMove(e,t){const i=this.getFirstActiveTouch(e.touches);i&&this.onCommonMove(i,this.touchStart,t)}onMouseMove(e,t){if(Ri()){var i;null===(i=Q(this.gos).getSelection())||void 0===i||i.removeAllRanges()}this.shouldPreventMouseEvent(e)&&e.preventDefault(),this.onCommonMove(e,this.mouseStartEvent,t)}shouldPreventMouseEvent(e){const t=this.gos.get("enableCellTextSelection"),i="mousemove"===e.type;return t&&i&&e.cancelable&&this.mouseEventService.isEventFromThisGrid(e)&&!this.isOverFormFieldElement(e)}isOverFormFieldElement(e){const t=e.target,i=null===t||void 0===t?void 0:t.tagName.toLocaleLowerCase();return!(null===i||void 0===i||!i.match("^a$|textarea|input|select|button"))}onTouchUp(e,t){let i=this.getFirstActiveTouch(e.changedTouches);i||(i=this.touchLastTime),this.onUpCommon(i,t)}onMouseUp(e,t){this.onUpCommon(e,t)}onUpCommon(e,t){this.dragging&&(this.dragging=!1,this.currentDragParams.onDragStop(e),this.eventService.dispatchEvent({type:"dragStopped",target:t})),this.resetDragProperties()}cancelDrag(e){var t,i;this.eventService.dispatchEvent({type:"dragCancelled",target:e}),null===(t=this.currentDragParams)||void 0===t||null===(i=t.onDragCancel)||void 0===i||i.call(t),this.resetDragProperties()}resetDragProperties(){this.mouseStartEvent=null,this.startTarget=null,this.touchStart=null,this.touchLastTime=null,this.currentDragParams=null,this.dragEndFunctions.forEach((e=>e())),this.dragEndFunctions.length=0}},Rn=class extends dr{constructor(e,t,i,r,n,o){super(),this.cellValueFn=e,this.rowNode=t,this.column=i,this.customGui=r,this.dragStartPixels=n,this.suppressVisibilityChange=o,this.dragSource=null}wireBeans(e){this.beans=e}isCustomGui(){return null!=this.customGui}postConstruct(){if(this.customGui?this.setDragElement(this.customGui,this.dragStartPixels):(this.setTemplate('<div class="ag-drag-handle ag-row-drag" aria-hidden="true"></div>'),this.getGui().appendChild(pr("rowDrag",this.gos,null)),this.addDragSource()),this.checkCompatibility(),!this.suppressVisibilityChange){const e=this.gos.get("rowDragManaged")?new Tn(this,this.beans,this.rowNode,this.column):new xn(this,this.beans,this.rowNode,this.column);this.createManagedBean(e,this.beans.context)}}setDragElement(e,t){this.setTemplateFromElement(e,void 0,void 0,!0),this.addDragSource(t)}getSelectedNodes(){if(!this.gos.get("rowDragMultiRow"))return[this.rowNode];const e=this.beans.selectionService.getSelectedNodes();return-1!==e.indexOf(this.rowNode)?e:[this.rowNode]}checkCompatibility(){const e=this.gos.get("rowDragManaged");this.gos.get("treeData")&&e&&v("If using row drag with tree data, you cannot have rowDragManaged=true")}getDragItem(){return{rowNode:this.rowNode,rowNodes:this.getSelectedNodes(),columns:this.column?[this.column]:void 0,defaultTextValue:this.cellValueFn()}}getRowDragText(e){if(e){const t=e.getColDef();if(t.rowDragText)return t.rowDragText}return this.gos.get("rowDragText")}addDragSource(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4;this.dragSource&&this.removeDragSource();const t=this.getGui();this.gos.get("enableCellTextSelection")&&(this.removeMouseDownListener(),this.mouseDownListener=this.addManagedElementListeners(t,{mousedown:e=>{null===e||void 0===e||e.preventDefault()}})[0]);const i=this.localeService.getLocaleTextFunc();this.dragSource={type:2,eElement:t,dragItemName:()=>{var e;const t=this.getDragItem(),r=(null===(e=t.rowNodes)||void 0===e?void 0:e.length)||1,n=this.getRowDragText(this.column);return n?n(t,r):1===r?this.cellValueFn():"".concat(r," ").concat(i("rowDragRows","rows"))},getDragItem:()=>this.getDragItem(),dragStartPixels:e,dragSourceDomDataKey:this.gos.getDomDataKey()},this.beans.dragAndDropService.addDragSource(this.dragSource,!0)}destroy(){this.removeDragSource(),this.removeMouseDownListener(),super.destroy()}removeDragSource(){this.dragSource&&(this.beans.dragAndDropService.removeDragSource(this.dragSource),this.dragSource=null)}removeMouseDownListener(){this.mouseDownListener&&(this.mouseDownListener(),this.mouseDownListener=void 0)}},En=class extends He{constructor(e,t,i){super(),this.parent=e,this.rowNode=t,this.column=i}setDisplayedOrVisible(e){const t={skipAriaHidden:!0};if(e)this.parent.setDisplayed(!1,t);else{let e=!0,i=!1;this.column&&(e=this.column.isRowDrag(this.rowNode)||this.parent.isCustomGui(),i=w(this.column.getColDef().rowDrag)),i?(this.parent.setDisplayed(!0,t),this.parent.setVisible(e,t)):(this.parent.setDisplayed(e,t),this.parent.setVisible(!0,t))}}},xn=class extends En{constructor(e,t,i,r){super(e,i,r),this.beans=t}postConstruct(){this.addManagedPropertyListener("suppressRowDrag",this.onSuppressRowDrag.bind(this));const e=this.workOutVisibility.bind(this);this.addManagedListeners(this.rowNode,{dataChanged:e,cellChanged:e}),this.addManagedListeners(this.beans.eventService,{newColumnsLoaded:e}),this.workOutVisibility()}onSuppressRowDrag(){this.workOutVisibility()}workOutVisibility(){const e=this.gos.get("suppressRowDrag");this.setDisplayedOrVisible(e)}},Tn=class extends En{constructor(e,t,i,r){super(e,i,r),this.beans=t}postConstruct(){const e=this.workOutVisibility.bind(this);this.addManagedListeners(this.beans.eventService,{sortChanged:e,filterChanged:e,columnRowGroupChanged:e,newColumnsLoaded:e}),this.addManagedListeners(this.rowNode,{dataChanged:e,cellChanged:e}),this.addManagedPropertyListener("suppressRowDrag",this.onSuppressRowDrag.bind(this)),this.workOutVisibility()}onSuppressRowDrag(){this.workOutVisibility()}workOutVisibility(){const e=this.beans.ctrlsService.getGridBodyCtrl().getRowDragFeature(),t=e&&e.shouldPreventRowMove(),i=this.gos.get("suppressRowDrag"),r=this.beans.dragAndDropService.hasExternalDropZones(),n=t&&!r||i;this.setDisplayedOrVisible(n)}},Fn=new Set(["localEventService","__objectId","sticky","__autoHeights","checkAutoHeightsDebounced"]),Pn=class e{constructor(t){this.rowIndex=null,this.key=null,this.sourceRowIndex=-1,this.childrenMapped={},this.treeNode=null,this.treeNodeFlags=0,this.displayed=!1,this.rowTop=null,this.oldRowTop=null,this.selectable=!0,this.__objectId=e.OBJECT_ID_SEQUENCE++,this.__autoHeights={},this.alreadyRendered=!1,this.highlighted=null,this.hovered=!1,this.selected=!1,this.beans=t}setData(e){this.setDataCommon(e,!1)}updateData(e){this.setDataCommon(e,!0)}setDataCommon(e,t){var i;const r=this.data;this.data=e,this.beans.valueCache.onDataChanged(),this.updateDataOnDetailNode(),this.checkRowSelectable(),this.resetQuickFilterAggregateText();const n=this.createDataChangedEvent(e,r,t);null===(i=this.localEventService)||void 0===i||i.dispatchEvent(n)}updateDataOnDetailNode(){this.detailNode&&(this.detailNode.data=this.data)}createDataChangedEvent(e,t,i){return{type:"dataChanged",node:this,oldData:t,newData:e,update:i}}getRowIndexString(){return null==this.rowIndex?(C("Could not find rowIndex, this means tasks are being executed on a rowNode that has been removed from the grid."),null):"top"===this.rowPinned?e.ID_PREFIX_TOP_PINNED+this.rowIndex:"bottom"===this.rowPinned?e.ID_PREFIX_BOTTOM_PINNED+this.rowIndex:this.rowIndex.toString()}createDaemonNode(){const t=new e(this.beans);return t.id=this.id,t.data=this.data,t.__daemon=!0,t.selected=this.selected,t.level=this.level,t}setDataAndId(e,t){var i;const r=F(this.id)?this.createDaemonNode():null,n=this.data;this.data=e,this.updateDataOnDetailNode(),this.setId(t),this.checkRowSelectable(),this.beans.selectionService.syncInRowNode(this,r);const o=this.createDataChangedEvent(e,n,!1);null===(i=this.localEventService)||void 0===i||i.dispatchEvent(o)}checkRowSelectable(){const e=me(this.beans.gos);this.setRowSelectable(!e||e(this))}setRowSelectable(e,t){if(this.selectable!==e){if(this.selectable=e,this.dispatchRowEvent("selectableChanged"),t)return;if(be(this.beans.gos)){const e=this.calculateSelectedFromChildren();return void this.setSelectedParams({newValue:null!==e&&void 0!==e&&e,source:"selectableChanged"})}this.isSelected()&&!this.selectable&&this.setSelectedParams({newValue:!1,source:"selectableChanged"})}}setId(t){const i=ce(this.beans.gos);if(i)if(this.data){var r,n;const t=null!==(r=null===(n=this.parent)||void 0===n?void 0:n.getRoute())&&void 0!==r?r:[];this.id=i({data:this.data,parentKeys:t.length>0?t:void 0,level:this.level,rowPinned:this.rowPinned}),this.id.startsWith(e.ID_PREFIX_ROW_GROUP)&&C("Row IDs cannot start with ".concat(e.ID_PREFIX_ROW_GROUP,", this is a reserved prefix for AG Grid's row grouping feature."))}else this.id=void 0;else this.id=t}setRowTop(e){this.oldRowTop=this.rowTop,this.rowTop!==e&&(this.rowTop=e,this.dispatchRowEvent("topChanged"),this.setDisplayed(null!==e))}clearRowTopAndRowIndex(){this.oldRowTop=null,this.setRowTop(null),this.setRowIndex(null)}setHovered(e){this.hovered=e}isHovered(){return this.hovered}setMaster(e){this.master!==e&&(this.master&&!e&&(this.expanded=!1),this.master=e,this.dispatchRowEvent("masterChanged"))}setGroup(e){this.group!==e&&(this.group&&!e&&(this.expanded=!1),this.group=e,this.updateHasChildren(),this.checkRowSelectable(),this.dispatchRowEvent("groupChanged"))}setRowHeight(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.rowHeight=e,this.rowHeightEstimated=t,this.dispatchRowEvent("heightChanged")}setRowAutoHeight(e,t){this.__autoHeights||(this.__autoHeights={}),this.__autoHeights[t.getId()]=e,null!=e&&(null==this.checkAutoHeightsDebounced&&(this.checkAutoHeightsDebounced=E(this.checkAutoHeights.bind(this),1)),this.checkAutoHeightsDebounced())}checkAutoHeights(){var e;let t=!1,i=!0,r=0;const n=this.__autoHeights;if(null==n)return;if(this.beans.visibleColsService.getAllAutoHeightCols().forEach((e=>{let o=n[e.getId()];if(null==o){if(!this.beans.columnModel.isColSpanActive())return void(t=!0);{let i=[];switch(e.getPinned()){case"left":i=this.beans.visibleColsService.getLeftColsForRow(this);break;case"right":i=this.beans.visibleColsService.getRightColsForRow(this);break;case null:i=this.beans.columnViewportService.getColsWithinViewport(this)}if(i.includes(e))return void(t=!0);o=-1}}else i=!1;o>r&&(r=o)})),t)return;if((i||r<10)&&(r=U(this.beans.gos,this).height),r==this.rowHeight)return;this.setRowHeight(r);const o=this.beans.rowModel;null===(e=o.onRowHeightChangedDebounced)||void 0===e||e.call(o)}setExpanded(e,t,i){if(this.expanded===e)return;this.expanded=e,this.dispatchRowEvent("expandedChanged");const r=c(c({},this.createGlobalRowEvent("rowGroupOpened")),{},{expanded:e,event:t||null});this.beans.rowNodeEventThrottle.dispatchExpanded(r,i),this.beans.rowRenderer.refreshCells({rowNodes:[this]})}createGlobalRowEvent(e){return this.beans.gos.addGridCommonParams({type:e,node:this,data:this.data,rowIndex:this.rowIndex,rowPinned:this.rowPinned})}setDataValue(e,t,i){const r=(()=>{var t;return"string"!==typeof e?e:null!==(t=this.beans.columnModel.getCol(e))&&void 0!==t?t:this.beans.columnModel.getColDefCol(e)})(),n=this.beans.valueService.getValueForDisplay(r,this);if(this.beans.gos.get("readOnlyEdit"))return this.beans.eventService.dispatchEvent({type:"cellEditRequest",event:null,rowIndex:this.rowIndex,rowPinned:this.rowPinned,column:r,colDef:r.getColDef(),data:this.data,node:this,oldValue:n,newValue:t,value:t,source:i}),!1;const o=this.beans.valueService.setValue(this,r,t,i);return this.dispatchCellChangedEvent(r,t,n),this.checkRowSelectable(),o}setGroupValue(e,t){const i=this.beans.columnModel.getCol(e);P(this.groupData)&&(this.groupData={});const r=i.getColId(),n=this.groupData[r];n!==t&&(this.groupData[r]=t,this.dispatchCellChangedEvent(i,t,n))}setAggData(e){const t=this.aggData;if(this.aggData=e,this.localEventService){const i=e=>{const i=this.aggData?this.aggData[e]:void 0,r=t?t[e]:void 0;if(i===r)return;const n=this.beans.columnModel.getCol(e);n&&this.dispatchCellChangedEvent(n,i,r)};for(const e in t)i(e);for(const r in e)t&&r in t||i(r)}}updateHasChildren(){let e=this.group&&!this.footer||this.childrenAfterGroup&&this.childrenAfterGroup.length>0;if(H(this.beans.gos)){const t=this.beans.gos.get("treeData"),i=this.beans.gos.get("isServerSideGroup");e=!this.stub&&!this.footer&&(t?!!i&&i(this.data):!!this.group)}e!==this.__hasChildren&&(this.__hasChildren=!!e,this.dispatchRowEvent("hasChildrenChanged"))}hasChildren(){return null==this.__hasChildren&&this.updateHasChildren(),this.__hasChildren}dispatchCellChangedEvent(e,t,i){var r;const n={type:"cellChanged",node:this,column:e,newValue:t,oldValue:i};null===(r=this.localEventService)||void 0===r||r.dispatchEvent(n)}resetQuickFilterAggregateText(){this.quickFilterAggregateText=null}isExpandable(){return!this.footer&&(this.beans.columnModel.isPivotMode()?this.hasChildren()&&!this.leafGroup:this.hasChildren()||!!this.master)}isSelected(){return this.footer?this.sibling.isSelected():this.selected}depthFirstSearch(e){this.childrenAfterGroup&&this.childrenAfterGroup.forEach((t=>t.depthFirstSearch(e))),e(this)}calculateSelectedFromChildren(){var e;let t=!1,i=!1;if(null===(e=this.childrenAfterGroup)||void 0===e||!e.length)return this.selectable?this.selected:null;for(let r=0;r<this.childrenAfterGroup.length;r++){const e=this.childrenAfterGroup[r];let n=e.isSelected();if(!e.selectable){const t=e.calculateSelectedFromChildren();if(null===t)continue;n=t}switch(n){case!0:t=!0;break;case!1:i=!0;break;default:return}}return t&&i?void 0:!!t||!i&&(this.selectable?this.selected:null)}setSelectedInitialValue(e){this.selected=e}dispatchRowEvent(e){var t;null===(t=this.localEventService)||void 0===t||t.dispatchEvent({type:e,node:this})}selectThisNode(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"api";const r=!this.selectable&&e,n=this.selected===e;if(r||n)return!1;this.selected=e,this.dispatchRowEvent("rowSelected");const o=this.sibling;return o&&o.footer&&o.localEventService&&o.dispatchRowEvent("rowSelected"),this.beans.eventService.dispatchEvent(c(c({},this.createGlobalRowEvent("rowSelected")),{},{event:t||null,source:i})),!0}setSelected(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"api";"boolean"!==typeof i?this.setSelectedParams({newValue:e,clearSelection:t,rangeSelect:!1,source:i}):v("since version v30, rowNode.setSelected() property `suppressFinishActions` has been removed, please use `gridApi.setNodesSelected()` for bulk actions, and the event `source` property for ignoring events instead.")}setSelectedParams(e){return this.rowPinned?(v("cannot select pinned rows"),0):void 0===this.id?(v("cannot select node until id for node is known"),0):this.beans.selectionService.setNodesSelected(c(c({},e),{},{nodes:[this.footer?this.sibling:this]}))}isRowPinned(){return!!this.rowPinned}addEventListener(e,t){var i,r;this.localEventService||(this.localEventService=new h),this.beans.frameworkOverrides.shouldWrapOutgoing&&!this.frameworkEventListenerService&&(this.localEventService.setFrameworkOverrides(this.beans.frameworkOverrides),this.frameworkEventListenerService=new Xe(this.beans.frameworkOverrides));const n=null!==(i=null===(r=this.frameworkEventListenerService)||void 0===r?void 0:r.wrap(t))&&void 0!==i?i:t;this.localEventService.addEventListener(e,n)}removeEventListener(e,t){var i,r;if(!this.localEventService)return;const n=null!==(i=null===(r=this.frameworkEventListenerService)||void 0===r?void 0:r.unwrap(t))&&void 0!==i?i:t;this.localEventService.removeEventListener(e,n),this.localEventService.noRegisteredListenersExist()&&(this.localEventService=null)}onMouseEnter(){this.dispatchRowEvent("mouseEnter")}onMouseLeave(){this.dispatchRowEvent("mouseLeave")}isFullWidthCell(){if(v("since version v32.2.0, rowNode.isFullWidthCell() has been deprecated. Instead check `rowNode.detail` followed by the user provided `isFullWidthRow` grid option."),this.detail)return!0;const e=this.beans.gos.getCallback("isFullWidthRow");return!!e&&e({rowNode:this})}getRoute(){if(-1===this.level)return[];if(null==this.key)return;const e=[];let t=this;for(;t&&null!=t.key;)e.push(t.key),t=t.parent;return e.reverse()}createFooter(){if(this.sibling)return;const t=new e(this.beans);Object.keys(this).forEach((e=>{Fn.has(e)||(t[e]=this[e])})),t.footer=!0,t.setRowTop(null),t.setRowIndex(null),t.oldRowTop=null,t.id="rowGroupFooter_"+this.id,t.sibling=this,this.sibling=t}destroyFooter(){this.sibling&&(this.sibling.setRowTop(null),this.sibling.setRowIndex(null),this.sibling=void 0)}setFirstChild(e){this.firstChild!==e&&(this.firstChild=e,this.dispatchRowEvent("firstChildChanged"))}setLastChild(e){this.lastChild!==e&&(this.lastChild=e,this.dispatchRowEvent("lastChildChanged"))}setChildIndex(e){this.childIndex!==e&&(this.childIndex=e,this.dispatchRowEvent("childIndexChanged"))}setDisplayed(e){this.displayed!==e&&(this.displayed=e,this.dispatchRowEvent("displayedChanged"))}setDragging(e){this.dragging!==e&&(this.dragging=e,this.dispatchRowEvent("draggingChanged"))}setHighlighted(e){this.highlighted!==e&&(this.highlighted=e,this.dispatchRowEvent("rowHighlightChanged"))}setAllChildrenCount(e){this.allChildrenCount!==e&&(this.allChildrenCount=e,this.dispatchRowEvent("allChildrenCountChanged"))}setRowIndex(e){this.rowIndex!==e&&(this.rowIndex=e,this.dispatchRowEvent("rowIndexChanged"))}setUiLevel(e){this.uiLevel!==e&&(this.uiLevel=e,this.dispatchRowEvent("uiLevelChanged"))}};Pn.ID_PREFIX_ROW_GROUP="row-group-",Pn.ID_PREFIX_TOP_PINNED="t-",Pn.ID_PREFIX_BOTTOM_PINNED="b-",Pn.OBJECT_ID_SEQUENCE=0;var Dn=Pn,kn=class extends dr{constructor(e,t){super('<div class="ag-filter"></div>'),this.column=e,this.source=t,this.filterWrapper=null}wireBeans(e){this.filterManager=e.filterManager,this.columnModel=e.columnModel}postConstruct(){this.createFilter(!0),this.addManagedEventListeners({filterDestroyed:this.onFilterDestroyed.bind(this)})}hasFilter(){return!!this.filterWrapper}getFilter(){var e,t;return null!==(e=null===(t=this.filterWrapper)||void 0===t?void 0:t.filterPromise)&&void 0!==e?e:null}afterInit(){var e,t;return null!==(e=null===(t=this.filterWrapper)||void 0===t||null===(t=t.filterPromise)||void 0===t?void 0:t.then((()=>{})))&&void 0!==e?e:Wr.resolve()}afterGuiAttached(e){var t;null===(t=this.filterWrapper)||void 0===t||null===(t=t.filterPromise)||void 0===t||t.then((t=>{var i;null===t||void 0===t||null===(i=t.afterGuiAttached)||void 0===i||i.call(t,e)}))}afterGuiDetached(){var e;null===(e=this.filterWrapper)||void 0===e||null===(e=e.filterPromise)||void 0===e||e.then((e=>{var t;null===e||void 0===e||null===(t=e.afterGuiDetached)||void 0===t||t.call(e)}))}createFilter(e){var t,i,r;const{column:n,source:o}=this;this.filterWrapper=null!==(t=null===(i=this.filterManager)||void 0===i?void 0:i.getOrCreateFilterWrapper(n))&&void 0!==t?t:null,null!==(r=this.filterWrapper)&&void 0!==r&&r.filterPromise&&this.filterWrapper.filterPromise.then((t=>{const i=t.getGui();F(i)||v("getGui method from filter returned ".concat(i,"; it should be a DOM element.")),this.appendChild(i),e&&this.eventService.dispatchEvent({type:"filterOpened",column:n,source:o,eGui:this.getGui()})}))}onFilterDestroyed(e){"api"!==e.source&&"paramsUpdated"!==e.source||e.column.getId()!==this.column.getId()||!this.columnModel.getColDefCol(this.column)||(Yi(this.getGui()),this.createFilter())}destroy(){this.filterWrapper=null,super.destroy()}},An="ag-resizer-wrapper",Mn=(e,t)=>'<div data-ref="'.concat(e,'Resizer" class="ag-resizer ag-resizer-').concat(t,'"></div>'),In='<div class="'.concat(An,'">\n        ').concat(Mn("eTopLeft","topLeft"),"\n        ").concat(Mn("eTop","top"),"\n        ").concat(Mn("eTopRight","topRight"),"\n        ").concat(Mn("eRight","right"),"\n        ").concat(Mn("eBottomRight","bottomRight"),"\n        ").concat(Mn("eBottom","bottom"),"\n        ").concat(Mn("eBottomLeft","bottomLeft"),"\n        ").concat(Mn("eLeft","left"),"\n    </div>"),Ln=class extends He{constructor(e,t){super(),this.element=e,this.dragStartPosition={x:0,y:0},this.position={x:0,y:0},this.lastSize={width:-1,height:-1},this.positioned=!1,this.resizersAdded=!1,this.resizeListeners=[],this.boundaryEl=null,this.isResizing=!1,this.isMoving=!1,this.resizable={},this.movable=!1,this.currentResizer=null,this.config=Object.assign({},{popup:!1},t)}wireBeans(e){this.popupService=e.popupService,this.resizeObserverService=e.resizeObserverService,this.dragService=e.dragService}center(){const{clientHeight:e,clientWidth:t}=this.offsetParent,i=t/2-this.getWidth()/2,r=e/2-this.getHeight()/2;this.offsetElement(i,r)}initialisePosition(){if(this.positioned)return;const{centered:e,forcePopupParentAsOffsetParent:t,minWidth:i,width:r,minHeight:n,height:o,x:s,y:a}=this.config;this.offsetParent||this.setOffsetParent();let l=0,c=0;const u=$i(this.element);if(u){const e=this.findBoundaryElement(),t=window.getComputedStyle(e);if(null!=t.minWidth){const i=e.offsetWidth-this.element.offsetWidth;c=parseInt(t.minWidth,10)-i}if(null!=t.minHeight){const i=e.offsetHeight-this.element.offsetHeight;l=parseInt(t.minHeight,10)-i}}if(this.minHeight=n||l,this.minWidth=i||c,r&&this.setWidth(r),o&&this.setHeight(o),r&&o||this.refreshSize(),e)this.center();else if(s||a)this.offsetElement(s,a);else if(u&&t){let e=this.boundaryEl,t=!0;if(e||(e=this.findBoundaryElement(),t=!1),e){const i=parseFloat(e.style.top),r=parseFloat(e.style.left);t?this.offsetElement(isNaN(r)?0:r,isNaN(i)?0:i):this.setPosition(r,i)}}this.positioned=!!this.offsetParent}isPositioned(){return this.positioned}getPosition(){return this.position}setMovable(e,t){if(!this.config.popup||e===this.movable)return;this.movable=e;const i=this.moveElementDragListener||{eElement:t,onDragStart:this.onMoveStart.bind(this),onDragging:this.onMove.bind(this),onDragStop:this.onMoveEnd.bind(this)};e?(this.dragService.addDragSource(i),this.moveElementDragListener=i):(this.dragService.removeDragSource(i),this.moveElementDragListener=void 0)}setResizable(e){if(this.clearResizeListeners(),e?this.addResizers():this.removeResizers(),"boolean"===typeof e){if(!1===e)return;e={topLeft:e,top:e,topRight:e,right:e,bottomRight:e,bottom:e,bottomLeft:e,left:e}}Object.keys(e).forEach((t=>{const i=!!e[t],r=this.getResizerElement(t),n={dragStartPixels:0,eElement:r,onDragStart:e=>this.onResizeStart(e,t),onDragging:this.onResize.bind(this),onDragStop:e=>this.onResizeEnd(e,t)};(i||!this.isAlive()&&!i)&&(i?(this.dragService.addDragSource(n),this.resizeListeners.push(n),r.style.pointerEvents="all"):r.style.pointerEvents="none",this.resizable[t]=i)}))}removeSizeFromEl(){this.element.style.removeProperty("height"),this.element.style.removeProperty("width"),this.element.style.removeProperty("flex")}restoreLastSize(){this.element.style.flex="0 0 auto";const{height:e,width:t}=this.lastSize;-1!==t&&(this.element.style.width="".concat(t,"px")),-1!==e&&(this.element.style.height="".concat(e,"px"))}getHeight(){return this.element.offsetHeight}setHeight(e){const{popup:t}=this.config,i=this.element;let r=!1;if("string"===typeof e&&-1!==e.indexOf("%"))er(i,e),e=Vi(i),r=!0;else if(e=Math.max(this.minHeight,e),this.positioned){const t=this.getAvailableHeight();t&&e>t&&(e=t)}this.getHeight()!==e&&(r?(i.style.maxHeight="unset",i.style.minHeight="unset"):t?er(i,e):(i.style.height="".concat(e,"px"),i.style.flex="0 0 auto",this.lastSize.height="number"===typeof e?e:parseFloat(e)))}getAvailableHeight(){const{popup:e,forcePopupParentAsOffsetParent:t}=this.config;this.positioned||this.initialisePosition();const{clientHeight:i}=this.offsetParent;if(!i)return null;const r=this.element.getBoundingClientRect(),n=this.offsetParent.getBoundingClientRect(),o=e?this.position.y:r.top,s=e?0:n.top;let a=0;if(t){const e=this.element.parentElement;if(e){const{bottom:t}=e.getBoundingClientRect();a=t-r.bottom}}return i+s-o-a}getWidth(){return this.element.offsetWidth}setWidth(e){const t=this.element,{popup:i}=this.config;let r=!1;if("string"===typeof e&&-1!==e.indexOf("%"))Zi(t,e),e=_i(t),r=!0;else if(this.positioned){e=Math.max(this.minWidth,e);const{clientWidth:t}=this.offsetParent,r=i?this.position.x:this.element.getBoundingClientRect().left;t&&e+r>t&&(e=t-r)}this.getWidth()!==e&&(r?(t.style.maxWidth="unset",t.style.minWidth="unset"):this.config.popup?Zi(t,e):(t.style.width="".concat(e,"px"),t.style.flex=" unset",this.lastSize.width="number"===typeof e?e:parseFloat(e)))}offsetElement(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const{forcePopupParentAsOffsetParent:i}=this.config,r=i?this.boundaryEl:this.element;r&&(this.popupService.positionPopup({ePopup:r,keepWithinBounds:!0,skipObserver:this.movable||this.isResizable(),updatePosition:()=>({x:e,y:t})}),this.setPosition(parseFloat(r.style.left),parseFloat(r.style.top)))}constrainSizeToAvailableHeight(e){if(!this.config.forcePopupParentAsOffsetParent)return;const t=()=>{const e=this.getAvailableHeight();this.element.style.setProperty("max-height","".concat(e,"px"))};e?this.resizeObserverSubscriber=this.resizeObserverService.observeResize(this.popupService.getPopupParent(),t):(this.element.style.removeProperty("max-height"),this.resizeObserverSubscriber&&(this.resizeObserverSubscriber(),this.resizeObserverSubscriber=void 0))}setPosition(e,t){this.position.x=e,this.position.y=t}updateDragStartPosition(e,t){this.dragStartPosition={x:e,y:t}}calculateMouseMovement(e){const{e:t,isLeft:i,isTop:r,anywhereWithin:n,topBuffer:o}=e,s=t.clientX-this.dragStartPosition.x,a=t.clientY-this.dragStartPosition.y;return{movementX:this.shouldSkipX(t,!!i,!!n,s)?0:s,movementY:this.shouldSkipY(t,!!r,o,a)?0:a}}shouldSkipX(e,t,i,r){const n=this.element.getBoundingClientRect(),o=this.offsetParent.getBoundingClientRect(),s=this.boundaryEl.getBoundingClientRect(),a=this.config.popup?this.position.x:n.left;let l=a<=0&&o.left>=e.clientX||o.right<=e.clientX&&o.right<=s.right;return!!l||(l=t?r<0&&e.clientX>a+o.left||r>0&&e.clientX<a+o.left:i?r<0&&e.clientX>s.right||r>0&&e.clientX<a+o.left:r<0&&e.clientX>s.right||r>0&&e.clientX<s.right,l)}shouldSkipY(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0;const n=this.element.getBoundingClientRect(),o=this.offsetParent.getBoundingClientRect(),s=this.boundaryEl.getBoundingClientRect(),a=this.config.popup?this.position.y:n.top;let l=a<=0&&o.top>=e.clientY||o.bottom<=e.clientY&&o.bottom<=s.bottom;return!!l||(l=t?r<0&&e.clientY>a+o.top+i||r>0&&e.clientY<a+o.top:r<0&&e.clientY>s.bottom||r>0&&e.clientY<s.bottom,l)}createResizeMap(){const e=this.element;this.resizerMap={topLeft:{element:e.querySelector("[data-ref=eTopLeftResizer]")},top:{element:e.querySelector("[data-ref=eTopResizer]")},topRight:{element:e.querySelector("[data-ref=eTopRightResizer]")},right:{element:e.querySelector("[data-ref=eRightResizer]")},bottomRight:{element:e.querySelector("[data-ref=eBottomRightResizer]")},bottom:{element:e.querySelector("[data-ref=eBottomResizer]")},bottomLeft:{element:e.querySelector("[data-ref=eBottomLeftResizer]")},left:{element:e.querySelector("[data-ref=eLeftResizer]")}}}addResizers(){if(this.resizersAdded)return;const e=this.element;if(!e)return;const t=(new DOMParser).parseFromString(In,"text/html").body;e.appendChild(t.firstChild),this.createResizeMap(),this.resizersAdded=!0}removeResizers(){this.resizerMap=void 0;const e=this.element.querySelector(".".concat(An));e&&this.element.removeChild(e),this.resizersAdded=!1}getResizerElement(e){return this.resizerMap[e].element}onResizeStart(e,t){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.currentResizer={isTop:!!t.match(/top/i),isRight:!!t.match(/right/i),isBottom:!!t.match(/bottom/i),isLeft:!!t.match(/left/i)},this.element.classList.add("ag-resizing"),this.resizerMap[t].element.classList.add("ag-active");const{popup:i,forcePopupParentAsOffsetParent:r}=this.config;i||r||this.applySizeToSiblings(this.currentResizer.isBottom||this.currentResizer.isTop),this.isResizing=!0,this.updateDragStartPosition(e.clientX,e.clientY)}getSiblings(){const e=this.element.parentElement;return e?Array.prototype.slice.call(e.children).filter((e=>!e.classList.contains("ag-hidden"))):null}getMinSizeOfSiblings(){const e=this.getSiblings()||[];let t=0,i=0;for(let r=0;r<e.length;r++){const n=e[r],o=!!n.style.flex&&"0 0 auto"!==n.style.flex;if(n===this.element)continue;let s=this.minHeight||0,a=this.minWidth||0;if(o){const e=window.getComputedStyle(n);e.minHeight&&(s=parseInt(e.minHeight,10)),e.minWidth&&(a=parseInt(e.minWidth,10))}else s=n.offsetHeight,a=n.offsetWidth;t+=s,i+=a}return{height:t,width:i}}applySizeToSiblings(e){let t=null;const i=this.getSiblings();if(i){for(let r=0;r<i.length;r++){const n=i[r];n!==t&&(e?n.style.height="".concat(n.offsetHeight,"px"):n.style.width="".concat(n.offsetWidth,"px"),n.style.flex="0 0 auto",n===this.element&&(t=i[r+1]))}t&&(t.style.removeProperty("height"),t.style.removeProperty("min-height"),t.style.removeProperty("max-height"),t.style.flex="1 1 auto")}}isResizable(){return Object.values(this.resizable).some((e=>e))}onResize(e){if(!this.isResizing||!this.currentResizer)return;const{popup:t,forcePopupParentAsOffsetParent:i}=this.config,{isTop:r,isRight:n,isBottom:o,isLeft:s}=this.currentResizer,a=n||s,l=o||r,{movementX:c,movementY:u}=this.calculateMouseMovement({e:e,isLeft:s,isTop:r}),d=this.position.x,h=this.position.y;let g=0,p=0;if(a&&c){const e=s?-1:1,t=this.getWidth(),i=t+c*e;let r=!1;s&&(g=t-i,(d+g<=0||i<=this.minWidth)&&(r=!0,g=0)),r||this.setWidth(i)}if(l&&u){const e=r?-1:1,t=this.getHeight(),i=t+u*e;let n=!1;r?(p=t-i,(h+p<=0||i<=this.minHeight)&&(n=!0,p=0)):!this.config.popup&&!this.config.forcePopupParentAsOffsetParent&&t<i&&this.getMinSizeOfSiblings().height+i>this.element.parentElement.offsetHeight&&(n=!0),n||this.setHeight(i)}this.updateDragStartPosition(e.clientX,e.clientY),((t||i)&&g||p)&&this.offsetElement(d+g,h+p)}onResizeEnd(e,t){this.isResizing=!1,this.currentResizer=null,this.boundaryEl=null,this.element.classList.remove("ag-resizing"),this.resizerMap[t].element.classList.remove("ag-active"),this.dispatchLocalEvent({type:"resize"})}refreshSize(){const e=this.element;this.config.popup&&(this.config.width||this.setWidth(e.offsetWidth),this.config.height||this.setHeight(e.offsetHeight))}onMoveStart(e){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.isMoving=!0,this.element.classList.add("ag-moving"),this.updateDragStartPosition(e.clientX,e.clientY)}onMove(e){if(!this.isMoving)return;const{x:t,y:i}=this.position;let r;this.config.calculateTopBuffer&&(r=this.config.calculateTopBuffer());const{movementX:n,movementY:o}=this.calculateMouseMovement({e:e,isTop:!0,anywhereWithin:!0,topBuffer:r});this.offsetElement(t+n,i+o),this.updateDragStartPosition(e.clientX,e.clientY)}onMoveEnd(){this.isMoving=!1,this.boundaryEl=null,this.element.classList.remove("ag-moving")}setOffsetParent(){this.config.forcePopupParentAsOffsetParent?this.offsetParent=this.popupService.getPopupParent():this.offsetParent=this.element.offsetParent}findBoundaryElement(){let e=this.element;for(;e;){if("static"!==window.getComputedStyle(e).position)return e;e=e.parentElement}return this.element}clearResizeListeners(){for(;this.resizeListeners.length;){const e=this.resizeListeners.pop();this.dragService.removeDragSource(e)}}destroy(){super.destroy(),this.moveElementDragListener&&this.dragService.removeDragSource(this.moveElementDragListener),this.constrainSizeToAvailableHeight(!1),this.clearResizeListeners(),this.removeResizers()}},On=class e extends He{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this.eFocusableElement=e,this.callbacks=t,this.callbacks=c({shouldStopEventPropagation:()=>!1,onTabKeyDown:e=>{if(e.defaultPrevented)return;const t=this.focusService.findNextFocusableElement(this.eFocusableElement,!1,e.shiftKey);t&&(t.focus(),e.preventDefault())}},t)}wireBeans(e){this.focusService=e.focusService}postConstruct(){this.eFocusableElement.classList.add(e.FOCUS_MANAGED_CLASS),this.addKeyDownListeners(this.eFocusableElement),this.callbacks.onFocusIn&&this.addManagedElementListeners(this.eFocusableElement,{focusin:this.callbacks.onFocusIn}),this.callbacks.onFocusOut&&this.addManagedElementListeners(this.eFocusableElement,{focusout:this.callbacks.onFocusOut})}addKeyDownListeners(e){this.addManagedElementListeners(e,{keydown:e=>{e.defaultPrevented||Oe(e)||(this.callbacks.shouldStopEventPropagation(e)?Le(e):e.key===Tr.TAB?this.callbacks.onTabKeyDown(e):this.callbacks.handleKeyDown&&this.callbacks.handleKeyDown(e))}})}};On.FOCUS_MANAGED_CLASS="ag-focus-managed";var Nn=On,Bn={applyFilter:"Apply",clearFilter:"Clear",resetFilter:"Reset",cancelFilter:"Cancel",textFilter:"Text Filter",numberFilter:"Number Filter",dateFilter:"Date Filter",setFilter:"Set Filter",filterOoo:"Filter...",empty:"Choose one",equals:"Equals",notEqual:"Does not equal",lessThan:"Less than",greaterThan:"Greater than",inRange:"Between",inRangeStart:"From",inRangeEnd:"To",lessThanOrEqual:"Less than or equal to",greaterThanOrEqual:"Greater than or equal to",contains:"Contains",notContains:"Does not contain",startsWith:"Begins with",endsWith:"Ends with",blank:"Blank",notBlank:"Not blank",before:"Before",after:"After",andCondition:"AND",orCondition:"OR",dateFormatOoo:"yyyy-mm-dd"};function Gn(e,t){return Hn(e)?(null!=e.debounceMs&&v("debounceMs is ignored when apply button is present"),0):null!=e.debounceMs?e.debounceMs:t}function Hn(e){return!!e.buttons&&e.buttons.indexOf("apply")>=0}var zn=class extends dr{constructor(e){super(),this.filterNameKey=e,this.applyActive=!1,this.hidePopup=null,this.debouncePending=!1,this.appliedModel=null,this.eFilterBody=ur,this.buttonListeners=[]}wireBeans(e){this.rowModel=e.rowModel}postConstruct(){this.resetTemplate(),this.createManagedBean(new Nn(this.getFocusableElement(),{handleKeyDown:this.handleKeyDown.bind(this)})),this.positionableFeature=new Ln(this.getPositionableElement(),{forcePopupParentAsOffsetParent:!0}),this.createBean(this.positionableFeature)}handleKeyDown(e){}getFilterTitle(){return this.translate(this.filterNameKey)}isFilterActive(){return!!this.appliedModel}resetTemplate(e){let t=this.getGui();t&&t.removeEventListener("submit",this.onFormSubmit);const i='\n            <form class="ag-filter-wrapper">\n                <div class="ag-filter-body-wrapper ag-'.concat(this.getCssIdentifier(),'-body-wrapper" data-ref="eFilterBody">\n                    ').concat(this.createBodyTemplate(),"\n                </div>\n            </form>");this.setTemplate(i,this.getAgComponents(),e),t=this.getGui(),t&&t.addEventListener("submit",this.onFormSubmit)}isReadOnly(){return!!this.providedFilterParams.readOnly}init(e){this.setParams(e),this.resetUiToDefaults(!0).then((()=>{this.updateUiVisibility(),this.setupOnBtApplyDebounce()}))}setParams(e){this.providedFilterParams=e,this.applyActive=Hn(e),this.resetButtonsPanel(e)}updateParams(e){this.providedFilterParams=e,this.applyActive=Hn(e),this.resetUiToActiveModel(this.getModel(),(()=>{this.updateUiVisibility(),this.setupOnBtApplyDebounce()}))}resetButtonsPanel(e,t){const{buttons:i,readOnly:r}=null!==t&&void 0!==t?t:{},{buttons:n,readOnly:o}=e;if(r===o&&L(i,n))return;const s=n&&n.length>0&&!this.isReadOnly();if(this.eButtonsPanel?(Yi(this.eButtonsPanel),this.buttonListeners.forEach((e=>e())),this.buttonListeners=[]):s&&(this.eButtonsPanel=document.createElement("div"),this.eButtonsPanel.classList.add("ag-filter-apply-panel")),!s)return void(this.eButtonsPanel&&qi(this.eButtonsPanel));const a=document.createDocumentFragment(),l=e=>{let t,i;switch(e){case"apply":t=this.translate("applyFilter"),i=e=>this.onBtApply(!1,!1,e);break;case"clear":t=this.translate("clearFilter"),i=()=>this.onBtClear();break;case"reset":t=this.translate("resetFilter"),i=()=>this.onBtReset();break;case"cancel":t=this.translate("cancelFilter"),i=e=>{this.onBtCancel(e)};break;default:return void v("Unknown button type specified")}const r=Xi('<button\n                    type="'.concat("apply"===e?"submit":"button",'"\n                    data-ref="').concat(e,'FilterButton"\n                    class="ag-button ag-standard-button ag-filter-apply-panel-button"\n                >').concat(t,"\n                </button>"));this.buttonListeners.push(...this.addManagedElementListeners(r,{click:i})),a.append(r)};n.forEach((e=>l(e))),this.eButtonsPanel.append(a),this.getGui().appendChild(this.eButtonsPanel)}getDefaultDebounceMs(){return 0}setupOnBtApplyDebounce(){const e=Gn(this.providedFilterParams,this.getDefaultDebounceMs()),t=E(this.checkApplyDebounce.bind(this),e);this.onBtApplyDebounce=()=>{this.debouncePending=!0,t()}}checkApplyDebounce(){this.debouncePending&&(this.debouncePending=!1,this.onBtApply())}getModel(){return this.appliedModel?this.appliedModel:null}setModel(e){return(null!=e?this.setModelIntoUi(e):this.resetUiToDefaults()).then((()=>{this.updateUiVisibility(),this.applyModel("api")}))}onBtCancel(e){this.resetUiToActiveModel(this.getModel(),(()=>{this.handleCancelEnd(e)}))}handleCancelEnd(e){this.providedFilterParams.closeOnApply&&this.close(e)}resetUiToActiveModel(e,t){const i=()=>{this.onUiChanged(!1,"prevent"),null===t||void 0===t||t()};null!=e?this.setModelIntoUi(e).then(i):this.resetUiToDefaults().then(i)}onBtClear(){this.resetUiToDefaults().then((()=>this.onUiChanged()))}onBtReset(){this.onBtClear(),this.onBtApply()}applyModel(){const e=this.getModelFromUi();if(!this.isModelValid(e))return!1;const t=this.appliedModel;return this.appliedModel=e,!this.areModelsEqual(t,e)}isModelValid(e){return!0}onFormSubmit(e){e.preventDefault()}onBtApply(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0;if(i&&i.preventDefault(),this.applyModel(t?"rowDataUpdated":"ui")){const i="columnFilter";this.providedFilterParams.filterChangedCallback({afterFloatingFilter:e,afterDataChange:t,source:i})}const{closeOnApply:r}=this.providedFilterParams;r&&this.applyActive&&!e&&!t&&this.close(i)}onNewRowsLoaded(){}close(e){if(!this.hidePopup)return;const t=e,i=t&&t.key;let r;"Enter"!==i&&"Space"!==i||(r={keyboardEvent:t}),this.hidePopup(r),this.hidePopup=null}onUiChanged(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;if(this.updateUiVisibility(),this.providedFilterParams.filterModifiedCallback(),this.applyActive&&!this.isReadOnly()){const e=this.isModelValid(this.getModelFromUi()),t=this.queryForHtmlElement('[data-ref="applyFilterButton"]');t&&Ni(t,!e)}e&&!t||"immediately"===t?this.onBtApply(e):(this.applyActive||t)&&"debounce"!==t||this.onBtApplyDebounce()}afterGuiAttached(e){e&&(this.hidePopup=e.hidePopup),this.refreshFilterResizer(null===e||void 0===e?void 0:e.container)}refreshFilterResizer(e){if(!this.positionableFeature||"toolPanel"===e)return;const t="floatingFilter"===e||"columnFilter"===e,{positionableFeature:i,gos:r}=this;t?(i.restoreLastSize(),i.setResizable(r.get("enableRtl")?{bottom:!0,bottomLeft:!0,left:!0}:{bottom:!0,bottomRight:!0,right:!0})):(this.positionableFeature.removeSizeFromEl(),this.positionableFeature.setResizable(!1)),this.positionableFeature.constrainSizeToAvailableHeight(!0)}afterGuiDetached(){this.checkApplyDebounce(),this.positionableFeature&&this.positionableFeature.constrainSizeToAvailableHeight(!1)}refresh(e){const t=this.providedFilterParams;return this.providedFilterParams=e,this.resetButtonsPanel(e,t),!0}destroy(){const e=this.getGui();e&&e.removeEventListener("submit",this.onFormSubmit),this.hidePopup=null,this.positionableFeature&&(this.positionableFeature=this.destroyBean(this.positionableFeature)),this.appliedModel=null,super.destroy()}translate(e){return this.localeService.getLocaleTextFunc()(e,Bn[e])}getCellValue(e){return this.providedFilterParams.getValue(e)}getPositionableElement(){return this.eFilterBody}},Vn=class extends kr{constructor(e){super(e,"ag-radio-button","radio")}isSelected(){return this.eInput.checked}toggle(){this.eInput.disabled||this.isSelected()||this.setValue(!0)}addInputListeners(){super.addInputListeners(),this.addManagedEventListeners({checkboxChanged:this.onChange.bind(this)})}onChange(e){e.selected&&e.name&&this.eInput.name&&this.eInput.name===e.name&&e.id&&this.eInput.id!==e.id&&this.setValue(!1,!0)}},_n=class extends dr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super('<div class="ag-list ag-'.concat(e,'-list" role="listbox"></div>')),this.cssIdentifier=e,this.unFocusable=t,this.activeClass="ag-active-item",this.options=[],this.itemEls=[]}postConstruct(){const e=this.getGui();this.addManagedElementListeners(e,{mouseleave:()=>this.clearHighlighted()}),this.unFocusable||this.addManagedElementListeners(e,{keydown:this.handleKeyDown.bind(this)})}handleKeyDown(e){const t=e.key;switch(t){case Tr.ENTER:if(this.highlightedEl){const e=this.itemEls.indexOf(this.highlightedEl);this.setValueByIndex(e)}else this.setValue(this.getValue());break;case Tr.DOWN:case Tr.UP:e.preventDefault(),this.navigate(t);break;case Tr.PAGE_DOWN:case Tr.PAGE_UP:case Tr.PAGE_HOME:case Tr.PAGE_END:e.preventDefault(),this.navigateToPage(t)}}navigate(e){const t=e===Tr.DOWN;let i;if(this.highlightedEl){let e=this.itemEls.indexOf(this.highlightedEl)+(t?1:-1);e=Math.min(Math.max(e,0),this.itemEls.length-1),i=this.itemEls[e]}else i=this.itemEls[t?0:this.itemEls.length-1];this.highlightItem(i)}navigateToPage(e){if(!this.highlightedEl||0===this.itemEls.length)return;const t=this.itemEls.indexOf(this.highlightedEl),i=this.options.length-1,r=this.itemEls[0].clientHeight,n=Math.floor(this.getGui().clientHeight/r);let o=-1;e===Tr.PAGE_HOME?o=0:e===Tr.PAGE_END?o=i:e===Tr.PAGE_DOWN?o=Math.min(t+n,i):e===Tr.PAGE_UP&&(o=Math.max(t-n,0)),-1!==o&&this.highlightItem(this.itemEls[o])}addOptions(e){return e.forEach((e=>this.addOption(e))),this}addOption(e){const{value:t,text:i}=e,r=i||t;return this.options.push({value:t,text:r}),this.renderOption(t,r),this.updateIndices(),this}clearOptions(){this.options=[],this.reset(!0),this.itemEls.forEach((e=>{qi(e)})),this.itemEls=[]}updateIndices(){const e=this.getGui().querySelectorAll(".ag-list-item");e.forEach(((t,i)=>{si(t,"posinset",i+1),function(e,t){si(e,"setsize",t)}(t,e.length)}))}renderOption(e,t){const i=Q(this.gos),r=i.createElement("div");ci(r,"option"),r.classList.add("ag-list-item","ag-".concat(this.cssIdentifier,"-list-item"));const n=i.createElement("span");r.appendChild(n),n.textContent=t,this.unFocusable||(r.tabIndex=-1),this.itemEls.push(r),this.addManagedListeners(r,{mouseover:()=>this.highlightItem(r),mousedown:t=>{t.preventDefault(),t.stopPropagation(),this.setValue(e)}}),this.createManagedBean(new lr({getTooltipValue:()=>t,getGui:()=>r,getLocation:()=>"UNKNOWN",shouldDisplayTooltip:()=>n.scrollWidth>n.clientWidth})),this.getGui().appendChild(r)}setValue(e,t){if(this.value===e)return this.fireItemSelected(),this;if(null==e)return this.reset(t),this;const i=this.options.findIndex((t=>t.value===e));if(-1!==i){const e=this.options[i];this.value=e.value,this.displayValue=e.text,this.highlightItem(this.itemEls[i]),t||this.fireChangeEvent()}return this}setValueByIndex(e){return this.setValue(this.options[e].value)}getValue(){return this.value}getDisplayValue(){return this.displayValue}refreshHighlighted(){this.clearHighlighted();const e=this.options.findIndex((e=>e.value===this.value));-1!==e&&this.highlightItem(this.itemEls[e])}reset(e){this.value=null,this.displayValue=null,this.clearHighlighted(),e||this.fireChangeEvent()}highlightItem(e){if(!$i(e))return;this.clearHighlighted(),this.highlightedEl=e,this.highlightedEl.classList.add(this.activeClass),Si(this.highlightedEl,!0);const t=this.getGui(),{scrollTop:i,clientHeight:r}=t,{offsetTop:n,offsetHeight:o}=e;(n+o>i+r||n<i)&&this.highlightedEl.scrollIntoView({block:"nearest"}),this.unFocusable||this.highlightedEl.focus()}clearHighlighted(){this.highlightedEl&&$i(this.highlightedEl)&&(this.highlightedEl.classList.remove(this.activeClass),Si(this.highlightedEl,!1),this.highlightedEl=null)}fireChangeEvent(){this.dispatchLocalEvent({type:"fieldValueChanged"}),this.fireItemSelected()}fireItemSelected(){this.dispatchLocalEvent({type:"selectedItem"})}},Wn=class extends Pr{constructor(e){if(super(e,(null===e||void 0===e?void 0:e.template)||'\n            <div class="ag-picker-field" role="presentation">\n                <div data-ref="eLabel"></div>\n                <div data-ref="eWrapper" class="ag-wrapper ag-picker-field-wrapper ag-picker-collapsed">\n                    <div data-ref="eDisplayField" class="ag-picker-field-display"></div>\n                    <div data-ref="eIcon" class="ag-picker-field-icon" aria-hidden="true"></div>\n                </div>\n            </div>',(null===e||void 0===e?void 0:e.agComponents)||[],null===e||void 0===e?void 0:e.className),this.isPickerDisplayed=!1,this.skipClick=!1,this.pickerGap=4,this.hideCurrentPicker=null,this.eLabel=ur,this.eWrapper=ur,this.eDisplayField=ur,this.eIcon=ur,this.ariaRole=null===e||void 0===e?void 0:e.ariaRole,this.onPickerFocusIn=this.onPickerFocusIn.bind(this),this.onPickerFocusOut=this.onPickerFocusOut.bind(this),!e)return;const{pickerGap:t,maxPickerHeight:i,variableWidth:r,minPickerWidth:n,maxPickerWidth:o}=e;null!=t&&(this.pickerGap=t),this.variableWidth=!!r,null!=i&&this.setPickerMaxHeight(i),null!=n&&this.setPickerMinWidth(n),null!=o&&this.setPickerMaxWidth(o)}wireBeans(e){this.popupService=e.popupService}postConstruct(){super.postConstruct(),this.setupAria();const e="ag-".concat(this.getCompId(),"-display");this.eDisplayField.setAttribute("id",e);const t=this.getAriaElement();this.addManagedElementListeners(t,{keydown:this.onKeyDown.bind(this)}),this.addManagedElementListeners(this.eLabel,{mousedown:this.onLabelOrWrapperMouseDown.bind(this)}),this.addManagedElementListeners(this.eWrapper,{mousedown:this.onLabelOrWrapperMouseDown.bind(this)});const{pickerIcon:i,inputWidth:r}=this.config;if(i){const e=pr(i,this.gos);e&&this.eIcon.appendChild(e)}null!=r&&this.setInputWidth(r)}setupAria(){const e=this.getAriaElement();e.setAttribute("tabindex",this.gos.get("tabIndex").toString()),pi(e,!1),this.ariaRole&&ci(e,this.ariaRole)}onLabelOrWrapperMouseDown(e){if(e){const t=this.getFocusableElement();if(t!==this.eWrapper&&(null===e||void 0===e?void 0:e.target)===t)return;e.preventDefault(),this.getFocusableElement().focus()}this.skipClick?this.skipClick=!1:this.isDisabled()||(this.isPickerDisplayed?this.hidePicker():this.showPicker())}onKeyDown(e){switch(e.key){case Tr.UP:case Tr.DOWN:case Tr.ENTER:case Tr.SPACE:e.preventDefault(),this.onLabelOrWrapperMouseDown();break;case Tr.ESCAPE:this.isPickerDisplayed&&(e.preventDefault(),e.stopPropagation(),this.hideCurrentPicker&&this.hideCurrentPicker())}}showPicker(){this.isPickerDisplayed=!0,this.pickerComponent||(this.pickerComponent=this.createPickerComponent());const e=this.pickerComponent.getGui();e.addEventListener("focusin",this.onPickerFocusIn),e.addEventListener("focusout",this.onPickerFocusOut),this.hideCurrentPicker=this.renderAndPositionPicker(),this.toggleExpandedStyles(!0)}renderAndPositionPicker(){const e=this.pickerComponent.getGui();this.gos.get("suppressScrollWhenPopupsAreOpen")||([this.destroyMouseWheelFunc]=this.addManagedEventListeners({bodyScroll:()=>{this.hidePicker()}}));const t=this.localeService.getLocaleTextFunc(),{pickerAriaLabelKey:i,pickerAriaLabelValue:r,modalPicker:n=!0}=this.config,o={modal:n,eChild:e,closeOnEsc:!0,closedCallback:()=>{const e=ee(this.gos);this.beforeHidePicker(),e&&this.isAlive()&&this.getFocusableElement().focus()},ariaLabel:t(i,r),anchorToElement:this.eWrapper};e.style.position="absolute";const s=this.popupService.addPopup(o),{maxPickerHeight:a,minPickerWidth:l,maxPickerWidth:c,variableWidth:u}=this;u?(l&&(e.style.minWidth=l),e.style.width=tr(_i(this.eWrapper)),c&&(e.style.maxWidth=c)):Ji(e,null!==c&&void 0!==c?c:_i(this.eWrapper));const d=null!==a&&void 0!==a?a:"".concat(Hi(this.popupService.getPopupParent()),"px");return e.style.setProperty("max-height",d),this.alignPickerToComponent(),s.hideFunc}alignPickerToComponent(){if(!this.pickerComponent)return;const{pickerType:e}=this.config,{pickerGap:t}=this,i=this.gos.get("enableRtl")?"right":"left";this.popupService.positionPopupByComponent({type:e,eventSource:this.eWrapper,ePopup:this.pickerComponent.getGui(),position:"under",alignSide:i,keepWithinBounds:!0,nudgeY:t})}beforeHidePicker(){this.destroyMouseWheelFunc&&(this.destroyMouseWheelFunc(),this.destroyMouseWheelFunc=void 0),this.toggleExpandedStyles(!1);const e=this.pickerComponent.getGui();e.removeEventListener("focusin",this.onPickerFocusIn),e.removeEventListener("focusout",this.onPickerFocusOut),this.isPickerDisplayed=!1,this.pickerComponent=void 0,this.hideCurrentPicker=null}toggleExpandedStyles(e){if(!this.isAlive())return;pi(this.getAriaElement(),e),this.eWrapper.classList.toggle("ag-picker-expanded",e),this.eWrapper.classList.toggle("ag-picker-collapsed",!e)}onPickerFocusIn(){this.togglePickerHasFocus(!0)}onPickerFocusOut(e){var t;null!==(t=this.pickerComponent)&&void 0!==t&&t.getGui().contains(e.relatedTarget)||this.togglePickerHasFocus(!1)}togglePickerHasFocus(e){this.pickerComponent&&this.eWrapper.classList.toggle("ag-picker-has-focus",e)}hidePicker(){this.hideCurrentPicker&&this.hideCurrentPicker()}setInputWidth(e){return Ji(this.eWrapper,e),this}getFocusableElement(){return this.eWrapper}setPickerGap(e){return this.pickerGap=e,this}setPickerMinWidth(e){return"number"===typeof e&&(e="".concat(e,"px")),this.minPickerWidth=null==e?void 0:e,this}setPickerMaxWidth(e){return"number"===typeof e&&(e="".concat(e,"px")),this.maxPickerWidth=null==e?void 0:e,this}setPickerMaxHeight(e){return"number"===typeof e&&(e="".concat(e,"px")),this.maxPickerHeight=null==e?void 0:e,this}destroy(){this.hidePicker(),super.destroy()}},Un=class extends Wn{constructor(e){super(c({pickerAriaLabelKey:"ariaLabelSelectField",pickerAriaLabelValue:"Select Field",pickerType:"ag-list",className:"ag-select",pickerIcon:"smallDown",ariaRole:"combobox"},e))}postConstruct(){super.postConstruct(),this.createListComponent(),this.eWrapper.tabIndex=this.gos.get("tabIndex");const{options:e,value:t,placeholder:i}=this.config;null!=e&&this.addOptions(e),null!=t&&this.setValue(t,!0),i&&null==t&&(this.eDisplayField.textContent=i),this.addManagedElementListeners(this.eWrapper,{focusout:this.onWrapperFocusOut.bind(this)})}onWrapperFocusOut(e){this.eWrapper.contains(e.relatedTarget)||this.hidePicker()}createListComponent(){this.listComponent=this.createBean(new _n("select",!0)),this.listComponent.setParentComponent(this);const e=this.listComponent.getAriaElement(),t="ag-select-list-".concat(this.listComponent.getCompId());var i,r;e.setAttribute("id",t),oi(i=this.getAriaElement(),"controls",(r=e).id),di(r,i.id),this.listComponent.addManagedListeners(this.listComponent,{selectedItem:()=>{this.hidePicker(),this.dispatchLocalEvent({type:"selectedItem"})}}),this.listComponent.addManagedListeners(this.listComponent,{fieldValueChanged:()=>{this.listComponent&&(this.setValue(this.listComponent.getValue(),!1,!0),this.hidePicker())}})}createPickerComponent(){return this.listComponent}onKeyDown(e){const{key:t}=e;switch(t===Tr.TAB&&this.hidePicker(),t){case Tr.ENTER:case Tr.UP:case Tr.DOWN:case Tr.PAGE_UP:case Tr.PAGE_DOWN:case Tr.PAGE_HOME:case Tr.PAGE_END:var i;if(e.preventDefault(),this.isPickerDisplayed)null===(i=this.listComponent)||void 0===i||i.handleKeyDown(e);else super.onKeyDown(e);break;case Tr.ESCAPE:super.onKeyDown(e);break;case Tr.SPACE:this.isPickerDisplayed?e.preventDefault():super.onKeyDown(e)}}showPicker(){this.listComponent&&(super.showPicker(),this.listComponent.refreshHighlighted())}addOptions(e){return e.forEach((e=>this.addOption(e))),this}addOption(e){return this.listComponent.addOption(e),this}clearOptions(){var e;return null===(e=this.listComponent)||void 0===e||e.clearOptions(),this}setValue(e,t,i){var r;if(this.value===e||!this.listComponent)return this;i||this.listComponent.setValue(e,!0);if(this.listComponent.getValue()===this.getValue())return this;let n=this.listComponent.getDisplayValue();return null==n&&this.config.placeholder&&(n=this.config.placeholder),this.eDisplayField.textContent=n,this.setTooltip({newTooltipText:null!==(r=n)&&void 0!==r?r:null,shouldDisplayTooltip:()=>this.eDisplayField.scrollWidth>this.eDisplayField.clientWidth}),super.setValue(e,t)}destroy(){this.listComponent&&(this.listComponent=this.destroyBean(this.listComponent)),super.destroy()}},jn={selector:"AG-SELECT",component:Un},Kn=class{constructor(){this.customFilterOptions={}}init(e,t){this.filterOptions=e.filterOptions||t,this.mapCustomOptions(),this.selectDefaultItem(e)}getFilterOptions(){return this.filterOptions}mapCustomOptions(){this.filterOptions&&this.filterOptions.forEach((e=>{if("string"===typeof e)return;[["displayKey"],["displayName"],["predicate","test"]].every((t=>!!t.some((t=>null!=e[t]))||(v("ignoring FilterOptionDef as it doesn't contain one of '".concat(t,"'")),!1)))?this.customFilterOptions[e.displayKey]=e:this.filterOptions=this.filterOptions.filter((t=>t===e))||[]}))}selectDefaultItem(e){if(e.defaultOption)this.defaultOption=e.defaultOption;else if(this.filterOptions.length>=1){const e=this.filterOptions[0];"string"===typeof e?this.defaultOption=e:e.displayKey?this.defaultOption=e.displayKey:v("invalid FilterOptionDef supplied as it doesn't contain a 'displayKey'")}else v("no filter options for filter")}getDefaultOption(){return this.defaultOption}getCustomOption(e){return this.customFilterOptions[e]}},Yn=class extends zn{constructor(){super(...arguments),this.eTypes=[],this.eJoinOperatorPanels=[],this.eJoinOperatorsAnd=[],this.eJoinOperatorsOr=[],this.eConditionBodies=[],this.listener=()=>this.onUiChanged(),this.lastUiCompletePosition=null,this.joinOperatorId=0}getNumberOfInputs(e){const t=this.optionsFactory.getCustomOption(e);if(t){const{numberOfInputs:e}=t;return null!=e?e:1}return e&&["empty","notBlank","blank"].indexOf(e)>=0?0:"inRange"===e?2:1}onFloatingFilterChanged(e,t){this.setTypeFromFloatingFilter(e),this.setValueFromFloatingFilter(t),this.onUiChanged(!0)}setTypeFromFloatingFilter(e){this.eTypes.forEach(((t,i)=>{0===i?t.setValue(e,!0):t.setValue(this.optionsFactory.getDefaultOption(),!0)}))}getModelFromUi(){const e=this.getUiCompleteConditions();return 0===e.length?null:this.maxNumConditions>1&&e.length>1?{filterType:this.getFilterType(),operator:this.getJoinOperator(),conditions:e}:e[0]}getConditionTypes(){return this.eTypes.map((e=>e.getValue()))}getConditionType(e){return this.eTypes[e].getValue()}getJoinOperator(){return 0===this.eJoinOperatorsOr.length?this.defaultJoinOperator:!0===this.eJoinOperatorsOr[0].getValue()?"OR":"AND"}areModelsEqual(e,t){if(!e&&!t)return!0;if(!e&&t||e&&!t)return!1;const i=!e.operator,r=!t.operator;if(!i&&r||i&&!r)return!1;let n;if(i){const i=e,r=t;n=this.areSimpleModelsEqual(i,r)}else{const i=e,r=t;n=i.operator===r.operator&&Re(i.conditions,r.conditions,((e,t)=>this.areSimpleModelsEqual(e,t)))}return n}shouldRefresh(e){var t,i,r;const n=this.getModel(),o=n?null!==(t=n.conditions)&&void 0!==t?t:[n]:null,s=null!==(i=null===(r=e.filterOptions)||void 0===r?void 0:r.map((e=>"string"===typeof e?e:e.displayKey)))&&void 0!==i?i:this.getDefaultFilterOptions();return!(o&&!o.every((e=>void 0!==s.find((t=>t===e.type)))))&&!("number"===typeof e.maxNumConditions&&o&&o.length>e.maxNumConditions)}refresh(e){if(!this.shouldRefresh(e))return!1;return!!super.refresh(e)&&(this.setParams(e),this.removeConditionsAndOperators(0),this.createOption(),this.setModel(this.getModel()),!0)}setModelIntoUi(e){if(e.operator){const t=e;let i=t.conditions;null==i&&(i=[],v("Filter model is missing 'conditions'"));const r=this.validateAndUpdateConditions(i),n=this.getNumConditions();if(r<n)this.removeConditionsAndOperators(r);else if(r>n)for(let e=n;e<r;e++)this.createJoinOperatorPanel(),this.createOption();const o="OR"===t.operator;this.eJoinOperatorsAnd.forEach((e=>e.setValue(!o,!0))),this.eJoinOperatorsOr.forEach((e=>e.setValue(o,!0))),i.forEach(((e,t)=>{this.eTypes[t].setValue(e.type,!0),this.setConditionIntoUi(e,t)}))}else{const t=e;this.getNumConditions()>1&&this.removeConditionsAndOperators(1),this.eTypes[0].setValue(t.type,!0),this.setConditionIntoUi(t,0)}return this.lastUiCompletePosition=this.getNumConditions()-1,this.createMissingConditionsAndOperators(),this.onUiChanged(),Wr.resolve()}validateAndUpdateConditions(e){let t=e.length;return t>this.maxNumConditions&&(e.splice(this.maxNumConditions),v('Filter Model contains more conditions than "filterParams.maxNumConditions". Additional conditions have been ignored.'),t=this.maxNumConditions),t}doesFilterPass(e){const t=this.getModel();if(null==t)return!0;const{operator:i}=t,r=[];if(i){var n;const e=t;r.push(...null!==(n=e.conditions)&&void 0!==n?n:[])}else r.push(t);return r[i&&"OR"===i?"some":"every"]((t=>this.individualConditionPasses(e,t)))}setParams(e){super.setParams(e),this.setNumConditions(e),this.defaultJoinOperator=this.getDefaultJoinOperator(e.defaultJoinOperator),this.filterPlaceholder=e.filterPlaceholder,this.optionsFactory=new Kn,this.optionsFactory.init(e,this.getDefaultFilterOptions()),this.createFilterListOptions(),this.createOption(),this.createMissingConditionsAndOperators(),this.isReadOnly()&&this.eFilterBody.setAttribute("tabindex","-1")}setNumConditions(e){var t,i;this.maxNumConditions=null!==(t=e.maxNumConditions)&&void 0!==t?t:2,this.maxNumConditions<1&&(v('"filterParams.maxNumConditions" must be greater than or equal to zero.'),this.maxNumConditions=1),this.numAlwaysVisibleConditions=null!==(i=e.numAlwaysVisibleConditions)&&void 0!==i?i:1,this.numAlwaysVisibleConditions<1&&(v('"filterParams.numAlwaysVisibleConditions" must be greater than or equal to zero.'),this.numAlwaysVisibleConditions=1),this.numAlwaysVisibleConditions>this.maxNumConditions&&(v('"filterParams.numAlwaysVisibleConditions" cannot be greater than "filterParams.maxNumConditions".'),this.numAlwaysVisibleConditions=this.maxNumConditions)}createOption(){const e=this.createManagedBean(new Un);this.eTypes.push(e),e.addCssClass("ag-filter-select"),this.eFilterBody.appendChild(e.getGui());const t=this.createValueElement();this.eConditionBodies.push(t),this.eFilterBody.appendChild(t),this.putOptionsIntoDropdown(e),this.resetType(e);const i=this.getNumConditions()-1;this.forEachPositionInput(i,(e=>this.resetInput(e))),this.addChangedListeners(e,i)}createJoinOperatorPanel(){const e=document.createElement("div");this.eJoinOperatorPanels.push(e),e.classList.add("ag-filter-condition");const t=this.createJoinOperator(this.eJoinOperatorsAnd,e,"and"),i=this.createJoinOperator(this.eJoinOperatorsOr,e,"or");this.eFilterBody.appendChild(e);const r=this.eJoinOperatorPanels.length-1,n=this.joinOperatorId++;this.resetJoinOperatorAnd(t,r,n),this.resetJoinOperatorOr(i,r,n),this.isReadOnly()||(t.onValueChange(this.listener),i.onValueChange(this.listener))}createJoinOperator(e,t,i){const r=this.createManagedBean(new Vn);return e.push(r),r.addCssClass("ag-filter-condition-operator"),r.addCssClass("ag-filter-condition-operator-".concat(i)),t.appendChild(r.getGui()),r}getDefaultJoinOperator(e){return"AND"===e||"OR"===e?e:"AND"}createFilterListOptions(){const e=this.optionsFactory.getFilterOptions();this.filterListOptions=e.map((e=>"string"===typeof e?this.createBoilerplateListOption(e):this.createCustomListOption(e)))}putOptionsIntoDropdown(e){this.filterListOptions.forEach((t=>{e.addOption(t)})),e.setDisabled(this.filterListOptions.length<=1)}createBoilerplateListOption(e){return{value:e,text:this.translate(e)}}createCustomListOption(e){const{displayKey:t}=e,i=this.optionsFactory.getCustomOption(e.displayKey);return{value:t,text:i?this.localeService.getLocaleTextFunc()(i.displayKey,i.displayName):this.translate(t)}}createBodyTemplate(){return""}getAgComponents(){return[]}getCssIdentifier(){return"simple-filter"}updateUiVisibility(){const e=this.getJoinOperator();this.updateNumConditions(),this.updateConditionStatusesAndValues(this.lastUiCompletePosition,e)}updateNumConditions(){let e=-1,t=!0;for(let r=0;r<this.getNumConditions();r++)this.isConditionUiComplete(r)?e=r:t=!1;if(this.shouldAddNewConditionAtEnd(t))this.createJoinOperatorPanel(),this.createOption();else{var i;const t=null!==(i=this.lastUiCompletePosition)&&void 0!==i?i:this.getNumConditions()-2;if(e<t){this.removeConditionsAndOperators(t+1);const i=e+1,r=t-i;r>0&&this.removeConditionsAndOperators(i,r),this.createMissingConditionsAndOperators()}}this.lastUiCompletePosition=e}updateConditionStatusesAndValues(e,t){this.eTypes.forEach(((t,i)=>{const r=this.isConditionDisabled(i,e);t.setDisabled(r||this.filterListOptions.length<=1),1===i&&(Ni(this.eJoinOperatorPanels[0],r),this.eJoinOperatorsAnd[0].setDisabled(r),this.eJoinOperatorsOr[0].setDisabled(r))})),this.eConditionBodies.forEach(((e,t)=>{Oi(e,this.isConditionBodyVisible(t))}));const i="OR"===(null!==t&&void 0!==t?t:this.getJoinOperator());this.eJoinOperatorsAnd.forEach((e=>{e.setValue(!i,!0)})),this.eJoinOperatorsOr.forEach((e=>{e.setValue(i,!0)})),this.forEachInput(((t,i,r,n)=>{this.setElementDisplayed(t,i<n),this.setElementDisabled(t,this.isConditionDisabled(r,e))})),this.resetPlaceholder()}shouldAddNewConditionAtEnd(e){return e&&this.getNumConditions()<this.maxNumConditions&&!this.isReadOnly()}removeConditionsAndOperators(e,t){if(e>=this.getNumConditions())return;this.removeComponents(this.eTypes,e,t),this.removeElements(this.eConditionBodies,e,t),this.removeValueElements(e,t);const i=Math.max(e-1,0);this.removeElements(this.eJoinOperatorPanels,i,t),this.removeComponents(this.eJoinOperatorsAnd,i,t),this.removeComponents(this.eJoinOperatorsOr,i,t)}removeElements(e,t,i){this.removeItems(e,t,i).forEach((e=>qi(e)))}removeComponents(e,t,i){this.removeItems(e,t,i).forEach((e=>{qi(e.getGui()),this.destroyBean(e)}))}removeItems(e,t,i){return null==i?e.splice(t):e.splice(t,i)}afterGuiAttached(e){if(super.afterGuiAttached(e),this.resetPlaceholder(),null===e||void 0===e||!e.suppressFocus)if(this.isReadOnly())this.eFilterBody.focus();else{const e=this.getInputs(0)[0];if(!e)return;e instanceof Dr&&e.getInputElement().focus()}}afterGuiDetached(){super.afterGuiDetached();const e=this.getModel();this.resetUiToActiveModel(e);let t=-1,i=-1,r=!1;const n=this.getJoinOperator();for(let s=this.getNumConditions()-1;s>=0;s--)if(this.isConditionUiComplete(s))-1===t&&(t=s,i=s);else{const e=s<t;(s>=this.numAlwaysVisibleConditions&&!this.isConditionUiComplete(s-1)||e)&&(this.removeConditionsAndOperators(s,1),r=!0,e&&i--)}let o=!1;this.getNumConditions()<this.numAlwaysVisibleConditions&&(this.createMissingConditionsAndOperators(),o=!0),this.shouldAddNewConditionAtEnd(i===this.getNumConditions()-1)&&(this.createJoinOperatorPanel(),this.createOption(),o=!0),o&&this.updateConditionStatusesAndValues(i,n),r&&this.updateJoinOperatorsDisabled(),this.lastUiCompletePosition=i}getPlaceholderText(e,t){let i=this.translate(e);if(w(this.filterPlaceholder)){const e=this.filterPlaceholder,r=this.eTypes[t].getValue();i=e({filterOptionKey:r,filterOption:this.translate(r),placeholder:i})}else"string"===typeof this.filterPlaceholder&&(i=this.filterPlaceholder);return i}resetPlaceholder(){const e=this.localeService.getLocaleTextFunc();this.forEachInput(((t,i,r,n)=>{if(!(t instanceof Dr))return;const o=0===i&&n>1?"inRangeStart":0===i?"filterOoo":"inRangeEnd",s=0===i&&n>1?e("ariaFilterFromValue","Filter from value"):0===i?e("ariaFilterValue","Filter Value"):e("ariaFilterToValue","Filter to Value");t.setInputPlaceholder(this.getPlaceholderText(o,r)),t.setInputAriaLabel(s)}))}setElementValue(e,t,i){e instanceof Dr&&e.setValue(null!=t?String(t):null,!0)}setElementDisplayed(e,t){e instanceof dr&&Oi(e.getGui(),t)}setElementDisabled(e,t){e instanceof dr&&Ni(e.getGui(),t)}attachElementOnChange(e,t){e instanceof Dr&&e.onValueChange(t)}forEachInput(e){this.getConditionTypes().forEach(((t,i)=>{this.forEachPositionTypeInput(i,t,e)}))}forEachPositionInput(e,t){const i=this.getConditionType(e);this.forEachPositionTypeInput(e,i,t)}forEachPositionTypeInput(e,t,i){const r=this.getNumberOfInputs(t),n=this.getInputs(e);for(let o=0;o<n.length;o++){const t=n[o];null!=t&&i(t,o,e,r)}}isConditionDisabled(e,t){return!!this.isReadOnly()||0!==e&&e>t+1}isConditionBodyVisible(e){const t=this.getConditionType(e);return this.getNumberOfInputs(t)>0}isConditionUiComplete(e){if(e>=this.getNumConditions())return!1;return"empty"!==this.getConditionType(e)&&!this.getValues(e).some((e=>null==e))}getNumConditions(){return this.eTypes.length}getUiCompleteConditions(){const e=[];for(let t=0;t<this.getNumConditions();t++)this.isConditionUiComplete(t)&&e.push(this.createCondition(t));return e}createMissingConditionsAndOperators(){if(!this.isReadOnly())for(let e=this.getNumConditions();e<this.numAlwaysVisibleConditions;e++)this.createJoinOperatorPanel(),this.createOption()}resetUiToDefaults(e){return this.removeConditionsAndOperators(this.isReadOnly()?1:this.numAlwaysVisibleConditions),this.eTypes.forEach((e=>this.resetType(e))),this.eJoinOperatorsAnd.forEach(((e,t)=>this.resetJoinOperatorAnd(e,t,this.joinOperatorId+t))),this.eJoinOperatorsOr.forEach(((e,t)=>this.resetJoinOperatorOr(e,t,this.joinOperatorId+t))),this.joinOperatorId++,this.forEachInput((e=>this.resetInput(e))),this.resetPlaceholder(),this.createMissingConditionsAndOperators(),this.lastUiCompletePosition=null,e||this.onUiChanged(),Wr.resolve()}resetType(e){const t=this.localeService.getLocaleTextFunc()("ariaFilteringOperator","Filtering operator");e.setValue(this.optionsFactory.getDefaultOption(),!0).setAriaLabel(t).setDisabled(this.isReadOnly()||this.filterListOptions.length<=1)}resetJoinOperatorAnd(e,t,i){this.resetJoinOperator(e,t,this.isDefaultOperator("AND"),this.translate("andCondition"),i)}resetJoinOperatorOr(e,t,i){this.resetJoinOperator(e,t,this.isDefaultOperator("OR"),this.translate("orCondition"),i)}resetJoinOperator(e,t,i,r,n){this.updateJoinOperatorDisabled(e.setValue(i,!0).setName("ag-simple-filter-and-or-".concat(this.getCompId(),"-").concat(n)).setLabel(r),t)}updateJoinOperatorsDisabled(){this.eJoinOperatorsAnd.forEach(((e,t)=>this.updateJoinOperatorDisabled(e,t))),this.eJoinOperatorsOr.forEach(((e,t)=>this.updateJoinOperatorDisabled(e,t)))}updateJoinOperatorDisabled(e,t){e.setDisabled(this.isReadOnly()||t>0)}resetInput(e){this.setElementValue(e,null),this.setElementDisabled(e,this.isReadOnly())}setConditionIntoUi(e,t){const i=this.mapValuesFromModel(e);this.forEachInput(((e,r,n)=>{n===t&&this.setElementValue(e,null!=i[r]?i[r]:null)}))}setValueFromFloatingFilter(e){this.forEachInput(((t,i,r)=>{this.setElementValue(t,0===i&&0===r?e:null,!0)}))}isDefaultOperator(e){return e===this.defaultJoinOperator}addChangedListeners(e,t){this.isReadOnly()||(e.onValueChange(this.listener),this.forEachPositionInput(t,(e=>{this.attachElementOnChange(e,this.listener)})))}individualConditionPasses(e,t){const i=this.getCellValue(e.node),r=this.mapValuesFromModel(t),n=this.optionsFactory.getCustomOption(t.type),o=this.evaluateCustomFilter(n,r,i);return null!=o?o:null==i?this.evaluateNullValue(t.type):this.evaluateNonNullValue(r,i,t,e)}evaluateCustomFilter(e,t,i){if(null==e)return;const{predicate:r}=e;return null==r||t.some((e=>null==e))?void 0:r(t,i)}isBlank(e){return null==e||"string"===typeof e&&0===e.trim().length}hasInvalidInputs(){return!1}},qn=class extends Yn{setParams(e){super.setParams(e),this.scalarFilterParams=e}evaluateNullValue(e){switch(e){case"equals":if(this.scalarFilterParams.includeBlanksInEquals)return!0;break;case"notEqual":if(this.scalarFilterParams.includeBlanksInNotEqual)return!0;break;case"greaterThan":case"greaterThanOrEqual":if(this.scalarFilterParams.includeBlanksInGreaterThan)return!0;break;case"lessThan":case"lessThanOrEqual":if(this.scalarFilterParams.includeBlanksInLessThan)return!0;break;case"inRange":if(this.scalarFilterParams.includeBlanksInRange)return!0;break;case"blank":return!0;case"notBlank":return!1}return!1}evaluateNonNullValue(e,t,i){const r=this.comparator(),n=null!=e[0]?r(e[0],t):0;switch(i.type){case"equals":return 0===n;case"notEqual":return 0!==n;case"greaterThan":return n>0;case"greaterThanOrEqual":return n>=0;case"lessThan":return n<0;case"lessThanOrEqual":return n<=0;case"inRange":{const i=r(e[1],t);return this.scalarFilterParams.inRangeInclusive?n>=0&&i<=0:n>0&&i<0}case"blank":return this.isBlank(t);case"notBlank":return!this.isBlank(t);default:return v('Unexpected type of filter "'+i.type+'", it looks like the filter was configured with incorrect Filter Options'),!0}}};function Qn(e){var t;if(e.altKey||e.ctrlKey||e.metaKey)return!1;return 1===(null===(t=e.key)||void 0===t?void 0:t.length)}function $n(e,t,i,r,n){const o=r?r.getColDef().suppressKeyboardEvent:void 0;if(!o)return!1;const s=e.addGridCommonParams({event:t,editing:n,column:r,node:i,data:i.data,colDef:r.getColDef()});if(o){if(o(s))return!0}return!1}var Xn=class extends Dr{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ag-text-field",arguments.length>2&&void 0!==arguments[2]?arguments[2]:"text")}postConstruct(){super.postConstruct(),this.config.allowedCharPattern&&this.preventDisallowedCharacters()}setValue(e,t){return this.eInput.value!==e&&(this.eInput.value=F(e)?e:""),super.setValue(e,t)}setStartValue(e){this.setValue(e,!0)}preventDisallowedCharacters(){const e=new RegExp("[".concat(this.config.allowedCharPattern,"]"));this.addManagedListeners(this.eInput,{keydown:t=>{Qn(t)&&t.key&&!e.test(t.key)&&t.preventDefault()},paste:t=>{var i;const r=null===(i=t.clipboardData)||void 0===i?void 0:i.getData("text");r&&r.split("").some((t=>!e.test(t)))&&t.preventDefault()}})}},Jn={selector:"AG-INPUT-TEXT-FIELD",component:Xn},Zn=class extends Xn{constructor(e){super(e,"ag-number-field","number")}postConstruct(){super.postConstruct(),this.addManagedListeners(this.eInput,{blur:()=>{const e=parseFloat(this.eInput.value),t=isNaN(e)?"":this.normalizeValue(e.toString());this.value!==t&&this.setValue(t)},wheel:this.onWheel.bind(this)}),this.eInput.step="any";const{precision:e,min:t,max:i,step:r}=this.config;"number"===typeof e&&this.setPrecision(e),"number"===typeof t&&this.setMin(t),"number"===typeof i&&this.setMax(i),"number"===typeof r&&this.setStep(r)}onWheel(e){Z(this.gos)===this.eInput&&e.preventDefault()}normalizeValue(e){if(""===e)return"";null!=this.precision&&(e=this.adjustPrecision(e));const t=parseFloat(e);return null!=this.min&&t<this.min?e=this.min.toString():null!=this.max&&t>this.max&&(e=this.max.toString()),e}adjustPrecision(e,t){if(null==this.precision)return e;if(t){const t=parseFloat(e).toFixed(this.precision);return parseFloat(t).toString()}const i=String(e).split(".");if(i.length>1){if(i[1].length<=this.precision)return e;if(this.precision>0)return"".concat(i[0],".").concat(i[1].slice(0,this.precision))}return i[0]}setMin(e){return this.min===e||(this.min=e,rr(this.eInput,"min",e)),this}setMax(e){return this.max===e||(this.max=e,rr(this.eInput,"max",e)),this}setPrecision(e){return this.precision=e,this}setStep(e){return this.step===e||(this.step=e,rr(this.eInput,"step",e)),this}setValue(e,t){return this.setValueOrInputValue((e=>super.setValue(e,t)),(()=>this),e)}setStartValue(e){return this.setValueOrInputValue((e=>super.setValue(e,!0)),(e=>{this.eInput.value=e}),e)}setValueOrInputValue(e,t,i){if(F(i)){let r=this.isScientificNotation(i);if(r&&this.eInput.validity.valid)return e(i);if(!r){r=(i=this.adjustPrecision(i))!=this.normalizeValue(i)}if(r)return t(i)}return e(i)}getValue(){if(!this.eInput.validity.valid)return;const e=this.eInput.value;return this.isScientificNotation(e)?this.adjustPrecision(e,!0):super.getValue()}isScientificNotation(e){return"string"===typeof e&&e.includes("e")}},eo={selector:"AG-INPUT-NUMBER-FIELD",component:Zn},to=["equals","notEqual","greaterThan","greaterThanOrEqual","lessThan","lessThanOrEqual","inRange","blank","notBlank"],io=class{constructor(e,t,i){this.localeService=e,this.optionsFactory=t,this.valueFormatter=i}getModelAsString(e){if(!e)return null;const t=null!=e.operator,i=this.localeService.getLocaleTextFunc();if(t){var r;const t=e,n=(null!==(r=t.conditions)&&void 0!==r?r:[]).map((e=>this.getModelAsString(e))),o="AND"===t.operator?"andCondition":"orCondition";return n.join(" ".concat(i(o,Bn[o])," "))}if("blank"===e.type||"notBlank"===e.type)return i(e.type,e.type);{const t=e,r=this.optionsFactory.getCustomOption(t.type),{displayKey:n,displayName:o,numberOfInputs:s}=r||{};return n&&o&&0===s?(i(n,o),o):this.conditionToString(t,r)}}updateParams(e){this.optionsFactory=e.optionsFactory}formatValue(e){var t;return this.valueFormatter?null!==(t=this.valueFormatter(null!==e&&void 0!==e?e:null))&&void 0!==t?t:"":String(e)}},ro=class extends io{conditionToString(e,t){const{numberOfInputs:i}=t||{};return"inRange"==e.type||2===i?"".concat(this.formatValue(e.filter),"-").concat(this.formatValue(e.filterTo)):null!=e.filter?this.formatValue(e.filter):"".concat(e.type)}};function no(e){const{allowedCharPattern:t}=null!==e&&void 0!==e?e:{};return null!==t&&void 0!==t?t:null}var oo=["contains","notContains","equals","notEqual","startsWith","endsWith","blank","notBlank"],so=class extends io{conditionToString(e,t){const{numberOfInputs:i}=t||{};return"inRange"==e.type||2===i?"".concat(e.filter,"-").concat(e.filterTo):null!=e.filter?"".concat(e.filter):"".concat(e.type)}};function ao(e){const t=e&&e.trim();return""===t?e:t}function lo(e){if("number"===typeof e)return e;if("string"===typeof e){const t=parseInt(e);if(isNaN(t))return;return t}}function co(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.MAX_VALUE;return i=>{const r=lo(i);if(!(null==r||r<e||r>t))return r}}function uo(e,t){return e.toString().padStart(t,"0")}function ho(e,t,i){return"number"!==typeof e?"":e.toString().replace(".",i).replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1".concat(t))}function go(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"-";if(!e)return null;let r=[e.getFullYear(),e.getMonth()+1,e.getDate()].map((e=>uo(e,2))).join(i);return t&&(r+=" "+[e.getHours(),e.getMinutes(),e.getSeconds()].map((e=>uo(e,2))).join(":")),r}var po=e=>{if(e>3&&e<21)return"th";switch(e%10){case 1:return"st";case 2:return"nd";case 3:return"rd"}return"th"};function fo(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD";const i=uo(e.getFullYear(),4),r=["January","February","March","April","May","June","July","August","September","October","November","December"],n=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],o={YYYY:()=>i.slice(i.length-4,i.length),YY:()=>i.slice(i.length-2,i.length),Y:()=>"".concat(e.getFullYear()),MMMM:()=>r[e.getMonth()],MMM:()=>r[e.getMonth()].slice(0,3),MM:()=>uo(e.getMonth()+1,2),Mo:()=>"".concat(e.getMonth()+1).concat(po(e.getMonth()+1)),M:()=>"".concat(e.getMonth()+1),Do:()=>"".concat(e.getDate()).concat(po(e.getDate())),DD:()=>uo(e.getDate(),2),D:()=>"".concat(e.getDate()),dddd:()=>n[e.getDay()],ddd:()=>n[e.getDay()].slice(0,3),dd:()=>n[e.getDay()].slice(0,2),do:()=>"".concat(e.getDay()).concat(po(e.getDay())),d:()=>"".concat(e.getDay())},s=new RegExp(Object.keys(o).join("|"),"g");return t.replace(s,(e=>e in o?o[e]():e))}function mo(e){if(!e)return null;const[t,i]=e.split(" ");if(!t)return null;const r=t.split("-").map((e=>parseInt(e,10)));if(3!==r.filter((e=>!isNaN(e))).length)return null;const[n,o,s]=r,a=new Date(n,o-1,s);if(a.getFullYear()!==n||a.getMonth()!==o-1||a.getDate()!==s)return null;if(!i||"00:00:00"===i)return a;const[l,c,u]=i.split(":").map((e=>parseInt(e,10)));return l>=0&&l<24&&a.setHours(l),c>=0&&c<60&&a.setMinutes(c),u>=0&&u<60&&a.setSeconds(u),a}var vo=class{constructor(e,t,i,r,n){this.alive=!0,this.context=e,this.eParent=r;t.getDateCompDetails(i).newAgStackInstance().then((t=>{this.alive?(this.dateComp=t,t&&(r.appendChild(t.getGui()),t.afterGuiAttached&&t.afterGuiAttached(),this.tempValue&&t.setDate(this.tempValue),null!=this.disabled&&this.setDateCompDisabled(this.disabled),null===n||void 0===n||n(this))):e.destroyBean(t)}))}destroy(){this.alive=!1,this.dateComp=this.context.destroyBean(this.dateComp)}getDate(){return this.dateComp?this.dateComp.getDate():this.tempValue}setDate(e){this.dateComp?this.dateComp.setDate(e):this.tempValue=e}setDisabled(e){this.dateComp?this.setDateCompDisabled(e):this.disabled=e}setDisplayed(e){Oi(this.eParent,e)}setInputPlaceholder(e){this.dateComp&&this.dateComp.setInputPlaceholder&&this.dateComp.setInputPlaceholder(e)}setInputAriaLabel(e){this.dateComp&&this.dateComp.setInputAriaLabel&&this.dateComp.setInputAriaLabel(e)}afterGuiAttached(e){this.dateComp&&"function"===typeof this.dateComp.afterGuiAttached&&this.dateComp.afterGuiAttached(e)}updateParams(e){var t,i;let r=!1;if(null!==(t=this.dateComp)&&void 0!==t&&t.refresh&&"function"===typeof this.dateComp.refresh){null!==this.dateComp.refresh(e)&&(r=!0)}if(!r&&null!==(i=this.dateComp)&&void 0!==i&&i.onParamsUpdated&&"function"===typeof this.dateComp.onParamsUpdated){null!==this.dateComp.onParamsUpdated(e)&&v("Custom date component method 'onParamsUpdated' is deprecated. Use 'refresh' instead.")}}setDateCompDisabled(e){null!=this.dateComp&&null!=this.dateComp.setDisabled&&this.dateComp.setDisabled(e)}},Co=["equals","notEqual","lessThan","greaterThan","inRange","blank","notBlank"],wo=class extends io{constructor(e,t,i){super(t,i),this.dateFilterParams=e}conditionToString(e,t){const{type:i}=e,{numberOfInputs:r}=t||{},n="inRange"==i||2===r,o=mo(e.dateFrom),s=mo(e.dateTo),a=this.dateFilterParams.inRangeFloatingFilterDateFormat;if(n){const e=null!==o?fo(o,a):"null",t=null!==s?fo(s,a):"null";return"".concat(e,"-").concat(t)}return null!=o?fo(o,a):"".concat(i)}updateParams(e){super.updateParams(e),this.dateFilterParams=e.dateFilterParams}},bo=1/0,So=class extends He{constructor(e,t,i,r){super(),this.columnOrGroup=e,this.columnOrGroup=e,this.eCell=t,this.ariaEl=this.eCell.querySelector("[role=columnheader]")||this.eCell,this.colsSpanning=r,this.beans=i}setColsSpanning(e){this.colsSpanning=e,this.onLeftChanged()}getColumnOrGroup(){return this.beans.gos.get("enableRtl")&&this.colsSpanning?ye(this.colsSpanning):this.columnOrGroup}postConstruct(){const e=this.onLeftChanged.bind(this);this.addManagedListeners(this.columnOrGroup,{leftChanged:e}),this.setLeftFirstTime(),this.addManagedEventListeners({displayedColumnsWidthChanged:e}),this.addManagedPropertyListener("domLayout",e)}setLeftFirstTime(){const e=this.beans.gos.get("suppressColumnMoveAnimation"),t=F(this.columnOrGroup.getOldLeft());this.beans.columnAnimationService.isActive()&&t&&!e?this.animateInLeft():this.onLeftChanged()}animateInLeft(){const e=this.getColumnOrGroup(),t=e.getLeft(),i=e.getOldLeft(),r=this.modifyLeftForPrintLayout(e,i),n=this.modifyLeftForPrintLayout(e,t);this.setLeft(r),this.actualLeft=n,this.beans.columnAnimationService.executeNextVMTurn((()=>{this.actualLeft===n&&this.setLeft(n)}))}onLeftChanged(){const e=this.getColumnOrGroup(),t=e.getLeft();this.actualLeft=this.modifyLeftForPrintLayout(e,t),this.setLeft(this.actualLeft)}modifyLeftForPrintLayout(e,t){if(!z(this.beans.gos,"print"))return t;if("left"===e.getPinned())return t;const i=this.beans.visibleColsService.getColsLeftWidth();if("right"===e.getPinned()){return i+this.beans.visibleColsService.getBodyContainerWidth()+t}return i+t}setLeft(e){if(F(e)&&(this.eCell.style.left="".concat(e,"px")),It(this.columnOrGroup)){const e=this.columnOrGroup.getLeafColumns();if(!e.length)return;e.length>1&&(t=this.ariaEl,i=e.length,si(t,"colspan",i))}var t,i}};function yo(e,t,i,r){return P(e)?[]:Eo(e.headerClass,e,t,i,r)}function Ro(e,t,i){e.addOrRemoveCssClass("ag-column-first",i.isColAtEdge(t,"first")),e.addOrRemoveCssClass("ag-column-last",i.isColAtEdge(t,"last"))}function Eo(e,t,i,r,n){if(P(e))return[];let o;if("function"===typeof e){const s=function(e,t,i,r){return t.addGridCommonParams({colDef:e,column:i,columnGroup:r})}(t,i,r,n);o=e(s)}else o=e;return"string"===typeof o?[o]:Array.isArray(o)?[...o]:[]}var xo=0,To=class e extends He{constructor(e,t,i){super(),this.resizeToggleTimeout=0,this.resizeMultiplier=1,this.resizeFeature=null,this.lastFocusEvent=null,this.dragSource=null,this.columnGroupChild=e,this.parentRowCtrl=i,this.beans=t,this.instanceId=e.getUniqueId()+"-"+xo++}wireBeans(e){this.pinnedWidthService=e.pinnedWidthService,this.focusService=e.focusService,this.userComponentFactory=e.userComponentFactory,this.ctrlsService=e.ctrlsService,this.dragAndDropService=e.dragAndDropService,this.menuService=e.menuService}postConstruct(){const e=this.refreshTabIndex.bind(this);this.addManagedPropertyListeners(["suppressHeaderFocus"],e),this.addManagedEventListeners({overlayExclusiveChanged:e})}shouldStopEventPropagation(e){const{headerRowIndex:t,column:i}=this.focusService.getFocusedHeader();return function(e,t,i,r){const n=r.getDefinition(),o=n&&n.suppressHeaderKeyboardEvent;return!!F(o)&&!!o(e.addGridCommonParams({colDef:n,column:r,headerRowIndex:i,event:t}))}(this.gos,e,t,i)}getWrapperHasFocus(){return Z(this.gos)===this.eGui}setGui(e,t){this.eGui=e,this.addDomData(t),t.addManagedListeners(this.beans.eventService,{displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this)}),t.addManagedElementListeners(this.eGui,{focus:this.onGuiFocus.bind(this)}),this.onDisplayedColumnsChanged(),this.refreshTabIndex()}onGuiFocus(){this.eventService.dispatchEvent({type:"headerFocused",column:this.column})}setupAutoHeight(e){const{wrapperElement:t,checkMeasuringCallback:i,compBean:r}=e,{animationFrameService:n,resizeObserverService:o,columnModel:s,gos:a}=this.beans,l=e=>{if(!this.isAlive()||!r.isAlive())return;const{paddingTop:i,paddingBottom:o,borderBottomWidth:c,borderTopWidth:u}=Gi(this.getGui()),d=i+o+c+u,h=t.offsetHeight+d;if(e<5){const i=Q(a);if(!i||!i.contains(t)||0==h)return void n.requestAnimationFrame((()=>l(e+1)))}s.setColHeaderHeight(this.column,h)};let c,u=!1;const d=()=>{const e=this.column.isAutoHeaderHeight();e&&!u&&h(),!e&&u&&g()},h=()=>{u=!0,l(0),this.comp.addOrRemoveCssClass("ag-header-cell-auto-height",!0),c=o.observeResize(t,(()=>l(0)))},g=()=>{u=!1,c&&c(),this.comp.addOrRemoveCssClass("ag-header-cell-auto-height",!1),c=void 0};d(),r.addDestroyFunc((()=>g())),r.addManagedListeners(this.column,{widthChanged:()=>u&&l(0)}),r.addManagedEventListeners({sortChanged:()=>{u&&window.setTimeout((()=>l(0)))}}),i&&i(d)}onDisplayedColumnsChanged(){const{comp:e,column:t,beans:i,eGui:r}=this;e&&t&&r&&(Ro(e,t,i.visibleColsService),Ci(r,i.visibleColsService.getAriaColIndex(t)))}addResizeAndMoveKeyboardListeners(e){this.resizeFeature&&e.addManagedListeners(this.eGui,{keydown:this.onGuiKeyDown.bind(this),keyup:this.onGuiKeyUp.bind(this)})}refreshTabIndex(){const e=this.focusService.isHeaderFocusSuppressed();this.eGui&&rr(this.eGui,"tabindex",e?null:"-1")}onGuiKeyDown(e){const t=Z(this.gos),i=e.key===Tr.LEFT||e.key===Tr.RIGHT;if(this.isResizing&&(e.preventDefault(),e.stopImmediatePropagation()),t!==this.eGui||!e.shiftKey&&!e.altKey)return;if((this.isResizing||i)&&(e.preventDefault(),e.stopImmediatePropagation()),!i)return;const r=e.key===Tr.LEFT!==this.gos.get("enableRtl"),n=Cn[r?"Left":"Right"];if(e.altKey){var o;this.isResizing=!0,this.resizeMultiplier+=1;const t=this.getViewportAdjustedResizeDiff(e);this.resizeHeader(t,e.shiftKey),null===(o=this.resizeFeature)||void 0===o||o.toggleColumnResizing(!0)}else this.moveHeader(n)}getViewportAdjustedResizeDiff(e){let t=this.getResizeDiff(e);if(this.column.getPinned()){const e=this.pinnedWidthService.getPinnedLeftWidth(),i=this.pinnedWidthService.getPinnedRightWidth(),r=zi(this.ctrlsService.getGridBodyCtrl().getBodyViewportElement())-50;if(e+i+t>r){if(!(r>e+i))return 0;t=r-e-i}}return t}getResizeDiff(e){let t=e.key===Tr.LEFT!==this.gos.get("enableRtl");const i=this.column.getPinned(),r=this.gos.get("enableRtl");return i&&r!==("right"===i)&&(t=!t),(t?-1:1)*this.resizeMultiplier}onGuiKeyUp(){this.isResizing&&(this.resizeToggleTimeout&&(window.clearTimeout(this.resizeToggleTimeout),this.resizeToggleTimeout=0),this.isResizing=!1,this.resizeMultiplier=1,this.resizeToggleTimeout=window.setTimeout((()=>{var e;null===(e=this.resizeFeature)||void 0===e||e.toggleColumnResizing(!1)}),150))}handleKeyDown(e){const t=this.getWrapperHasFocus();switch(e.key){case Tr.PAGE_DOWN:case Tr.PAGE_UP:case Tr.PAGE_HOME:case Tr.PAGE_END:t&&e.preventDefault()}}addDomData(t){const i=e.DOM_DATA_KEY_HEADER_CTRL;q(this.gos,this.eGui,i,this),t.addDestroyFunc((()=>q(this.gos,this.eGui,i,null)))}getGui(){return this.eGui}focus(e){return!!this.eGui&&(this.lastFocusEvent=e||null,this.eGui.focus(),!0)}getRowIndex(){return this.parentRowCtrl.getRowIndex()}getParentRowCtrl(){return this.parentRowCtrl}getPinned(){return this.parentRowCtrl.getPinned()}getColumnGroupChild(){return this.columnGroupChild}removeDragSource(){this.dragSource&&(this.dragAndDropService.removeDragSource(this.dragSource),this.dragSource=null)}handleContextMenuMouseEvent(e,t,i){const r=null!==e&&void 0!==e?e:t;this.gos.get("preventDefaultOnContextMenu")&&r.preventDefault(),this.menuService.isHeaderContextMenuEnabled(i)&&this.menuService.showHeaderContextMenu(i,e,t),this.dispatchColumnMouseEvent("columnHeaderContextMenu",i)}dispatchColumnMouseEvent(e,t){this.eventService.dispatchEvent({type:e,column:t})}clearComponent(){this.removeDragSource(),this.resizeFeature=null,this.comp=null,this.eGui=null}destroy(){super.destroy(),this.column=null,this.lastFocusEvent=null,this.columnGroupChild=null,this.parentRowCtrl=null}};To.DOM_DATA_KEY_HEADER_CTRL="headerCtrl";var Fo=To,Po=class extends He{wireBeans(e){this.columnHoverService=e.columnHoverService}constructor(e,t){super(),this.columns=e,this.element=t}postConstruct(){this.gos.get("columnHoverHighlight")&&this.addMouseHoverListeners()}addMouseHoverListeners(){this.addManagedListeners(this.element,{mouseout:this.onMouseOut.bind(this),mouseover:this.onMouseOver.bind(this)})}onMouseOut(){this.columnHoverService.clearMouseOver()}onMouseOver(){this.columnHoverService.setMouseOver(this.columns)}};var Do="32.3.3";var ko={january:"January",february:"February",march:"March",april:"April",may:"May",june:"June",july:"July",august:"August",september:"September",october:"October",november:"November",december:"December"},Ao=["january","february","march","april","may","june","july","august","september","october","november","december"];var Mo=class extends dr{wireBeans(e){this.columnNameService=e.columnNameService}getDefaultDebounceMs(){return 0}destroy(){super.destroy()}isEventFromFloatingFilter(e){return e&&e.afterFloatingFilter}isEventFromDataChange(e){return null===e||void 0===e?void 0:e.afterDataChange}getLastType(){return this.lastType}isReadOnly(){return this.readOnly}setLastTypeFromModel(e){if(!e)return void(this.lastType=this.optionsFactory.getDefaultOption());let t;if(e.operator){t=e.conditions[0]}else t=e;this.lastType=t.type}canWeEditAfterModelFromParentFilter(e){if(!e)return this.isTypeEditable(this.lastType);if(e.operator)return!1;const t=e;return this.isTypeEditable(t.type)}init(e){this.setSimpleParams(e,!1)}setSimpleParams(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.optionsFactory=new Kn,this.optionsFactory.init(e.filterParams,this.getDefaultFilterOptions()),t||(this.lastType=this.optionsFactory.getDefaultOption()),this.readOnly=!!e.filterParams.readOnly;const i=this.isTypeEditable(this.optionsFactory.getDefaultOption());this.setEditable(i)}onParamsUpdated(e){this.refresh(e)}refresh(e){this.setSimpleParams(e)}doesFilterHaveSingleInput(e){const t=this.optionsFactory.getCustomOption(e),{numberOfInputs:i}=t||{};return null==i||1==i}isTypeEditable(e){return!!e&&!this.isReadOnly()&&this.doesFilterHaveSingleInput(e)&&["inRange","empty","blank","notBlank"].indexOf(e)<0}getAriaLabel(e){const t=this.columnNameService.getDisplayNameForColumn(e.column,"header",!0),i=this.localeService.getLocaleTextFunc();return"".concat(t," ").concat(i("ariaFilterInput","Filter Input"))}},Io=class extends He{constructor(e){super(),this.params=e,this.eFloatingFilterTextInput=ur,this.valueChangedListener=()=>{}}setupGui(e){var t;this.eFloatingFilterTextInput=this.createManagedBean(new Xn(null===(t=this.params)||void 0===t?void 0:t.config));const i=this.eFloatingFilterTextInput.getGui();e.appendChild(i);const r=e=>this.valueChangedListener(e);this.addManagedListeners(i,{input:r,keydown:r})}setEditable(e){this.eFloatingFilterTextInput.setDisabled(!e)}setAutoComplete(e){this.eFloatingFilterTextInput.setAutoComplete(e)}getValue(){return this.eFloatingFilterTextInput.getValue()}setValue(e,t){this.eFloatingFilterTextInput.setValue(e,t)}setValueChangedListener(e){this.valueChangedListener=e}setParams(e){this.setAriaLabel(e.ariaLabel),void 0!==e.autoComplete&&this.setAutoComplete(e.autoComplete)}setAriaLabel(e){this.eFloatingFilterTextInput.setInputAriaLabel(e)}},Lo=class extends Mo{constructor(){super(...arguments),this.eFloatingFilterInputContainer=ur}postConstruct(){this.setTemplate('\n            <div class="ag-floating-filter-input" role="presentation" data-ref="eFloatingFilterInputContainer"></div>\n        ')}getDefaultDebounceMs(){return 500}onParentModelChanged(e,t){this.isEventFromFloatingFilter(t)||this.isEventFromDataChange(t)||(this.setLastTypeFromModel(e),this.setEditable(this.canWeEditAfterModelFromParentFilter(e)),this.floatingFilterInputService.setValue(this.getFilterModelFormatter().getModelAsString(e)))}init(e){this.setupFloatingFilterInputService(e),super.init(e),this.setTextInputParams(e)}setupFloatingFilterInputService(e){this.floatingFilterInputService=this.createFloatingFilterInputService(e),this.floatingFilterInputService.setupGui(this.eFloatingFilterInputContainer)}setTextInputParams(e){var t;this.params=e;const i=null!==(t=e.browserAutoComplete)&&void 0!==t&&t;if(this.floatingFilterInputService.setParams({ariaLabel:this.getAriaLabel(e),autoComplete:i}),this.applyActive=Hn(this.params.filterParams),!this.isReadOnly()){const e=Gn(this.params.filterParams,this.getDefaultDebounceMs()),t=E(this.syncUpWithParentFilter.bind(this),e);this.floatingFilterInputService.setValueChangedListener(t)}}onParamsUpdated(e){this.refresh(e)}refresh(e){super.refresh(e),this.setTextInputParams(e)}recreateFloatingFilterInputService(e){const t=this.floatingFilterInputService.getValue();Yi(this.eFloatingFilterInputContainer),this.destroyBean(this.floatingFilterInputService),this.setupFloatingFilterInputService(e),this.floatingFilterInputService.setValue(t,!0)}syncUpWithParentFilter(e){const t=e.key===Tr.ENTER;if(this.applyActive&&!t)return;let i=this.floatingFilterInputService.getValue();this.params.filterParams.trimInput&&(i=ao(i),this.floatingFilterInputService.setValue(i,!0)),this.params.parentFilterInstance((e=>{e&&e.onFloatingFilterChanged(this.getLastType()||null,i||null)}))}setEditable(e){this.floatingFilterInputService.setEditable(e)}},Oo=class extends He{constructor(){super(...arguments),this.valueChangedListener=()=>{},this.numberInputActive=!0}setupGui(e){this.eFloatingFilterNumberInput=this.createManagedBean(new Zn),this.eFloatingFilterTextInput=this.createManagedBean(new Xn),this.eFloatingFilterTextInput.setDisabled(!0);const t=this.eFloatingFilterNumberInput.getGui(),i=this.eFloatingFilterTextInput.getGui();e.appendChild(t),e.appendChild(i),this.setupListeners(t,(e=>this.valueChangedListener(e))),this.setupListeners(i,(e=>this.valueChangedListener(e)))}setEditable(e){this.numberInputActive=e,this.eFloatingFilterNumberInput.setDisplayed(this.numberInputActive),this.eFloatingFilterTextInput.setDisplayed(!this.numberInputActive)}setAutoComplete(e){this.eFloatingFilterNumberInput.setAutoComplete(e),this.eFloatingFilterTextInput.setAutoComplete(e)}getValue(){return this.getActiveInputElement().getValue()}setValue(e,t){this.getActiveInputElement().setValue(e,t)}getActiveInputElement(){return this.numberInputActive?this.eFloatingFilterNumberInput:this.eFloatingFilterTextInput}setValueChangedListener(e){this.valueChangedListener=e}setupListeners(e,t){this.addManagedListeners(e,{input:t,keydown:t})}setParams(e){this.setAriaLabel(e.ariaLabel),void 0!==e.autoComplete&&this.setAutoComplete(e.autoComplete)}setAriaLabel(e){this.eFloatingFilterNumberInput.setInputAriaLabel(e),this.eFloatingFilterTextInput.setInputAriaLabel(e)}};var No={version:Do,moduleName:"@ag-grid-community/filter-core",beans:[class extends He{constructor(){super(...arguments),this.beanName="filterManager",this.advancedFilterModelUpdateQueue=[]}wireBeans(e){this.columnModel=e.columnModel,this.dataTypeService=e.dataTypeService,this.quickFilterService=e.quickFilterService,this.advancedFilterService=e.advancedFilterService,this.columnFilterService=e.columnFilterService}postConstruct(){const e=this.refreshFiltersForAggregations.bind(this),t=this.updateAdvancedFilterColumns.bind(this);this.addManagedEventListeners({columnValueChanged:e,columnPivotChanged:e,columnPivotModeChanged:e,newColumnsLoaded:t,columnVisible:t,advancedFilterEnabledChanged:e=>{let{enabled:t}=e;return this.onAdvancedFilterEnabledChanged(t)},dataTypesInferred:this.processFilterModelUpdateQueue.bind(this)}),this.externalFilterPresent=this.isExternalFilterPresentCallback(),this.addManagedPropertyListeners(["isExternalFilterPresent","doesExternalFilterPass"],(()=>{this.onFilterChanged({source:"api"})})),this.updateAggFiltering(),this.addManagedPropertyListener("groupAggFiltering",(()=>{this.updateAggFiltering(),this.onFilterChanged()})),this.addManagedPropertyListener("advancedFilterModel",(e=>this.setAdvancedFilterModel(e.currentValue))),this.quickFilterService&&this.addManagedListeners(this.quickFilterService,{quickFilterChanged:()=>this.onFilterChanged({source:"quickFilter"})})}isExternalFilterPresentCallback(){const e=this.gos.getCallback("isExternalFilterPresent");return"function"===typeof e&&e({})}doesExternalFilterPass(e){const t=this.gos.get("doesExternalFilterPass");return"function"===typeof t&&t(e)}setFilterModel(e){var t;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";this.isAdvancedFilterEnabled()?this.warnAdvancedFilters():null===(t=this.columnFilterService)||void 0===t||t.setFilterModel(e,i)}getFilterModel(){var e,t;return null!==(e=null===(t=this.columnFilterService)||void 0===t?void 0:t.getFilterModel())&&void 0!==e?e:{}}isColumnFilterPresent(){var e;return!(null===(e=this.columnFilterService)||void 0===e||!e.isColumnFilterPresent())}isAggregateFilterPresent(){var e;return!(null===(e=this.columnFilterService)||void 0===e||!e.isAggregateFilterPresent())}isExternalFilterPresent(){return this.externalFilterPresent}isChildFilterPresent(){return this.isColumnFilterPresent()||this.isQuickFilterPresent()||this.isExternalFilterPresent()||this.isAdvancedFilterPresent()}isAdvancedFilterPresent(){return this.isAdvancedFilterEnabled()&&this.advancedFilterService.isFilterPresent()}onAdvancedFilterEnabledChanged(e){var t,i;e?null!==(t=this.columnFilterService)&&void 0!==t&&t.disableColumnFilters()&&this.onFilterChanged({source:"advancedFilter"}):null!==(i=this.advancedFilterService)&&void 0!==i&&i.isFilterPresent()&&(this.advancedFilterService.setModel(null),this.onFilterChanged({source:"advancedFilter"}))}isAdvancedFilterEnabled(){var e;return!(null===(e=this.advancedFilterService)||void 0===e||!e.isEnabled())}isAdvancedFilterHeaderActive(){return this.isAdvancedFilterEnabled()&&this.advancedFilterService.isHeaderActive()}isAnyFilterPresent(){return this.isQuickFilterPresent()||this.isColumnFilterPresent()||this.isAggregateFilterPresent()||this.isExternalFilterPresent()||this.isAdvancedFilterPresent()}resetQuickFilterCache(){var e;null===(e=this.quickFilterService)||void 0===e||e.resetQuickFilterCache()}refreshFiltersForAggregations(){ne(this.gos)&&this.onFilterChanged()}onFilterChanged(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{source:t,additionalEventAttributes:i,columns:r=[]}=e;this.externalFilterPresent=this.isExternalFilterPresentCallback(),(this.columnFilterService?this.columnFilterService.updateBeforeFilterChanged(e):Wr.resolve()).then((()=>{var e;const n={source:t,type:"filterChanged",columns:r};i&&rt(n,i),this.eventService.dispatchEvent(n),null===(e=this.columnFilterService)||void 0===e||e.updateAfterFilterChanged()}))}isSuppressFlashingCellsBecauseFiltering(){var e;return!(null===(e=this.columnFilterService)||void 0===e||!e.isSuppressFlashingCellsBecauseFiltering())}isQuickFilterPresent(){var e;return!(null===(e=this.quickFilterService)||void 0===e||!e.isQuickFilterPresent())}updateAggFiltering(){this.aggFiltering=!!ne(this.gos)}isAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&this.shouldApplyQuickFilterAfterAgg()}isNonAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&!this.shouldApplyQuickFilterAfterAgg()}shouldApplyQuickFilterAfterAgg(){return(this.aggFiltering||this.columnModel.isPivotMode())&&!this.gos.get("applyQuickFilterBeforePivotOrAgg")}doesRowPassOtherFilters(e,t){return this.doesRowPassFilter({rowNode:t,filterInstanceToSkip:e})}doesRowPassAggregateFilters(e){return!(this.isAggregateQuickFilterPresent()&&!this.quickFilterService.doesRowPassQuickFilter(e.rowNode))&&!(this.isAggregateFilterPresent()&&!this.columnFilterService.doAggregateFiltersPass(e.rowNode,e.filterInstanceToSkip))}doesRowPassFilter(e){return!(this.isNonAggregateQuickFilterPresent()&&!this.quickFilterService.doesRowPassQuickFilter(e.rowNode))&&(!(this.isExternalFilterPresent()&&!this.doesExternalFilterPass(e.rowNode))&&(!(this.isColumnFilterPresent()&&!this.columnFilterService.doColumnFiltersPass(e.rowNode,e.filterInstanceToSkip))&&!(this.isAdvancedFilterPresent()&&!this.advancedFilterService.doesFilterPass(e.rowNode))))}isFilterActive(e){var t;return!(null===(t=this.columnFilterService)||void 0===t||!t.isFilterActive(e))}getOrCreateFilterWrapper(e){var t,i;return null!==(t=null===(i=this.columnFilterService)||void 0===i?void 0:i.getOrCreateFilterWrapper(e))&&void 0!==t?t:null}getDefaultFloatingFilter(e){return this.columnFilterService.getDefaultFloatingFilter(e)}createFilterParams(e,t){return this.columnFilterService.createFilterParams(e,t)}isFilterAllowed(e){var t;return!this.isAdvancedFilterEnabled()&&!(null===(t=this.columnFilterService)||void 0===t||!t.isFilterAllowed(e))}getFloatingFilterCompDetails(e,t){var i;return null===(i=this.columnFilterService)||void 0===i?void 0:i.getFloatingFilterCompDetails(e,t)}getCurrentFloatingFilterParentModel(e){var t;return null===(t=this.columnFilterService)||void 0===t?void 0:t.getCurrentFloatingFilterParentModel(e)}destroyFilter(e){var t;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";null===(t=this.columnFilterService)||void 0===t||t.destroyFilter(e,i)}areFilterCompsDifferent(e,t){var i;return!(null===(i=this.columnFilterService)||void 0===i||!i.areFilterCompsDifferent(e,t))}getAdvancedFilterModel(){return this.isAdvancedFilterEnabled()?this.advancedFilterService.getModel():null}setAdvancedFilterModel(e){var t;this.isAdvancedFilterEnabled()&&(null!==(t=this.dataTypeService)&&void 0!==t&&t.isPendingInference()?this.advancedFilterModelUpdateQueue.push(e):(this.advancedFilterService.setModel(null!==e&&void 0!==e?e:null),this.onFilterChanged({source:"advancedFilter"})))}toggleAdvancedFilterBuilder(e,t){this.isAdvancedFilterEnabled()&&this.advancedFilterService.getCtrl().toggleFilterBuilder({source:t,force:e})}updateAdvancedFilterColumns(){this.isAdvancedFilterEnabled()&&this.advancedFilterService.updateValidity()&&this.onFilterChanged({source:"advancedFilter"})}hasFloatingFilters(){var e;return!this.isAdvancedFilterEnabled()&&!(null===(e=this.columnFilterService)||void 0===e||!e.hasFloatingFilters())}getFilterInstance(e,t){var i;if(!this.isAdvancedFilterEnabled())return null===(i=this.columnFilterService)||void 0===i?void 0:i.getFilterInstance(e,t);this.warnAdvancedFilters()}getColumnFilterInstance(e){var t,i;return this.isAdvancedFilterEnabled()?(this.warnAdvancedFilters(),Promise.resolve(void 0)):null!==(t=null===(i=this.columnFilterService)||void 0===i?void 0:i.getColumnFilterInstance(e))&&void 0!==t?t:Promise.resolve(void 0)}warnAdvancedFilters(){v("Column Filter API methods have been disabled as Advanced Filters are enabled.")}setupAdvancedFilterHeaderComp(e){var t;null===(t=this.advancedFilterService)||void 0===t||t.getCtrl().setupHeaderComp(e)}getHeaderRowCount(){return this.isAdvancedFilterHeaderActive()?1:0}getHeaderHeight(){return this.isAdvancedFilterHeaderActive()?this.advancedFilterService.getCtrl().getHeaderHeight():0}processFilterModelUpdateQueue(){this.advancedFilterModelUpdateQueue.forEach((e=>this.setAdvancedFilterModel(e))),this.advancedFilterModelUpdateQueue=[]}getColumnFilterModel(e){var t;return null===(t=this.columnFilterService)||void 0===t?void 0:t.getColumnFilterModel(e)}setColumnFilterModel(e,t){var i,r;return this.isAdvancedFilterEnabled()?(this.warnAdvancedFilters(),Promise.resolve()):null!==(i=null===(r=this.columnFilterService)||void 0===r?void 0:r.setColumnFilterModel(e,t))&&void 0!==i?i:Promise.resolve()}setColDefPropertiesForDataType(e,t,i){var r;null===(r=this.columnFilterService)||void 0===r||r.setColDefPropertiesForDataType(e,t,i)}}]},Bo={version:Do,moduleName:"@ag-grid-community/filter-api",apiFunctions:{isAnyFilterPresent:function(e){var t;return!(null===(t=e.filterManager)||void 0===t||!t.isAnyFilterPresent())},onFilterChanged:function(e){var t;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";null===(t=e.filterManager)||void 0===t||t.onFilterChanged({source:i})}},dependantModules:[No]},Go={version:Do,moduleName:"@ag-grid-community/column-filter",beans:[class extends He{constructor(){super(...arguments),this.beanName="columnFilterService",this.allColumnFilters=new Map,this.allColumnListeners=new Map,this.activeAggregateFilters=[],this.activeColumnFilters=[],this.processingFilterChange=!1,this.filterModelUpdateQueue=[],this.columnFilterModelUpdateQueue=[]}wireBeans(e){this.valueService=e.valueService,this.columnModel=e.columnModel,this.rowModel=e.rowModel,this.userComponentFactory=e.userComponentFactory,this.rowRenderer=e.rowRenderer,this.dataTypeService=e.dataTypeService,this.filterManager=e.filterManager}postConstruct(){var e,t;this.addManagedEventListeners({gridColumnsChanged:this.onColumnsChanged.bind(this),rowDataUpdated:()=>this.onNewRowsLoaded("rowDataUpdated"),dataTypesInferred:this.processFilterModelUpdateQueue.bind(this)}),this.initialFilterModel=c({},null!==(e=null===(t=this.gos.get("initialState"))||void 0===t||null===(t=t.filter)||void 0===t?void 0:t.filterModel)&&void 0!==e?e:{})}setFilterModel(e){var t;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";if(null!==(t=this.dataTypeService)&&void 0!==t&&t.isPendingInference())return void this.filterModelUpdateQueue.push({model:e,source:i});const r=[],n=this.getFilterModel(!0);if(e){const t=new Set(Object.keys(e));this.allColumnFilters.forEach(((i,n)=>{const o=e[n];r.push(this.setModelOnFilterWrapper(i.filterPromise,o)),t.delete(n)})),t.forEach((t=>{const i=this.columnModel.getColDefCol(t)||this.columnModel.getCol(t);if(!i)return void v("setFilterModel() - no column found for colId: "+t);if(!i.isFilterAllowed())return void v("setFilterModel() - unable to fully apply model, filtering disabled for colId: "+t);const n=this.getOrCreateFilterWrapper(i);n?r.push(this.setModelOnFilterWrapper(n.filterPromise,e[t])):v("setFilterModel() - unable to fully apply model, unable to create filter for colId: "+t)}))}else this.allColumnFilters.forEach((e=>{r.push(this.setModelOnFilterWrapper(e.filterPromise,null))}));Wr.all(r).then((()=>{const e=this.getFilterModel(!0),t=[];var r;(this.allColumnFilters.forEach(((i,r)=>{L(n?n[r]:null,e?e[r]:null)||t.push(i.column)})),t.length>0)&&(null===(r=this.filterManager)||void 0===r||r.onFilterChanged({columns:t,source:i}))}))}setModelOnFilterWrapper(e,t){return new Wr((i=>{e.then((e=>{"function"!==typeof e.setModel&&(v("filter missing setModel method, which is needed for setFilterModel"),i()),(e.setModel(t)||Wr.resolve()).then((()=>i()))}))}))}getFilterModel(e){const t={},{allColumnFilters:i,initialFilterModel:r}=this;return i.forEach(((e,i)=>{const r=this.getModelFromFilterWrapper(e);F(r)&&(t[i]=r)})),e||Object.entries(r).forEach((e=>{var r;let[n,o]=e;F(o)&&!i.has(n)&&null!==(r=this.columnModel.getCol(n))&&void 0!==r&&r.isFilterAllowed()&&(t[n]=o)})),t}getModelFromFilterWrapper(e){const{filter:t}=e;return t?"function"!==typeof t.getModel?(v("filter API missing getModel method, which is needed for getFilterModel"),null):t.getModel():this.getModelFromInitialState(e.column)}getModelFromInitialState(e){var t;return null!==(t=this.initialFilterModel[e.getColId()])&&void 0!==t?t:null}isColumnFilterPresent(){return this.activeColumnFilters.length>0}isAggregateFilterPresent(){return!!this.activeAggregateFilters.length}disableColumnFilters(){return!!this.allColumnFilters.size&&(this.allColumnFilters.forEach((e=>this.disposeFilterWrapper(e,"advancedFilterEnabled"))),!0)}doAggregateFiltersPass(e,t){return this.doColumnFiltersPass(e,t,!0)}updateActiveFilters(){const e=!!ne(this.gos),t=t=>{if(!t.isPrimary())return!0;const i=!this.columnModel.isPivotActive();return!(!t.isValueActive()||!i)&&(!!this.columnModel.isPivotMode()||e)},i=[],r=[];return this.forEachColumnFilter(((e,n)=>{const o=(e=>!!e&&(e.isFilterActive?e.isFilterActive():(v("Filter is missing isFilterActive() method"),!1)))(e);o&&(t(n.column)?i.push(e):r.push(e))})).then((()=>{this.activeAggregateFilters=i,this.activeColumnFilters=r}))}updateFilterFlagInColumns(e,t){return this.forEachColumnFilter(((i,r)=>r.column.setFilterActive(i.isFilterActive(),e,t)))}forEachColumnFilter(e){return Wr.all(Array.from(this.allColumnFilters.values()).map((t=>t.filterPromise.then((i=>e(i,t))))))}doColumnFiltersPass(e,t,i){const{data:r,aggData:n}=e,o=i?this.activeAggregateFilters:this.activeColumnFilters,s=i?n:r;for(let a=0;a<o.length;a++){const i=o[a];if(null!=i&&i!==t){if("function"!==typeof i.doesFilterPass)throw new Error("Filter is missing method doesFilterPass");if(!i.doesFilterPass({node:e,data:s}))return!1}}return!0}callOnFilterChangedOutsideRenderCycle(e){const t=()=>{var t;return null===(t=this.filterManager)||void 0===t?void 0:t.onFilterChanged(e)};this.rowRenderer.isRefreshInProgress()?setTimeout(t,0):t()}updateBeforeFilterChanged(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{filterInstance:t,additionalEventAttributes:i}=e;return this.updateDependentFilters(),this.updateActiveFilters().then((()=>this.updateFilterFlagInColumns("filterChanged",i).then((()=>{this.allColumnFilters.forEach((e=>{e.filterPromise&&e.filterPromise.then((e=>{e&&e!==t&&e.onAnyFilterChanged&&e.onAnyFilterChanged()}))})),this.processingFilterChange=!0}))))}updateAfterFilterChanged(){this.processingFilterChange=!1}isSuppressFlashingCellsBecauseFiltering(){var e;return!(null!==(e=this.gos.get("allowShowChangeAfterFilter"))&&void 0!==e&&e)&&this.processingFilterChange}onNewRowsLoaded(e){this.forEachColumnFilter((e=>{e.onNewRowsLoaded&&e.onNewRowsLoaded()})).then((()=>this.updateFilterFlagInColumns(e,{afterDataChange:!0}))).then((()=>this.updateActiveFilters()))}createValueGetter(e){return t=>{let{node:i}=t;return this.valueService.getValue(e,i,!0)}}createGetValue(e){return(t,i)=>{const r=i?this.columnModel.getCol(i):e;return r?this.valueService.getValue(r,t,!0):void 0}}isFilterActive(e){var t;const{filter:i}=null!==(t=this.cachedFilter(e))&&void 0!==t?t:{};return i?i.isFilterActive():null!=this.getModelFromInitialState(e)}getOrCreateFilterWrapper(e){if(!e.isFilterAllowed())return null;let t=this.cachedFilter(e);return t||(t=this.createFilterWrapper(e),this.setColumnFilterWrapper(e,t)),t}cachedFilter(e){return this.allColumnFilters.get(e.getColId())}getDefaultFilter(e){let t;if(Se(this.gos))t="agSetColumnFilter";else{var i;const r=null===(i=this.dataTypeService)||void 0===i?void 0:i.getBaseDataType(e);t="number"===r?"agNumberColumnFilter":"date"===r||"dateString"===r?"agDateColumnFilter":"agTextColumnFilter"}return t}getDefaultFloatingFilter(e){let t;if(Se(this.gos))t="agSetColumnFloatingFilter";else{var i;const r=null===(i=this.dataTypeService)||void 0===i?void 0:i.getBaseDataType(e);t="number"===r?"agNumberColumnFloatingFilter":"date"===r||"dateString"===r?"agDateColumnFloatingFilter":"agTextColumnFloatingFilter"}return t}createFilterInstance(e,t){const i=this.getDefaultFilter(e),r=e.getColDef();let n;const o=c(c({},this.createFilterParams(e,r)),{},{filterModifiedCallback:()=>this.filterModifiedCallbackFactory(n,e)(),filterChangedCallback:t=>this.filterChangedCallbackFactory(n,e)(t),doesRowPassOtherFilter:e=>!this.filterManager||this.filterManager.doesRowPassOtherFilters(n,e)}),s=this.userComponentFactory.getFilterDetails(r,o,i);return s?{filterPromise:()=>{const e=s.newAgStackInstance();return null!=e&&e.then((e=>{n=e,t&&(t.filter=e)})),e},compDetails:s}:{filterPromise:null,compDetails:null}}createFilterParams(e,t){return this.gos.addGridCommonParams({column:e,colDef:et(t),rowModel:this.rowModel,filterChangedCallback:()=>{},filterModifiedCallback:()=>{},valueGetter:this.createValueGetter(e),getValue:this.createGetValue(e),doesRowPassOtherFilter:()=>!0})}createFilterWrapper(e){var t;const i={column:e,filterPromise:null,compiledElement:null,compDetails:null},{filterPromise:r,compDetails:n}=this.createFilterInstance(e,i);return i.filterPromise=null!==(t=null===r||void 0===r?void 0:r())&&void 0!==t?t:null,i.compDetails=n,i}onColumnsChanged(){const e=[];this.allColumnFilters.forEach(((t,i)=>{let r;r=t.column.isPrimary()?this.columnModel.getColDefCol(i):this.columnModel.getCol(i),r&&r===t.column||(e.push(t.column),this.disposeFilterWrapper(t,"columnChanged"),this.disposeColumnListener(i))}));const t=e.every((e=>"agGroupColumnFilter"===e.getColDef().filter));var i;e.length>0&&!t?null===(i=this.filterManager)||void 0===i||i.onFilterChanged({columns:e,source:"api"}):this.updateDependentFilters()}updateDependentFilters(){const e=this.columnModel.getAutoCols();null===e||void 0===e||e.forEach((e=>{"agGroupColumnFilter"===e.getColDef().filter&&this.getOrCreateFilterWrapper(e)}))}isFilterAllowed(e){var t;if(!e.isFilterAllowed())return!1;const{filter:i}=null!==(t=this.allColumnFilters.get(e.getColId()))&&void 0!==t?t:{};return!i||("function"!==typeof(null===i||void 0===i?void 0:i.isFilterAllowed)||i.isFilterAllowed())}getFloatingFilterCompDetails(e,t){const i=t=>{var i;const r=null===(i=this.getOrCreateFilterWrapper(e))||void 0===i?void 0:i.filterPromise;null!=r&&r.then((e=>{t(gn(e))}))},r=e.getColDef(),n=c(c({},this.createFilterParams(e,r)),{},{filterChangedCallback:()=>i((t=>this.filterChangedCallbackFactory(t,e)()))}),o=this.userComponentFactory.mergeParamsWithApplicationProvidedParams(r,rn,n);let s=function(e,t,i){if(null==t)return null;let r=null;const{compName:n,jsComp:o,fwComp:s}=hn.getCompKeys(e,t,rn);n?r={set:"agSetColumnFloatingFilter",agSetColumnFilter:"agSetColumnFloatingFilter",multi:"agMultiColumnFloatingFilter",agMultiColumnFilter:"agMultiColumnFloatingFilter",group:"agGroupColumnFloatingFilter",agGroupColumnFilter:"agGroupColumnFloatingFilter",number:"agNumberColumnFloatingFilter",agNumberColumnFilter:"agNumberColumnFloatingFilter",date:"agDateColumnFloatingFilter",agDateColumnFilter:"agDateColumnFloatingFilter",text:"agTextColumnFloatingFilter",agTextColumnFilter:"agTextColumnFloatingFilter"}[n]:null==o&&null==s&&!0===t.filter&&(r=i());return r}(this.frameworkOverrides,r,(()=>this.getDefaultFloatingFilter(e)));null==s&&(s="agReadOnlyFloatingFilter");const a={column:e,filterParams:o,currentParentModel:()=>this.getCurrentFloatingFilterParentModel(e),parentFilterInstance:i,showParentFilter:t,suppressFilterButton:!1};return this.userComponentFactory.getFloatingFilterCompDetails(r,a,s)}getCurrentFloatingFilterParentModel(e){var t;return this.getModelFromFilterWrapper(null!==(t=this.cachedFilter(e))&&void 0!==t?t:{column:e})}destroyFilter(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"api";const i=e.getColId(),r=this.allColumnFilters.get(i);var n;(this.disposeColumnListener(i),delete this.initialFilterModel[i],r)&&(this.disposeFilterWrapper(r,t),null===(n=this.filterManager)||void 0===n||n.onFilterChanged({columns:[e],source:"api"}))}disposeColumnListener(e){const t=this.allColumnListeners.get(e);t&&(this.allColumnListeners.delete(e),t())}disposeFilterWrapper(e,t){e.filterPromise.then((i=>{this.destroyBean(i),e.column.setFilterActive(!1,"filterDestroyed"),this.allColumnFilters.delete(e.column.getColId()),this.eventService.dispatchEvent({type:"filterDestroyed",source:t,column:e.column})}))}filterModifiedCallbackFactory(e,t){return()=>{this.eventService.dispatchEvent({type:"filterModified",column:t,filterInstance:e})}}filterChangedCallbackFactory(e,t){return i=>{var r;const n=null!==(r=null===i||void 0===i?void 0:i.source)&&void 0!==r?r:"columnFilter",o={filter:e,additionalEventAttributes:i,columns:[t],source:n};this.callOnFilterChangedOutsideRenderCycle(o)}}checkDestroyFilter(e){const t=this.allColumnFilters.get(e);if(!t)return;const i=t.column,{compDetails:r}=i.isFilterAllowed()?this.createFilterInstance(i):{compDetails:null};if(this.areFilterCompsDifferent(t.compDetails,r))return void this.destroyFilter(i,"paramsUpdated");const n=i.getColDef().filterParams;t.filterPromise?t.filterPromise.then((e=>{!1===(null===e||void 0===e||!e.refresh||e.refresh(c(c({},this.createFilterParams(i,i.getColDef())),{},{filterModifiedCallback:this.filterModifiedCallbackFactory(e,i),filterChangedCallback:this.filterChangedCallbackFactory(e,i),doesRowPassOtherFilter:t=>!this.filterManager||this.filterManager.doesRowPassOtherFilters(e,t)},n)))&&this.destroyFilter(i,"paramsUpdated")})):this.destroyFilter(i,"paramsUpdated")}setColumnFilterWrapper(e,t){const i=e.getColId();this.allColumnFilters.set(i,t),this.allColumnListeners.set(i,this.addManagedListeners(e,{colDefChanged:()=>this.checkDestroyFilter(i)})[0])}areFilterCompsDifferent(e,t){if(!t||!e)return!0;const{componentClass:i}=e,{componentClass:r}=t;return!(i===r||(null===i||void 0===i?void 0:i.render)&&(null===r||void 0===r?void 0:r.render)&&i.render===r.render)}hasFloatingFilters(){return this.columnModel.getCols().some((e=>e.getColDef().floatingFilter))}getFilterInstance(e,t){t&&this.getFilterInstanceImpl(e).then((e=>{const i=gn(e);t(i)}))}getColumnFilterInstance(e){return new Promise((t=>{this.getFilterInstanceImpl(e).then((e=>{t(gn(e))}))}))}getFilterInstanceImpl(e){var t;const i=this.columnModel.getColDefCol(e);if(!i)return Wr.resolve(void 0);const r=null===(t=this.getOrCreateFilterWrapper(i))||void 0===t?void 0:t.filterPromise;return null!==r&&void 0!==r?r:Wr.resolve(null)}processFilterModelUpdateQueue(){this.filterModelUpdateQueue.forEach((e=>{let{model:t,source:i}=e;return this.setFilterModel(t,i)})),this.filterModelUpdateQueue=[],this.columnFilterModelUpdateQueue.forEach((e=>{let{key:t,model:i,resolve:r}=e;this.setColumnFilterModel(t,i).then((()=>r()))})),this.columnFilterModelUpdateQueue=[]}getColumnFilterModel(e){const t=this.getFilterWrapper(e);return t?this.getModelFromFilterWrapper(t):null}setColumnFilterModel(e,t){var i;if(null!==(i=this.dataTypeService)&&void 0!==i&&i.isPendingInference()){let i=()=>{};const r=new Promise((e=>{i=e}));return this.columnFilterModelUpdateQueue.push({key:e,model:t,resolve:i}),r}const r=this.columnModel.getColDefCol(e),n=r?this.getOrCreateFilterWrapper(r):null;return n?(o=this.setModelOnFilterWrapper(n.filterPromise,t),new Promise((e=>{o.then((t=>e(t)))}))):Promise.resolve();var o}getFilterWrapper(e){var t;const i=this.columnModel.getColDefCol(e);return i&&null!==(t=this.cachedFilter(i))&&void 0!==t?t:null}setColDefPropertiesForDataType(e,t,i){const r=Se(this.gos),n=this.localeService.getLocaleTextFunc(),o=t=>{const{filterParams:i}=e;e.filterParams="object"===typeof i?c(c({},i),t):t};switch(t.baseDataType){case"number":r&&o({comparator:(e,t)=>{const i=null==e?0:parseInt(e),r=null==t?0:parseInt(t);return i===r?0:i>r?1:-1}});break;case"boolean":o(r?{valueFormatter:e=>F(e.value)?n(String(e.value),e.value?"True":"False"):n("blanks","(Blanks)")}:{maxNumConditions:1,debounceMs:0,filterOptions:["empty",{displayKey:"true",displayName:"True",predicate:(e,t)=>t,numberOfInputs:0},{displayKey:"false",displayName:"False",predicate:(e,t)=>!1===t,numberOfInputs:0}]});break;case"date":r&&o({valueFormatter:e=>{const t=i(e);return F(t)?t:n("blanks","(Blanks)")},treeList:!0,treeListFormatter:(e,t)=>{if(1===t&&null!=e){const t=Ao[Number(e)-1];return n(t,ko[t])}return null!==e&&void 0!==e?e:n("blanks","(Blanks)")}});break;case"dateString":{const e=t.dateParser;o(r?{valueFormatter:e=>{const t=i(e);return F(t)?t:n("blanks","(Blanks)")},treeList:!0,treeListPathGetter:t=>{const i=e(null!==t&&void 0!==t?t:void 0);return i?[String(i.getFullYear()),String(i.getMonth()+1),String(i.getDate())]:null},treeListFormatter:(e,t)=>{if(1===t&&null!=e){const t=Ao[Number(e)-1];return n(t,ko[t])}return null!==e&&void 0!==e?e:n("blanks","(Blanks)")}}:{comparator:(t,i)=>{const r=e(i);return null==i||r<t?-1:r>t?1:0}});break}case"object":r?o({valueFormatter:e=>{const t=i(e);return F(t)?t:n("blanks","(Blanks)")}}):e.filterValueGetter=e=>i({column:e.column,node:e.node,value:this.valueService.getValue(e.column,e.node)})}}destroy(){super.destroy(),this.allColumnFilters.forEach((e=>this.disposeFilterWrapper(e,"gridDestroyed"))),this.allColumnListeners.clear()}}],dependantModules:[No]},Ho={version:Do,moduleName:"@ag-grid-community/column-filter-api",apiFunctions:{isColumnFilterPresent:function(e){var t,i;return!(null===(t=e.filterManager)||void 0===t||!t.isColumnFilterPresent())||!(null===(i=e.filterManager)||void 0===i||!i.isAggregateFilterPresent())},getFilterInstance:function(e,t,i){var r;return null===(r=e.filterManager)||void 0===r?void 0:r.getFilterInstance(t,i)},getColumnFilterInstance:function(e,t){var i,r;return null!==(i=null===(r=e.filterManager)||void 0===r?void 0:r.getColumnFilterInstance(t))&&void 0!==i?i:Promise.resolve(void 0)},destroyFilter:function(e,t){const i=e.columnModel.getColDefCol(t);var r;if(i)return null===(r=e.filterManager)||void 0===r?void 0:r.destroyFilter(i,"api")},setFilterModel:function(e,t){e.frameworkOverrides.wrapIncoming((()=>{var i;return null===(i=e.filterManager)||void 0===i?void 0:i.setFilterModel(t)}))},getFilterModel:function(e){var t,i;return null!==(t=null===(i=e.filterManager)||void 0===i?void 0:i.getFilterModel())&&void 0!==t?t:{}},getColumnFilterModel:function(e,t){var i,r;return null!==(i=null===(r=e.filterManager)||void 0===r?void 0:r.getColumnFilterModel(t))&&void 0!==i?i:null},setColumnFilterModel:function(e,t,i){var r,n;return null!==(r=null===(n=e.filterManager)||void 0===n?void 0:n.setColumnFilterModel(t,i))&&void 0!==r?r:Promise.resolve()},showColumnFilter:function(e,t){const i=e.columnModel.getCol(t);i?e.menuService.showFilterMenu({column:i,containerType:"columnFilter",positionBy:"auto"}):C("column '".concat(t,"' not found"))}},dependantModules:[Go,Bo]},zo={version:Do,moduleName:"@ag-grid-community/floating-filter-core",controllers:[{name:"headerFilterCell",classImp:class extends Fo{constructor(e,t,i){super(e,t,i),this.iconCreated=!1,this.column=e}setComp(e,t,i,r,n){this.comp=e,n=Yt(this,this.beans.context,n),this.eButtonShowMainFilter=i,this.eFloatingFilterBody=r,this.setGui(t,n),this.setupActive(),this.setupWidth(n),this.setupLeft(n),this.setupHover(n),this.setupFocus(n),this.setupAria(),this.setupFilterButton(),this.setupUserComp(),this.setupSyncWithFilter(n),this.setupUi(),n.addManagedElementListeners(this.eButtonShowMainFilter,{click:this.showParentFilter.bind(this)}),this.setupFilterChangedListener(n),n.addManagedListeners(this.column,{colDefChanged:()=>this.onColDefChanged(n)}),n.addDestroyFunc((()=>{this.eButtonShowMainFilter=null,this.eFloatingFilterBody=null,this.userCompDetails=null,this.clearComponent()}))}resizeHeader(){}moveHeader(){}setupActive(){const e=this.column.getColDef(),t=!!e.filter,i=!!e.floatingFilter;this.active=t&&i}setupUi(){if(this.comp.setButtonWrapperDisplayed(!this.suppressFilterButton&&this.active),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-full-body",this.suppressFilterButton),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-body",!this.suppressFilterButton),!this.active||this.iconCreated)return;const e=pr("filter",this.gos,this.column);e&&(this.iconCreated=!0,this.eButtonShowMainFilter.appendChild(e))}setupFocus(e){e.createManagedBean(new Nn(this.eGui,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)}))}setupAria(){const e=this.localeService.getLocaleTextFunc();ui(this.eButtonShowMainFilter,e("ariaFilterMenuOpen","Open Filter Menu"))}onTabKeyDown(e){if(Z(this.gos)===this.eGui)return;const t=this.focusService.findNextFocusableElement(this.eGui,null,e.shiftKey);if(t)return this.beans.headerNavigationService.scrollToColumn(this.column),e.preventDefault(),void t.focus();const i=this.findNextColumnWithFloatingFilter(e.shiftKey);i&&this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:this.getParentRowCtrl().getRowIndex(),column:i},event:e})&&e.preventDefault()}findNextColumnWithFloatingFilter(e){const t=this.beans.visibleColsService;let i=this.column;do{if(i=e?t.getColBefore(i):t.getColAfter(i),!i)break}while(!i.getColDef().filter||!i.getColDef().floatingFilter);return i}handleKeyDown(e){super.handleKeyDown(e);const t=this.getWrapperHasFocus();switch(e.key){case Tr.UP:case Tr.DOWN:t||e.preventDefault();case Tr.LEFT:case Tr.RIGHT:if(t)return;e.stopPropagation();case Tr.ENTER:t&&this.focusService.focusInto(this.eGui)&&e.preventDefault();break;case Tr.ESCAPE:t||this.eGui.focus()}}onFocusIn(e){if(this.eGui.contains(e.relatedTarget))return;const t=!!e.relatedTarget&&!e.relatedTarget.classList.contains("ag-floating-filter"),i=!!e.relatedTarget&&Bi(e.relatedTarget,"ag-floating-filter");if(t&&i&&e.target===this.eGui){const e=this.lastFocusEvent,t=!(!e||e.key!==Tr.TAB);if(e&&t){const t=e.shiftKey;this.focusService.focusInto(this.eGui,t)}}const r=this.getRowIndex();this.beans.focusService.setFocusedHeader(r,this.column)}setupHover(e){e.createManagedBean(new Po([this.column],this.eGui));const t=()=>{if(!this.gos.get("columnHoverHighlight"))return;const e=this.beans.columnHoverService.isHovered(this.column);this.comp.addOrRemoveCssClass("ag-column-hover",e)};e.addManagedEventListeners({columnHoverChanged:t}),t()}setupLeft(e){const t=new So(this.column,this.eGui,this.beans);e.createManagedBean(t)}setupFilterButton(){this.suppressFilterButton=!this.menuService.isFloatingFilterButtonEnabled(this.column),this.highlightFilterButtonWhenActive=!this.menuService.isLegacyMenuEnabled()}setupUserComp(){var e;if(!this.active)return;const t=null===(e=this.beans.filterManager)||void 0===e?void 0:e.getFloatingFilterCompDetails(this.column,(()=>this.showParentFilter()));t&&this.setCompDetails(t)}setCompDetails(e){this.userCompDetails=e,this.comp.setCompDetails(e)}showParentFilter(){const e=this.suppressFilterButton?this.eFloatingFilterBody:this.eButtonShowMainFilter;this.menuService.showFilterMenu({column:this.column,buttonElement:e,containerType:"floatingFilter",positionBy:"button"})}setupSyncWithFilter(e){if(!this.active)return;const{filterManager:t}=this.beans,i=e=>{if("filterDestroyed"===(null===e||void 0===e?void 0:e.source)&&!this.isAlive())return;const i=this.comp.getFloatingFilterComp();i&&i.then((i=>{if(i){var r;const n=null===t||void 0===t?void 0:t.getCurrentFloatingFilterParentModel(this.column),o=e?c(c({},e),{},{columns:null!==(r=e.columns)&&void 0!==r?r:[],source:"api"===e.source?"api":"columnFilter"}):null;i.onParentModelChanged(n,o)}}))};[this.destroySyncListener]=e.addManagedListeners(this.column,{filterChanged:i}),null!==t&&void 0!==t&&t.isFilterActive(this.column)&&i(null)}setupWidth(e){const t=()=>{const e="".concat(this.column.getActualWidth(),"px");this.comp.setWidth(e)};e.addManagedListeners(this.column,{widthChanged:t}),t()}setupFilterChangedListener(e){this.active&&([this.destroyFilterChangedListener]=e.addManagedListeners(this.column,{filterChanged:this.updateFilterButton.bind(this)}),this.updateFilterButton())}updateFilterButton(){if(!this.suppressFilterButton&&this.comp){var e;const t=!(null===(e=this.beans.filterManager)||void 0===e||!e.isFilterAllowed(this.column));this.comp.setButtonWrapperDisplayed(t),this.highlightFilterButtonWhenActive&&t&&this.eButtonShowMainFilter.classList.toggle("ag-filter-active",this.column.isFilterActive())}}onColDefChanged(e){var t;const i=this.active;this.setupActive();const r=!i&&this.active;i&&!this.active&&(this.destroySyncListener(),this.destroyFilterChangedListener());const n=this.active?null===(t=this.beans.filterManager)||void 0===t?void 0:t.getFloatingFilterCompDetails(this.column,(()=>this.showParentFilter())):null,o=this.comp.getFloatingFilterComp();o&&n?o.then((t=>{var i,o;!t||null!==(i=this.beans.filterManager)&&void 0!==i&&i.areFilterCompsDifferent(null!==(o=this.userCompDetails)&&void 0!==o?o:null,n)?this.updateCompDetails(e,n,r):this.updateFloatingFilterParams(n)})):this.updateCompDetails(e,n,r)}updateCompDetails(e,t,i){this.isAlive()&&(this.setCompDetails(t),this.setupFilterButton(),this.setupUi(),i&&(this.setupSyncWithFilter(e),this.setupFilterChangedListener(e)))}updateFloatingFilterParams(e){var t;if(!e)return;const i=e.params;null===(t=this.comp.getFloatingFilterComp())||void 0===t||t.then((e=>{let t=!1;if(null!==e&&void 0!==e&&e.refresh&&"function"===typeof e.refresh){null!==e.refresh(i)&&(t=!0)}if(!t&&null!==e&&void 0!==e&&e.onParamsUpdated&&"function"===typeof e.onParamsUpdated){null!==e.onParamsUpdated(i)&&v("Custom floating filter method 'onParamsUpdated' is deprecated. Use 'refresh' instead.")}}))}destroy(){super.destroy(),this.destroySyncListener=null,this.destroyFilterChangedListener=null}}}],dependantModules:[Go]},Vo={version:Do,moduleName:"@ag-grid-community/read-only-floating-filter",userComponents:[{name:"agReadOnlyFloatingFilter",classImp:class extends dr{constructor(){super('\n            <div class="ag-floating-filter-input" role="presentation">\n                <ag-input-text-field data-ref="eFloatingFilterText"></ag-input-text-field>\n            </div>',[Jn]),this.eFloatingFilterText=ur}wireBeans(e){this.columnNameService=e.columnNameService}destroy(){super.destroy()}init(e){this.params=e;const t=this.columnNameService.getDisplayNameForColumn(e.column,"header",!0),i=this.localeService.getLocaleTextFunc();this.eFloatingFilterText.setDisabled(!0).setInputAriaLabel("".concat(t," ").concat(i("ariaFilterInput","Filter Input")))}onParentModelChanged(e){null!=e?this.params.parentFilterInstance((t=>{if(t.getModelAsString){const i=t.getModelAsString(e);this.eFloatingFilterText.setValue(i)}})):this.eFloatingFilterText.setValue("")}onParamsUpdated(e){this.refresh(e)}refresh(e){this.init(e)}}}],dependantModules:[zo]},_o={version:Do,moduleName:"@ag-grid-community/simple-floating-filter",dependantModules:[{version:Do,moduleName:"@ag-grid-community/simple-filter",dependantModules:[Go],userComponents:[{name:"agTextColumnFilter",classImp:class extends Yn{constructor(){super("textFilter"),this.defaultFormatter=e=>e,this.defaultLowercaseFormatter=e=>null==e?null:e.toString().toLowerCase(),this.defaultMatcher=e=>{let{filterOption:t,value:i,filterText:r}=e;if(null==r)return!1;switch(t){case"contains":return i.indexOf(r)>=0;case"notContains":return i.indexOf(r)<0;case"equals":return i===r;case"notEqual":return i!=r;case"startsWith":return 0===i.indexOf(r);case"endsWith":{const e=i.lastIndexOf(r);return e>=0&&e===i.length-r.length}default:return!1}},this.eValuesFrom=[],this.eValuesTo=[]}getDefaultDebounceMs(){return 500}setParams(e){this.textFilterParams=e,super.setParams(e),this.matcher=this.getTextMatcher(),this.formatter=this.textFilterParams.textFormatter||(this.textFilterParams.caseSensitive?this.defaultFormatter:this.defaultLowercaseFormatter),this.filterModelFormatter=new so(this.localeService,this.optionsFactory)}getTextMatcher(){const e=this.textFilterParams.textCustomComparator;return e?(v("textCustomComparator is deprecated, use textMatcher instead."),t=>{let{filterOption:i,value:r,filterText:n}=t;return e(i,r,n)}):this.textFilterParams.textMatcher||this.defaultMatcher}createCondition(e){const t=this.getConditionType(e),i={filterType:this.getFilterType(),type:t},r=this.getValuesWithSideEffects(e,!0);return r.length>0&&(i.filter=r[0]),r.length>1&&(i.filterTo=r[1]),i}getFilterType(){return"text"}areSimpleModelsEqual(e,t){return e.filter===t.filter&&e.filterTo===t.filterTo&&e.type===t.type}getInputs(e){return e>=this.eValuesFrom.length?[null,null]:[this.eValuesFrom[e],this.eValuesTo[e]]}getValues(e){return this.getValuesWithSideEffects(e,!1)}getValuesWithSideEffects(e,t){const i=[];return this.forEachPositionInput(e,((e,r,n,o)=>{if(r<o){let r=T(e.getValue());var s;if(t&&this.textFilterParams.trimInput)r=null!==(s=ao(r))&&void 0!==s?s:null,e.setValue(r,!0);i.push(r)}})),i}getDefaultFilterOptions(){return oo}createValueElement(){const e=document.createElement("div");return e.classList.add("ag-filter-body"),ci(e,"presentation"),this.createFromToElement(e,this.eValuesFrom,"from"),this.createFromToElement(e,this.eValuesTo,"to"),e}createFromToElement(e,t,i){const r=this.createManagedBean(new Xn);r.addCssClass("ag-filter-".concat(i)),r.addCssClass("ag-filter-filter"),t.push(r),e.appendChild(r.getGui())}removeValueElements(e,t){this.removeComponents(this.eValuesFrom,e,t),this.removeComponents(this.eValuesTo,e,t)}mapValuesFromModel(e){const{filter:t,filterTo:i,type:r}=e||{};return[t||null,i||null].slice(0,this.getNumberOfInputs(r))}evaluateNullValue(e){return!!e&&["notEqual","notContains","blank"].indexOf(e)>=0}evaluateNonNullValue(e,t,i,r){const n=e.map((e=>this.formatter(e)))||[],o=this.formatter(t),{api:s,colDef:a,column:l,context:u,textFormatter:d}=this.textFilterParams;if("blank"===i.type)return this.isBlank(t);if("notBlank"===i.type)return!this.isBlank(t);const h={api:s,colDef:a,column:l,context:u,node:r.node,data:r.data,filterOption:i.type,value:o,textFormatter:d};return n.some((e=>this.matcher(c(c({},h),{},{filterText:e}))))}getModelAsString(e){var t;return null!==(t=this.filterModelFormatter.getModelAsString(e))&&void 0!==t?t:""}}},{name:"agNumberColumnFilter",classImp:class extends qn{constructor(){super("numberFilter"),this.eValuesFrom=[],this.eValuesTo=[]}refresh(e){return this.numberFilterParams.allowedCharPattern===e.allowedCharPattern&&super.refresh(e)}mapValuesFromModel(e){const{filter:t,filterTo:i,type:r}=e||{};return[this.processValue(t),this.processValue(i)].slice(0,this.getNumberOfInputs(r))}getDefaultDebounceMs(){return 500}comparator(){return(e,t)=>e===t?0:e<t?1:-1}setParams(e){this.numberFilterParams=e,super.setParams(e),this.filterModelFormatter=new ro(this.localeService,this.optionsFactory,this.numberFilterParams.numberFormatter)}getDefaultFilterOptions(){return to}setElementValue(e,t,i){const r=!i&&this.numberFilterParams.numberFormatter?this.numberFilterParams.numberFormatter(null!==t&&void 0!==t?t:null):t;super.setElementValue(e,r)}createValueElement(){const e=no(this.numberFilterParams),t=document.createElement("div");return t.classList.add("ag-filter-body"),ci(t,"presentation"),this.createFromToElement(t,this.eValuesFrom,"from",e),this.createFromToElement(t,this.eValuesTo,"to",e),t}createFromToElement(e,t,i,r){const n=this.createManagedBean(r?new Xn({allowedCharPattern:r}):new Zn);n.addCssClass("ag-filter-".concat(i)),n.addCssClass("ag-filter-filter"),t.push(n),e.appendChild(n.getGui())}removeValueElements(e,t){this.removeComponents(this.eValuesFrom,e,t),this.removeComponents(this.eValuesTo,e,t)}getValues(e){const t=[];return this.forEachPositionInput(e,((e,i,r,n)=>{i<n&&t.push(this.processValue(this.stringToFloat(e.getValue())))})),t}areSimpleModelsEqual(e,t){return e.filter===t.filter&&e.filterTo===t.filterTo&&e.type===t.type}getFilterType(){return"number"}processValue(e){return null==e||isNaN(e)?null:e}stringToFloat(e){if("number"===typeof e)return e;let t=T(e);return null!=t&&""===t.trim()&&(t=null),this.numberFilterParams.numberParser?this.numberFilterParams.numberParser(t):null==t||"-"===t.trim()?null:parseFloat(t)}createCondition(e){const t=this.getConditionType(e),i={filterType:this.getFilterType(),type:t},r=this.getValues(e);return r.length>0&&(i.filter=r[0]),r.length>1&&(i.filterTo=r[1]),i}getInputs(e){return e>=this.eValuesFrom.length?[null,null]:[this.eValuesFrom[e],this.eValuesTo[e]]}getModelAsString(e){var t;return null!==(t=this.filterModelFormatter.getModelAsString(e))&&void 0!==t?t:""}hasInvalidInputs(){let e=!1;return this.forEachInput((t=>{t.getInputElement().validity.valid||(e=!0)})),e}}},{name:"agDateColumnFilter",classImp:class extends qn{constructor(){super("dateFilter"),this.eConditionPanelsFrom=[],this.eConditionPanelsTo=[],this.dateConditionFromComps=[],this.dateConditionToComps=[],this.minValidYear=1e3,this.maxValidYear=bo,this.minValidDate=null,this.maxValidDate=null}wireBeans(e){super.wireBeans(e),this.context=e.context,this.userComponentFactory=e.userComponentFactory}afterGuiAttached(e){super.afterGuiAttached(e),this.dateConditionFromComps[0].afterGuiAttached(e)}mapValuesFromModel(e){const{dateFrom:t,dateTo:i,type:r}=e||{};return[t&&mo(t)||null,i&&mo(i)||null].slice(0,this.getNumberOfInputs(r))}comparator(){return this.dateFilterParams.comparator?this.dateFilterParams.comparator:this.defaultComparator.bind(this)}defaultComparator(e,t){return null==t||t<e?-1:t>e?1:0}setParams(e){this.dateFilterParams=e,super.setParams(e);const t=(t,i)=>{if(null!=e[t]){if(!isNaN(e[t]))return null==e[t]?i:Number(e[t]);v("DateFilter ".concat(t," is not a number"))}return i};this.minValidYear=t("minValidYear",1e3),this.maxValidYear=t("maxValidYear",bo),this.minValidYear>this.maxValidYear&&v("DateFilter minValidYear should be <= maxValidYear"),e.minValidDate?this.minValidDate=e.minValidDate instanceof Date?e.minValidDate:mo(e.minValidDate):this.minValidDate=null,e.maxValidDate?this.maxValidDate=e.maxValidDate instanceof Date?e.maxValidDate:mo(e.maxValidDate):this.maxValidDate=null,this.minValidDate&&this.maxValidDate&&this.minValidDate>this.maxValidDate&&v("DateFilter minValidDate should be <= maxValidDate"),this.filterModelFormatter=new wo(this.dateFilterParams,this.localeService,this.optionsFactory)}createDateCompWrapper(e){const t=new vo(this.context,this.userComponentFactory,{onDateChanged:()=>this.onUiChanged(),filterParams:this.dateFilterParams},e);return this.addDestroyFunc((()=>t.destroy())),t}setElementValue(e,t){e.setDate(t)}setElementDisplayed(e,t){e.setDisplayed(t)}setElementDisabled(e,t){e.setDisabled(t)}getDefaultFilterOptions(){return Co}createValueElement(){const e=Q(this.gos).createElement("div");return e.classList.add("ag-filter-body"),this.createFromToElement(e,this.eConditionPanelsFrom,this.dateConditionFromComps,"from"),this.createFromToElement(e,this.eConditionPanelsTo,this.dateConditionToComps,"to"),e}createFromToElement(e,t,i,r){const n=Q(this.gos).createElement("div");n.classList.add("ag-filter-".concat(r)),n.classList.add("ag-filter-date-".concat(r)),t.push(n),e.appendChild(n),i.push(this.createDateCompWrapper(n))}removeValueElements(e,t){this.removeDateComps(this.dateConditionFromComps,e,t),this.removeDateComps(this.dateConditionToComps,e,t),this.removeItems(this.eConditionPanelsFrom,e,t),this.removeItems(this.eConditionPanelsTo,e,t)}removeDateComps(e,t,i){this.removeItems(e,t,i).forEach((e=>e.destroy()))}isValidDateValue(e){if(null===e)return!1;if(this.minValidDate){if(e<this.minValidDate)return!1}else if(e.getUTCFullYear()<this.minValidYear)return!1;if(this.maxValidDate){if(e>this.maxValidDate)return!1}else if(e.getUTCFullYear()>this.maxValidYear)return!1;return!0}isConditionUiComplete(e){if(!super.isConditionUiComplete(e))return!1;let t=!0;return this.forEachInput(((i,r,n,o)=>{n!==e||!t||r>=o||(t=t&&this.isValidDateValue(i.getDate()))})),t}areSimpleModelsEqual(e,t){return e.dateFrom===t.dateFrom&&e.dateTo===t.dateTo&&e.type===t.type}getFilterType(){return"date"}createCondition(e){const t=this.getConditionType(e),i={},r=this.getValues(e);return r.length>0&&(i.dateFrom=go(r[0])),r.length>1&&(i.dateTo=go(r[1])),c({dateFrom:null,dateTo:null,filterType:this.getFilterType(),type:t},i)}resetPlaceholder(){const e=this.localeService.getLocaleTextFunc(),t=this.translate("dateFormatOoo"),i=e("ariaFilterValue","Filter Value");this.forEachInput((e=>{e.setInputPlaceholder(t),e.setInputAriaLabel(i)}))}getInputs(e){return e>=this.dateConditionFromComps.length?[null,null]:[this.dateConditionFromComps[e],this.dateConditionToComps[e]]}getValues(e){const t=[];return this.forEachPositionInput(e,((e,i,r,n)=>{i<n&&t.push(e.getDate())})),t}translate(e){return"lessThan"===e?super.translate("before"):"greaterThan"===e?super.translate("after"):super.translate(e)}getModelAsString(e){var t;return null!==(t=this.filterModelFormatter.getModelAsString(e))&&void 0!==t?t:""}}},{name:"agDateInput",classImp:class extends dr{constructor(){super('\n            <div class="ag-filter-filter">\n                <ag-input-text-field class="ag-date-filter" data-ref="eDateInput"></ag-input-text-field>\n            </div>',[Jn]),this.eDateInput=ur}destroy(){super.destroy()}init(e){this.params=e,this.setParams(e);const t=this.eDateInput.getInputElement();this.addManagedListeners(t,{mouseDown:()=>{this.eDateInput.isDisabled()||this.usingSafariDatePicker||t.focus()},input:e=>{e.target===Z(this.gos)&&(this.eDateInput.isDisabled()||this.params.onDateChanged())}})}setParams(e){const t=this.eDateInput.getInputElement(),i=this.shouldUseBrowserDatePicker(e);this.usingSafariDatePicker=i&&Ri(),t.type=i?"date":"text";const{minValidYear:r,maxValidYear:n,minValidDate:o,maxValidDate:s}=e.filterParams||{};if(o&&r&&v("DateFilter should not have both minValidDate and minValidYear parameters set at the same time! minValidYear will be ignored."),s&&n&&v("DateFilter should not have both maxValidDate and maxValidYear parameters set at the same time! maxValidYear will be ignored."),o&&s){const[e,t]=[o,s].map((e=>e instanceof Date?e:mo(e)));e&&t&&e.getTime()>t.getTime()&&v("DateFilter parameter minValidDate should always be lower than or equal to parameter maxValidDate.")}o?o instanceof Date?t.min=fo(o):t.min=o:r&&(t.min="".concat(r,"-01-01")),s?s instanceof Date?t.max=fo(s):t.max=s:n&&(t.max="".concat(n,"-12-31"))}onParamsUpdated(e){this.refresh(e)}refresh(e){this.params=e,this.setParams(e)}getDate(){return mo(this.eDateInput.getValue())}setDate(e){this.eDateInput.setValue(go(e,!1))}setInputPlaceholder(e){this.eDateInput.setInputPlaceholder(e)}setInputAriaLabel(e){this.eDateInput.setAriaLabel(e)}setDisabled(e){this.eDateInput.setDisabled(e)}afterGuiAttached(e){e&&e.suppressFocus||this.eDateInput.getInputElement().focus()}shouldUseBrowserDatePicker(e){return e.filterParams&&null!=e.filterParams.browserDatePicker?e.filterParams.browserDatePicker:xi()||Ti()||Ri()&&Ei()>=14.1}}}]},zo],userComponents:[{name:"agTextColumnFloatingFilter",classImp:class extends Lo{init(e){super.init(e),this.filterModelFormatter=new so(this.localeService,this.optionsFactory)}onParamsUpdated(e){this.refresh(e)}refresh(e){super.refresh(e),this.filterModelFormatter.updateParams({optionsFactory:this.optionsFactory})}getDefaultFilterOptions(){return oo}getFilterModelFormatter(){return this.filterModelFormatter}createFloatingFilterInputService(){return this.createManagedBean(new Io)}}},{name:"agNumberColumnFloatingFilter",classImp:class extends Lo{init(e){var t;super.init(e),this.filterModelFormatter=new ro(this.localeService,this.optionsFactory,null===(t=e.filterParams)||void 0===t?void 0:t.numberFormatter)}onParamsUpdated(e){this.refresh(e)}refresh(e){no(e.filterParams)!==this.allowedCharPattern&&this.recreateFloatingFilterInputService(e),super.refresh(e),this.filterModelFormatter.updateParams({optionsFactory:this.optionsFactory})}getDefaultFilterOptions(){return to}getFilterModelFormatter(){return this.filterModelFormatter}createFloatingFilterInputService(e){return this.allowedCharPattern=no(e.filterParams),this.allowedCharPattern?this.createManagedBean(new Io({config:{allowedCharPattern:this.allowedCharPattern}})):this.createManagedBean(new Oo)}}},{name:"agDateColumnFloatingFilter",classImp:class extends Mo{constructor(){super('\n            <div class="ag-floating-filter-input" role="presentation">\n                <ag-input-text-field data-ref="eReadOnlyText"></ag-input-text-field>\n                <div data-ref="eDateWrapper" style="display: flex;"></div>\n            </div>',[Jn]),this.eReadOnlyText=ur,this.eDateWrapper=ur}wireBeans(e){super.wireBeans(e),this.context=e.context,this.userComponentFactory=e.userComponentFactory}getDefaultFilterOptions(){return Co}init(e){super.init(e),this.params=e,this.filterParams=e.filterParams,this.createDateComponent(),this.filterModelFormatter=new wo(this.filterParams,this.localeService,this.optionsFactory);const t=this.localeService.getLocaleTextFunc();this.eReadOnlyText.setDisabled(!0).setInputAriaLabel(t("ariaDateFilterInput","Date Filter Input"))}onParamsUpdated(e){this.refresh(e)}refresh(e){super.refresh(e),this.params=e,this.filterParams=e.filterParams,this.updateDateComponent(),this.filterModelFormatter.updateParams({optionsFactory:this.optionsFactory,dateFilterParams:this.filterParams}),this.updateCompOnModelChange(e.currentParentModel())}updateCompOnModelChange(e){const t=!this.isReadOnly()&&this.canWeEditAfterModelFromParentFilter(e);if(this.setEditable(t),t){if(e){const t=e;this.dateComp.setDate(mo(t.dateFrom))}else this.dateComp.setDate(null);this.eReadOnlyText.setValue("")}else this.eReadOnlyText.setValue(this.filterModelFormatter.getModelAsString(e)),this.dateComp.setDate(null)}setEditable(e){Oi(this.eDateWrapper,e),Oi(this.eReadOnlyText.getGui(),!e)}onParentModelChanged(e,t){this.isEventFromFloatingFilter(t)||this.isEventFromDataChange(t)||(super.setLastTypeFromModel(e),this.updateCompOnModelChange(e))}onDateChanged(){const e=go(this.dateComp.getDate());this.params.parentFilterInstance((t=>{if(t){const i=mo(e);t.onFloatingFilterChanged(this.getLastType()||null,i)}}))}getDateComponentParams(){const e=Gn(this.params.filterParams,this.getDefaultDebounceMs());return{onDateChanged:E(this.onDateChanged.bind(this),e),filterParams:this.params.column.getColDef().filterParams}}createDateComponent(){this.dateComp=new vo(this.context,this.userComponentFactory,this.getDateComponentParams(),this.eDateWrapper,(e=>{e.setInputAriaLabel(this.getAriaLabel(this.params))})),this.addDestroyFunc((()=>this.dateComp.destroy()))}updateDateComponent(){const e=this.gos.addGridCommonParams(this.getDateComponentParams());this.dateComp.updateParams(e)}getFilterModelFormatter(){return this.filterModelFormatter}}}]},Wo={version:Do,moduleName:"@ag-grid-community/quick-filter-core",beans:[class extends He{constructor(){super(...arguments),this.beanName="quickFilterService",this.quickFilter=null,this.quickFilterParts=null}wireBeans(e){this.valueService=e.valueService,this.columnModel=e.columnModel,this.rowModel=e.rowModel,this.pivotResultColsService=e.pivotResultColsService}postConstruct(){const e=this.resetQuickFilterCache.bind(this);this.addManagedEventListeners({columnPivotModeChanged:e,newColumnsLoaded:e,columnRowGroupChanged:e,columnVisible:()=>{this.gos.get("includeHiddenColumnsInQuickFilter")||this.resetQuickFilterCache()}}),this.addManagedPropertyListener("quickFilterText",(e=>this.setQuickFilter(e.currentValue))),this.addManagedPropertyListeners(["includeHiddenColumnsInQuickFilter","applyQuickFilterBeforePivotOrAgg"],(()=>this.onQuickFilterColumnConfigChanged())),this.quickFilter=this.parseQuickFilter(this.gos.get("quickFilterText")),this.parser=this.gos.get("quickFilterParser"),this.matcher=this.gos.get("quickFilterMatcher"),this.setQuickFilterParts(),this.addManagedPropertyListeners(["quickFilterMatcher","quickFilterParser"],(()=>this.setQuickFilterParserAndMatcher()))}refreshQuickFilterCols(){var e,t;const i=this.columnModel.isPivotMode(),r=this.columnModel.getAutoCols(),n=this.columnModel.getColDefCols();let o=null!==(e=i&&!this.gos.get("applyQuickFilterBeforePivotOrAgg")?null===(t=this.pivotResultColsService.getPivotResultCols())||void 0===t?void 0:t.list:n)&&void 0!==e?e:[];r&&(o=o.concat(r)),this.colsForQuickFilter=this.gos.get("includeHiddenColumnsInQuickFilter")?o:o.filter((e=>e.isVisible()||e.isRowGroupActive()))}isQuickFilterPresent(){return null!==this.quickFilter}doesRowPassQuickFilter(e){const t=this.gos.get("cacheQuickFilter");return this.matcher?this.doesRowPassQuickFilterMatcher(t,e):this.quickFilterParts.every((i=>t?this.doesRowPassQuickFilterCache(e,i):this.doesRowPassQuickFilterNoCache(e,i)))}resetQuickFilterCache(){this.rowModel.forEachNode((e=>e.quickFilterAggregateText=null))}setQuickFilterParts(){const{quickFilter:e,parser:t}=this;this.quickFilterParts=e?t?t(e):e.split(" "):null}parseQuickFilter(e){return F(e)?G(this.gos)?e.toUpperCase():(v("Quick filtering only works with the Client-Side Row Model"),null):null}setQuickFilter(e){if(null!=e&&"string"!==typeof e)return void v("Grid option quickFilterText only supports string inputs, received: ".concat(typeof e));const t=this.parseQuickFilter(e);this.quickFilter!==t&&(this.quickFilter=t,this.setQuickFilterParts(),this.dispatchLocalEvent({type:"quickFilterChanged"}))}setQuickFilterParserAndMatcher(){const e=this.gos.get("quickFilterParser"),t=this.gos.get("quickFilterMatcher"),i=e!==this.parser||t!==this.matcher;this.parser=e,this.matcher=t,i&&(this.setQuickFilterParts(),this.dispatchLocalEvent({type:"quickFilterChanged"}))}onQuickFilterColumnConfigChanged(){this.refreshQuickFilterCols(),this.resetQuickFilterCache(),this.isQuickFilterPresent()&&this.dispatchLocalEvent({type:"quickFilterChanged"})}doesRowPassQuickFilterNoCache(e,t){return this.colsForQuickFilter.some((i=>{const r=this.getQuickFilterTextForColumn(i,e);return F(r)&&r.indexOf(t)>=0}))}doesRowPassQuickFilterCache(e,t){return this.checkGenerateQuickFilterAggregateText(e),e.quickFilterAggregateText.indexOf(t)>=0}doesRowPassQuickFilterMatcher(e,t){let i;e?(this.checkGenerateQuickFilterAggregateText(t),i=t.quickFilterAggregateText):i=this.getQuickFilterAggregateText(t);const{quickFilterParts:r,matcher:n}=this;return n(r,i)}checkGenerateQuickFilterAggregateText(e){e.quickFilterAggregateText||(e.quickFilterAggregateText=this.getQuickFilterAggregateText(e))}getQuickFilterTextForColumn(e,t){let i=this.valueService.getValue(e,t,!0);const r=e.getColDef();if(r.getQuickFilterText){const n=this.gos.addGridCommonParams({value:i,node:t,data:t.data,column:e,colDef:r});i=r.getQuickFilterText(n)}return F(i)?i.toString().toUpperCase():null}getQuickFilterAggregateText(e){const t=[];return this.colsForQuickFilter.forEach((i=>{const r=this.getQuickFilterTextForColumn(i,e);F(r)&&t.push(r)})),t.join("\n")}}],dependantModules:[No]},Uo={version:Do,moduleName:"@ag-grid-community/filter",dependantModules:[_o,Vo,{version:Do,moduleName:"@ag-grid-community/quick-filter",dependantModules:[Wo,{version:Do,moduleName:"@ag-grid-community/quick-filter-api",apiFunctions:{isQuickFilterPresent:function(e){var t;return!(null===(t=e.filterManager)||void 0===t||!t.isQuickFilterPresent())},getQuickFilter:function(e){return e.gos.get("quickFilterText")},resetQuickFilter:function(e){var t;null===(t=e.filterManager)||void 0===t||t.resetQuickFilterCache()}},dependantModules:[Wo]}]},Ho]},jo=(e=>(e.COLUMN_GROUP="group",e.COLUMN="column",e.FLOATING_FILTER="filter",e))(jo||{}),Ko=class extends He{constructor(){super(...arguments),this.beanName="headerNavigationService",this.currentHeaderRowWithoutSpan=-1}wireBeans(e){this.focusService=e.focusService,this.headerPositionUtils=e.headerPositionUtils,this.ctrlsService=e.ctrlsService,this.columnModel=e.columnModel,this.visibleColService=e.visibleColsService}postConstruct(){this.ctrlsService.whenReady(this,(e=>{this.gridBodyCon=e.gridBodyCtrl}));const e=Q(this.gos);this.addManagedElementListeners(e,{mousedown:()=>this.setCurrentHeaderRowWithoutSpan(-1)})}getHeaderRowCount(){var e,t;return null!==(e=null===(t=this.ctrlsService.getHeaderRowContainerCtrl())||void 0===t?void 0:t.getRowCount())&&void 0!==e?e:0}getHeaderPositionForColumn(e,t){let i;if("string"===typeof e?(i=this.columnModel.getCol(e),i||(i=this.visibleColService.getColumnGroup(e))):i=e,!i)return null;const r=this.ctrlsService.getHeaderRowContainerCtrl(),n="filter"===ye((null===r||void 0===r?void 0:r.getAllCtrls())||[]).getType(),o=this.getHeaderRowCount()-1;let s=-1,a=i;for(;a;)s++,a=a.getParent();let l=s;return t&&n&&l===o-1&&l++,-1===l?null:{headerRowIndex:l,column:i}}navigateVertically(e,t,i){if(t||(t=this.focusService.getFocusedHeader()),!t)return!1;const{headerRowIndex:r}=t,n=t.column,o=this.getHeaderRowCount(),s=0===e;let{headerRowIndex:a,column:l,headerRowIndexWithoutSpan:c}=s?this.headerPositionUtils.getColumnVisibleParent(n,r):this.headerPositionUtils.getColumnVisibleChild(n,r),u=!1;return a<0&&(a=0,l=n,u=!0),a>=o?(a=-1,this.setCurrentHeaderRowWithoutSpan(-1)):void 0!==c&&(this.currentHeaderRowWithoutSpan=c),!(!u&&!l)&&this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:a,column:l},allowUserOverride:!0,event:i})}setCurrentHeaderRowWithoutSpan(e){this.currentHeaderRowWithoutSpan=e}navigateHorizontally(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0;const r=this.focusService.getFocusedHeader(),n=2===e,o=this.gos.get("enableRtl");let s,a;if(-1!==this.currentHeaderRowWithoutSpan?r.headerRowIndex=this.currentHeaderRowWithoutSpan:this.currentHeaderRowWithoutSpan=r.headerRowIndex,n!==o?(a="Before",s=this.headerPositionUtils.findHeader(r,a)):(a="After",s=this.headerPositionUtils.findHeader(r,a)),s||!t)return this.focusService.focusHeaderPosition({headerPosition:s,direction:a,fromTab:t,allowUserOverride:!0,event:i});if(t){const e=this.gos.getCallback("tabToNextHeader");if(e)return this.focusService.focusHeaderPositionFromUserFunc({userFunc:e,headerPosition:s,direction:a})}return this.focusNextHeaderRow(r,a,i)}focusNextHeaderRow(e,t,i){var r;const n=e.headerRowIndex;let o,s=null;if("Before"===t?n>0&&(o=n-1,this.currentHeaderRowWithoutSpan-=1,s=this.headerPositionUtils.findColAtEdgeForHeaderRow(o,"end")):(o=n+1,this.currentHeaderRowWithoutSpan<this.getHeaderRowCount()?this.currentHeaderRowWithoutSpan+=1:this.setCurrentHeaderRowWithoutSpan(-1),s=this.headerPositionUtils.findColAtEdgeForHeaderRow(o,"start")),!s)return!1;const{column:a,headerRowIndex:l}=this.headerPositionUtils.getHeaderIndexToFocus(s.column,null===(r=s)||void 0===r?void 0:r.headerRowIndex);return this.focusService.focusHeaderPosition({headerPosition:{column:a,headerRowIndex:l},direction:t,fromTab:!0,allowUserOverride:!0,event:i})}scrollToColumn(e){let t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"After";if(!e.getPinned()){if(It(e)){const r=e.getDisplayedLeafColumns();t="Before"===i?ye(r):r[0]}else t=e;this.gridBodyCon.getScrollFeature().ensureColumnVisible(t)}}},Yo=class extends He{wireBeans(e){this.animationFrameService=e.animationFrameService,this.headerNavigationService=e.headerNavigationService,this.focusService=e.focusService,this.columnModel=e.columnModel,this.visibleColsService=e.visibleColsService,this.ctrlsService=e.ctrlsService,this.filterManager=e.filterManager,this.menuService=e.menuService}setComp(e,t,i){this.comp=e,this.eGui=t,this.createManagedBean(new Nn(i,{onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addManagedEventListeners({columnPivotModeChanged:this.onPivotModeChanged.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this)}),this.onPivotModeChanged(),this.setupHeaderHeight();const r=this.onHeaderContextMenu.bind(this);this.addManagedElementListeners(this.eGui,{contextmenu:r}),this.mockContextMenuForIPad(r),this.ctrlsService.register("gridHeaderCtrl",this)}setupHeaderHeight(){const e=this.setHeaderHeight.bind(this);e(),this.addManagedPropertyListeners(["headerHeight","pivotHeaderHeight","groupHeaderHeight","pivotGroupHeaderHeight","floatingFiltersHeight"],e),this.addManagedEventListeners({displayedColumnsChanged:e,columnHeaderHeightChanged:e,columnGroupHeaderHeightChanged:()=>this.animationFrameService.requestAnimationFrame((()=>e())),gridStylesChanged:e,advancedFilterEnabledChanged:e})}getHeaderHeight(){return this.headerHeight}setHeaderHeight(){var e;const{columnModel:t}=this;let i=0;const r=this.columnModel.getGroupRowsHeight().reduce(((e,t)=>e+t),0),n=this.columnModel.getColumnHeaderRowHeight();if(null!==(e=this.filterManager)&&void 0!==e&&e.hasFloatingFilters()&&(i+=t.getFloatingFiltersHeight()),i+=r,i+=n,this.headerHeight===i)return;this.headerHeight=i;const o="".concat(i+1,"px");this.comp.setHeightAndMinHeight(o),this.eventService.dispatchEvent({type:"headerHeightChanged"})}onPivotModeChanged(){const e=this.columnModel.isPivotMode();this.comp.addOrRemoveCssClass("ag-pivot-on",e),this.comp.addOrRemoveCssClass("ag-pivot-off",!e)}onDisplayedColumnsChanged(){const e=this.visibleColsService.getAllCols().some((e=>e.isSpanHeaderHeight()));this.comp.addOrRemoveCssClass("ag-header-allow-overflow",e)}onTabKeyDown(e){const t=this.gos.get("enableRtl"),i=e.shiftKey,r=i!==t?2:3;(this.headerNavigationService.navigateHorizontally(r,!0,e)||!i&&this.focusService.focusOverlay(!1)||this.focusService.focusNextGridCoreContainer(i,!0))&&e.preventDefault()}handleKeyDown(e){let t=null;switch(e.key){case Tr.LEFT:t=2;case Tr.RIGHT:F(t)||(t=3),this.headerNavigationService.navigateHorizontally(t,!1,e)&&e.preventDefault();break;case Tr.UP:t=0;case Tr.DOWN:F(t)||(t=1),this.headerNavigationService.navigateVertically(t,null,e)&&e.preventDefault();break;default:return}}onFocusOut(e){const{relatedTarget:t}=e;!t&&this.eGui.contains(Z(this.gos))||this.eGui.contains(t)||this.focusService.clearFocusedHeader()}onHeaderContextMenu(e,t,i){var r;if(!e&&!i||!this.menuService.isHeaderContextMenuEnabled())return;const{target:n}=null!==e&&void 0!==e?e:t;n!==this.eGui&&n!==(null===(r=this.ctrlsService.getHeaderRowContainerCtrl())||void 0===r?void 0:r.getViewportElement())||this.menuService.showHeaderContextMenu(void 0,e,i)}mockContextMenuForIPad(e){if(!Pi())return;const t=new vr(this.eGui);this.addManagedListeners(t,{longTap:t=>{e(void 0,t.touchStart,t.touchEvent)}}),this.addDestroyFunc((()=>t.destroy()))}},qo=class extends He{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super(),this.callback=e,this.addSpacer=t}wireBeans(e){this.visibleColsService=e.visibleColsService,this.scrollVisibleService=e.scrollVisibleService}postConstruct(){const e=this.setWidth.bind(this);this.addManagedPropertyListener("domLayout",e),this.addManagedEventListeners({columnContainerWidthChanged:e,displayedColumnsChanged:e,leftPinnedWidthChanged:e}),this.addSpacer&&this.addManagedEventListeners({rightPinnedWidthChanged:e,scrollVisibilityChanged:e,scrollbarWidthChanged:e}),this.setWidth()}setWidth(){const e=z(this.gos,"print"),t=this.visibleColsService.getBodyContainerWidth(),i=this.visibleColsService.getColsLeftWidth(),r=this.visibleColsService.getDisplayedColumnsRightWidth();let n;if(e)n=t+i+r;else if(n=t,this.addSpacer){0===(this.gos.get("enableRtl")?i:r)&&this.scrollVisibleService.isVerticalScrollShowing()&&(n+=this.scrollVisibleService.getScrollbarWidth())}this.callback(n)}},Qo=class extends He{constructor(e){super(),this.columnsToAggregate=[],this.columnsToGroup=[],this.columnsToPivot=[],this.pinned=e}wireBeans(e){this.funcColsService=e.funcColsService}onDragEnter(e){if(this.clearColumnsList(),this.gos.get("functionsReadOnly"))return;const t=e.dragItem.columns;t&&t.forEach((e=>{e.isPrimary()&&(e.isAnyFunctionActive()||(e.isAllowValue()?this.columnsToAggregate.push(e):e.isAllowRowGroup()?this.columnsToGroup.push(e):e.isAllowPivot()&&this.columnsToPivot.push(e)))}))}getIconName(){return this.columnsToAggregate.length+this.columnsToGroup.length+this.columnsToPivot.length>0?this.pinned?"pinned":"move":null}onDragLeave(e){this.clearColumnsList()}clearColumnsList(){this.columnsToAggregate.length=0,this.columnsToGroup.length=0,this.columnsToPivot.length=0}onDragging(e){}onDragStop(e){this.columnsToAggregate.length>0&&this.funcColsService.addValueColumns(this.columnsToAggregate,"toolPanelDragAndDrop"),this.columnsToGroup.length>0&&this.funcColsService.addRowGroupColumns(this.columnsToGroup,"toolPanelDragAndDrop"),this.columnsToPivot.length>0&&this.funcColsService.addPivotColumns(this.columnsToPivot,"toolPanelDragAndDrop")}onDragCancel(){this.clearColumnsList()}};function $o(e){const{isFromHeader:t,fromLeft:i,xPosition:r,fromEnter:n,fakeEvent:o,pinned:s,gos:a,columnModel:l,columnMoveService:c,visibleColsService:u}=e;let{allMovingColumns:d}=e;if(t){const e=[];d.forEach((t=>{let i=null,r=t.getParent();for(;null!=r&&1===r.getDisplayedLeafColumns().length;)i=r,r=r.getParent();if(null!=i){var n;(!(null===(n=i.getColGroupDef())||void 0===n||!n.marryChildren)?i.getProvidedColumnGroup().getLeafColumns():i.getLeafColumns()).forEach((t=>{e.includes(t)||e.push(t)}))}else e.includes(t)||e.push(t)})),d=e}const h=d.slice();l.sortColsLikeCols(h);const g=function(e){const{movingCols:t,draggingRight:i,xPosition:r,pinned:n,gos:o,columnModel:s,visibleColsService:a}=e,l=o.get("suppressMovableColumns")||t.some((e=>e.getColDef().suppressMovable));if(l)return[];const c=function(e,t){switch(t){case"left":return e.getLeftCols();case"right":return e.getRightCols();default:return e.getCenterCols()}}(a,n),u=s.getCols(),d=c.filter((e=>Pe(t,e))),h=c.filter((e=>!Pe(t,e))),g=u.filter((e=>!Pe(t,e)));let p,f=0,m=r;if(i){let e=0;d.forEach((t=>e+=t.getActualWidth())),m-=e}if(m>0){for(let e=0;e<h.length;e++){if(m-=h[e].getActualWidth(),m<0)break;f++}i&&f++}if(f>0){const e=h[f-1];p=g.indexOf(e)+1}else p=g.indexOf(h[0]),-1===p&&(p=0);const v=[p],C=(e,t)=>e-t;if(i){let e=p+1;const t=u.length-1;for(;e<=t;)v.push(e),e++;v.sort(C)}else{let e=p;const t=u.length-1;let i=u[e];for(;e<=t&&c.indexOf(i)<0;)e++,v.push(e),i=u[e];e=p-1;const r=0;for(;e>=r;)v.push(e),e--;v.sort(C).reverse()}return v}({movingCols:h,draggingRight:i,xPosition:r,pinned:s,gos:a,columnModel:l,visibleColsService:u}),p=function(e,t){const i=t.getCols(),r=(s=e.map((e=>i.indexOf(e))),s.sort(((e,t)=>e-t))),n=r[0],o=ye(r);var s;return o-n!==r.length-1?null:n}(h,l);if(0===g.length)return;const f=g[0];let m=null!==p&&!n;if(t&&(m=null!==p),m&&!o){if(!i&&f>=p)return;if(i&&f<=p)return}const v=u.getAllCols(),C=[];let w=null;for(let S=0;S<g.length;S++){const e=g[S],t=c.getProposedColumnOrder(h,e);if(!c.doesOrderPassRules(t))continue;const i=t.filter((e=>v.includes(e)));if(null===w)w=i;else if(!Re(i,w))break;const r=Jo(t);C.push({move:e,fragCount:r})}if(0===C.length)return;C.sort(((e,t)=>e.fragCount-t.fragCount));const b=C[0].move;return b>l.getCols().length-d.length?void 0:{columns:d,toIndex:b}}function Xo(e){const{columns:t,toIndex:i}=$o(e)||{},{finished:r,columnMoveService:n}=e;return t&&null!=i?(n.moveColumns(t,i,"uiColumnMoved",r),r?null:{columns:t,toIndex:i}):null}function Jo(e){function t(e){const t=[];let i=e.getOriginalParent();for(;null!=i;)t.push(i),i=i.getOriginalParent();return t}let i=0;for(let r=0;r<e.length-1;r++){let n=t(e[r]),o=t(e[r+1]);[n,o]=n.length>o.length?[n,o]:[o,n],n.forEach((e=>{-1===o.indexOf(e)&&i++}))}return i}function Zo(e){var t;const{pinned:i,fromKeyboard:r,gos:n,ctrlsService:o,useHeaderRow:s,skipScrollPadding:a}=e;let l=null===(t=o.getHeaderRowContainerCtrl(i))||void 0===t?void 0:t.getViewportElement(),{x:c}=e;return l?(r&&(c-=l.getBoundingClientRect().left),n.get("enableRtl")&&(s&&(l=l.querySelector(".ag-header-row")),c=l.clientWidth-c),null!=i||a||(c+=o.get("center").getCenterViewportScrollLeft()),c):0}function es(e,t){for(const i of e)i.setMoving(t,"uiColumnMoved")}var ts=class extends He{constructor(e){super(),this.needToMoveLeft=!1,this.needToMoveRight=!1,this.lastMovedInfo=null,this.pinned=e,this.isCenterContainer=!F(e)}wireBeans(e){this.columnModel=e.columnModel,this.visibleColsService=e.visibleColsService,this.columnMoveService=e.columnMoveService,this.dragAndDropService=e.dragAndDropService,this.ctrlsService=e.ctrlsService}postConstruct(){this.ctrlsService.whenReady(this,(e=>{this.gridBodyCon=e.gridBodyCtrl}))}getIconName(){var e,t;const i=null!==(e=null===(t=this.lastDraggingEvent)||void 0===t?void 0:t.dragItem.columns)&&void 0!==e?e:[];for(const r of i){const e=r.getPinned();if(r.getColDef().lockPinned){if(e==this.pinned)return"move"}else{if(e===this.pinned||!this.pinned)return"move";if(!e&&this.pinned)return"pinned"}}return"notAllowed"}onDragEnter(e){const t=e.dragItem.columns;if(0===e.dragSource.type)this.setColumnsVisible(t,!0,"uiColumnDragged");else{const i=e.dragItem.visibleState,r=(t||[]).filter((e=>i[e.getId()]));this.setColumnsVisible(r,!0,"uiColumnDragged")}this.gos.get("suppressMoveWhenColumnDragging")||this.attemptToPinColumns(t,this.pinned),this.onDragging(e,!0,!0)}onDragging(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.lastDraggingEvent,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const n=this.gos.get("suppressMoveWhenColumnDragging");if(r&&!n)return void this.finishColumnMoving();if(this.lastDraggingEvent=e,!e||!r&&P(e.hDirection))return;const{pinned:o,gos:s,ctrlsService:a}=this,l=Zo({x:e.x,pinned:o,gos:s,ctrlsService:a});t||this.checkCenterForScrolling(l),n?this.handleColumnDragWhileSuppressingMovement(e,t,i,l,r):this.handleColumnDragWhileAllowingMovement(e,t,i,l,r)}onDragLeave(){this.ensureIntervalCleared(),this.clearHighlighted(),this.lastMovedInfo=null}onDragStop(){this.onDragging(this.lastDraggingEvent,!1,!0,!0),this.ensureIntervalCleared(),this.lastMovedInfo=null}onDragCancel(){this.clearHighlighted(),this.ensureIntervalCleared(),this.lastMovedInfo=null}setColumnsVisible(e,t,i){if(!e)return;const r=e.filter((e=>!e.getColDef().lockVisible));this.columnModel.setColsVisible(r,t,i)}finishColumnMoving(){if(this.clearHighlighted(),!this.lastMovedInfo)return;const{columns:e,toIndex:t}=this.lastMovedInfo;this.columnMoveService.moveColumns(e,t,"uiColumnMoved",!0)}handleColumnDragWhileSuppressingMovement(e,t,i,r,n){const o=this.getAllMovingColumns(e,!0);if(n){const e=this.isAttemptingToPin(o);e&&this.attemptToPinColumns(o,void 0,!0);const{fromLeft:r,xPosition:n}=this.getNormalisedXPositionInfo(o,e)||{};if(null==r||null==n)return void this.finishColumnMoving();this.moveColumnsAfterHighlight({allMovingColumns:o,xPosition:n,fromEnter:t,fakeEvent:i,fromLeft:r})}else{if(!this.dragAndDropService.isDropZoneWithinThisGrid(e))return;this.highlightHoveredColumn(o,r)}}handleColumnDragWhileAllowingMovement(e,t,i,r,n){const o=this.getAllMovingColumns(e),s=1===this.normaliseDirection(e.hDirection),a=1===e.dragSource.type,l=Xo(c(c({},this.getMoveColumnParams({allMovingColumns:o,isFromHeader:a,xPosition:r,fromLeft:s,fromEnter:t,fakeEvent:i})),{},{finished:n}));l&&(this.lastMovedInfo=l)}getAllMovingColumns(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i=e.dragSource.getDragItem();let r=null;t?(r=i.columnsInSplit,r||(r=i.columns)):r=i.columns;return r?r.filter((e=>!e.getColDef().lockPinned||e.getPinned()==this.pinned)):[]}getMoveColumnParams(e){const{allMovingColumns:t,isFromHeader:i,xPosition:r,fromLeft:n,fromEnter:o,fakeEvent:s}=e,{pinned:a,gos:l,columnModel:c,columnMoveService:u,visibleColsService:d}=this;return{allMovingColumns:t,isFromHeader:i,fromLeft:n,xPosition:r,pinned:a,fromEnter:o,fakeEvent:s,gos:l,columnModel:c,columnMoveService:u,visibleColsService:d}}findFirstAndLastMovingColumns(e){const t=e.length;let i,r;for(let n=0;n<=t;n++){if(!i){const t=e[n];null!=t.getLeft()&&(i=t)}if(!r){const i=e[t-1-n];null!=i.getLeft()&&(r=i)}if(i&&r)break}return{firstMovingCol:i,lastMovingCol:r}}highlightHoveredColumn(e,t){var i;const{gos:r,columnModel:n}=this,o=r.get("enableRtl"),s=n.getCols().filter((e=>e.isVisible()&&e.getPinned()===this.pinned));let a,l=null,c=null,u=null;for(const d of s){if(c=d.getActualWidth(),l=this.getNormalisedColumnLeft(d,0,o),null!=l){if(l<=t&&l+c>=t){u=d;break}}l=null,c=null}if(u)-1!==e.indexOf(u)&&(u=null);else{for(let e=s.length-1;e>=0;e--){const t=s[e],i=s[e].getParent();if(!i){u=t;break}const r=null===i||void 0===i?void 0:i.getDisplayedLeafColumns();if(r.length){u=ye(r);break}}if(!u)return;l=this.getNormalisedColumnLeft(u,0,o),c=u.getActualWidth()}(null===(i=this.lastHighlightedColumn)||void 0===i?void 0:i.column)!==u&&this.clearHighlighted(),null!=u&&null!=l&&null!=c&&(a=t-l<c/2!==o?0:1,u.setHighlighted(a),this.lastHighlightedColumn={column:u,position:a})}getNormalisedXPositionInfo(e,t){const{gos:i,visibleColsService:r}=this,n=i.get("enableRtl"),{firstMovingCol:o,column:s,position:a}=this.getColumnMoveAndTargetInfo(e,t,n);if(!o||!s||null==a)return;const l=r.getAllCols(),c=l.indexOf(o),u=l.indexOf(s),d=0===a!==n,h=c<u||c===u&&!d;let g=0;if(d?h&&(g-=1):h||(g+=1),u+g===c)return;const p=l[u+g];if(!p)return;return{fromLeft:h,xPosition:this.getNormalisedColumnLeft(p,20,n)}}getColumnMoveAndTargetInfo(e,t,i){const r=this.lastHighlightedColumn||{},{firstMovingCol:n,lastMovingCol:o}=this.findFirstAndLastMovingColumns(e);if(!n||!o||r.column||!t)return c({firstMovingCol:n},r);const s="left"===this.getPinDirection();return{firstMovingCol:n,position:s?1:0,column:s!==i?n:o}}normaliseDirection(e){if(this.gos.get("enableRtl"))switch(e){case 0:return 1;case 1:return 0}return e}getNormalisedColumnLeft(e,t,i){const{gos:r,ctrlsService:n}=this,o=e.getLeft();if(null==o)return null;const s=e.getActualWidth();return Zo({x:i?o+s-t:o+t,pinned:e.getPinned(),useHeaderRow:i,skipScrollPadding:!0,gos:r,ctrlsService:n})}isAttemptingToPin(e){const t=this.needToMoveLeft||this.needToMoveRight,i=this.failedMoveAttempts>7;return t&&i||e.some((e=>e.getPinned()!==this.pinned))}moveColumnsAfterHighlight(e){const{allMovingColumns:t,xPosition:i,fromEnter:r,fakeEvent:n,fromLeft:o}=e,s=this.getMoveColumnParams({allMovingColumns:t,isFromHeader:!0,xPosition:i,fromLeft:o,fromEnter:r,fakeEvent:n}),{columns:a,toIndex:l}=$o(s)||{};a&&null!=l&&(this.lastMovedInfo={columns:a,toIndex:l}),this.finishColumnMoving()}clearHighlighted(){this.lastHighlightedColumn&&(this.lastHighlightedColumn.column.setHighlighted(null),this.lastHighlightedColumn=null)}checkCenterForScrolling(e){if(!this.isCenterContainer)return;const t=this.ctrlsService.get("center"),i=t.getCenterViewportScrollLeft(),r=i+t.getCenterWidth();this.gos.get("enableRtl")?(this.needToMoveRight=e<i+50,this.needToMoveLeft=e>r-50):(this.needToMoveLeft=e<i+50,this.needToMoveRight=e>r-50),this.needToMoveLeft||this.needToMoveRight?this.ensureIntervalStarted():this.ensureIntervalCleared()}ensureIntervalStarted(){var e;this.movingIntervalId||(this.intervalCount=0,this.failedMoveAttempts=0,this.movingIntervalId=window.setInterval(this.moveInterval.bind(this),100),null===(e=this.dragAndDropService.getDragAndDropImageComponent())||void 0===e||e.setIcon(this.needToMoveLeft?"left":"right",!0))}ensureIntervalCleared(){var e;this.movingIntervalId&&(window.clearInterval(this.movingIntervalId),this.movingIntervalId=null,this.failedMoveAttempts=0,null===(e=this.dragAndDropService.getDragAndDropImageComponent())||void 0===e||e.setIcon(this.getIconName()))}moveInterval(){let e;this.intervalCount++,e=10+5*this.intervalCount,e>100&&(e=100);let t=null;const i=this.gridBodyCon.getScrollFeature();if(this.needToMoveLeft?t=i.scrollHorizontally(-e):this.needToMoveRight&&(t=i.scrollHorizontally(e)),0!==t)this.onDragging(this.lastDraggingEvent),this.failedMoveAttempts=0;else{var r;if(this.failedMoveAttempts++,this.failedMoveAttempts<=8)return;if(null===(r=this.dragAndDropService.getDragAndDropImageComponent())||void 0===r||r.setIcon("pinned"),!this.gos.get("suppressMoveWhenColumnDragging")){var n;const e=null===(n=this.lastDraggingEvent)||void 0===n?void 0:n.dragItem.columns;this.attemptToPinColumns(e,void 0,!0)}}}getPinDirection(){return this.needToMoveLeft||"left"===this.pinned?"left":this.needToMoveRight||"right"===this.pinned?"right":void 0}attemptToPinColumns(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=(e||[]).filter((e=>!e.getColDef().lockPinned));return r.length?(i&&(t=this.getPinDirection()),this.columnModel.setColsPinned(r,t,"uiColumnDragged"),i&&this.dragAndDropService.nudge(),r.length):0}destroy(){super.destroy(),this.lastDraggingEvent=null,this.clearHighlighted(),this.lastMovedInfo=null}},is=class extends He{wireBeans(e){this.dragAndDropService=e.dragAndDropService,this.columnModel=e.columnModel,this.ctrlsService=e.ctrlsService}constructor(e,t){super(),this.pinned=e,this.eContainer=t}postConstruct(){this.ctrlsService.whenReady(this,(e=>{switch(this.pinned){case"left":this.eSecondaryContainers=[[e.gridBodyCtrl.getBodyViewportElement(),e.left.getContainerElement()],[e.bottomLeft.getContainerElement()],[e.topLeft.getContainerElement()]];break;case"right":this.eSecondaryContainers=[[e.gridBodyCtrl.getBodyViewportElement(),e.right.getContainerElement()],[e.bottomRight.getContainerElement()],[e.topRight.getContainerElement()]];break;default:this.eSecondaryContainers=[[e.gridBodyCtrl.getBodyViewportElement(),e.center.getViewportElement()],[e.bottomCenter.getViewportElement()],[e.topCenter.getViewportElement()]]}})),this.moveColumnFeature=this.createManagedBean(new ts(this.pinned)),this.bodyDropPivotTarget=this.createManagedBean(new Qo(this.pinned)),this.dragAndDropService.addDropTarget(this),this.addDestroyFunc((()=>this.dragAndDropService.removeDropTarget(this)))}isInterestedIn(e){return 1===e||0===e&&this.gos.get("allowDragFromColumnsToolPanel")}getSecondaryContainers(){return this.eSecondaryContainers}getContainer(){return this.eContainer}getIconName(){return this.currentDropListener.getIconName()}isDropColumnInPivotMode(e){return this.columnModel.isPivotMode()&&0===e.dragSource.type}onDragEnter(e){this.currentDropListener=this.isDropColumnInPivotMode(e)?this.bodyDropPivotTarget:this.moveColumnFeature,this.currentDropListener.onDragEnter(e)}onDragLeave(e){this.currentDropListener.onDragLeave(e)}onDragging(e){this.currentDropListener.onDragging(e)}onDragStop(e){this.currentDropListener.onDragStop(e)}onDragCancel(){this.currentDropListener.onDragCancel()}},rs=class extends He{wireBeans(e){this.horizontalResizeService=e.horizontalResizeService,this.pinnedWidthService=e.pinnedWidthService,this.ctrlsService=e.ctrlsService,this.columnSizeService=e.columnSizeService,this.columnAutosizeService=e.columnAutosizeService}constructor(e,t,i,r,n){super(),this.pinned=e,this.column=t,this.eResize=i,this.comp=r,this.ctrl=n}postConstruct(){const e=[];let t,i;const r=()=>{if(Oi(this.eResize,t),!t)return;const r=this.horizontalResizeService.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});if(e.push(r),i){const t=this.gos.get("skipHeaderOnAutoSize"),i=()=>{this.columnAutosizeService.autoSizeColumn(this.column,"uiColumnResized",t)};this.eResize.addEventListener("dblclick",i);const r=new vr(this.eResize);r.addEventListener("doubleTap",i),e.push((()=>{this.eResize.removeEventListener("dblclick",i),r.removeEventListener("doubleTap",i),r.destroy()}))}},n=()=>{e.forEach((e=>e())),e.length=0},o=()=>{const e=this.column.isResizable(),o=!this.gos.get("suppressAutoSize")&&!this.column.getColDef().suppressAutoSize;(e!==t||o!==i)&&(t=e,i=o,n(),r())};o(),this.addDestroyFunc(n),this.ctrl.setRefreshFunction("resize",o)}onResizing(e,t){const{column:i,lastResizeAmount:r,resizeStartWidth:n}=this,o=this.normaliseResizeAmount(t),s=[{key:i,newWidth:n+o}];if(this.column.getPinned()){if(this.pinnedWidthService.getPinnedLeftWidth()+this.pinnedWidthService.getPinnedRightWidth()+(o-r)>zi(this.ctrlsService.getGridBodyCtrl().getBodyViewportElement())-50)return}this.lastResizeAmount=o,this.columnSizeService.setColumnWidths(s,this.resizeWithShiftKey,e,"uiColumnResized"),e&&this.toggleColumnResizing(!1)}onResizeStart(e){this.resizeStartWidth=this.column.getActualWidth(),this.lastResizeAmount=0,this.resizeWithShiftKey=e,this.toggleColumnResizing(!0)}toggleColumnResizing(e){this.comp.addOrRemoveCssClass("ag-column-resizing",e)}normaliseResizeAmount(e){let t=e;const i="left"!==this.pinned,r="right"===this.pinned;return this.gos.get("enableRtl")?i&&(t*=-1):r&&(t*=-1),t}},ns=class extends He{constructor(e){super(),this.cbSelectAllVisible=!1,this.processingEventFromCheckbox=!1,this.column=e}wireBeans(e){this.rowModel=e.rowModel,this.selectionService=e.selectionService}onSpaceKeyDown(e){const t=this.cbSelectAll;t.isDisplayed()&&!t.getGui().contains(Z(this.gos))&&(e.preventDefault(),t.setValue(!t.getValue()))}getCheckboxGui(){return this.cbSelectAll.getGui()}setComp(e){this.headerCellCtrl=e,this.cbSelectAll=this.createManagedBean(new kr),this.cbSelectAll.addCssClass("ag-header-select-all"),ci(this.cbSelectAll.getGui(),"presentation"),this.showOrHideSelectAll(),this.addManagedEventListeners({newColumnsLoaded:this.onNewColumnsLoaded.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),selectionChanged:this.onSelectionChanged.bind(this),paginationChanged:this.onSelectionChanged.bind(this),modelUpdated:this.onModelChanged.bind(this)}),this.addManagedListeners(this.cbSelectAll,{fieldValueChanged:this.onCbSelectAll.bind(this)}),this.cbSelectAll.getInputElement().setAttribute("tabindex","-1"),this.refreshSelectAllLabel()}onNewColumnsLoaded(){this.showOrHideSelectAll()}onDisplayedColumnsChanged(){this.isAlive()&&this.showOrHideSelectAll()}showOrHideSelectAll(){this.cbSelectAllVisible=this.isCheckboxSelection(),this.cbSelectAll.setDisplayed(this.cbSelectAllVisible),this.cbSelectAllVisible&&(this.checkRightRowModelType("selectAllCheckbox"),this.checkSelectionType("selectAllCheckbox"),this.updateStateOfCheckbox()),this.refreshSelectAllLabel()}onModelChanged(){this.cbSelectAllVisible&&this.updateStateOfCheckbox()}onSelectionChanged(){this.cbSelectAllVisible&&this.updateStateOfCheckbox()}updateStateOfCheckbox(){if(this.processingEventFromCheckbox)return;this.processingEventFromCheckbox=!0;const e=this.selectionService.getSelectAllState(this.isFilteredOnly(),this.isCurrentPageOnly());this.cbSelectAll.setValue(e);const t=this.selectionService.hasNodesToSelect(this.isFilteredOnly(),this.isCurrentPageOnly());this.cbSelectAll.setDisabled(!t),this.refreshSelectAllLabel(),this.processingEventFromCheckbox=!1}refreshSelectAllLabel(){const e=this.localeService.getLocaleTextFunc(),t=this.cbSelectAll.getValue()?e("ariaChecked","checked"):e("ariaUnchecked","unchecked"),i=e("ariaRowSelectAll","Press Space to toggle all rows selection");this.cbSelectAllVisible?this.headerCellCtrl.setAriaDescriptionProperty("selectAll","".concat(i," (").concat(t,")")):this.headerCellCtrl.setAriaDescriptionProperty("selectAll",null),this.cbSelectAll.setInputAriaLabel(e("ariaHeaderSelection","Column with Header Selection")),this.headerCellCtrl.announceAriaDescription()}checkSelectionType(e){return!!Ce(this.gos)||(v("".concat(e," is only available if using 'multiRow' selection mode.")),!1)}checkRightRowModelType(e){return!(!G(this.gos)&&!H(this.gos))||(v("".concat(e," is only available if using 'clientSide' or 'serverSide' rowModelType, you are using ").concat(this.rowModel.getType(),".")),!1)}onCbSelectAll(){if(this.processingEventFromCheckbox)return;if(!this.cbSelectAllVisible)return;const e=this.cbSelectAll.getValue(),t=this.isFilteredOnly(),i=this.isCurrentPageOnly();let r="uiSelectAll";i?r="uiSelectAllCurrentPage":t&&(r="uiSelectAllFiltered");const n={source:r,justFiltered:t,justCurrentPage:i};e?this.selectionService.selectAllRowNodes(n):this.selectionService.deselectAllRowNodes(n)}isCheckboxSelection(){const e=this.gos.get("rowSelection"),t="object"===typeof e&&de(e)&&Qe(this.column),i=this.column.getColDef().headerCheckboxSelection;let r=!1;return r=!!t||("function"===typeof i?i(this.gos.addGridCommonParams({column:this.column,colDef:this.column.getColDef()})):!!i),r&&this.checkRightRowModelType(t?"headerCheckbox":"headerCheckboxSelection")&&this.checkSelectionType(t?"headerCheckbox":"headerCheckboxSelection")}isFilteredOnly(){const e=this.gos.get("rowSelection");return"object"===typeof e?"multiRow"===e.mode&&"filtered"===e.selectAll:!!this.column.getColDef().headerCheckboxSelectionFilteredOnly}isCurrentPageOnly(){const e=this.gos.get("rowSelection");return"object"===typeof e?"multiRow"===e.mode&&"currentPage"===e.selectAll:!!this.column.getColDef().headerCheckboxSelectionCurrentPageOnly}},os=class extends Fo{constructor(e,t,i){super(e,t,i),this.refreshFunctions={},this.userHeaderClasses=new Set,this.ariaDescriptionProperties=new Map,this.column=e}setComp(e,t,i,r,n){this.comp=e,n=Yt(this,this.beans.context,n),this.setGui(t,n),this.updateState(),this.setupWidth(n),this.setupMovingCss(n),this.setupMenuClass(n),this.setupSortableClass(n),this.setupWrapTextClass(),this.refreshSpanHeaderHeight(),this.setupAutoHeight({wrapperElement:r,checkMeasuringCallback:e=>this.setRefreshFunction("measuring",e),compBean:n}),this.addColumnHoverListener(n),this.setupFilterClass(n),this.setupClassesFromColDef(),this.setupTooltip(n),this.addActiveHeaderMouseListeners(n),this.setupSelectAll(n),this.setupUserComp(n),this.refreshAria(),this.resizeFeature=n.createManagedBean(new rs(this.getPinned(),this.column,i,e,this)),n.createManagedBean(new Po([this.column],t)),n.createManagedBean(new So(this.column,t,this.beans)),n.createManagedBean(new Nn(t,{shouldStopEventPropagation:e=>this.shouldStopEventPropagation(e),onTabKeyDown:()=>null,handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addResizeAndMoveKeyboardListeners(n),n.addManagedPropertyListeners(["suppressMovableColumns","suppressMenuHide","suppressAggFuncInHeader"],(()=>this.refresh(n))),n.addManagedListeners(this.column,{colDefChanged:()=>this.refresh(n)}),n.addManagedListeners(this.column,{headerHighlightChanged:this.onHeaderHighlightChanged.bind(this)});const o=()=>this.checkDisplayName(n);n.addManagedEventListeners({columnValueChanged:o,columnRowGroupChanged:o,columnPivotChanged:o,headerHeightChanged:this.onHeaderHeightChanged.bind(this)}),n.addDestroyFunc((()=>{this.refreshFunctions={},this.selectAllFeature=null,this.dragSourceElement=void 0,this.userCompDetails=null,this.userHeaderClasses.clear(),this.ariaDescriptionProperties.clear(),this.clearComponent()}))}resizeHeader(e,t){if(!this.column.isResizable())return;const i=this.column.getActualWidth(),r=this.column.getMinWidth(),n=this.column.getMaxWidth(),o=Math.min(Math.max(i+e,r),n);this.beans.columnSizeService.setColumnWidths([{key:this.column,newWidth:o}],t,!0,"uiColumnResized")}moveHeader(e){const{eGui:t,beans:i,column:r,ctrlsService:n}=this,{gos:o,columnModel:s,columnMoveService:a,visibleColsService:l}=i,c=this.getPinned(),u=t.getBoundingClientRect().left,d=r.getActualWidth(),h=Zo({x:0===e!==o.get("enableRtl")?u-20:u+d+20,pinned:c,fromKeyboard:!0,gos:o,ctrlsService:n}),g=this.focusService.getFocusedHeader();Xo({allMovingColumns:[r],isFromHeader:!0,fromLeft:1===e,xPosition:h,pinned:c,fromEnter:!1,fakeEvent:!1,gos:o,columnModel:s,columnMoveService:a,visibleColsService:l,finished:!0}),n.getGridBodyCtrl().getScrollFeature().ensureColumnVisible(r,"auto"),this.isAlive()&&!this.beans.gos.get("ensureDomOrder")||!g||this.restoreFocus(g)}restoreFocus(e){this.focusService.focusHeaderPosition({headerPosition:c(c({},e),{},{column:this.column})})}setupUserComp(e){const t=this.lookupUserCompDetails(e);this.setCompDetails(t)}setCompDetails(e){this.userCompDetails=e,this.comp.setUserCompDetails(e)}lookupUserCompDetails(e){const t=this.createParams(e),i=this.column.getColDef();return this.userComponentFactory.getHeaderCompDetails(i,t)}createParams(e){return this.gos.addGridCommonParams({column:this.column,displayName:this.displayName,enableSorting:this.column.isSortable(),enableMenu:this.menuEnabled,enableFilterButton:this.openFilterEnabled&&this.menuService.isHeaderFilterButtonEnabled(this.column),enableFilterIcon:!this.openFilterEnabled||this.menuService.isLegacyMenuEnabled(),showColumnMenu:e=>{this.menuService.showColumnMenu({column:this.column,buttonElement:e,positionBy:"button"})},showColumnMenuAfterMouseClick:e=>{this.menuService.showColumnMenu({column:this.column,mouseEvent:e,positionBy:"mouse"})},showFilter:e=>{this.menuService.showFilterMenu({column:this.column,buttonElement:e,containerType:"columnFilter",positionBy:"button"})},progressSort:e=>{this.beans.sortController.progressSort(this.column,!!e,"uiColumnSorted")},setSort:(e,t)=>{this.beans.sortController.setSortForColumn(this.column,e,!!t,"uiColumnSorted")},eGridHeader:this.getGui(),setTooltip:(t,i)=>{this.setupTooltip(e,t,i)}})}setupSelectAll(e){this.selectAllFeature=e.createManagedBean(new ns(this.column)),this.selectAllFeature.setComp(this)}getSelectAllGui(){return this.selectAllFeature.getCheckboxGui()}handleKeyDown(e){super.handleKeyDown(e),e.key===Tr.SPACE&&this.selectAllFeature.onSpaceKeyDown(e),e.key===Tr.ENTER&&this.onEnterKeyDown(e),e.key===Tr.DOWN&&e.altKey&&this.showMenuOnKeyPress(e,!1)}onEnterKeyDown(e){if(e.ctrlKey||e.metaKey)this.showMenuOnKeyPress(e,!0);else if(this.sortable){const t=e.shiftKey;this.beans.sortController.progressSort(this.column,t,"uiColumnSorted")}}showMenuOnKeyPress(e,t){const i=this.comp.getUserCompInstance();i&&i instanceof yr&&i.onMenuKeyboardShortcut(t)&&e.preventDefault()}onFocusIn(e){if(!this.getGui().contains(e.relatedTarget)){const e=this.getRowIndex();this.focusService.setFocusedHeader(e,this.column),this.announceAriaDescription()}this.focusService.isKeyboardMode()&&this.setActiveHeader(!0)}onFocusOut(e){this.getGui().contains(e.relatedTarget)||this.setActiveHeader(!1)}setupTooltip(e,t,i){this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature));const r="whenTruncated"===this.gos.get("tooltipShowMode"),n=this.eGui,o=this.column.getColDef();i||!r||o.headerComponent||(i=()=>{const e=n.querySelector(".ag-header-cell-text");return!e||e.scrollWidth>e.clientWidth});const s={getColumn:()=>this.column,getColDef:()=>this.column.getColDef(),getGui:()=>n,getLocation:()=>"header",getTooltipValue:()=>{if(null!=t)return t;return this.column.getColDef().headerTooltip},shouldDisplayTooltip:i},a=e.createManagedBean(new lr(s));this.setRefreshFunction("tooltip",(()=>a.refreshToolTip()))}setupClassesFromColDef(){const e=()=>{const e=yo(this.column.getColDef(),this.gos,this.column,null),t=this.userHeaderClasses;this.userHeaderClasses=new Set(e),e.forEach((e=>{t.has(e)?t.delete(e):this.comp.addOrRemoveCssClass(e,!0)})),t.forEach((e=>this.comp.addOrRemoveCssClass(e,!1)))};this.setRefreshFunction("headerClasses",e),e()}setDragSource(e){if(this.dragSourceElement=e,this.removeDragSource(),!e||!this.draggable)return;const{column:t,beans:i,displayName:r,dragAndDropService:n,gos:o}=this,{columnModel:s}=i;let a=!this.gos.get("suppressDragLeaveHidesColumns");const l=this.dragSource={type:1,eElement:e,getDefaultIconName:()=>a?"hide":"notAllowed",getDragItem:()=>this.createDragItem(t),dragItemName:r,onDragStarted:()=>{a=!o.get("suppressDragLeaveHidesColumns"),es([t],!0)},onDragStopped:()=>es([t],!1),onDragCancelled:()=>es([t],!1),onGridEnter:e=>{if(a){var t;const i=(null===e||void 0===e||null===(t=e.columns)||void 0===t?void 0:t.filter((e=>!e.getColDef().lockVisible)))||[];s.setColsVisible(i,!0,"uiColumnMoved")}},onGridExit:e=>{if(a){var t;const i=(null===e||void 0===e||null===(t=e.columns)||void 0===t?void 0:t.filter((e=>!e.getColDef().lockVisible)))||[];s.setColsVisible(i,!1,"uiColumnMoved")}}};n.addDragSource(l,!0)}createDragItem(e){const t={};return t[e.getId()]=e.isVisible(),{columns:[e],visibleState:t}}updateState(){this.menuEnabled=this.menuService.isColumnMenuInHeaderEnabled(this.column),this.openFilterEnabled=this.menuService.isFilterMenuInHeaderEnabled(this.column),this.sortable=this.column.isSortable(),this.displayName=this.calculateDisplayName(),this.draggable=this.workOutDraggable()}setRefreshFunction(e,t){this.refreshFunctions[e]=t}refresh(e){this.updateState(),this.refreshHeaderComp(e),this.refreshAria(),Object.values(this.refreshFunctions).forEach((e=>e()))}refreshHeaderComp(e){const t=this.lookupUserCompDetails(e);!!(null!=this.comp.getUserCompInstance()&&this.userCompDetails.componentClass==t.componentClass)&&this.attemptHeaderCompRefresh(t.params)?this.setDragSource(this.dragSourceElement):this.setCompDetails(t)}attemptHeaderCompRefresh(e){const t=this.comp.getUserCompInstance();if(!t)return!1;if(!t.refresh)return!1;return t.refresh(e)}calculateDisplayName(){return this.beans.columnNameService.getDisplayNameForColumn(this.column,"header",!0)}checkDisplayName(e){this.displayName!==this.calculateDisplayName()&&this.refresh(e)}workOutDraggable(){const e=this.column.getColDef();return!!(!this.gos.get("suppressMovableColumns")&&!e.suppressMovable&&!e.lockPosition)||!!e.enableRowGroup||!!e.enablePivot}setupWidth(e){const t=()=>{const e=this.column.getActualWidth();this.comp.setWidth("".concat(e,"px"))};e.addManagedListeners(this.column,{widthChanged:t}),t()}setupMovingCss(e){const t=()=>{this.comp.addOrRemoveCssClass("ag-header-cell-moving",this.column.isMoving())};e.addManagedListeners(this.column,{movingChanged:t}),t()}setupMenuClass(e){const t=()=>{this.comp.addOrRemoveCssClass("ag-column-menu-visible",this.column.isMenuVisible())};e.addManagedListeners(this.column,{menuVisibleChanged:t}),t()}setupSortableClass(e){const t=()=>{this.comp.addOrRemoveCssClass("ag-header-cell-sortable",!!this.sortable)};t(),this.setRefreshFunction("updateSortable",t),e.addManagedEventListeners({sortChanged:this.refreshAriaSort.bind(this)})}setupFilterClass(e){const t=()=>{const e=this.column.isFilterActive();this.comp.addOrRemoveCssClass("ag-header-cell-filtered",e),this.refreshAria()};e.addManagedListeners(this.column,{filterActiveChanged:t}),t()}setupWrapTextClass(){const e=()=>{const e=!!this.column.getColDef().wrapHeaderText;this.comp.addOrRemoveCssClass("ag-header-cell-wrap-text",e)};e(),this.setRefreshFunction("wrapText",e)}onHeaderHighlightChanged(){const e=this.column.getHighlighted(),t=0===e,i=1===e;this.comp.addOrRemoveCssClass("ag-header-highlight-before",t),this.comp.addOrRemoveCssClass("ag-header-highlight-after",i)}onDisplayedColumnsChanged(){super.onDisplayedColumnsChanged(),this.isAlive()&&this.onHeaderHeightChanged()}onHeaderHeightChanged(){this.refreshSpanHeaderHeight()}refreshSpanHeaderHeight(){const{eGui:e,column:t,comp:i,beans:r}=this,n=this.beans.columnModel.getGroupRowsHeight(),o=0===n.reduce(((e,t)=>e+t),0);if(i.addOrRemoveCssClass("ag-header-parent-hidden",o),!t.isSpanHeaderHeight())return e.style.removeProperty("top"),e.style.removeProperty("height"),i.addOrRemoveCssClass("ag-header-span-height",!1),void i.addOrRemoveCssClass("ag-header-span-total",!1);const{numberOfParents:s,isSpanningTotal:a}=this.column.getColumnGroupPaddingInfo();i.addOrRemoveCssClass("ag-header-span-height",s>0);const{columnModel:l}=r,c=l.getColumnHeaderRowHeight();if(0===s)return i.addOrRemoveCssClass("ag-header-span-total",!1),e.style.setProperty("top","0px"),void e.style.setProperty("height","".concat(c,"px"));i.addOrRemoveCssClass("ag-header-span-total",a);let u=0;for(let d=0;d<s;d++)u+=n[n.length-1-d];e.style.setProperty("top","".concat(-u,"px")),e.style.setProperty("height","".concat(c+u,"px"))}refreshAriaSort(){if(this.sortable){const e=this.localeService.getLocaleTextFunc(),t=this.beans.sortController.getDisplaySortForColumn(this.column)||null;this.comp.setAriaSort(function(e){let t;return t="asc"===e?"ascending":"desc"===e?"descending":"mixed"===e?"other":"none",t}(t)),this.setAriaDescriptionProperty("sort",e("ariaSortableColumn","Press ENTER to sort"))}else this.comp.setAriaSort(),this.setAriaDescriptionProperty("sort",null)}refreshAriaMenu(){if(this.menuEnabled){const e=this.localeService.getLocaleTextFunc();this.setAriaDescriptionProperty("menu",e("ariaMenuColumn","Press ALT DOWN to open column menu"))}else this.setAriaDescriptionProperty("menu",null)}refreshAriaFilterButton(){if(this.openFilterEnabled&&!this.menuService.isLegacyMenuEnabled()){const e=this.localeService.getLocaleTextFunc();this.setAriaDescriptionProperty("filterButton",e("ariaFilterColumn","Press CTRL ENTER to open filter"))}else this.setAriaDescriptionProperty("filterButton",null)}refreshAriaFiltered(){const e=this.localeService.getLocaleTextFunc();this.column.isFilterActive()?this.setAriaDescriptionProperty("filter",e("ariaColumnFiltered","Column Filtered")):this.setAriaDescriptionProperty("filter",null)}setAriaDescriptionProperty(e,t){null!=t?this.ariaDescriptionProperties.set(e,t):this.ariaDescriptionProperties.delete(e)}announceAriaDescription(){if(!this.eGui.contains(Z(this.beans.gos)))return;const e=Array.from(this.ariaDescriptionProperties.keys()).sort(((e,t)=>"filter"===e?-1:t.charCodeAt(0)-e.charCodeAt(0))).map((e=>this.ariaDescriptionProperties.get(e))).join(". ");this.beans.ariaAnnouncementService.announceValue(e,"columnHeader")}refreshAria(){this.refreshAriaSort(),this.refreshAriaMenu(),this.refreshAriaFilterButton(),this.refreshAriaFiltered()}addColumnHoverListener(e){const t=()=>{if(!this.gos.get("columnHoverHighlight"))return;const e=this.beans.columnHoverService.isHovered(this.column);this.comp.addOrRemoveCssClass("ag-column-hover",e)};e.addManagedEventListeners({columnHoverChanged:t}),t()}getColId(){return this.column.getColId()}addActiveHeaderMouseListeners(e){const t=e=>this.handleMouseOverChange("mouseenter"===e.type);e.addManagedListeners(this.getGui(),{mouseenter:t,mouseleave:t,click:()=>this.dispatchColumnMouseEvent("columnHeaderClicked",this.column),contextmenu:e=>this.handleContextMenuMouseEvent(e,void 0,this.column)})}handleMouseOverChange(e){this.setActiveHeader(e),this.eventService.dispatchEvent({type:e?"columnHeaderMouseOver":"columnHeaderMouseLeave",column:this.column})}setActiveHeader(e){this.comp.addOrRemoveCssClass("ag-header-active",e)}getAnchorElementForMenu(e){const t=this.comp.getUserCompInstance();return t instanceof yr?t.getAnchorElementForMenu(e):this.getGui()}destroy(){super.destroy()}},ss=class extends He{wireBeans(e){this.horizontalResizeService=e.horizontalResizeService,this.autoWidthCalculator=e.autoWidthCalculator,this.visibleColsService=e.visibleColsService,this.columnSizeService=e.columnSizeService,this.columnAutosizeService=e.columnAutosizeService}constructor(e,t,i,r){super(),this.eResize=t,this.comp=e,this.pinned=i,this.columnGroup=r}postConstruct(){if(!this.columnGroup.isResizable())return void this.comp.setResizableDisplayed(!1);const e=this.horizontalResizeService.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});if(this.addDestroyFunc(e),!this.gos.get("suppressAutoSize")){const e=this.gos.get("skipHeaderOnAutoSize");this.eResize.addEventListener("dblclick",(()=>{const t=[];this.columnGroup.getDisplayedLeafColumns().forEach((e=>{e.getColDef().suppressAutoSize||t.push(e.getColId())})),t.length>0&&this.columnAutosizeService.autoSizeCols({colKeys:t,skipHeader:e,stopAtGroup:this.columnGroup,source:"uiColumnResized"}),this.resizeLeafColumnsToFit("uiColumnResized")}))}}onResizeStart(e){const t=this.getInitialValues(e);this.storeLocalValues(t),this.toggleColumnResizing(!0)}onResizing(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"uiColumnResized";const r=this.normaliseDragChange(t),n=this.resizeStartWidth+r;this.resizeColumnsFromLocalValues(n,i,e)}getInitialValues(e){const t=this.getColumnsToResize(),i=this.getInitialSizeOfColumns(t),r={columnsToResize:t,resizeStartWidth:i,resizeRatios:this.getSizeRatiosOfColumns(t,i)};let n=null;if(e&&(n=this.visibleColsService.getGroupAtDirection(this.columnGroup,"After")),n){const e=n.getDisplayedLeafColumns(),t=r.groupAfterColumns=e.filter((e=>e.isResizable())),i=r.groupAfterStartWidth=this.getInitialSizeOfColumns(t);r.groupAfterRatios=this.getSizeRatiosOfColumns(t,i)}else r.groupAfterColumns=void 0,r.groupAfterStartWidth=void 0,r.groupAfterRatios=void 0;return r}storeLocalValues(e){const{columnsToResize:t,resizeStartWidth:i,resizeRatios:r,groupAfterColumns:n,groupAfterStartWidth:o,groupAfterRatios:s}=e;this.resizeCols=t,this.resizeStartWidth=i,this.resizeRatios=r,this.resizeTakeFromCols=n,this.resizeTakeFromStartWidth=o,this.resizeTakeFromRatios=s}clearLocalValues(){this.resizeCols=void 0,this.resizeRatios=void 0,this.resizeTakeFromCols=void 0,this.resizeTakeFromRatios=void 0}resizeLeafColumnsToFit(e){const t=this.autoWidthCalculator.getPreferredWidthForColumnGroup(this.columnGroup),i=this.getInitialValues();t>i.resizeStartWidth&&this.resizeColumns(i,t,e,!0)}resizeColumnsFromLocalValues(e,t){var i,r,n;let o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!this.resizeCols||!this.resizeRatios)return;const s={columnsToResize:this.resizeCols,resizeStartWidth:this.resizeStartWidth,resizeRatios:this.resizeRatios,groupAfterColumns:null!==(i=this.resizeTakeFromCols)&&void 0!==i?i:void 0,groupAfterStartWidth:null!==(r=this.resizeTakeFromStartWidth)&&void 0!==r?r:void 0,groupAfterRatios:null!==(n=this.resizeTakeFromRatios)&&void 0!==n?n:void 0};this.resizeColumns(s,e,t,o)}resizeColumns(e,t,i){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const{columnsToResize:n,resizeStartWidth:o,resizeRatios:s,groupAfterColumns:a,groupAfterStartWidth:l,groupAfterRatios:c}=e,u=[];if(u.push({columns:n,ratios:s,width:t}),a){const e=t-o;u.push({columns:a,ratios:c,width:l-e})}this.columnSizeService.resizeColumnSets({resizeSets:u,finished:r,source:i}),r&&this.toggleColumnResizing(!1)}toggleColumnResizing(e){this.comp.addOrRemoveCssClass("ag-column-resizing",e)}getColumnsToResize(){return this.columnGroup.getDisplayedLeafColumns().filter((e=>e.isResizable()))}getInitialSizeOfColumns(e){return e.reduce(((e,t)=>e+t.getActualWidth()),0)}getSizeRatiosOfColumns(e,t){return e.map((e=>e.getActualWidth()/t))}normaliseDragChange(e){let t=e;return this.gos.get("enableRtl")?"left"!==this.pinned&&(t*=-1):"right"===this.pinned&&(t*=-1),t}destroy(){super.destroy(),this.clearLocalValues()}},as=class extends He{constructor(e,t){super(),this.removeChildListenersFuncs=[],this.columnGroup=t,this.comp=e}postConstruct(){this.addListenersToChildrenColumns(),this.addManagedListeners(this.columnGroup,{displayedChildrenChanged:this.onDisplayedChildrenChanged.bind(this)}),this.onWidthChanged(),this.addDestroyFunc(this.removeListenersOnChildrenColumns.bind(this))}addListenersToChildrenColumns(){this.removeListenersOnChildrenColumns();const e=this.onWidthChanged.bind(this);this.columnGroup.getLeafColumns().forEach((t=>{t.addEventListener("widthChanged",e),t.addEventListener("visibleChanged",e),this.removeChildListenersFuncs.push((()=>{t.removeEventListener("widthChanged",e),t.removeEventListener("visibleChanged",e)}))}))}removeListenersOnChildrenColumns(){this.removeChildListenersFuncs.forEach((e=>e())),this.removeChildListenersFuncs=[]}onDisplayedChildrenChanged(){this.addListenersToChildrenColumns(),this.onWidthChanged()}onWidthChanged(){const e=this.columnGroup.getActualWidth();this.comp.setWidth("".concat(e,"px")),this.comp.addOrRemoveCssClass("ag-hidden",0===e)}},ls=class extends Fo{constructor(e,t,i){super(e,t,i),this.onSuppressColMoveChange=()=>{if(!this.isAlive()||this.isSuppressMoving())this.removeDragSource();else if(!this.dragSource){const e=this.getGui();this.setDragSource(e)}},this.column=e}setComp(e,t,i,r,n){this.comp=e,n=Yt(this,this.beans.context,n),this.setGui(t,n),this.displayName=this.beans.columnNameService.getDisplayNameForColumnGroup(this.column,"header"),this.addClasses(),this.setupMovingCss(n),this.setupExpandable(n),this.setupTooltip(n),this.setupAutoHeight({wrapperElement:r,compBean:n}),this.setupUserComp(n),this.addHeaderMouseListeners(n),this.addManagedPropertyListener("groupHeaderHeight",this.refreshMaxHeaderHeight.bind(this)),this.refreshMaxHeaderHeight();const o=this.getParentRowCtrl().getPinned(),s=this.column.getProvidedColumnGroup().getLeafColumns();n.createManagedBean(new Po(s,t)),n.createManagedBean(new So(this.column,t,this.beans)),n.createManagedBean(new as(e,this.column)),this.resizeFeature=n.createManagedBean(new ss(e,i,o,this.column)),n.createManagedBean(new Nn(t,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:()=>{},handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)})),this.addHighlightListeners(n,s),n.addManagedPropertyListener("suppressMovableColumns",this.onSuppressColMoveChange),this.addResizeAndMoveKeyboardListeners(n),n.addDestroyFunc((()=>this.clearComponent()))}refreshMaxHeaderHeight(){const{gos:e,comp:t}=this,i=e.get("groupHeaderHeight");null!=i?0===i?t.setHeaderWrapperHidden(!0):t.setHeaderWrapperMaxHeight(i):(t.setHeaderWrapperHidden(!1),t.setHeaderWrapperMaxHeight(null))}addHighlightListeners(e,t){if(this.beans.gos.get("suppressMoveWhenColumnDragging"))for(const i of t)e.addManagedListeners(i,{headerHighlightChanged:this.onLeafColumnHighlightChanged.bind(this,i)})}onLeafColumnHighlightChanged(e){const t=this.column.getDisplayedLeafColumns(),i=t[0]===e,r=ye(t)===e;if(!i&&!r)return;const n=e.getHighlighted();let o=!1,s=!1;if(!!this.getParentRowCtrl().findHeaderCellCtrl((e=>e.getColumnGroupChild().isMoving()))){const e=this.beans.gos.get("enableRtl"),t=1===n,a=0===n;i&&(e?s=t:o=a),r&&(e?o=a:s=t)}this.comp.addOrRemoveCssClass("ag-header-highlight-before",o),this.comp.addOrRemoveCssClass("ag-header-highlight-after",s)}getColumn(){return this.column}resizeHeader(e,t){if(!this.resizeFeature)return;const i=this.resizeFeature.getInitialValues(t);this.resizeFeature.resizeColumns(i,i.resizeStartWidth+e,"uiColumnResized",!0)}moveHeader(e){const{beans:t,eGui:i,column:r,ctrlsService:n}=this,{gos:o,columnModel:s,columnMoveService:a,visibleColsService:l}=t,c=o.get("enableRtl"),u=0===e,d=this.getPinned(),h=i.getBoundingClientRect(),g=h.left,p=h.width,f=Zo({x:u!==c?g-20:g+p+20,pinned:d,fromKeyboard:!0,gos:o,ctrlsService:n}),m=r.getGroupId(),v=this.focusService.getFocusedHeader();Xo({allMovingColumns:this.column.getLeafColumns(),isFromHeader:!0,fromLeft:1===e,xPosition:f,pinned:d,fromEnter:!1,fakeEvent:!1,gos:o,columnModel:s,columnMoveService:a,visibleColsService:l,finished:!0});const C=r.getDisplayedLeafColumns(),w=u?C[0]:ye(C);this.ctrlsService.getGridBodyCtrl().getScrollFeature().ensureColumnVisible(w,"auto"),this.isAlive()&&!this.beans.gos.get("ensureDomOrder")||!v||this.restoreFocus(m,r,v)}restoreFocus(e,t,i){const r=t.getLeafColumns();if(!r.length)return;const n=r[0].getParent();if(!n)return;const o=this.findGroupWidthId(n,e);o&&this.focusService.focusHeaderPosition({headerPosition:c(c({},i),{},{column:o})})}findGroupWidthId(e,t){for(;e;){if(e.getGroupId()===t)return e;e=e.getParent()}return null}resizeLeafColumnsToFit(e){this.resizeFeature&&this.resizeFeature.resizeLeafColumnsToFit(e)}setupUserComp(e){const t=this.gos.addGridCommonParams({displayName:this.displayName,columnGroup:this.column,setExpanded:e=>{this.beans.columnModel.setColumnGroupOpened(this.column.getProvidedColumnGroup(),e,"gridInitializing")},setTooltip:(t,i)=>{this.setupTooltip(e,t,i)}}),i=this.userComponentFactory.getHeaderGroupCompDetails(t);this.comp.setUserCompDetails(i)}addHeaderMouseListeners(e){const t=e=>this.handleMouseOverChange("mouseenter"===e.type);e.addManagedListeners(this.getGui(),{mouseenter:t,mouseleave:t,click:()=>this.dispatchColumnMouseEvent("columnHeaderClicked",this.column.getProvidedColumnGroup()),contextmenu:e=>this.handleContextMenuMouseEvent(e,void 0,this.column.getProvidedColumnGroup())})}handleMouseOverChange(e){this.eventService.dispatchEvent({type:e?"columnHeaderMouseOver":"columnHeaderMouseLeave",column:this.column.getProvidedColumnGroup()})}setupTooltip(e,t,i){this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature));const r=this.column.getColGroupDef(),n="whenTruncated"===this.gos.get("tooltipShowMode"),o=this.eGui;i||!n||null!==r&&void 0!==r&&r.headerGroupComponent||(i=()=>{const e=o.querySelector(".ag-header-group-text");return!e||e.scrollWidth>e.clientWidth});const s={getColumn:()=>this.column,getGui:()=>o,getLocation:()=>"headerGroup",getTooltipValue:()=>null!==t&&void 0!==t?t:r&&r.headerTooltip,shouldDisplayTooltip:i};r&&(s.getColDef=()=>r),e.createManagedBean(new lr(s))}setupExpandable(e){const t=this.column.getProvidedColumnGroup();this.refreshExpanded();const i=this.refreshExpanded.bind(this);e.addManagedListeners(t,{expandedChanged:i,expandableChanged:i})}refreshExpanded(){const{column:e}=this;this.expandable=e.isExpandable();const t=e.isExpanded();this.expandable?this.comp.setAriaExpanded(t?"true":"false"):this.comp.setAriaExpanded(void 0)}getColId(){return this.column.getUniqueId()}addClasses(){const e=this.column.getColGroupDef(),t=yo(e,this.gos,null,this.column);if(this.column.isPadding()){t.push("ag-header-group-cell-no-group");this.column.getLeafColumns().every((e=>e.isSpanHeaderHeight()))&&t.push("ag-header-span-height")}else t.push("ag-header-group-cell-with-group"),null!==e&&void 0!==e&&e.wrapHeaderText&&t.push("ag-header-cell-wrap-text");t.forEach((e=>this.comp.addOrRemoveCssClass(e,!0)))}setupMovingCss(e){const t=this.column.getProvidedColumnGroup().getLeafColumns(),i=()=>this.comp.addOrRemoveCssClass("ag-header-cell-moving",this.column.isMoving());t.forEach((t=>{e.addManagedListeners(t,{movingChanged:i})})),i()}onFocusIn(e){if(!this.eGui.contains(e.relatedTarget)){const e=this.getRowIndex();this.beans.focusService.setFocusedHeader(e,this.column)}}handleKeyDown(e){super.handleKeyDown(e);const t=this.getWrapperHasFocus();if(this.expandable&&t&&e.key===Tr.ENTER){const e=this.column,t=!e.isExpanded();this.beans.columnModel.setColumnGroupOpened(e.getProvidedColumnGroup(),t,"uiColumnExpanded")}}setDragSource(e){if(!this.isAlive()||this.isSuppressMoving())return;if(this.removeDragSource(),!e)return;const{beans:t,column:i,displayName:r,gos:n,dragAndDropService:o}=this,{columnModel:s}=t,a=i.getProvidedColumnGroup().getLeafColumns();let l=!n.get("suppressDragLeaveHidesColumns");const c=this.dragSource={type:1,eElement:e,getDefaultIconName:()=>l?"hide":"notAllowed",dragItemName:r,getDragItem:()=>this.getDragItemForGroup(i),onDragStarted:()=>{l=!n.get("suppressDragLeaveHidesColumns"),es(a,!0)},onDragStopped:()=>es(a,!1),onDragCancelled:()=>es(a,!1),onGridEnter:e=>{if(l){const{columns:t=[],visibleState:i}=null!==e&&void 0!==e?e:{},r=t.filter((e=>!e.getColDef().lockVisible&&(!i||i[e.getColId()])));s.setColsVisible(r,!0,"uiColumnMoved")}},onGridExit:e=>{if(l){var t;const i=(null===e||void 0===e||null===(t=e.columns)||void 0===t?void 0:t.filter((e=>!e.getColDef().lockVisible)))||[];s.setColsVisible(i,!1,"uiColumnMoved")}}};o.addDragSource(c,!0)}getDragItemForGroup(e){const t=e.getProvidedColumnGroup().getLeafColumns(),i={};t.forEach((e=>i[e.getId()]=e.isVisible()));const r=[];this.beans.visibleColsService.getAllCols().forEach((e=>{t.indexOf(e)>=0&&(r.push(e),xe(t,e))})),t.forEach((e=>r.push(e)));const n=[],o=e.getLeafColumns();for(const s of r)-1!==o.indexOf(s)&&n.push(s);return{columns:r,columnsInSplit:n,visibleState:i}}isSuppressMoving(){let e=!1;this.column.getLeafColumns().forEach((t=>{(t.getColDef().suppressMovable||t.getColDef().lockPosition)&&(e=!0)}));return e||this.gos.get("suppressMovableColumns")}destroy(){super.destroy()}},cs=0,us=class extends He{constructor(e,t,i){super(),this.instanceId=cs++,this.rowIndex=e,this.pinned=t,this.type=i;const r="group"==i?"ag-header-row-column-group":"filter"==i?"ag-header-row-column-filter":"ag-header-row-column";this.headerRowClass="ag-header-row ".concat(r)}wireBeans(e){this.beans=e}postConstruct(){this.isPrintLayout=z(this.gos,"print"),this.isEnsureDomOrder=this.gos.get("ensureDomOrder")}areCellsRendered(){return!!this.comp&&this.getHeaderCellCtrls().every((e=>null!=e.getGui()))}setComp(e,t){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.comp=e,t=Yt(this,this.beans.context,t),i&&(this.onRowHeightChanged(),this.onVirtualColumnsChanged()),this.setWidth(),this.addEventListeners(t)}getHeaderRowClass(){return this.headerRowClass}getAriaRowIndex(){return this.rowIndex+1}addEventListeners(e){const t=this.onRowHeightChanged.bind(this);e.addManagedEventListeners({columnResized:this.onColumnResized.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),virtualColumnsChanged:e=>this.onVirtualColumnsChanged(e.afterScroll),columnGroupHeaderHeightChanged:t,columnHeaderHeightChanged:t,gridStylesChanged:t,advancedFilterEnabledChanged:t}),e.addManagedPropertyListener("domLayout",this.onDisplayedColumnsChanged.bind(this)),e.addManagedPropertyListener("ensureDomOrder",(e=>this.isEnsureDomOrder=e.currentValue)),e.addManagedPropertyListeners(["headerHeight","pivotHeaderHeight","groupHeaderHeight","pivotGroupHeaderHeight","floatingFiltersHeight"],t)}getHeaderCellCtrl(e){if(this.headerCellCtrls)return N(this.headerCellCtrls).find((t=>t.getColumnGroupChild()===e))}onDisplayedColumnsChanged(){this.isPrintLayout=z(this.gos,"print"),this.onVirtualColumnsChanged(),this.setWidth(),this.onRowHeightChanged()}getType(){return this.type}onColumnResized(){this.setWidth()}setWidth(){const e=this.getWidthForRow();this.comp.setWidth("".concat(e,"px"))}getWidthForRow(){const{visibleColsService:e}=this.beans;if(this.isPrintLayout){return null!=this.pinned?0:e.getContainerWidth("right")+e.getContainerWidth("left")+e.getContainerWidth(null)}return e.getContainerWidth(this.pinned)}onRowHeightChanged(){const{topOffset:e,rowHeight:t}=this.getTopAndHeight();this.comp.setTop(e+"px"),this.comp.setHeight(t+"px")}getTopAndHeight(){const{columnModel:e,filterManager:t}=this.beans,i=[],r=e.getGroupRowsHeight(),n=e.getColumnHeaderRowHeight();i.push(...r),i.push(n),null!==t&&void 0!==t&&t.hasFloatingFilters()&&i.push(e.getFloatingFiltersHeight());let o=0;for(let s=0;s<this.rowIndex;s++)o+=i[s];return{topOffset:o,rowHeight:i[this.rowIndex]}}getPinned(){return this.pinned}getRowIndex(){return this.rowIndex}onVirtualColumnsChanged(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.getHeaderCtrls(),i=this.isEnsureDomOrder||this.isPrintLayout;this.comp.setHeaderCtrls(t,i,e)}getHeaderCtrls(){const e=this.headerCellCtrls;this.headerCellCtrls=new Map;const t=this.getColumnsInViewport();for(const r of t)this.recycleAndCreateHeaderCtrls(r,e);const i=e=>{const{focusService:t,visibleColsService:i}=this.beans;if(!t.isHeaderWrapperFocused(e))return!1;return i.isVisible(e.getColumnGroupChild())};if(e)for(const[r,n]of e){i(n)?this.headerCellCtrls.set(r,n):this.destroyBean(n)}return this.getHeaderCellCtrls()}getHeaderCellCtrls(){var e,t;return Array.from(null!==(e=null===(t=this.headerCellCtrls)||void 0===t?void 0:t.values())&&void 0!==e?e:[])}recycleAndCreateHeaderCtrls(e,t){if(!this.headerCellCtrls)return;if(e.isEmptyGroup())return;const i=e.getUniqueId();let r;t&&(r=t.get(i),t.delete(i));if(r&&r.getColumnGroupChild()!=e&&(this.destroyBean(r),r=void 0),null==r)switch(this.type){case"filter":r=this.createBean(this.beans.ctrlsFactory.getInstance("headerFilterCell",e,this.beans,this));break;case"group":r=this.createBean(new ls(e,this.beans,this));break;default:r=this.createBean(new os(e,this.beans,this))}this.headerCellCtrls.set(i,r)}getColumnsInViewport(){return this.isPrintLayout?this.getColumnsInViewportPrintLayout():this.getColumnsInViewportNormalLayout()}getColumnsInViewportPrintLayout(){if(null!=this.pinned)return[];let e=[];const t=this.getActualDepth(),{columnViewportService:i}=this.beans;return["left",null,"right"].forEach((r=>{const n=i.getHeadersToRender(r,t);e=e.concat(n)})),e}getActualDepth(){return"filter"==this.type?this.rowIndex-1:this.rowIndex}getColumnsInViewportNormalLayout(){return this.beans.columnViewportService.getHeadersToRender(this.pinned,this.getActualDepth())}findHeaderCellCtrl(e){if(!this.headerCellCtrls)return;const t=this.getHeaderCellCtrls();let i;return i="function"===typeof e?t.find(e):t.find((t=>t.getColumnGroupChild()==e)),i}focusHeader(e,t){const i=this.findHeaderCellCtrl(e);if(!i)return!1;return i.focus(t)}destroy(){var e;null===(e=this.headerCellCtrls)||void 0===e||e.forEach((e=>{this.destroyBean(e)})),this.headerCellCtrls=void 0,super.destroy()}},ds=class extends He{constructor(e){super(),this.hidden=!1,this.includeFloatingFilter=!1,this.groupsRowCtrls=[],this.pinned=e}wireBeans(e){this.ctrlsService=e.ctrlsService,this.scrollVisibleService=e.scrollVisibleService,this.pinnedWidthService=e.pinnedWidthService,this.columnModel=e.columnModel,this.focusService=e.focusService,this.filterManager=e.filterManager}setComp(e,t){this.comp=e,this.eViewport=t,this.setupCenterWidth(),this.setupPinnedWidth(),this.setupDragAndDrop(this.eViewport);const i=this.onDisplayedColumnsChanged.bind(this);this.addManagedEventListeners({gridColumnsChanged:this.onGridColumnsChanged.bind(this),displayedColumnsChanged:i,advancedFilterEnabledChanged:i});const r="".concat("string"===typeof this.pinned?this.pinned:"center","Header");this.ctrlsService.register(r,this),this.columnModel.isReady()&&this.refresh()}getAllCtrls(){const e=[...this.groupsRowCtrls];return this.columnsRowCtrl&&e.push(this.columnsRowCtrl),this.filtersRowCtrl&&e.push(this.filtersRowCtrl),e}refresh(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=new or,i=this.focusService.getFocusHeaderToUseAfterRefresh();(()=>{const e=this.columnModel.getHeaderRowCount()-1;this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls);for(let i=0;i<e;i++){const e=this.createBean(new us(t.next(),this.pinned,"group"));this.groupsRowCtrls.push(e)}})(),(()=>{const i=t.next(),r=!this.hidden&&(null==this.columnsRowCtrl||!e||this.columnsRowCtrl.getRowIndex()!==i);(r||this.hidden)&&(this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl)),r&&(this.columnsRowCtrl=this.createBean(new us(i,this.pinned,"column")))})(),(()=>{var i;this.includeFloatingFilter=!(null===(i=this.filterManager)||void 0===i||!i.hasFloatingFilters())&&!this.hidden;const r=()=>{this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl)};if(!this.includeFloatingFilter)return void r();const n=t.next();if(this.filtersRowCtrl){const t=this.filtersRowCtrl.getRowIndex()!==n;e&&!t||r()}this.filtersRowCtrl||(this.filtersRowCtrl=this.createBean(new us(n,this.pinned,"filter")))})();const r=this.getAllCtrls();this.comp.setCtrls(r),this.restoreFocusOnHeader(i)}getHeaderCtrlForColumn(e){var t;if(ct(e))return null===(t=this.columnsRowCtrl)||void 0===t?void 0:t.getHeaderCellCtrl(e);if(0!==this.groupsRowCtrls.length)for(let i=0;i<this.groupsRowCtrls.length;i++){const t=this.groupsRowCtrls[i].getHeaderCellCtrl(e);if(t)return t}}getHtmlElementForColumnHeader(e){const t=this.getHeaderCtrlForColumn(e);return t?t.getGui():null}getRowType(e){const t=this.getAllCtrls()[e];return t?t.getType():void 0}focusHeader(e,t,i){const r=this.getAllCtrls()[e];return!!r&&r.focusHeader(t,i)}getViewportElement(){return this.eViewport}getGroupRowCount(){return this.groupsRowCtrls.length}getGroupRowCtrlAtIndex(e){return this.groupsRowCtrls[e]}getRowCount(){return this.groupsRowCtrls.length+(this.columnsRowCtrl?1:0)+(this.filtersRowCtrl?1:0)}setHorizontalScroll(e){this.comp.setViewportScrollLeft(e)}onScrollCallback(e){this.addManagedElementListeners(this.getViewportElement(),{scroll:e})}destroy(){this.filtersRowCtrl&&(this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl)),this.columnsRowCtrl&&(this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl)),this.groupsRowCtrls&&this.groupsRowCtrls.length&&(this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls)),super.destroy()}setupDragAndDrop(e){const t=new is(this.pinned,e);this.createManagedBean(t)}restoreFocusOnHeader(e){if(!e)return;const{column:t}=e;t.getPinned()==this.pinned&&this.focusService.focusHeaderPosition({headerPosition:e})}onGridColumnsChanged(){this.refresh(!0)}onDisplayedColumnsChanged(){var e;const t=(null===(e=this.filterManager)||void 0===e?void 0:e.hasFloatingFilters())&&!this.hidden;this.includeFloatingFilter!==t&&this.refresh(!0)}setupCenterWidth(){null==this.pinned&&this.createManagedBean(new qo((e=>this.comp.setCenterWidth("".concat(e,"px"))),!0))}setupPinnedWidth(){if(null==this.pinned)return;const e="left"===this.pinned,t="right"===this.pinned;this.hidden=!0;const i=()=>{const i=e?this.pinnedWidthService.getPinnedLeftWidth():this.pinnedWidthService.getPinnedRightWidth();if(null==i)return;const r=0==i,n=this.hidden!==r,o=this.gos.get("enableRtl"),s=this.scrollVisibleService.getScrollbarWidth(),a=this.scrollVisibleService.isVerticalScrollShowing()&&(o&&e||!o&&t)?i+s:i;this.comp.setPinnedContainerWidth("".concat(a,"px")),this.comp.setDisplayed(!r),n&&(this.hidden=r,this.refresh())};this.addManagedEventListeners({leftPinnedWidthChanged:i,rightPinnedWidthChanged:i,scrollVisibilityChanged:i,scrollbarWidthChanged:i})}},hs=class extends He{constructor(e){super(),this.view=e}postConstruct(){this.addManagedPropertyListener("domLayout",this.updateLayoutClasses.bind(this)),this.updateLayoutClasses()}updateLayoutClasses(){const e=this.getDomLayout(),t={autoHeight:"autoHeight"===e,normal:"normal"===e,print:"print"===e},i=t.autoHeight?"ag-layout-auto-height":t.print?"ag-layout-print":"ag-layout-normal";this.view.updateLayoutClasses(i,t)}getDomLayout(){var e;const t=null!==(e=this.gos.get("domLayout"))&&void 0!==e?e:"normal";return-1===["normal","print","autoHeight"].indexOf(t)?(v("".concat(t," is not valid for DOM Layout, valid values are 'normal', 'autoHeight', 'print'.")),"normal"):t}},gs=class extends dr{constructor(){super('\n            <div class="ag-overlay" role="presentation">\n                <div class="ag-overlay-panel" role="presentation">\n                    <div class="ag-overlay-wrapper" data-ref="eOverlayWrapper" role="presentation"></div>\n                </div>\n            </div>'),this.eOverlayWrapper=ur,this.activePromise=null,this.activeOverlay=null,this.updateListenerDestroyFunc=null,this.activeOverlayWrapperCssClass=null,this.elToFocusAfter=null}wireBeans(e){this.overlayService=e.overlayService,this.focusService=e.focusService,this.visibleColsService=e.visibleColsService}handleKeyDown(e){if(e.key!==Tr.TAB||e.defaultPrevented||Oe(e))return;if(this.focusService.findNextFocusableElement(this.eOverlayWrapper,!1,e.shiftKey))return;let t=!1;t=e.shiftKey?this.focusService.focusGridView(ye(this.visibleColsService.getAllCols()),!0,!1):this.focusService.focusNextGridCoreContainer(!1),t&&e.preventDefault()}updateLayoutClasses(e,t){const i=this.eOverlayWrapper.classList;i.toggle("ag-layout-auto-height",t.autoHeight),i.toggle("ag-layout-normal",t.normal),i.toggle("ag-layout-print",t.print)}postConstruct(){this.createManagedBean(new hs(this)),this.setDisplayed(!1,{skipAriaHidden:!0}),this.overlayService.setOverlayWrapperComp(this),this.addManagedElementListeners(this.getFocusableElement(),{keydown:this.handleKeyDown.bind(this)})}setWrapperTypeClass(e){const t=this.eOverlayWrapper.classList;this.activeOverlayWrapperCssClass&&t.toggle(this.activeOverlayWrapperCssClass,!1),this.activeOverlayWrapperCssClass=e,t.toggle(e,!0)}showOverlay(e,t,i,r){if(this.setWrapperTypeClass(t),this.destroyActiveOverlay(),this.elToFocusAfter=null,this.activePromise=e,e){if(this.setDisplayed(!0,{skipAriaHidden:!0}),i&&this.focusService.isGridFocused()){const e=Z(this.gos);e&&!ee(this.gos)&&(this.elToFocusAfter=e)}e.then((t=>{if(this.activePromise!==e)return void(this.activeOverlay!==t&&(this.destroyBean(t),t=null));if(this.activePromise=null,!t)return;if(this.activeOverlay!==t&&(this.eOverlayWrapper.appendChild(t.getGui()),this.activeOverlay=t,r)){const e=t;this.updateListenerDestroyFunc=this.addManagedPropertyListener(r,(t=>{var i;let{currentValue:r}=t;null===(i=e.refresh)||void 0===i||i.call(e,this.gos.addGridCommonParams(c({},null!==r&&void 0!==r?r:{})))}))}const n=this.focusService;i&&n.isGridFocused()&&n.focusInto(this.eOverlayWrapper)}))}}updateOverlayWrapperPaddingTop(e){this.eOverlayWrapper.style.setProperty("padding-top","".concat(e,"px"))}destroyActiveOverlay(){var e,t;this.activePromise=null;const i=this.activeOverlay;if(!i)return;let r=this.elToFocusAfter;this.activeOverlay=null,this.elToFocusAfter=null,r&&!this.focusService.isGridFocused()&&(r=null);const n=this.updateListenerDestroyFunc;n&&(n(),this.updateListenerDestroyFunc=null),this.destroyBean(i),Yi(this.eOverlayWrapper),null===(e=r)||void 0===e||null===(t=e.focus)||void 0===t||t.call(e,{preventScroll:!0})}hideOverlay(){this.destroyActiveOverlay(),this.setDisplayed(!1,{skipAriaHidden:!0})}destroy(){this.elToFocusAfter=null,this.destroyActiveOverlay(),this.overlayService.setOverlayWrapperComp(void 0),super.destroy()}},ps=class extends dr{constructor(e,t){super(),this.direction=t,this.eViewport=ur,this.eContainer=ur,this.hideTimeout=null,this.setTemplate(e)}wireBeans(e){this.animationFrameService=e.animationFrameService}postConstruct(){this.addManagedEventListeners({scrollVisibilityChanged:this.onScrollVisibilityChanged.bind(this)}),this.onScrollVisibilityChanged(),this.addOrRemoveCssClass("ag-apple-scrollbar",Fi()||Pi())}initialiseInvisibleScrollbar(){void 0===this.invisibleScrollbar&&(this.invisibleScrollbar=Mi(),this.invisibleScrollbar&&(this.hideAndShowInvisibleScrollAsNeeded(),this.addActiveListenerToggles()))}addActiveListenerToggles(){const e=this.getGui(),t=()=>this.addOrRemoveCssClass("ag-scrollbar-active",!0),i=()=>this.addOrRemoveCssClass("ag-scrollbar-active",!1);this.addManagedListeners(e,{mouseenter:t,mousedown:t,touchstart:t,mouseleave:i,touchend:i})}onScrollVisibilityChanged(){void 0===this.invisibleScrollbar&&this.initialiseInvisibleScrollbar(),this.animationFrameService.requestAnimationFrame((()=>this.setScrollVisible()))}hideAndShowInvisibleScrollAsNeeded(){this.addManagedEventListeners({bodyScroll:e=>{e.direction===this.direction&&(null!==this.hideTimeout&&(window.clearTimeout(this.hideTimeout),this.hideTimeout=null),this.addOrRemoveCssClass("ag-scrollbar-scrolling",!0))},bodyScrollEnd:()=>{this.hideTimeout=window.setTimeout((()=>{this.addOrRemoveCssClass("ag-scrollbar-scrolling",!1),this.hideTimeout=null}),400)}})}attemptSettingScrollPosition(e){const t=this.getViewportElement();!function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,r=arguments.length>3?arguments[3]:void 0;const n=(new Date).getTime();let o=null,s=!1;const a=()=>{const a=(new Date).getTime()-n>i;(e()||a)&&(t(),s=!0,null!=o&&(window.clearInterval(o),o=null),a&&r&&v(r))};a(),s||(o=window.setInterval(a,10))}((()=>$i(t)),(()=>this.setScrollPosition(e)),100)}getViewportElement(){return this.eViewport}getContainer(){return this.eContainer}onScrollCallback(e){this.addManagedElementListeners(this.getViewportElement(),{scroll:e})}},fs=class extends ps{constructor(){super('<div class="ag-body-horizontal-scroll" aria-hidden="true">\n            <div class="ag-horizontal-left-spacer" data-ref="eLeftSpacer"></div>\n            <div class="ag-body-horizontal-scroll-viewport" data-ref="eViewport">\n                <div class="ag-body-horizontal-scroll-container" data-ref="eContainer"></div>\n            </div>\n            <div class="ag-horizontal-right-spacer" data-ref="eRightSpacer"></div>\n        </div>',"horizontal"),this.eLeftSpacer=ur,this.eRightSpacer=ur}wireBeans(e){super.wireBeans(e),this.visibleColsService=e.visibleColsService,this.pinnedRowModel=e.pinnedRowModel,this.ctrlsService=e.ctrlsService,this.scrollVisibleService=e.scrollVisibleService}postConstruct(){super.postConstruct();const e=this.setFakeHScrollSpacerWidths.bind(this);this.addManagedEventListeners({displayedColumnsChanged:e,displayedColumnsWidthChanged:e,pinnedRowDataChanged:this.onPinnedRowDataChanged.bind(this)}),this.addManagedPropertyListener("domLayout",e),this.ctrlsService.register("fakeHScrollComp",this),this.createManagedBean(new qo((e=>this.eContainer.style.width="".concat(e,"px")))),this.addManagedPropertyListeners(["suppressHorizontalScroll"],this.onScrollVisibilityChanged.bind(this))}initialiseInvisibleScrollbar(){void 0===this.invisibleScrollbar&&(this.enableRtl=this.gos.get("enableRtl"),super.initialiseInvisibleScrollbar(),this.invisibleScrollbar&&this.refreshCompBottom())}onPinnedRowDataChanged(){this.refreshCompBottom()}refreshCompBottom(){if(!this.invisibleScrollbar)return;const e=this.pinnedRowModel.getPinnedBottomTotalHeight();this.getGui().style.bottom="".concat(e,"px")}onScrollVisibilityChanged(){super.onScrollVisibilityChanged(),this.setFakeHScrollSpacerWidths()}setFakeHScrollSpacerWidths(){const e=this.scrollVisibleService.isVerticalScrollShowing();let t=this.visibleColsService.getDisplayedColumnsRightWidth();const i=!this.enableRtl&&e,r=this.scrollVisibleService.getScrollbarWidth();i&&(t+=r),Zi(this.eRightSpacer,t),this.eRightSpacer.classList.toggle("ag-scroller-corner",t<=r);let n=this.visibleColsService.getColsLeftWidth();this.enableRtl&&e&&(n+=r),Zi(this.eLeftSpacer,n),this.eLeftSpacer.classList.toggle("ag-scroller-corner",n<=r)}setScrollVisible(){const e=this.scrollVisibleService.isHorizontalScrollShowing(),t=this.invisibleScrollbar,i=this.gos.get("suppressHorizontalScroll"),r=e&&this.scrollVisibleService.getScrollbarWidth()||0,n=i?0:0===r&&t?16:r;this.addOrRemoveCssClass("ag-scrollbar-invisible",t),er(this.getGui(),n),er(this.eViewport,n),er(this.eContainer,n),this.setDisplayed(e,{skipAriaHidden:!0})}getScrollPosition(){return ji(this.getViewportElement(),this.enableRtl)}setScrollPosition(e){$i(this.getViewportElement())||this.attemptSettingScrollPosition(e),Ki(this.getViewportElement(),e,this.enableRtl)}},ms=class extends He{wireBeans(e){this.maxDivHeightScaler=e.rowContainerHeightService}constructor(e,t){super(),this.eContainer=e,this.eViewport=t}postConstruct(){this.addManagedEventListeners({rowContainerHeightChanged:this.onHeightChanged.bind(this)})}onHeightChanged(){const e=this.maxDivHeightScaler.getUiContainerHeight(),t=null!=e?"".concat(e,"px"):"";this.eContainer.style.height=t,this.eViewport&&(this.eViewport.style.height=t)}},vs=class extends ps{wireBeans(e){super.wireBeans(e),this.ctrlsService=e.ctrlsService,this.scrollVisibleService=e.scrollVisibleService}constructor(){super('<div class="ag-body-vertical-scroll" aria-hidden="true">\n            <div class="ag-body-vertical-scroll-viewport" data-ref="eViewport">\n                <div class="ag-body-vertical-scroll-container" data-ref="eContainer"></div>\n            </div>\n        </div>',"vertical")}postConstruct(){super.postConstruct(),this.createManagedBean(new ms(this.eContainer)),this.ctrlsService.register("fakeVScrollComp",this),this.addManagedEventListeners({rowContainerHeightChanged:this.onRowContainerHeightChanged.bind(this)})}setScrollVisible(){const e=this.scrollVisibleService.isVerticalScrollShowing(),t=this.invisibleScrollbar,i=e&&this.scrollVisibleService.getScrollbarWidth()||0,r=0===i&&t?16:i;this.addOrRemoveCssClass("ag-scrollbar-invisible",t),Zi(this.getGui(),r),Zi(this.eViewport,r),Zi(this.eContainer,r),this.setDisplayed(e,{skipAriaHidden:!0})}onRowContainerHeightChanged(){const{ctrlsService:e}=this,t=e.getGridBodyCtrl().getBodyViewportElement(),i=this.getScrollPosition(),r=t.scrollTop;i!=r&&this.setScrollPosition(r,!0)}getScrollPosition(){return this.getViewportElement().scrollTop}setScrollPosition(e,t){t||$i(this.getViewportElement())||this.attemptSettingScrollPosition(e),this.getViewportElement().scrollTop=e}},Cs=(e=>(e.FakeHScrollbar="fakeHScrollComp",e.Header="centerHeader",e.PinnedTop="topCenter",e.PinnedBottom="bottomCenter",e.StickyTop="stickyTopCenter",e.StickyBottom="stickyBottomCenter",e))(Cs||{}),ws=class extends He{constructor(e){super(),this.lastScrollSource=[null,null],this.scrollLeft=-1,this.nextScrollTop=-1,this.scrollTop=-1,this.lastOffsetHeight=-1,this.lastScrollTop=-1,this.eBodyViewport=e,this.resetLastHScrollDebounced=E((()=>this.lastScrollSource[1]=null),500),this.resetLastVScrollDebounced=E((()=>this.lastScrollSource[0]=null),500)}wireBeans(e){this.ctrlsService=e.ctrlsService,this.animationFrameService=e.animationFrameService,this.paginationService=e.paginationService,this.pageBoundsService=e.pageBoundsService,this.rowModel=e.rowModel,this.heightScaler=e.rowContainerHeightService,this.rowRenderer=e.rowRenderer,this.columnModel=e.columnModel,this.visibleColsService=e.visibleColsService}postConstruct(){this.enableRtl=this.gos.get("enableRtl"),this.addManagedEventListeners({displayedColumnsWidthChanged:this.onDisplayedColumnsWidthChanged.bind(this)}),this.ctrlsService.whenReady(this,(e=>{this.centerRowsCtrl=e.center,this.onDisplayedColumnsWidthChanged(),this.addScrollListener()}))}addScrollListener(){this.addHorizontalScrollListeners(),this.addVerticalScrollListeners()}addHorizontalScrollListeners(){this.addManagedElementListeners(this.centerRowsCtrl.getViewportElement(),{scroll:this.onHScroll.bind(this,"Viewport")});for(const e of Object.values(Cs)){const t=this.ctrlsService.get(e);this.registerScrollPartner(t,this.onHScroll.bind(this,e))}}addVerticalScrollListeners(){const e=this.ctrlsService.get("fakeVScrollComp"),t=this.gos.get("debounceVerticalScrollbar"),i=t?E(this.onVScroll.bind(this,"Viewport"),100):this.onVScroll.bind(this,"Viewport"),r=t?E(this.onVScroll.bind(this,"fakeVScrollComp"),100):this.onVScroll.bind(this,"fakeVScrollComp");this.addManagedElementListeners(this.eBodyViewport,{scroll:i}),this.registerScrollPartner(e,r)}registerScrollPartner(e,t){e.onScrollCallback(t)}onDisplayedColumnsWidthChanged(){this.enableRtl&&this.horizontallyScrollHeaderCenterAndFloatingCenter()}horizontallyScrollHeaderCenterAndFloatingCenter(e){null==this.centerRowsCtrl||(void 0===e&&(e=this.centerRowsCtrl.getCenterViewportScrollLeft()),this.setScrollLeftForAllContainersExceptCurrent(Math.abs(e)))}setScrollLeftForAllContainersExceptCurrent(e){for(const t of[...Object.values(Cs),"Viewport"]){if(this.lastScrollSource[1]===t)continue;Ki(this.getViewportForSource(t),e,this.enableRtl)}}getViewportForSource(e){return"Viewport"===e?this.centerRowsCtrl.getViewportElement():this.ctrlsService.get(e).getViewportElement()}isControllingScroll(e,t){return null==this.lastScrollSource[t]?(0===t?this.lastScrollSource[0]=e:this.lastScrollSource[1]=e,!0):this.lastScrollSource[t]===e}onHScroll(e){if(!this.isControllingScroll(e,1))return;const t=this.centerRowsCtrl.getViewportElement(),{scrollLeft:i}=t;if(this.shouldBlockScrollUpdate(1,i,!0))return;const r=ji(this.getViewportForSource(e),this.enableRtl);this.doHorizontalScroll(r),this.resetLastHScrollDebounced()}onVScroll(e){if(!this.isControllingScroll(e,0))return;let t;t="Viewport"===e?this.eBodyViewport.scrollTop:this.ctrlsService.get("fakeVScrollComp").getScrollPosition(),this.shouldBlockScrollUpdate(0,t,!0)||(this.animationFrameService.setScrollTop(t),this.nextScrollTop=t,"Viewport"===e?this.ctrlsService.get("fakeVScrollComp").setScrollPosition(t):this.eBodyViewport.scrollTop=t,this.gos.get("suppressAnimationFrame")?this.scrollGridIfNeeded():this.animationFrameService.schedule(),this.resetLastVScrollDebounced())}doHorizontalScroll(e){const t=this.ctrlsService.get("fakeHScrollComp").getScrollPosition();this.scrollLeft===e&&e===t||(this.scrollLeft=e,this.fireScrollEvent(1),this.horizontallyScrollHeaderCenterAndFloatingCenter(e),this.centerRowsCtrl.onHorizontalViewportChanged(!0))}fireScrollEvent(e){const t={type:"bodyScroll",direction:1===e?"horizontal":"vertical",left:this.scrollLeft,top:this.scrollTop};this.eventService.dispatchEvent(t),window.clearTimeout(this.scrollTimer),this.scrollTimer=void 0,this.scrollTimer=window.setTimeout((()=>{this.eventService.dispatchEvent(c(c({},t),{},{type:"bodyScrollEnd"}))}),100)}shouldBlockScrollUpdate(e,t){return!(arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&!Pi())&&(0===e?this.shouldBlockVerticalScroll(t):this.shouldBlockHorizontalScroll(t))}shouldBlockVerticalScroll(e){const t=Hi(this.eBodyViewport),{scrollHeight:i}=this.eBodyViewport;return e<0||e+t>i}shouldBlockHorizontalScroll(e){const t=this.centerRowsCtrl.getCenterWidth(),{scrollWidth:i}=this.centerRowsCtrl.getViewportElement();if(this.enableRtl&&Ui()){if(e>0)return!0}else if(e<0)return!0;return Math.abs(e)+t>i}redrawRowsAfterScroll(){this.fireScrollEvent(0)}checkScrollLeft(){this.scrollLeft!==this.centerRowsCtrl.getCenterViewportScrollLeft()&&this.onHScroll("Viewport")}scrollGridIfNeeded(){const e=this.scrollTop!=this.nextScrollTop;return e&&(this.scrollTop=this.nextScrollTop,this.redrawRowsAfterScroll()),e}setHorizontalScrollPosition(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i=this.centerRowsCtrl.getViewportElement().scrollWidth-this.centerRowsCtrl.getCenterWidth();!t&&this.shouldBlockScrollUpdate(1,e)&&(e=this.enableRtl&&Ui()?e>0?0:i:Math.min(Math.max(e,0),i)),Ki(this.centerRowsCtrl.getViewportElement(),Math.abs(e),this.enableRtl),this.doHorizontalScroll(e)}setVerticalScrollPosition(e){this.eBodyViewport.scrollTop=e}getVScrollPosition(){this.lastScrollTop=this.eBodyViewport.scrollTop,this.lastOffsetHeight=this.eBodyViewport.offsetHeight;return{top:this.lastScrollTop,bottom:this.lastScrollTop+this.lastOffsetHeight}}getApproximateVScollPosition(){return this.lastScrollTop>=0&&this.lastOffsetHeight>=0?{top:this.scrollTop,bottom:this.scrollTop+this.lastOffsetHeight}:this.getVScrollPosition()}getHScrollPosition(){return this.centerRowsCtrl.getHScrollPosition()}isHorizontalScrollShowing(){return this.centerRowsCtrl.isHorizontalScrollShowing()}scrollHorizontally(e){const t=this.centerRowsCtrl.getViewportElement().scrollLeft;return this.setHorizontalScrollPosition(t+e),this.centerRowsCtrl.getViewportElement().scrollLeft-t}scrollToTop(){this.eBodyViewport.scrollTop=0}ensureNodeVisible(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const i=this.rowModel.getRowCount();let r=-1;for(let n=0;n<i;n++){const t=this.rowModel.getRow(n);if("function"===typeof e){if(t&&e(t)){r=n;break}}else if(e===t||e===t.data){r=n;break}}r>=0&&this.ensureIndexVisible(r,t)}ensureIndexVisible(e,t){if(z(this.gos,"print"))return;const i=this.rowModel.getRowCount();if("number"!==typeof e||e<0||e>=i)return void v("Invalid row index for ensureIndexVisible: "+e);const r=this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel");this.getFrameworkOverrides().wrapIncoming((()=>{var i;r||(null===(i=this.paginationService)||void 0===i||i.goToPageWithIndex(e));const n=this.ctrlsService.getGridBodyCtrl(),o=n.getStickyTopHeight(),s=n.getStickyBottomHeight(),a=this.rowModel.getRow(e);let l;do{const e=a.rowTop,i=a.rowHeight,r=this.pageBoundsService.getPixelOffset(),n=a.rowTop-r,c=n+a.rowHeight,u=this.getVScrollPosition(),d=this.heightScaler.getDivStretchOffset(),h=u.top+d,g=u.bottom+d,p=g-h,f=this.heightScaler.getScrollPositionForPixel(n),m=this.heightScaler.getScrollPositionForPixel(c-p),v=Math.min((f+m)/2,n);let C=null;"top"===t?C=f:"bottom"===t?C=m:"middle"===t?C=v:h+o>n?C=f-o:g-s<c&&(C=m+s),null!==C&&(this.setVerticalScrollPosition(C),this.rowRenderer.redraw({afterScroll:!0})),l=e!==a.rowTop||i!==a.rowHeight}while(l);this.animationFrameService.flushAllFrames()}))}ensureColumnVisible(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"auto";const i=this.columnModel.getCol(e);if(!i)return;if(i.isPinned())return;if(!this.visibleColsService.isColDisplayed(i))return;const r=this.getPositionedHorizontalScroll(i,t);this.getFrameworkOverrides().wrapIncoming((()=>{null!==r&&this.centerRowsCtrl.setCenterViewportScrollLeft(r),this.centerRowsCtrl.onHorizontalViewportChanged(),this.animationFrameService.flushAllFrames()}))}setScrollPosition(e,t){this.getFrameworkOverrides().wrapIncoming((()=>{this.centerRowsCtrl.setCenterViewportScrollLeft(t),this.setVerticalScrollPosition(e),this.rowRenderer.redraw({afterScroll:!0}),this.animationFrameService.flushAllFrames()}))}getPositionedHorizontalScroll(e,t){const{columnBeforeStart:i,columnAfterEnd:r}=this.isColumnOutsideViewport(e),n=this.centerRowsCtrl.getCenterWidth()<e.getActualWidth(),o=this.centerRowsCtrl.getCenterWidth(),s=this.enableRtl;let a=(s?i:r)||n,l=s?r:i;"auto"!==t&&(a="start"===t,l="end"===t);const c="middle"===t;if(a||l||c){const{colLeft:t,colMiddle:i,colRight:r}=this.getColumnBounds(e);return c?i-o/2:a?s?r:t:s?t-o:r-o}return null}isColumnOutsideViewport(e){const{start:t,end:i}=this.getViewportBounds(),{colLeft:r,colRight:n}=this.getColumnBounds(e),o=this.enableRtl;return{columnBeforeStart:o?t>n:i<n,columnAfterEnd:o?i<r:t>r}}getColumnBounds(e){const t=this.enableRtl,i=this.visibleColsService.getBodyContainerWidth(),r=e.getActualWidth(),n=e.getLeft(),o=t?-1:1,s=t?i-n:n;return{colLeft:s,colMiddle:s+r/2*o,colRight:s+r*o}}getViewportBounds(){const e=this.centerRowsCtrl.getCenterWidth(),t=this.centerRowsCtrl.getCenterViewportScrollLeft();return{start:t,end:e+t,width:e}}},bs=class extends He{wireBeans(e){this.animationFrameService=e.animationFrameService,this.ctrlsService=e.ctrlsService,this.pinnedWidthService=e.pinnedWidthService,this.columnModel=e.columnModel,this.visibleColsService=e.visibleColsService,this.columnSizeService=e.columnSizeService,this.scrollVisibleService=e.scrollVisibleService,this.columnViewportService=e.columnViewportService}constructor(e){super(),this.centerContainerCtrl=e}postConstruct(){this.ctrlsService.whenReady(this,(e=>{this.gridBodyCtrl=e.gridBodyCtrl,this.listenForResize()})),this.addManagedEventListeners({scrollbarWidthChanged:this.onScrollbarWidthChanged.bind(this)}),this.addManagedPropertyListeners(["alwaysShowHorizontalScroll","alwaysShowVerticalScroll"],(()=>{this.checkViewportAndScrolls()}))}listenForResize(){const e=()=>{this.animationFrameService.requestAnimationFrame((()=>{this.onCenterViewportResized()}))};this.centerContainerCtrl.registerViewportResizeListener(e),this.gridBodyCtrl.registerBodyViewportResizeListener(e)}onScrollbarWidthChanged(){this.checkViewportAndScrolls()}onCenterViewportResized(){if(this.scrollVisibleService.onCentreViewportResized(),this.centerContainerCtrl.isViewportInTheDOMTree()){this.keepPinnedColumnsNarrowerThanViewport(),this.checkViewportAndScrolls();const e=this.centerContainerCtrl.getCenterWidth();e!==this.centerWidth&&(this.centerWidth=e,this.columnSizeService.refreshFlexedColumns({viewportWidth:this.centerWidth,updateBodyWidths:!0,fireResizedEvent:!0}))}else this.bodyHeight=0}keepPinnedColumnsNarrowerThanViewport(){const e=zi(this.gridBodyCtrl.getBodyViewportElement());if(e<=50)return;let t=this.getPinnedColumnsOverflowingViewport(e-50);const i=this.gos.getCallback("processUnpinnedColumns");if(t.length){if(i){t=i({columns:t,viewportWidth:e})}this.columnModel.setColsPinned(t,null,"viewportSizeFeature")}}getPinnedColumnsOverflowingViewport(e){const t=this.pinnedWidthService.getPinnedRightWidth()+this.pinnedWidthService.getPinnedLeftWidth();if(t<e)return[];const i=[...this.visibleColsService.getLeftCols()],r=[...this.visibleColsService.getRightCols()];let n=0,o=0;const s=[];let a=t-0-e;for(;(o<i.length||n<r.length)&&a>0;){if(n<r.length){const e=r[n++];a-=e.getActualWidth(),s.push(e)}if(o<i.length&&a>0){const e=i[o++];a-=e.getActualWidth(),s.push(e)}}return s}checkViewportAndScrolls(){this.updateScrollVisibleService(),this.checkBodyHeight(),this.onHorizontalViewportChanged(),this.gridBodyCtrl.getScrollFeature().checkScrollLeft()}getBodyHeight(){return this.bodyHeight}checkBodyHeight(){const e=Hi(this.gridBodyCtrl.getBodyViewportElement());this.bodyHeight!==e&&(this.bodyHeight=e,this.eventService.dispatchEvent({type:"bodyHeightChanged"}))}updateScrollVisibleService(){this.updateScrollVisibleServiceImpl(),setTimeout(this.updateScrollVisibleServiceImpl.bind(this),500)}updateScrollVisibleServiceImpl(){const e={horizontalScrollShowing:this.isHorizontalScrollShowing(),verticalScrollShowing:this.gridBodyCtrl.isVerticalScrollShowing()};this.scrollVisibleService.setScrollsVisible(e)}isHorizontalScrollShowing(){return this.centerContainerCtrl.isHorizontalScrollShowing()}onHorizontalViewportChanged(){const e=this.centerContainerCtrl.getCenterWidth(),t=this.centerContainerCtrl.getViewportScrollLeft();this.columnViewportService.setScrollPosition(e,t)}},Ss=class extends He{wireBeans(e){this.dragService=e.dragService,this.rangeService=e.rangeService}constructor(e){super(),this.eContainer=e}postConstruct(){if(!this.rangeService)return;this.params={eElement:this.eContainer,onDragStart:this.rangeService.onDragStart.bind(this.rangeService),onDragStop:this.rangeService.onDragStop.bind(this.rangeService),onDragging:this.rangeService.onDragging.bind(this.rangeService)},this.addManagedPropertyListeners(["enableRangeSelection","cellSelection"],(()=>{he(this.gos)?this.enableFeature():this.disableFeature()})),this.addDestroyFunc((()=>this.disableFeature()));he(this.gos)&&this.enableFeature()}enableFeature(){this.dragService.addDragSource(this.params)}disableFeature(){this.dragService.removeDragSource(this.params)}},ys=class extends dr{constructor(){super('\n            <div class="ag-selection-checkbox" role="presentation">\n                <ag-checkbox role="presentation" data-ref="eCheckbox"></ag-checkbox>\n            </div>',[Ar]),this.eCheckbox=ur}postConstruct(){this.eCheckbox.setPassive(!0)}getCheckboxId(){return this.eCheckbox.getInputElement().id}onDataChanged(){this.onSelectionChanged()}onSelectableChanged(){this.showOrHideSelect()}onSelectionChanged(){const e=this.localeService.getLocaleTextFunc(),t=this.rowNode.isSelected(),i=yi(e,t),[r,n]=this.rowNode.selectable?["ariaRowToggleSelection","Press Space to toggle row selection"]:["ariaRowSelectionDisabled","Row Selection is disabled for this row"],o=e(r,n);this.eCheckbox.setValue(t,!0),this.eCheckbox.setInputAriaLabel("".concat(o," (").concat(i,")"))}onClicked(e,t,i){return this.rowNode.setSelectedParams({newValue:e,rangeSelect:i.shiftKey,groupSelectsFiltered:t,event:i,source:"checkboxSelected"})}init(e){this.rowNode=e.rowNode,this.column=e.column,this.overrides=e.overrides,this.onSelectionChanged(),this.addManagedListeners(this.eCheckbox.getInputElement(),{dblclick:e=>Le(e),click:e=>{Le(e);const t="filteredDescendants"===we(this.gos),i=this.eCheckbox.getValue();if(this.shouldHandleIndeterminateState(i,t)){0===this.onClicked(!0,t,e||{})&&this.onClicked(!1,t,e)}else i?this.onClicked(!1,t,e):this.onClicked(!0,t,e||{})}}),this.addManagedListeners(this.rowNode,{rowSelected:this.onSelectionChanged.bind(this),dataChanged:this.onDataChanged.bind(this),selectableChanged:this.onSelectableChanged.bind(this)});if(me(this.gos)||"function"===typeof this.getIsVisible()){const e=this.showOrHideSelect.bind(this);this.addManagedEventListeners({displayedColumnsChanged:e}),this.addManagedListeners(this.rowNode,{dataChanged:e,cellChanged:e}),this.showOrHideSelect()}this.eCheckbox.getInputElement().setAttribute("tabindex","-1")}shouldHandleIndeterminateState(e,t){return t&&(void 0===this.eCheckbox.getPreviousValue()||void 0===e)&&G(this.gos)}showOrHideSelect(){var e,t;let i=this.rowNode.selectable;const r=this.getIsVisible();if(i)if("function"===typeof r){var n;const e=null===(n=this.overrides)||void 0===n?void 0:n.callbackParams;if(this.column){const t=this.column.createColumnFunctionCallbackParams(this.rowNode);i=r(c(c({},e),t))}else i=r(c(c({},e),{},{node:this.rowNode,data:this.rowNode.data}))}else i=null!==r&&void 0!==r&&r;const o=this.gos.get("rowSelection");if(o&&"string"!==typeof o?!function(e){var t;return null!==(t=null===e||void 0===e?void 0:e.hideDisabledCheckboxes)&&void 0!==t&&t}(o):null===(e=this.column)||void 0===e?void 0:e.getColDef().showDisabledCheckboxes)return this.eCheckbox.setDisabled(!i),this.setVisible(!0),void this.setDisplayed(!0);null!==(t=this.overrides)&&void 0!==t&&t.removeHidden?this.setDisplayed(i):this.setVisible(i)}getIsVisible(){var e;if(this.overrides)return this.overrides.isVisible;const t=this.gos.get("rowSelection");return t&&"string"!==typeof t?ue(t):null===(e=this.column)||void 0===e||null===(e=e.getColDef())||void 0===e?void 0:e.checkboxSelection}},Rs=class extends dr{constructor(e,t,i){super('<div class="ag-drag-handle ag-row-drag" draggable="true"></div>'),this.rowNode=e,this.column=t,this.eCell=i}postConstruct(){this.getGui().appendChild(pr("rowDrag",this.gos,null)),this.addGuiEventListener("mousedown",(e=>{e.stopPropagation()})),this.addDragSource(),this.checkVisibility()}addDragSource(){this.addGuiEventListener("dragstart",this.onDragStart.bind(this))}onDragStart(e){const t=this.column.getColDef().dndSourceOnRowDrag;e.dataTransfer.setDragImage(this.eCell,0,0);const i=()=>{try{const t=JSON.stringify(this.rowNode.data);e.dataTransfer.setData("application/json",t),e.dataTransfer.setData("text/plain",t)}catch(t){}};if(t){t(this.gos.addGridCommonParams({rowNode:this.rowNode,dragEvent:e}))}else i()}checkVisibility(){const e=this.column.isDndSource(this.rowNode);this.setDisplayed(e)}},Es=class extends He{constructor(e,t){super(),this.staticClasses=[],this.cellCtrl=e,this.beans=t,this.column=e.getColumn(),this.rowNode=e.getRowNode()}setComp(e){this.cellComp=e,this.applyUserStyles(),this.applyCellClassRules(),this.applyClassesFromColDef()}applyCellClassRules(){const e=this.column.getColDef(),{cellClassRules:t}=e,i=this.beans.gos.addGridCommonParams({value:this.cellCtrl.getValue(),data:this.rowNode.data,node:this.rowNode,colDef:e,column:this.column,rowIndex:this.rowNode.rowIndex});this.beans.stylingService.processClassRules(t===this.cellClassRules?void 0:this.cellClassRules,t,i,(e=>this.cellComp.addOrRemoveCssClass(e,!0)),(e=>this.cellComp.addOrRemoveCssClass(e,!1))),this.cellClassRules=t}applyUserStyles(){const e=this.column.getColDef();if(!e.cellStyle)return;let t;if("function"===typeof e.cellStyle){const i=this.beans.gos.addGridCommonParams({column:this.column,value:this.cellCtrl.getValue(),colDef:e,data:this.rowNode.data,node:this.rowNode,rowIndex:this.rowNode.rowIndex});t=(0,e.cellStyle)(i)}else t=e.cellStyle;t&&this.cellComp.setUserStyles(t)}applyClassesFromColDef(){const e=this.column.getColDef(),t=this.beans.gos.addGridCommonParams({value:this.cellCtrl.getValue(),data:this.rowNode.data,node:this.rowNode,column:this.column,colDef:e,rowIndex:this.rowNode.rowIndex});this.staticClasses.length&&this.staticClasses.forEach((e=>this.cellComp.addOrRemoveCssClass(e,!1))),this.staticClasses=this.beans.stylingService.getStaticCellClasses(e,t),this.staticClasses.length&&this.staticClasses.forEach((e=>this.cellComp.addOrRemoveCssClass(e,!0)))}destroy(){super.destroy()}},xs=class extends He{constructor(e,t,i,r,n){super(),this.cellCtrl=e,this.beans=t,this.rowNode=r,this.rowCtrl=n}setComp(e){this.eGui=e}onKeyDown(e){const t=e.key;switch(t){case Tr.ENTER:this.onEnterKeyDown(e);break;case Tr.F2:this.onF2KeyDown(e);break;case Tr.ESCAPE:this.onEscapeKeyDown(e);break;case Tr.TAB:this.onTabKeyDown(e);break;case Tr.BACKSPACE:case Tr.DELETE:this.onBackspaceOrDeleteKeyDown(t,e);break;case Tr.DOWN:case Tr.UP:case Tr.RIGHT:case Tr.LEFT:this.onNavigationKeyDown(e,t)}}onNavigationKeyDown(e,t){this.cellCtrl.isEditing()||(e.shiftKey&&this.cellCtrl.isRangeSelectionEnabled()?this.onShiftRangeSelect(e):this.beans.navigationService.navigateToNextCell(e,t,this.cellCtrl.getCellPosition(),!0),e.preventDefault())}onShiftRangeSelect(e){if(!this.beans.rangeService)return;const t=this.beans.rangeService.extendLatestRangeInDirection(e);t&&this.beans.navigationService.ensureCellVisible(t)}onTabKeyDown(e){this.beans.navigationService.onTabKeyDown(this.cellCtrl,e)}onBackspaceOrDeleteKeyDown(e,t){const{cellCtrl:i,beans:r,rowNode:n}=this,{gos:o,rangeService:s,eventService:a}=r;if(!i.isEditing()){if(a.dispatchEvent({type:"keyShortcutChangedCellStart"}),function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e===Tr.DELETE||!t&&e===Tr.BACKSPACE&&Fi()}(e,o.get("enableCellEditingOnBackspace"))){if(s&&he(o))s.clearCellRangeCellValues({dispatchWrapperEvents:!0,wrapperEventSource:"deleteKey"});else if(i.isCellEditable()){const e=i.getColumn(),t=this.beans.valueService.getDeleteValue(e,n);n.setDataValue(e,t,"cellClear")}}else i.startRowOrCellEdit(e,t);a.dispatchEvent({type:"keyShortcutChangedCellEnd"})}}onEnterKeyDown(e){if(this.cellCtrl.isEditing()||this.rowCtrl.isEditing())this.cellCtrl.stopEditingAndFocus(!1,e.shiftKey);else if(this.beans.gos.get("enterNavigatesVertically")){const t=e.shiftKey?Tr.UP:Tr.DOWN;this.beans.navigationService.navigateToNextCell(null,t,this.cellCtrl.getCellPosition(),!1)}else this.cellCtrl.startRowOrCellEdit(Tr.ENTER,e),this.cellCtrl.isEditing()&&e.preventDefault()}onF2KeyDown(e){this.cellCtrl.isEditing()||this.cellCtrl.startRowOrCellEdit(Tr.F2,e)}onEscapeKeyDown(e){this.cellCtrl.isEditing()&&(this.cellCtrl.stopRowOrCellEdit(!0),this.cellCtrl.focusCell(!0))}processCharacter(e){if(e.target!==this.eGui||this.cellCtrl.isEditing())return;const t=e.key;" "===t?this.onSpaceKeyDown(e):this.cellCtrl.startRowOrCellEdit(t,e)&&e.preventDefault()}onSpaceKeyDown(e){const{gos:t}=this.beans;if(!this.cellCtrl.isEditing()&&V(t)){const i=this.rowNode.isSelected(),r=!i,n="filteredDescendants"===we(t),o=this.rowNode.setSelectedParams({newValue:r,rangeSelect:e.shiftKey,groupSelectsFiltered:n,event:e,source:"spaceKey"});void 0===i&&0===o&&this.rowNode.setSelectedParams({newValue:!1,rangeSelect:e.shiftKey,groupSelectsFiltered:n,event:e,source:"spaceKey"})}e.preventDefault()}destroy(){super.destroy()}},Ts=class extends He{constructor(e,t,i){super(),this.cellCtrl=e,this.beans=t,this.column=i}onMouseEvent(e,t){if(!Oe(t))switch(e){case"click":this.onCellClicked(t);break;case"mousedown":case"touchstart":this.onMouseDown(t);break;case"dblclick":this.onCellDoubleClicked(t);break;case"mouseout":this.onMouseOut(t);break;case"mouseover":this.onMouseOver(t)}}onCellClicked(e){if(this.isDoubleClickOnIPad())return this.onCellDoubleClicked(e),void e.preventDefault();const{eventService:t,rangeService:i,gos:r}=this.beans,n=e.ctrlKey||e.metaKey;i&&n&&i.getCellRangeCount(this.cellCtrl.getCellPosition())>1&&i.intersectLastRange(!0);const o=this.cellCtrl.createEvent(e,"cellClicked");t.dispatchEvent(o);const s=this.column.getColDef();s.onCellClicked&&window.setTimeout((()=>{this.beans.frameworkOverrides.wrapOutgoing((()=>{s.onCellClicked(o)}))}),0);!((r.get("singleClickEdit")||s.singleClickEdit)&&!r.get("suppressClickEdit"))||e.shiftKey&&0!=(null===i||void 0===i?void 0:i.getCellRanges().length)||this.cellCtrl.startRowOrCellEdit()}isDoubleClickOnIPad(){if(!Pi()||Ne("dblclick"))return!1;const e=(new Date).getTime(),t=e-this.lastIPadMouseClickEvent<200;return this.lastIPadMouseClickEvent=e,t}onCellDoubleClicked(e){const{column:t,beans:i,cellCtrl:r}=this,{eventService:n,frameworkOverrides:o,gos:s}=i,a=t.getColDef(),l=r.createEvent(e,"cellDoubleClicked");n.dispatchEvent(l),"function"===typeof a.onCellDoubleClicked&&window.setTimeout((()=>{o.wrapOutgoing((()=>{a.onCellDoubleClicked(l)}))}),0);!s.get("singleClickEdit")&&!s.get("suppressClickEdit")&&r.startRowOrCellEdit(null,e)}onMouseDown(e){const{ctrlKey:t,metaKey:i,shiftKey:r}=e,n=e.target,{cellCtrl:o,beans:s}=this,{eventService:a,rangeService:l,focusService:c,gos:u}=s;if(this.isRightClickInExistingRange(e))return;const d=l&&0!=l.getCellRanges().length;if(!r||!d){const t=u.get("enableCellTextSelection")&&e.defaultPrevented,i=(Ri()||t)&&!o.isEditing()&&!Li(n);o.focusCell(i)}if(r&&d&&!c.isCellFocused(o.getCellPosition())){e.preventDefault();const t=c.getFocusedCell();if(t){const{column:e,rowIndex:i,rowPinned:r}=t,n=s.rowRenderer.getRowByPosition({rowIndex:i,rowPinned:r}),o=null===n||void 0===n?void 0:n.getCellCtrl(e);null!==o&&void 0!==o&&o.isEditing()&&o.stopEditing(),c.setFocusedCell({column:e,rowIndex:i,rowPinned:r,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0})}}if(!this.containsWidget(n)){if(l){const e=this.cellCtrl.getCellPosition();if(r)l.extendLatestRangeToCell(e);else{const r=t||i;l.setRangeToCell(e,r)}}a.dispatchEvent(this.cellCtrl.createEvent(e,"cellMouseDown"))}}isRightClickInExistingRange(e){const{rangeService:t}=this.beans;if(t){const i=t.isCellInAnyRange(this.cellCtrl.getCellPosition()),r=2===e.button||e.ctrlKey&&this.beans.gos.get("allowContextMenuWithControlKey");if(i&&r)return!0}return!1}containsWidget(e){return Bi(e,"ag-selection-checkbox",3)}onMouseOut(e){this.mouseStayingInsideCell(e)||(this.beans.eventService.dispatchEvent(this.cellCtrl.createEvent(e,"cellMouseOut")),this.beans.columnHoverService.clearMouseOver())}onMouseOver(e){this.mouseStayingInsideCell(e)||(this.beans.eventService.dispatchEvent(this.cellCtrl.createEvent(e,"cellMouseOver")),this.beans.columnHoverService.setMouseOver([this.column]))}mouseStayingInsideCell(e){if(!e.target||!e.relatedTarget)return!1;const t=this.cellCtrl.getGui(),i=t.contains(e.target),r=t.contains(e.relatedTarget);return i&&r}destroy(){super.destroy()}},Fs=class extends He{constructor(e,t){super(),this.cellCtrl=e,this.beans=t,this.column=e.getColumn(),this.rowNode=e.getRowNode()}setupRowSpan(){this.rowSpan=this.column.getRowSpan(this.rowNode),this.addManagedListeners(this.beans.eventService,{newColumnsLoaded:()=>this.onNewColumnsLoaded()})}setComp(e){this.eGui=e,this.setupColSpan(),this.setupRowSpan(),this.onLeftChanged(),this.onWidthChanged(),this.applyRowSpan()}onNewColumnsLoaded(){const e=this.column.getRowSpan(this.rowNode);this.rowSpan!==e&&(this.rowSpan=e,this.applyRowSpan(!0))}onDisplayColumnsChanged(){const e=this.getColSpanningList();Re(this.colsSpanning,e)||(this.colsSpanning=e,this.onWidthChanged(),this.onLeftChanged())}setupColSpan(){null!=this.column.getColDef().colSpan&&(this.colsSpanning=this.getColSpanningList(),this.addManagedListeners(this.beans.eventService,{displayedColumnsChanged:this.onDisplayColumnsChanged.bind(this),displayedColumnsWidthChanged:this.onWidthChanged.bind(this)}))}onWidthChanged(){if(!this.eGui)return;const e=this.getCellWidth();this.eGui.style.width="".concat(e,"px")}getCellWidth(){return this.colsSpanning?this.colsSpanning.reduce(((e,t)=>e+t.getActualWidth()),0):this.column.getActualWidth()}getColSpanningList(){const e=this.column.getColSpan(this.rowNode),t=[];if(1===e)t.push(this.column);else{let i=this.column;const r=this.column.getPinned();for(let n=0;i&&n<e&&(t.push(i),i=this.beans.visibleColsService.getColAfter(i),i&&!P(i))&&r===i.getPinned();n++);}return t}onLeftChanged(){if(!this.eGui)return;const e=this.modifyLeftForPrintLayout(this.getCellLeft());this.eGui.style.left=e+"px"}getCellLeft(){let e;return e=this.beans.gos.get("enableRtl")&&this.colsSpanning?ye(this.colsSpanning):this.column,e.getLeft()}modifyLeftForPrintLayout(e){if(!this.cellCtrl.isPrintLayout()||"left"===this.column.getPinned())return e;const t=this.beans.visibleColsService.getColsLeftWidth();if("right"===this.column.getPinned()){return t+this.beans.visibleColsService.getBodyContainerWidth()+(e||0)}return t+(e||0)}applyRowSpan(e){if(1===this.rowSpan&&!e)return;const t=j(this.beans.gos)*this.rowSpan;this.eGui.style.height="".concat(t,"px"),this.eGui.style.zIndex="1"}destroy(){super.destroy()}},Ps="ag-cell-range-selected",Ds=class{constructor(e,t){this.beans=e,this.rangeService=e.rangeService,this.selectionHandleFactory=e.selectionHandleFactory,this.cellCtrl=t}setComp(e,t){this.cellComp=e,this.eGui=t,this.onCellSelectionChanged()}onCellSelectionChanged(){this.cellComp&&(this.rangeCount=this.rangeService.getCellRangeCount(this.cellCtrl.getCellPosition()),this.hasChartRange=this.getHasChartRange(),this.cellComp.addOrRemoveCssClass(Ps,0!==this.rangeCount),this.cellComp.addOrRemoveCssClass("".concat(Ps,"-1"),1===this.rangeCount),this.cellComp.addOrRemoveCssClass("".concat(Ps,"-2"),2===this.rangeCount),this.cellComp.addOrRemoveCssClass("".concat(Ps,"-3"),3===this.rangeCount),this.cellComp.addOrRemoveCssClass("".concat(Ps,"-4"),this.rangeCount>=4),this.cellComp.addOrRemoveCssClass("ag-cell-range-chart",this.hasChartRange),Si(this.eGui,this.rangeCount>0||void 0),this.cellComp.addOrRemoveCssClass("ag-cell-range-single-cell",this.isSingleCell()),this.updateRangeBorders(),this.refreshHandle())}updateRangeBorders(){const e=this.getRangeBorders(),t=this.isSingleCell(),i=!t&&e.top,r=!t&&e.right,n=!t&&e.bottom,o=!t&&e.left;this.cellComp.addOrRemoveCssClass("ag-cell-range-top",i),this.cellComp.addOrRemoveCssClass("ag-cell-range-right",r),this.cellComp.addOrRemoveCssClass("ag-cell-range-bottom",n),this.cellComp.addOrRemoveCssClass("ag-cell-range-left",o)}isSingleCell(){const{rangeService:e}=this.beans;return 1===this.rangeCount&&!!e&&!e.isMoreThanOneCell()}getHasChartRange(){const{rangeService:e}=this.beans;if(!this.rangeCount||!e)return!1;const t=e.getCellRanges();return t.length>0&&t.every((e=>Pe([1,0],e.type)))}updateRangeBordersIfRangeCount(){this.rangeCount>0&&(this.updateRangeBorders(),this.refreshHandle())}getRangeBorders(){const e=this.beans.gos.get("enableRtl");let t=!1,i=!1,r=!1,n=!1;const o=this.cellCtrl.getCellPosition().column,s=this.beans.visibleColsService;let a,l;e?(a=s.getColAfter(o),l=s.getColBefore(o)):(a=s.getColBefore(o),l=s.getColAfter(o));const c=this.rangeService.getCellRanges().filter((e=>this.rangeService.isCellInSpecificRange(this.cellCtrl.getCellPosition(),e)));a||(n=!0),l||(i=!0);for(let u=0;u<c.length&&!(t&&i&&r&&n);u++){const e=c[u],o=this.rangeService.getRangeStartRow(e),s=this.rangeService.getRangeEndRow(e);!t&&this.beans.rowPositionUtils.sameRow(o,this.cellCtrl.getCellPosition())&&(t=!0),!r&&this.beans.rowPositionUtils.sameRow(s,this.cellCtrl.getCellPosition())&&(r=!0),!n&&a&&e.columns.indexOf(a)<0&&(n=!0),!i&&l&&e.columns.indexOf(l)<0&&(i=!0)}return{top:t,right:i,bottom:r,left:n}}refreshHandle(){if(this.beans.context.isDestroyed())return;const e=this.shouldHaveSelectionHandle();this.selectionHandle&&!e&&(this.selectionHandle=this.beans.context.destroyBean(this.selectionHandle)),e&&this.addSelectionHandle(),this.cellComp.addOrRemoveCssClass("ag-cell-range-handle",!!this.selectionHandle)}shouldHaveSelectionHandle(){const e=this.beans.gos,t=this.rangeService.getCellRanges(),i=t.length;if(this.rangeCount<1||i<1)return!1;const r=ye(t),n=this.cellCtrl.getCellPosition(),o=ge(e)&&!this.cellCtrl.isSuppressFillHandle(),s=function(e){var t;const i=e.get("cellSelection");return void 0!==i?"boolean"!==typeof i&&"range"===(null===(t=i.handle)||void 0===t?void 0:t.mode):e.get("enableRangeHandle")}(e);let a=1===i&&!this.cellCtrl.isEditing()&&(o||s);if(this.hasChartRange){const e=1===t[0].type&&this.rangeService.isCellInSpecificRange(n,t[0]);this.cellComp.addOrRemoveCssClass("ag-cell-range-chart-category",e),a=0===r.type}return a&&null!=r.endRow&&this.rangeService.isContiguousRange(r)&&this.rangeService.isBottomRightCell(r,n)}addSelectionHandle(){const e=ye(this.rangeService.getCellRanges()).type,t=ge(this.beans.gos)&&P(e)?0:1;this.selectionHandle&&this.selectionHandle.getType()!==t&&(this.selectionHandle=this.beans.context.destroyBean(this.selectionHandle)),this.selectionHandle||(this.selectionHandle=this.selectionHandleFactory.createSelectionHandle(t)),this.selectionHandle.refresh(this.cellCtrl)}destroy(){this.beans.context.destroyBean(this.selectionHandle)}},ks=0,As=class e extends He{constructor(e,t,i,r){super(),this.column=e,this.rowNode=t,this.beans=i,this.rowCtrl=r,this.cellRangeFeature=void 0,this.cellPositionFeature=void 0,this.cellCustomStyleFeature=void 0,this.tooltipFeature=void 0,this.cellMouseListenerFeature=void 0,this.cellKeyboardListenerFeature=void 0,this.suppressRefreshCell=!1,this.onCellCompAttachedFuncs=[],this.onCellEditorAttachedFuncs=[],this.instanceId=e.getId()+"-"+ks++,this.colIdSanitised=Pt(this.column.getId()),this.createCellPosition(),this.updateAndFormatValue(!1)}shouldRestoreFocus(){return this.beans.focusService.shouldRestoreFocus(this.cellPosition)}onFocusOut(){this.beans.focusService.clearRestoreFocus()}addFeatures(){this.cellPositionFeature=new Fs(this,this.beans),this.cellCustomStyleFeature=new Es(this,this.beans),this.cellMouseListenerFeature=new Ts(this,this.beans,this.column),this.cellKeyboardListenerFeature=new xs(this,this.beans,this.column,this.rowNode,this.rowCtrl),this.column.isTooltipEnabled()&&this.enableTooltipFeature();this.beans.rangeService&&he(this.beans.gos)&&(this.cellRangeFeature=new Ds(this.beans,this))}removeFeatures(){const e=this.beans.context;this.cellPositionFeature=e.destroyBean(this.cellPositionFeature),this.cellCustomStyleFeature=e.destroyBean(this.cellCustomStyleFeature),this.cellMouseListenerFeature=e.destroyBean(this.cellMouseListenerFeature),this.cellKeyboardListenerFeature=e.destroyBean(this.cellKeyboardListenerFeature),this.cellRangeFeature=e.destroyBean(this.cellRangeFeature),this.disableTooltipFeature()}enableTooltipFeature(e,t){const i="whenTruncated"===this.beans.gos.get("tooltipShowMode");t||!i||this.isCellRenderer()||(t=()=>{const e=this.getGui(),t=0===e.children.length?e:e.querySelector(".ag-cell-value");return!t||t.scrollWidth>t.clientWidth});const r={getColumn:()=>this.column,getColDef:()=>this.column.getColDef(),getRowIndex:()=>this.cellPosition.rowIndex,getRowNode:()=>this.rowNode,getGui:()=>this.getGui(),getLocation:()=>"cell",getTooltipValue:null!=e?()=>e:()=>{const e=this.column.getColDef(),t=this.rowNode.data;if(e.tooltipField&&F(t))return nt(t,e.tooltipField,this.column.isTooltipFieldContainsDots());const i=e.tooltipValueGetter;return i?i(this.beans.gos.addGridCommonParams({location:"cell",colDef:this.column.getColDef(),column:this.column,rowIndex:this.cellPosition.rowIndex,node:this.rowNode,data:this.rowNode.data,value:this.value,valueFormatted:this.valueFormatted})):null},getValueFormatted:()=>this.valueFormatted,shouldDisplayTooltip:t};this.tooltipFeature=new lr(r,this.beans)}disableTooltipFeature(){this.tooltipFeature=this.beans.context.destroyBean(this.tooltipFeature)}setComp(e,t,i,r,n,o){var s,a,l,c,u;this.cellComp=e,this.eGui=t,this.printLayout=r,null!==(s=o)&&void 0!==s||(o=this),this.addDomData(o),this.addFeatures(),o.addDestroyFunc((()=>this.removeFeatures())),this.onSuppressCellFocusChanged(this.beans.gos.get("suppressCellFocus")),this.onCellFocused(this.focusEventToRestore),this.applyStaticCssClasses(),this.setWrapText(),this.onFirstRightPinnedChanged(),this.onLastLeftPinnedChanged(),this.onColumnHover(),this.setupControlComps(),this.setupAutoHeight(i,o),this.refreshFirstAndLastStyles(),this.refreshAriaColIndex(),null===(a=this.cellPositionFeature)||void 0===a||a.setComp(t),null===(l=this.cellCustomStyleFeature)||void 0===l||l.setComp(e),null===(c=this.tooltipFeature)||void 0===c||c.refreshToolTip(),null===(u=this.cellKeyboardListenerFeature)||void 0===u||u.setComp(this.eGui),this.cellRangeFeature&&this.cellRangeFeature.setComp(e,t),n&&this.isCellEditable()?this.startEditing():this.showValue(),this.onCellCompAttachedFuncs.length&&(this.onCellCompAttachedFuncs.forEach((e=>e())),this.onCellCompAttachedFuncs=[])}setupAutoHeight(e,t){if(this.isAutoHeight=this.column.isAutoHeight(),!this.isAutoHeight||!e)return;const i=e.parentElement,r=U(this.beans.gos,this.rowNode).height,n=o=>{if(this.editing)return;if(!this.isAlive()||!t.isAlive())return;const{paddingTop:s,paddingBottom:a,borderBottomWidth:l,borderTopWidth:c}=Gi(i),u=s+a+l+c,d=e.offsetHeight+u;if(o<5){const t=Q(this.beans.gos);if(!t||!t.contains(e)||0==d)return void window.setTimeout((()=>n(o+1)),0)}const h=Math.max(d,r);this.rowNode.setRowAutoHeight(h,this.column)},o=()=>n(0);o();const s=this.beans.resizeObserverService.observeResize(e,o);t.addDestroyFunc((()=>{s(),this.rowNode.setRowAutoHeight(void 0,this.column)}))}getCellAriaRole(){var e;return null!==(e=this.column.getColDef().cellAriaRole)&&void 0!==e?e:"gridcell"}isCellRenderer(){const e=this.column.getColDef();return null!=e.cellRenderer||null!=e.cellRendererSelector}getValueToDisplay(){var e;return null!==(e=this.valueFormatted)&&void 0!==e?e:this.value}showValue(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{beans:i,column:r,rowNode:n,cellRangeFeature:o,cellComp:s}=this,{userComponentFactory:a,animationFrameService:l}=i,c=this.getValueToDisplay();let u;if(n.stub&&null==(null===(e=n.groupData)||void 0===e?void 0:e[this.column.getId()])){const e=this.createCellRendererParams();u=a.getLoadingCellRendererDetails(r.getColDef(),e)}else if(this.isCellRenderer()){const e=this.createCellRendererParams();u=a.getCellRendererDetails(r.getColDef(),e)}s.setRenderDetails(u,c,t),l.requestAnimationFrame((()=>null===o||void 0===o?void 0:o.refreshHandle()))}setupControlComps(){const e=this.column.getColDef();this.includeSelection=this.isIncludeControl(this.isCheckboxSelection(e)),this.includeRowDrag=this.isIncludeControl(e.rowDrag),this.includeDndSource=this.isIncludeControl(e.dndSource),this.cellComp.setIncludeSelection(this.includeSelection),this.cellComp.setIncludeDndSource(this.includeDndSource),this.cellComp.setIncludeRowDrag(this.includeRowDrag)}isForceWrapper(){return this.beans.gos.get("enableCellTextSelection")||this.column.isAutoHeight()}isIncludeControl(e){return!(null!=this.rowNode.rowPinned)&&("function"===typeof e||!0===e)}isCheckboxSelection(e){const{rowSelection:t}=this.beans.gridOptions;return e.checkboxSelection||Qe(this.column)&&t&&"string"!==typeof t&&ue(t)}refreshShouldDestroy(){const e=this.column.getColDef(),t=this.includeSelection!=this.isIncludeControl(this.isCheckboxSelection(e)),i=this.includeRowDrag!=this.isIncludeControl(e.rowDrag),r=this.includeDndSource!=this.isIncludeControl(e.dndSource),n=this.isAutoHeight!=this.column.isAutoHeight();return t||i||r||n}startEditing(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const{editService:r}=this.beans;return!(this.isCellEditable()&&!this.editing&&r)||(this.cellComp?r.startEditing(this,e,t,i):(this.onCellCompAttachedFuncs.push((()=>{this.startEditing(e,t,i)})),!0))}setEditing(e,t){this.editCompDetails=t,this.editing!==e&&(this.editing=e)}stopRowOrCellEdit(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];"fullRow"===this.beans.gos.get("editType")?this.rowCtrl.stopEditing(e):this.stopEditing(e)}onPopupEditorClosed(){this.editing&&this.stopEditingAndFocus()}stopEditing(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.onCellEditorAttachedFuncs=[];const{editService:t}=this.beans;return!(!this.editing||!t)&&t.stopEditing(this,e)}createCellRendererParams(){return this.beans.gos.addGridCommonParams({value:this.value,valueFormatted:this.valueFormatted,getValue:()=>this.beans.valueService.getValueForDisplay(this.column,this.rowNode),setValue:e=>this.beans.valueService.setValue(this.rowNode,this.column,e),formatValue:this.formatValue.bind(this),data:this.rowNode.data,node:this.rowNode,pinned:this.column.getPinned(),colDef:this.column.getColDef(),column:this.column,refreshCell:this.refreshCell.bind(this),eGridCell:this.getGui(),eParentOfValue:this.cellComp.getParentOfValue(),registerRowDragger:(e,t,i,r)=>this.registerRowDragger(e,t,r),setTooltip:(e,t)=>{var i;this.tooltipFeature&&this.disableTooltipFeature(),this.enableTooltipFeature(e,t),null===(i=this.tooltipFeature)||void 0===i||i.refreshToolTip()}})}setFocusOutOnEditor(){var e;this.editing&&(null===(e=this.beans.editService)||void 0===e||e.setFocusOutOnEditor(this))}setFocusInOnEditor(){var e;this.editing&&(null===(e=this.beans.editService)||void 0===e||e.setFocusInOnEditor(this))}onCellChanged(e){e.column===this.column&&this.refreshCell({})}refreshOrDestroyCell(e){var t;this.refreshShouldDestroy()?null===(t=this.rowCtrl)||void 0===t||t.recreateCell(this):this.refreshCell(e)}refreshCell(e){var t,i;if(this.suppressRefreshCell||this.editing)return;const r=this.column.getColDef(),n=null!=e&&!!e.newData,o=null!=e&&!!e.suppressFlash||!!r.suppressCellFlash,s=null==r.field&&null==r.valueGetter&&null==r.showRowGroup,a=e&&e.forceRefresh||s||n,l=!!this.cellComp,c=this.updateAndFormatValue(l);if(l){if(a||c){var u,d,h;this.showValue(n);const e=null===(u=this.beans.filterManager)||void 0===u?void 0:u.isSuppressFlashingCellsBecauseFiltering();!o&&!e&&(this.beans.gos.get("enableCellChangeFlash")||r.enableCellChangeFlash)&&this.flashCell(),null===(d=this.cellCustomStyleFeature)||void 0===d||d.applyUserStyles(),null===(h=this.cellCustomStyleFeature)||void 0===h||h.applyClassesFromColDef()}null===(t=this.tooltipFeature)||void 0===t||t.refreshToolTip(),null===(i=this.cellCustomStyleFeature)||void 0===i||i.applyCellClassRules()}}stopEditingAndFocus(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];null===(e=this.beans.editService)||void 0===e||e.stopEditingAndFocus(this,t,i)}flashCell(e){var t,i;const r=null!==(t=null===e||void 0===e?void 0:e.flashDuration)&&void 0!==t?t:null===e||void 0===e?void 0:e.flashDelay,n=null!==(i=null===e||void 0===e?void 0:e.fadeDuration)&&void 0!==i?i:null===e||void 0===e?void 0:e.fadeDelay;this.animateCell("data-changed",r,n)}animateCell(e,t,i){if(!this.cellComp)return;const{gos:r}=this.beans;if(t||(t=r.get("cellFlashDuration")),0===t)return;F(i)||(i=r.get("cellFadeDuration"));const n="ag-cell-".concat(e),o="ag-cell-".concat(e,"-animation");this.cellComp.addOrRemoveCssClass(n,!0),this.cellComp.addOrRemoveCssClass(o,!1),this.beans.frameworkOverrides.wrapIncoming((()=>{window.setTimeout((()=>{this.isAlive()&&(this.cellComp.addOrRemoveCssClass(n,!1),this.cellComp.addOrRemoveCssClass(o,!0),this.eGui.style.transition="background-color ".concat(i,"ms"),window.setTimeout((()=>{this.isAlive()&&(this.cellComp.addOrRemoveCssClass(o,!1),this.eGui.style.transition="")}),i))}),t)}))}onFlashCells(e){if(!this.cellComp)return;const t=this.beans.cellPositionUtils.createId(this.getCellPosition());e.cells[t]&&this.animateCell("highlight")}isCellEditable(){return this.column.isCellEditable(this.rowNode)}isSuppressFillHandle(){return this.column.isSuppressFillHandle()}formatValue(e){var t;return null!==(t=this.callValueFormatter(e))&&void 0!==t?t:e}callValueFormatter(e){return this.beans.valueService.formatValue(this.column,this.rowNode,e)}updateAndFormatValue(e){const t=this.value,i=this.valueFormatted;return this.value=this.beans.valueService.getValueForDisplay(this.column,this.rowNode),this.valueFormatted=this.callValueFormatter(this.value),!e||(!this.valuesAreEqual(t,this.value)||this.valueFormatted!=i)}valuesAreEqual(e,t){const i=this.column.getColDef();return i.equals?i.equals(e,t):e===t}getComp(){return this.cellComp}getValue(){return this.value}addDomData(t){const i=this.getGui();q(this.beans.gos,i,e.DOM_DATA_KEY_CELL_CTRL,this),t.addDestroyFunc((()=>q(this.beans.gos,i,e.DOM_DATA_KEY_CELL_CTRL,null)))}createEvent(e,t){return this.beans.gos.addGridCommonParams({type:t,node:this.rowNode,data:this.rowNode.data,value:this.value,column:this.column,colDef:this.column.getColDef(),rowPinned:this.rowNode.rowPinned,event:e,rowIndex:this.rowNode.rowIndex})}processCharacter(e){var t;null===(t=this.cellKeyboardListenerFeature)||void 0===t||t.processCharacter(e)}onKeyDown(e){var t;null===(t=this.cellKeyboardListenerFeature)||void 0===t||t.onKeyDown(e)}onMouseEvent(e,t){var i;null===(i=this.cellMouseListenerFeature)||void 0===i||i.onMouseEvent(e,t)}getGui(){return this.eGui}getColSpanningList(){return this.cellPositionFeature.getColSpanningList()}onLeftChanged(){var e;this.cellComp&&(null===(e=this.cellPositionFeature)||void 0===e||e.onLeftChanged())}onDisplayedColumnsChanged(){this.eGui&&(this.refreshAriaColIndex(),this.refreshFirstAndLastStyles())}refreshFirstAndLastStyles(){const{cellComp:e,column:t,beans:i}=this;Ro(e,t,i.visibleColsService)}refreshAriaColIndex(){const e=this.beans.visibleColsService.getAriaColIndex(this.column);Ci(this.getGui(),e)}isSuppressNavigable(){return this.column.isSuppressNavigable(this.rowNode)}onWidthChanged(){var e;return null===(e=this.cellPositionFeature)||void 0===e?void 0:e.onWidthChanged()}getColumn(){return this.column}getRowNode(){return this.rowNode}isPrintLayout(){return this.printLayout}getCellPosition(){return this.cellPosition}isEditing(){return this.editing}startRowOrCellEdit(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.cellComp?"fullRow"===this.beans.gos.get("editType")?this.rowCtrl.startRowEditing(e,this):this.startEditing(e,!0,t):(this.onCellCompAttachedFuncs.push((()=>{this.startRowOrCellEdit(e,t)})),!0)}getRowCtrl(){return this.rowCtrl}getRowPosition(){return{rowIndex:this.cellPosition.rowIndex,rowPinned:this.cellPosition.rowPinned}}updateRangeBordersIfRangeCount(){this.cellComp&&this.cellRangeFeature&&this.cellRangeFeature.updateRangeBordersIfRangeCount()}onCellSelectionChanged(){this.cellComp&&this.cellRangeFeature&&this.cellRangeFeature.onCellSelectionChanged()}isRangeSelectionEnabled(){return null!=this.cellRangeFeature}focusCell(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.beans.focusService.setFocusedCell({rowIndex:this.getCellPosition().rowIndex,column:this.column,rowPinned:this.rowNode.rowPinned,forceBrowserFocus:e})}onRowIndexChanged(){this.createCellPosition(),this.onCellFocused(),this.cellRangeFeature&&this.cellRangeFeature.onCellSelectionChanged()}onSuppressCellFocusChanged(e){this.eGui&&rr(this.eGui,"tabindex",e?void 0:-1)}onFirstRightPinnedChanged(){if(!this.cellComp)return;const e=this.column.isFirstRightPinned();this.cellComp.addOrRemoveCssClass("ag-cell-first-right-pinned",e)}onLastLeftPinnedChanged(){if(!this.cellComp)return;const e=this.column.isLastLeftPinned();this.cellComp.addOrRemoveCssClass("ag-cell-last-left-pinned",e)}onCellFocused(e){if(this.beans.focusService.isCellFocusSuppressed())return;const t=this.beans.focusService.isCellFocused(this.cellPosition);if(!this.cellComp)return void(t&&null!==e&&void 0!==e&&e.forceBrowserFocus&&(this.focusEventToRestore=e));if(this.focusEventToRestore=void 0,this.cellComp.addOrRemoveCssClass("ag-cell-focus",t),t&&e&&e.forceBrowserFocus){let t=this.cellComp.getFocusableElement();if(this.editing){const e=this.beans.focusService.findFocusableElements(t,null,!0);e.length&&(t=e[0])}t.focus({preventScroll:!!e.preventScrollOnBrowserFocus})}const i="fullRow"===this.beans.gos.get("editType");t||i||!this.editing||this.stopRowOrCellEdit(),t&&this.rowCtrl.announceDescription()}createCellPosition(){this.cellPosition={rowIndex:this.rowNode.rowIndex,rowPinned:T(this.rowNode.rowPinned),column:this.column}}applyStaticCssClasses(){this.cellComp.addOrRemoveCssClass("ag-cell",!0),this.cellComp.addOrRemoveCssClass("ag-cell-not-inline-editing",!0);const e=1==this.column.isAutoHeight();this.cellComp.addOrRemoveCssClass("ag-cell-auto-height",e),this.cellComp.addOrRemoveCssClass("ag-cell-normal-height",!e)}onColumnHover(){if(!this.cellComp)return;if(!this.beans.gos.get("columnHoverHighlight"))return;const e=this.beans.columnHoverService.isHovered(this.column);this.cellComp.addOrRemoveCssClass("ag-column-hover",e)}onColDefChanged(){if(!this.cellComp)return;var e;(this.column.isTooltipEnabled()?(this.disableTooltipFeature(),this.enableTooltipFeature()):this.disableTooltipFeature(),this.setWrapText(),this.editing)?null===(e=this.beans.editService)||void 0===e||e.handleColDefChanged(this):this.refreshOrDestroyCell({forceRefresh:!0,suppressFlash:!0})}setWrapText(){const e=1==this.column.getColDef().wrapText;this.cellComp.addOrRemoveCssClass("ag-cell-wrap-text",e)}dispatchCellContextMenuEvent(e){const t=this.column.getColDef(),i=this.createEvent(e,"cellContextMenu");this.beans.eventService.dispatchEvent(i),t.onCellContextMenu&&window.setTimeout((()=>{this.beans.frameworkOverrides.wrapOutgoing((()=>{t.onCellContextMenu(i)}))}),0)}getCellRenderer(){return this.cellComp?this.cellComp.getCellRenderer():null}getCellEditor(){return this.cellComp?this.cellComp.getCellEditor():null}destroy(){this.onCellCompAttachedFuncs=[],this.onCellEditorAttachedFuncs=[],super.destroy()}createSelectionCheckbox(){const e=new ys;return this.beans.context.createBean(e),e.init({rowNode:this.rowNode,column:this.column}),e}createDndSource(){const e=new Rs(this.rowNode,this.column,this.eGui);return this.beans.context.createBean(e),e}registerRowDragger(e,t,i){if(this.customRowDragComp)return void this.customRowDragComp.setDragElement(e,t);const r=this.createRowDragComp(e,t,i);r&&(this.customRowDragComp=r,this.addDestroyFunc((()=>{this.beans.context.destroyBean(r),this.customRowDragComp=null})))}createRowDragComp(e,t,i){const r=this.beans.gos.get("pagination"),n=this.beans.gos.get("rowDragManaged"),o=G(this.beans.gos);if(n){if(!o)return void v("managed row dragging is only allowed in the Client Side Row Model");if(r)return void v("managed row dragging is not possible when doing pagination")}const s=new Rn((()=>this.value),this.rowNode,this.column,e,t,i);return this.beans.context.createBean(s),s}setSuppressRefreshCell(e){this.suppressRefreshCell=e}getEditCompDetails(){return this.editCompDetails}onCellEditorAttached(e){this.onCellEditorAttachedFuncs.push(e)}cellEditorAttached(){this.onCellEditorAttachedFuncs.forEach((e=>e())),this.onCellEditorAttachedFuncs=[]}};As.DOM_DATA_KEY_CELL_CTRL="cellCtrl";var Ms=As,Is=0,Ls=class e extends He{constructor(e,t,i,r,n){var o,s;super(),this.allRowGuis=[],this.active=!0,this.centerCellCtrls={list:[],map:{}},this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}},this.slideInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.fadeInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.rowDragComps=[],this.lastMouseDownOnDragger=!1,this.emptyStyle={},this.updateColumnListsPending=!1,this.rowId=null,this.businessKeySanitised=null,this.beans=t,this.gos=t.gos,this.rowNode=e,this.paginationPage=null!==(o=null===(s=t.paginationService)||void 0===s?void 0:s.getCurrentPage())&&void 0!==o?o:0,this.useAnimationFrameForCreate=r,this.printLayout=n,this.suppressRowTransform=this.gos.get("suppressRowTransform"),this.instanceId=e.id+"-"+Is++,this.rowId=Pt(e.id),this.initRowBusinessKey(),this.rowFocused=t.focusService.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned),this.rowLevel=t.rowCssClassCalculator.calculateRowLevel(this.rowNode),this.setRowType(),this.setAnimateFlags(i),this.rowStyles=this.processStylesFromGridOptions(),this.addListeners()}initRowBusinessKey(){this.businessKeyForNodeFunc=this.gos.get("getBusinessKeyForNode"),this.updateRowBusinessKey()}updateRowBusinessKey(){if("function"!==typeof this.businessKeyForNodeFunc)return;const e=this.businessKeyForNodeFunc(this.rowNode);this.businessKeySanitised=Pt(e)}getRowId(){return this.rowId}getRowStyles(){return this.rowStyles}isSticky(){return this.rowNode.sticky}updateGui(e,t){"left"===e?this.leftGui=t:"right"===e?this.rightGui=t:"fullWidth"===e?this.fullWidthGui=t:this.centerGui=t}setComp(e,t,i,r){const n={rowComp:e,element:t,containerType:i,compBean:r=Yt(this,this.beans.context,r)};this.allRowGuis.push(n),this.updateGui(i,n),this.initialiseRowComp(n),"FullWidthLoading"===this.rowType||this.rowNode.rowPinned||this.beans.rowRenderer.dispatchFirstDataRenderedEvent()}unsetComp(e){this.allRowGuis=this.allRowGuis.filter((t=>t.containerType!==e)),this.updateGui(e,void 0)}isCacheable(){return"FullWidthDetail"===this.rowType&&this.gos.get("keepDetailRows")}setCached(e){const t=e?"none":"";this.allRowGuis.forEach((e=>e.element.style.display=t))}initialiseRowComp(t){const i=this.gos;this.onSuppressCellFocusChanged(this.beans.gos.get("suppressCellFocus")),this.listenOnDomOrder(t),this.beans.columnModel.wasAutoRowHeightEverActive()&&this.rowNode.checkAutoHeights(),this.onRowHeightChanged(t),this.updateRowIndexes(t),this.setFocusedClasses(t),this.setStylesFromGridOptions(!1,t),V(i)&&this.rowNode.selectable&&this.onRowSelected(t),this.updateColumnLists(!this.useAnimationFrameForCreate);const r=t.rowComp;this.getInitialRowClasses(t.containerType).forEach((e=>r.addOrRemoveCssClass(e,!0))),this.executeSlideAndFadeAnimations(t),this.rowNode.group&&pi(t.element,1==this.rowNode.expanded),this.setRowCompRowId(r),this.setRowCompRowBusinessKey(r),q(i,t.element,e.DOM_DATA_KEY_ROW_CTRL,this),t.compBean.addDestroyFunc((()=>q(i,t.element,e.DOM_DATA_KEY_ROW_CTRL,null))),this.useAnimationFrameForCreate?this.beans.animationFrameService.createTask(this.addHoverFunctionality.bind(this,t),this.rowNode.rowIndex,"createTasksP2"):this.addHoverFunctionality(t),this.isFullWidth()&&this.setupFullWidth(t),i.get("rowDragEntireRow")&&this.addRowDraggerToRow(t),this.useAnimationFrameForCreate&&this.beans.animationFrameService.addDestroyTask((()=>{this.isAlive()&&t.rowComp.addOrRemoveCssClass("ag-after-created",!0)})),this.executeProcessRowPostCreateFunc()}setRowCompRowBusinessKey(e){null!=this.businessKeySanitised&&e.setRowBusinessKey(this.businessKeySanitised)}getBusinessKey(){return this.businessKeySanitised}setRowCompRowId(e){this.rowId=Pt(this.rowNode.id),null!=this.rowId&&e.setRowId(this.rowId)}executeSlideAndFadeAnimations(e){const{containerType:t}=e;this.slideInAnimation[t]&&(R((()=>{this.onTopChanged()})),this.slideInAnimation[t]=!1);this.fadeInAnimation[t]&&(R((()=>{e.rowComp.addOrRemoveCssClass("ag-opacity-zero",!1)})),this.fadeInAnimation[t]=!1)}addRowDraggerToRow(e){if(he(this.gos))return void v("Setting `rowDragEntireRow: true` in the gridOptions doesn't work with `cellSelection: true`");const t=this.beans.localeService.getLocaleTextFunc(),i=new Rn((()=>"1 ".concat(t("rowDragRow","row"))),this.rowNode,void 0,e.element,void 0,!0),r=this.createBean(i,this.beans.context);this.rowDragComps.push(r),e.compBean.addDestroyFunc((()=>{this.rowDragComps=this.rowDragComps.filter((e=>e!==r)),this.destroyBean(r,this.beans.context)}))}setupFullWidth(e){const t=this.getPinnedForContainer(e.containerType);if("FullWidthDetail"==this.rowType&&!this.gos.assertModuleRegistered("@ag-grid-enterprise/master-detail","cell renderer 'agDetailCellRenderer' (for master detail)"))return;const i=this.createFullWidthCompDetails(e.element,t);e.rowComp.showFullWidth(i)}isPrintLayout(){return this.printLayout}getFullWidthCellRenderers(){var e;return this.gos.get("embedFullWidthRows")?this.allRowGuis.map((e=>{var t;return null===e||void 0===e||null===(t=e.rowComp)||void 0===t?void 0:t.getFullWidthCellRenderer()})):[null===(e=this.fullWidthGui)||void 0===e||null===(e=e.rowComp)||void 0===e?void 0:e.getFullWidthCellRenderer()]}getCellElement(e){const t=this.getCellCtrl(e);return t?t.getGui():null}executeProcessRowPostCreateFunc(){const e=this.gos.getCallback("processRowPostCreate");if(!e||!this.areAllContainersReady())return;e({eRow:this.centerGui.element,ePinnedLeftRow:this.leftGui?this.leftGui.element:void 0,ePinnedRightRow:this.rightGui?this.rightGui.element:void 0,node:this.rowNode,rowIndex:this.rowNode.rowIndex,addRenderedRowListener:this.addEventListener.bind(this)})}areAllContainersReady(){const e=!!this.leftGui||!this.beans.visibleColsService.isPinningLeft(),t=!!this.centerGui,i=!!this.rightGui||!this.beans.visibleColsService.isPinningRight();return e&&t&&i}isNodeFullWidthCell(){if(this.rowNode.detail)return!0;const e=this.beans.gos.getCallback("isFullWidthRow");return!!e&&e({rowNode:this.rowNode})}setRowType(){const e=this.rowNode.stub&&!this.gos.get("suppressServerSideFullWidthLoadingRow")&&!this.gos.get("groupHideOpenParents"),t=this.isNodeFullWidthCell(),i=this.gos.get("masterDetail")&&this.rowNode.detail,r=this.beans.columnModel.isPivotMode(),n=!!this.rowNode.group&&!this.rowNode.footer&&le(this.gos,r);this.rowType=e?"FullWidthLoading":i?"FullWidthDetail":t?"FullWidth":n?"FullWidthGroup":"Normal"}updateColumnLists(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.isFullWidth())return;e||this.gos.get("suppressAnimationFrame")||this.printLayout?this.updateColumnListsImpl(t):this.updateColumnListsPending||(this.beans.animationFrameService.createTask((()=>{this.active&&this.updateColumnListsImpl(!0)}),this.rowNode.rowIndex,"createTasksP1"),this.updateColumnListsPending=!0)}createCellCtrls(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const r={list:[],map:{}},n=(e,t)=>{r.list.push(t),r.map[e]=t};return t.forEach((t=>{const i=t.getInstanceId();let r=e.map[i];r||(r=new Ms(t,this.rowNode,this.beans,this)),n(i,r)})),e.list.forEach((e=>{const t=e.getColumn().getInstanceId();if(null!=r.map[t])return;this.isCellEligibleToBeRemoved(e,i)?e.destroy():n(t,e)})),r}updateColumnListsImpl(e){this.updateColumnListsPending=!1,this.createAllCellCtrls(),this.setCellCtrls(e)}setCellCtrls(e){this.allRowGuis.forEach((t=>{const i=this.getCellCtrlsForContainer(t.containerType);t.rowComp.setCellCtrls(i,e)}))}getCellCtrlsForContainer(e){switch(e){case"left":return this.leftCellCtrls.list;case"right":return this.rightCellCtrls.list;case"fullWidth":return[];case"center":return this.centerCellCtrls.list}}createAllCellCtrls(){const e=this.beans.columnViewportService,t=this.beans.visibleColsService;if(this.printLayout)this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,t.getAllCols()),this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}};else{const i=e.getColsWithinViewport(this.rowNode);this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,i);const r=t.getLeftColsForRow(this.rowNode);this.leftCellCtrls=this.createCellCtrls(this.leftCellCtrls,r,"left");const n=t.getRightColsForRow(this.rowNode);this.rightCellCtrls=this.createCellCtrls(this.rightCellCtrls,n,"right")}}isCellEligibleToBeRemoved(e,t){const i=!0;if(e.getColumn().getPinned()!=t)return i;const r=e.isEditing(),n=this.beans.focusService.isCellFocused(e.getCellPosition());if(r||n){const t=e.getColumn();return!(this.beans.visibleColsService.getAllCols().indexOf(t)>=0)&&i}return i}getDomOrder(){return this.gos.get("ensureDomOrder")||z(this.gos,"print")}listenOnDomOrder(e){e.compBean.addManagedPropertyListeners(["domLayout","ensureDomOrder"],(()=>{e.rowComp.setDomOrder(this.getDomOrder())}))}setAnimateFlags(e){if(this.isSticky()||!e)return;const t=F(this.rowNode.oldRowTop),i=this.beans.visibleColsService.isPinningLeft(),r=this.beans.visibleColsService.isPinningRight();if(t){if(this.isFullWidth()&&!this.gos.get("embedFullWidthRows"))return void(this.slideInAnimation.fullWidth=!0);this.slideInAnimation.center=!0,this.slideInAnimation.left=i,this.slideInAnimation.right=r}else{if(this.isFullWidth()&&!this.gos.get("embedFullWidthRows"))return void(this.fadeInAnimation.fullWidth=!0);this.fadeInAnimation.center=!0,this.fadeInAnimation.left=i,this.fadeInAnimation.right=r}}isEditing(){return this.editingRow}isFullWidth(){return"Normal"!==this.rowType}refreshFullWidth(){const e=(e,t)=>!e||e.rowComp.refreshFullWidth((()=>this.createFullWidthCompDetails(e.element,t).params)),t=e(this.fullWidthGui,null),i=e(this.centerGui,null),r=e(this.leftGui,"left"),n=e(this.rightGui,"right");return t&&i&&r&&n}addListeners(){this.addManagedListeners(this.rowNode,{heightChanged:()=>this.onRowHeightChanged(),rowSelected:()=>this.onRowSelected(),rowIndexChanged:this.onRowIndexChanged.bind(this),topChanged:this.onTopChanged.bind(this),expandedChanged:this.updateExpandedCss.bind(this),hasChildrenChanged:this.updateExpandedCss.bind(this)}),this.rowNode.detail&&this.addManagedListeners(this.rowNode.parent,{dataChanged:this.onRowNodeDataChanged.bind(this)}),this.addManagedListeners(this.rowNode,{dataChanged:this.onRowNodeDataChanged.bind(this),cellChanged:this.postProcessCss.bind(this),rowHighlightChanged:this.onRowNodeHighlightChanged.bind(this),draggingChanged:this.postProcessRowDragging.bind(this),uiLevelChanged:this.onUiLevelChanged.bind(this)}),this.addManagedListeners(this.beans.eventService,{paginationPixelOffsetChanged:this.onPaginationPixelOffsetChanged.bind(this),heightScaleChanged:this.onTopChanged.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),virtualColumnsChanged:this.onVirtualColumnsChanged.bind(this),cellFocused:this.onCellFocusChanged.bind(this),cellFocusCleared:this.onCellFocusChanged.bind(this),paginationChanged:this.onPaginationChanged.bind(this),modelUpdated:this.refreshFirstAndLastRowStyles.bind(this),columnMoved:()=>this.updateColumnLists()}),this.addDestroyFunc((()=>{this.rowDragComps=this.destroyBeans(this.rowDragComps,this.beans.context),this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature,this.beans.context))})),this.addManagedPropertyListeners(["rowStyle","getRowStyle","rowClass","getRowClass","rowClassRules"],this.postProcessCss.bind(this)),this.addManagedPropertyListener("rowDragEntireRow",(()=>{this.gos.get("rowDragEntireRow")?this.allRowGuis.forEach((e=>{this.addRowDraggerToRow(e)})):this.rowDragComps=this.destroyBeans(this.rowDragComps,this.beans.context)})),this.addListenersForCellComps()}addListenersForCellComps(){this.addManagedListeners(this.rowNode,{rowIndexChanged:()=>{this.getAllCellCtrls().forEach((e=>e.onRowIndexChanged()))},cellChanged:e=>{this.getAllCellCtrls().forEach((t=>t.onCellChanged(e)))}})}onRowNodeDataChanged(e){if(this.isFullWidth()!==!!this.isNodeFullWidthCell())this.beans.rowRenderer.redrawRow(this.rowNode);else if(this.isFullWidth()){this.refreshFullWidth()||this.beans.rowRenderer.redrawRow(this.rowNode)}else this.getAllCellCtrls().forEach((t=>t.refreshCell({suppressFlash:!e.update,newData:!e.update}))),this.allRowGuis.forEach((e=>{this.setRowCompRowId(e.rowComp),this.updateRowBusinessKey(),this.setRowCompRowBusinessKey(e.rowComp)})),this.onRowSelected(),this.postProcessCss()}postProcessCss(){this.setStylesFromGridOptions(!0),this.postProcessClassesFromGridOptions(),this.postProcessRowClassRules(),this.postProcessRowDragging()}onRowNodeHighlightChanged(){const e=this.rowNode.highlighted;this.allRowGuis.forEach((t=>{const i=0===e,r=1===e;t.rowComp.addOrRemoveCssClass("ag-row-highlight-above",i),t.rowComp.addOrRemoveCssClass("ag-row-highlight-below",r)}))}postProcessRowDragging(){const e=this.rowNode.dragging;this.allRowGuis.forEach((t=>t.rowComp.addOrRemoveCssClass("ag-row-dragging",e)))}updateExpandedCss(){const e=this.rowNode.isExpandable(),t=1==this.rowNode.expanded;this.allRowGuis.forEach((i=>{i.rowComp.addOrRemoveCssClass("ag-row-group",e),i.rowComp.addOrRemoveCssClass("ag-row-group-expanded",e&&t),i.rowComp.addOrRemoveCssClass("ag-row-group-contracted",e&&!t),pi(i.element,e&&t)}))}onDisplayedColumnsChanged(){this.updateColumnLists(!0),this.beans.columnModel.wasAutoRowHeightEverActive()&&this.rowNode.checkAutoHeights()}onVirtualColumnsChanged(){this.updateColumnLists(!1,!0)}getRowPosition(){return{rowPinned:T(this.rowNode.rowPinned),rowIndex:this.rowNode.rowIndex}}findFullWidthRowGui(e){return this.allRowGuis.find((t=>t.element.contains(e)))}onKeyboardNavigate(e){var t;const i=this.findFullWidthRowGui(e.target);if(!((i?i.element:null)===e.target))return;const r=this.rowNode,n=this.beans.focusService.getFocusedCell(),o={rowIndex:r.rowIndex,rowPinned:r.rowPinned,column:null!==(t=null===n||void 0===n?void 0:n.column)&&void 0!==t?t:this.getColumnForFullWidth(i)};this.beans.navigationService.navigateToNextCell(e,e.key,o,!0),e.preventDefault()}onTabKeyDown(e){if(e.defaultPrevented||Oe(e))return;const t=this.allRowGuis.find((t=>t.element.contains(e.target))),i=t?t.element:null,r=i===e.target,n=Z(this.gos);let o=!1;i&&n&&(o=i.contains(n)&&n.classList.contains("ag-cell"));let s=null;r||o||(s=this.beans.focusService.findNextFocusableElement(i,!1,e.shiftKey)),(this.isFullWidth()&&r||!s)&&this.beans.navigationService.onTabKeyDown(this,e)}getFullWidthElement(){return this.fullWidthGui?this.fullWidthGui.element:null}getRowYPosition(){var e;const t=null===(e=this.allRowGuis.find((e=>$i(e.element))))||void 0===e?void 0:e.element;return t?t.getBoundingClientRect().top:0}onSuppressCellFocusChanged(e){const t=this.isFullWidth()&&e?void 0:-1;this.allRowGuis.forEach((e=>{rr(e.element,"tabindex",t)}))}onFullWidthRowFocused(e){var t;const i=this.rowNode,r=!!e&&(this.isFullWidth()&&e.rowIndex===i.rowIndex&&e.rowPinned==i.rowPinned),n=this.fullWidthGui?this.fullWidthGui.element:null===(t=this.centerGui)||void 0===t?void 0:t.element;n&&(n.classList.toggle("ag-full-width-focus",r),r&&null!==e&&void 0!==e&&e.forceBrowserFocus&&n.focus({preventScroll:!0}))}recreateCell(e){this.centerCellCtrls=this.removeCellCtrl(this.centerCellCtrls,e),this.leftCellCtrls=this.removeCellCtrl(this.leftCellCtrls,e),this.rightCellCtrls=this.removeCellCtrl(this.rightCellCtrls,e),e.destroy(),this.updateColumnLists()}removeCellCtrl(e,t){const i={list:[],map:{}};return e.list.forEach((e=>{e!==t&&(i.list.push(e),i.map[e.getColumn().getInstanceId()]=e)})),i}onMouseEvent(e,t){switch(e){case"dblclick":this.onRowDblClick(t);break;case"click":this.onRowClick(t);break;case"touchstart":case"mousedown":this.onRowMouseDown(t)}}createRowEvent(e,t){return this.gos.addGridCommonParams({type:e,node:this.rowNode,data:this.rowNode.data,rowIndex:this.rowNode.rowIndex,rowPinned:this.rowNode.rowPinned,event:t})}createRowEventWithSource(e,t){const i=this.createRowEvent(e,t);return i.source=this,i}onRowDblClick(e){Oe(e)||this.beans.eventService.dispatchEvent(this.createRowEventWithSource("rowDoubleClicked",e))}getColumnForFullWidth(e){const{visibleColsService:t}=this.beans;switch(null===e||void 0===e?void 0:e.containerType){case"center":return t.getCenterCols()[0];case"left":return t.getLeftCols()[0];case"right":return t.getRightCols()[0];default:return t.getAllCols()[0]}}onRowMouseDown(e){if(this.lastMouseDownOnDragger=Bi(e.target,"ag-row-drag",3),!this.isFullWidth())return;const t=this.rowNode;this.beans.rangeService&&this.beans.rangeService.removeAllCellRanges();const i=this.findFullWidthRowGui(e.target),r=null===i||void 0===i?void 0:i.element,n=e.target;let o=!0;r&&r.contains(n)&&Li(n)&&(o=!1),this.beans.focusService.setFocusedCell({rowIndex:t.rowIndex,column:this.getColumnForFullWidth(i),rowPinned:t.rowPinned,forceBrowserFocus:o})}onRowClick(e){if(Oe(e)||this.lastMouseDownOnDragger)return;const{gos:t}=this;this.beans.eventService.dispatchEvent(this.createRowEventWithSource("rowClicked",e));const i=e.ctrlKey||e.metaKey,r=e.shiftKey,n=this.rowNode.isSelected(),o=be(t),s=fe(t),a=function(e){const t=pe(e);return!0===t||"enableSelection"===t}(t);if(o&&this.rowNode.group||this.isRowSelectionBlocked()||!a&&!n||!s&&n)return;const l=function(e){var t;const i=e.get("rowSelection");return"string"===typeof i?e.get("rowMultiSelectWithClick"):null!==(t=null===i||void 0===i?void 0:i.enableSelectionWithoutKeys)&&void 0!==t&&t}(t),c="rowClicked";if(n)l?this.rowNode.setSelectedParams({newValue:!1,event:e,source:c}):i?s&&this.rowNode.setSelectedParams({newValue:!1,event:e,source:c}):a&&this.rowNode.setSelectedParams({newValue:!0,clearSelection:!r,rangeSelect:r,event:e,source:c});else{const t=!l&&!i;this.rowNode.setSelectedParams({newValue:!0,clearSelection:t,rangeSelect:r,event:e,source:c})}}isRowSelectionBlocked(){return!this.rowNode.selectable||!!this.rowNode.rowPinned||!V(this.gos)}setupDetailRowAutoHeight(e){if("FullWidthDetail"!==this.rowType)return;if(!this.gos.get("detailRowAutoHeight"))return;const t=()=>{const t=e.clientHeight;if(null!=t&&t>0){const e=()=>{this.rowNode.setRowHeight(t),(G(this.gos)||H(this.gos))&&this.beans.rowModel.onRowHeightChanged()};window.setTimeout(e,0)}},i=this.beans.resizeObserverService.observeResize(e,t);this.addDestroyFunc(i),t()}createFullWidthCompDetails(e,t){const{gos:i,rowNode:r}=this,n=i.addGridCommonParams({fullWidth:!0,data:r.data,node:r,value:r.key,valueFormatted:r.key,eGridCell:e,eParentOfValue:e,pinned:t,addRenderedRowListener:this.addEventListener.bind(this),registerRowDragger:(e,t,i,r)=>this.addFullWidthRowDragging(e,t,i,r),setTooltip:(e,t)=>this.refreshRowTooltip(e,t)}),o=this.beans.userComponentFactory;switch(this.rowType){case"FullWidthDetail":return o.getFullWidthDetailCellRendererDetails(n);case"FullWidthGroup":return o.getFullWidthGroupCellRendererDetails(n);case"FullWidthLoading":return o.getFullWidthLoadingCellRendererDetails(n);default:return o.getFullWidthCellRendererDetails(n)}}refreshRowTooltip(e,t){if(!this.fullWidthGui)return;const i={getGui:()=>this.fullWidthGui.element,getTooltipValue:()=>e,getLocation:()=>"fullWidthRow",shouldDisplayTooltip:t};this.tooltipFeature&&this.destroyBean(this.tooltipFeature,this.beans.context),this.tooltipFeature=this.createBean(new lr(i,this.beans))}addFullWidthRowDragging(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments.length>3?arguments[3]:void 0;if(!this.isFullWidth())return;const n=new Rn((()=>i),this.rowNode,void 0,e,t,r);this.createBean(n,this.beans.context),this.addDestroyFunc((()=>{this.destroyBean(n,this.beans.context)}))}onUiLevelChanged(){const e=this.beans.rowCssClassCalculator.calculateRowLevel(this.rowNode);if(this.rowLevel!=e){const t="ag-row-level-"+e,i="ag-row-level-"+this.rowLevel;this.allRowGuis.forEach((e=>{e.rowComp.addOrRemoveCssClass(t,!0),e.rowComp.addOrRemoveCssClass(i,!1)}))}this.rowLevel=e}isFirstRowOnPage(){return this.rowNode.rowIndex===this.beans.pageBoundsService.getFirstRow()}isLastRowOnPage(){return this.rowNode.rowIndex===this.beans.pageBoundsService.getLastRow()}refreshFirstAndLastRowStyles(){const e=this.isFirstRowOnPage(),t=this.isLastRowOnPage();this.firstRowOnPage!==e&&(this.firstRowOnPage=e,this.allRowGuis.forEach((t=>t.rowComp.addOrRemoveCssClass("ag-row-first",e)))),this.lastRowOnPage!==t&&(this.lastRowOnPage=t,this.allRowGuis.forEach((e=>e.rowComp.addOrRemoveCssClass("ag-row-last",t))))}stopEditing(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.stoppingRowEdit||null===(e=this.beans.rowEditService)||void 0===e||e.stopEditing(this,t)}setInlineEditingCss(){const e=this.editingRow||this.getAllCellCtrls().some((e=>e.isEditing()));this.allRowGuis.forEach((t=>{t.rowComp.addOrRemoveCssClass("ag-row-inline-editing",e),t.rowComp.addOrRemoveCssClass("ag-row-not-inline-editing",!e)}))}setEditingRow(e){this.editingRow=e}startRowEditing(){var e,t;let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return!!this.editingRow||(null===(e=null===(t=this.beans.rowEditService)||void 0===t?void 0:t.startEditing(this,i,r,n))||void 0===e||e)}getAllCellCtrls(){if(0===this.leftCellCtrls.list.length&&0===this.rightCellCtrls.list.length)return this.centerCellCtrls.list;return[...this.centerCellCtrls.list,...this.leftCellCtrls.list,...this.rightCellCtrls.list]}postProcessClassesFromGridOptions(){const e=this.beans.rowCssClassCalculator.processClassesFromGridOptions(this.rowNode);e&&e.length&&e.forEach((e=>{this.allRowGuis.forEach((t=>t.rowComp.addOrRemoveCssClass(e,!0)))}))}postProcessRowClassRules(){this.beans.rowCssClassCalculator.processRowClassRules(this.rowNode,(e=>{this.allRowGuis.forEach((t=>t.rowComp.addOrRemoveCssClass(e,!0)))}),(e=>{this.allRowGuis.forEach((t=>t.rowComp.addOrRemoveCssClass(e,!1)))}))}setStylesFromGridOptions(e,t){e&&(this.rowStyles=this.processStylesFromGridOptions()),this.forEachGui(t,(e=>e.rowComp.setUserStyles(this.rowStyles)))}getPinnedForContainer(e){return"left"===e||"right"===e?e:null}getInitialRowClasses(e){const t=this.getPinnedForContainer(e),i={rowNode:this.rowNode,rowFocused:this.rowFocused,fadeRowIn:this.fadeInAnimation[e],rowIsEven:this.rowNode.rowIndex%2===0,rowLevel:this.rowLevel,fullWidthRow:this.isFullWidth(),firstRowOnPage:this.isFirstRowOnPage(),lastRowOnPage:this.isLastRowOnPage(),printLayout:this.printLayout,expandable:this.rowNode.isExpandable(),pinned:t};return this.beans.rowCssClassCalculator.getInitialRowClasses(i)}processStylesFromGridOptions(){const e=this.gos.get("rowStyle");if(e&&"function"===typeof e)return void v("rowStyle should be an object of key/value styles, not be a function, use getRowStyle() instead");const t=this.gos.getCallback("getRowStyle");let i;if(t){i=t({data:this.rowNode.data,node:this.rowNode,rowIndex:this.rowNode.rowIndex})}return i||e?Object.assign({},e,i):this.emptyStyle}onRowSelected(e){const t=!!this.rowNode.isSelected();this.forEachGui(e,(e=>{e.rowComp.addOrRemoveCssClass("ag-row-selected",t),Si(e.element,t);!e.element.contains(Z(this.gos))||e!==this.centerGui&&e!==this.fullWidthGui||this.announceDescription()}))}announceDescription(){if(this.isRowSelectionBlocked())return;const e=this.rowNode.isSelected();if(e&&!fe(this.gos))return;const t=this.beans.localeService.getLocaleTextFunc()(e?"ariaRowDeselect":"ariaRowSelect","Press SPACE to ".concat(e?"deselect":"select"," this row."));this.beans.ariaAnnouncementService.announceValue(t,"rowSelection")}addHoverFunctionality(e){if(!this.active)return;const{element:t,compBean:i}=e,{rowNode:r,beans:n,gos:o}=this;i.addManagedListeners(t,{mouseenter:()=>r.onMouseEnter(),mouseleave:()=>r.onMouseLeave()}),i.addManagedListeners(r,{mouseEnter:()=>{n.dragService.isDragging()||o.get("suppressRowHoverHighlight")||(t.classList.add("ag-row-hover"),r.setHovered(!0))},mouseLeave:()=>{t.classList.remove("ag-row-hover"),r.setHovered(!1)}})}roundRowTopToBounds(e){const t=this.beans.ctrlsService.getGridBodyCtrl().getScrollFeature().getApproximateVScollPosition(),i=this.applyPaginationOffset(t.top,!0)-100,r=this.applyPaginationOffset(t.bottom,!0)+100;return Math.min(Math.max(i,e),r)}getFrameworkOverrides(){return this.beans.frameworkOverrides}forEachGui(e,t){e?t(e):this.allRowGuis.forEach(t)}onRowHeightChanged(e){if(null==this.rowNode.rowHeight)return;const t=this.rowNode.rowHeight,i=this.beans.environment.getDefaultRowHeight(),r=W(this.gos)?U(this.gos,this.rowNode).height:void 0,n=r?"".concat(Math.min(i,r)-2,"px"):void 0;this.forEachGui(e,(e=>{e.element.style.height="".concat(t,"px"),n&&e.element.style.setProperty("--ag-line-height",n)}))}addEventListener(e,t){super.addEventListener(e,t)}removeEventListener(e,t){super.removeEventListener(e,t)}destroyFirstPass(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.active=!1,!e&&te(this.gos)&&!this.isSticky()){if(null!=this.rowNode.rowTop){const e=this.roundRowTopToBounds(this.rowNode.rowTop);this.setRowTop(e)}else this.allRowGuis.forEach((e=>e.rowComp.addOrRemoveCssClass("ag-opacity-zero",!0)))}this.rowNode.setHovered(!1);const t=this.createRowEvent("virtualRowRemoved");this.dispatchLocalEvent(t),this.beans.eventService.dispatchEvent(t),super.destroy()}destroySecondPass(){this.allRowGuis.length=0,this.stopEditing();const e=e=>(e.list.forEach((e=>e.destroy())),{list:[],map:{}});this.centerCellCtrls=e(this.centerCellCtrls),this.leftCellCtrls=e(this.leftCellCtrls),this.rightCellCtrls=e(this.rightCellCtrls)}setFocusedClasses(e){this.forEachGui(e,(e=>{e.rowComp.addOrRemoveCssClass("ag-row-focus",this.rowFocused),e.rowComp.addOrRemoveCssClass("ag-row-no-focus",!this.rowFocused)}))}onCellFocusChanged(){const e=this.beans.focusService.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned);e!==this.rowFocused&&(this.rowFocused=e,this.setFocusedClasses()),!e&&this.editingRow&&this.stopEditing(!1)}onPaginationChanged(){var e,t;const i=null!==(e=null===(t=this.beans.paginationService)||void 0===t?void 0:t.getCurrentPage())&&void 0!==e?e:0;this.paginationPage!==i&&(this.paginationPage=i,this.onTopChanged()),this.refreshFirstAndLastRowStyles()}onTopChanged(){this.setRowTop(this.rowNode.rowTop)}onPaginationPixelOffsetChanged(){this.onTopChanged()}applyPaginationOffset(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.rowNode.isRowPinned()||this.rowNode.sticky)return e;return e+this.beans.pageBoundsService.getPixelOffset()*(t?1:-1)}setRowTop(e){if(!this.printLayout&&F(e)){const t=this.applyPaginationOffset(e),i=this.rowNode.isRowPinned()||this.rowNode.sticky?t:this.beans.rowContainerHeightService.getRealPixelPosition(t),r="".concat(i,"px");this.setRowTopStyle(r)}}getInitialRowTop(e){return this.suppressRowTransform?this.getInitialRowTopShared(e):void 0}getInitialTransform(e){return this.suppressRowTransform?void 0:"translateY(".concat(this.getInitialRowTopShared(e),")")}getInitialRowTopShared(e){if(this.printLayout)return"";const t=this.rowNode;let i;if(this.isSticky())i=t.stickyRowTop;else{const r=this.slideInAnimation[e]?this.roundRowTopToBounds(t.oldRowTop):t.rowTop,n=this.applyPaginationOffset(r);i=t.isRowPinned()?n:this.beans.rowContainerHeightService.getRealPixelPosition(n)}return i+"px"}setRowTopStyle(e){this.allRowGuis.forEach((t=>this.suppressRowTransform?t.rowComp.setTop(e):t.rowComp.setTransform("translateY(".concat(e,")"))))}getRowNode(){return this.rowNode}getCellCtrl(e){let t=null;return this.getAllCellCtrls().forEach((i=>{i.getColumn()==e&&(t=i)})),null!=t||this.getAllCellCtrls().forEach((i=>{i.getColSpanningList().indexOf(e)>=0&&(t=i)})),t}onRowIndexChanged(){null!=this.rowNode.rowIndex&&(this.onCellFocusChanged(),this.updateRowIndexes(),this.postProcessCss())}getRowIndex(){return this.rowNode.getRowIndexString()}updateRowIndexes(e){var t,i;const r=this.rowNode.getRowIndexString();if(null===r)return;const n=this.beans.headerNavigationService.getHeaderRowCount()+(null!==(t=null===(i=this.beans.filterManager)||void 0===i?void 0:i.getHeaderRowCount())&&void 0!==t?t:0),o=this.rowNode.rowIndex%2===0,s=n+this.rowNode.rowIndex+1;this.forEachGui(e,(e=>{e.rowComp.setRowIndex(r),e.rowComp.addOrRemoveCssClass("ag-row-even",o),e.rowComp.addOrRemoveCssClass("ag-row-odd",!o),mi(e.element,s)}))}setStoppingRowEdit(e){this.stoppingRowEdit=e}};Ls.DOM_DATA_KEY_ROW_CTRL="renderedRow";var Os=Ls,Ns=class extends He{wireBeans(e){this.mouseEventService=e.mouseEventService,this.valueService=e.valueService,this.menuService=e.menuService,this.ctrlsService=e.ctrlsService,this.navigationService=e.navigationService,this.focusService=e.focusService,this.undoRedoService=e.undoRedoService,this.visibleColsService=e.visibleColsService,this.rowModel=e.rowModel,this.pinnedRowModel=e.pinnedRowModel,this.rangeService=e.rangeService,this.clipboardService=e.clipboardService}constructor(e){super(),this.element=e}postConstruct(){this.addKeyboardListeners(),this.addMouseListeners(),this.mockContextMenuForIPad()}addKeyboardListeners(){const e="keydown",t=this.processKeyboardEvent.bind(this,e);this.addManagedElementListeners(this.element,{[e]:t})}addMouseListeners(){["dblclick","contextmenu","mouseover","mouseout","click",Ne("touchstart")?"touchstart":"mousedown"].forEach((e=>{const t=this.processMouseEvent.bind(this,e);this.addManagedElementListeners(this.element,{[e]:t})}))}processMouseEvent(e,t){if(!this.mouseEventService.isEventFromThisGrid(t)||Oe(t))return;const i=this.getRowForEvent(t),r=this.mouseEventService.getRenderedCellForEvent(t);"contextmenu"===e?this.handleContextMenuMouseEvent(t,void 0,i,r):(r&&r.onMouseEvent(e,t),i&&i.onMouseEvent(e,t))}mockContextMenuForIPad(){if(!Pi())return;const e=new vr(this.element);this.addManagedListeners(e,{longTap:e=>{const t=this.getRowForEvent(e.touchEvent),i=this.mouseEventService.getRenderedCellForEvent(e.touchEvent);this.handleContextMenuMouseEvent(void 0,e.touchEvent,t,i)}}),this.addDestroyFunc((()=>e.destroy()))}getRowForEvent(e){let t=e.target;for(;t;){const e=Y(this.gos,t,Os.DOM_DATA_KEY_ROW_CTRL);if(e)return e;t=t.parentElement}return null}handleContextMenuMouseEvent(e,t,i,r){const n=i?i.getRowNode():null,o=r?r.getColumn():null;let s=null;if(o){const i=e||t;r.dispatchCellContextMenuEvent(null!==i&&void 0!==i?i:null),s=this.valueService.getValue(o,n)}const a=this.ctrlsService.getGridBodyCtrl(),l=r?r.getGui():a.getGridBodyElement();this.menuService.showContextMenu({mouseEvent:e,touchEvent:t,rowNode:n,column:o,value:s,anchorToElement:l})}getControlsForEventTarget(e){return{cellCtrl:Be(this.gos,e,Ms.DOM_DATA_KEY_CELL_CTRL),rowCtrl:Be(this.gos,e,Os.DOM_DATA_KEY_ROW_CTRL)}}processKeyboardEvent(e,t){const{cellCtrl:i,rowCtrl:r}=this.getControlsForEventTarget(t.target);t.defaultPrevented||(i?this.processCellKeyboardEvent(i,e,t):r&&r.isFullWidth()&&this.processFullWidthRowKeyboardEvent(r,e,t))}processCellKeyboardEvent(e,t,i){const r=e.getRowNode(),n=e.getColumn(),o=e.isEditing();if(!$n(this.gos,i,r,n,o)&&"keydown"===t){!o&&this.navigationService.handlePageScrollingKey(i)||e.onKeyDown(i),this.doGridOperations(i,e.isEditing()),Qn(i)&&e.processCharacter(i)}"keydown"===t&&this.eventService.dispatchEvent(e.createEvent(i,"cellKeyDown"))}processFullWidthRowKeyboardEvent(e,t,i){const r=e.getRowNode(),n=this.focusService.getFocusedCell(),o=n&&n.column;if(!$n(this.gos,i,r,o,!1)){const r=i.key;if("keydown"===t)switch(r){case Tr.PAGE_HOME:case Tr.PAGE_END:case Tr.PAGE_UP:case Tr.PAGE_DOWN:this.navigationService.handlePageScrollingKey(i,!0);break;case Tr.UP:case Tr.DOWN:e.onKeyboardNavigate(i);break;case Tr.TAB:e.onTabKeyDown(i)}}"keydown"===t&&this.eventService.dispatchEvent(e.createRowEvent("cellKeyDown",i))}doGridOperations(e,t){if(!e.ctrlKey&&!e.metaKey)return;if(t)return;if(!this.mouseEventService.isEventFromThisGrid(e))return;const i=function(e){const{keyCode:t}=e;let i;switch(t){case 65:i=Tr.A;break;case 67:i=Tr.C;break;case 86:i=Tr.V;break;case 68:i=Tr.D;break;case 90:i=Tr.Z;break;case 89:i=Tr.Y;break;default:i=e.code}return i}(e);return i===Tr.A?this.onCtrlAndA(e):i===Tr.C?this.onCtrlAndC(e):i===Tr.D?this.onCtrlAndD(e):i===Tr.V?this.onCtrlAndV(e):i===Tr.X?this.onCtrlAndX(e):i===Tr.Y?this.onCtrlAndY():i===Tr.Z?this.onCtrlAndZ(e):void 0}onCtrlAndA(e){const{pinnedRowModel:t,rowModel:i,rangeService:r}=this;if(r&&i.isRowsToRender()){const[e,n]=[t.isEmpty("top"),t.isEmpty("bottom")],o=e?null:"top";let s,a;n?(s=null,a=i.getRowCount()-1):(s="bottom",a=t.getPinnedBottomRowCount()-1);const l=this.visibleColsService.getAllCols();if(D(l))return;r.setCellRange({rowStartIndex:0,rowStartPinned:o,rowEndIndex:a,rowEndPinned:s,columnStart:l[0],columnEnd:ye(l)})}e.preventDefault()}onCtrlAndC(e){if(!this.clipboardService||this.gos.get("enableCellTextSelection"))return;const{cellCtrl:t,rowCtrl:i}=this.getControlsForEventTarget(e.target);null!==t&&void 0!==t&&t.isEditing()||null!==i&&void 0!==i&&i.isEditing()||(e.preventDefault(),this.clipboardService.copyToClipboard())}onCtrlAndX(e){if(!this.clipboardService||this.gos.get("enableCellTextSelection")||this.gos.get("suppressCutToClipboard"))return;const{cellCtrl:t,rowCtrl:i}=this.getControlsForEventTarget(e.target);null!==t&&void 0!==t&&t.isEditing()||null!==i&&void 0!==i&&i.isEditing()||(e.preventDefault(),this.clipboardService.cutToClipboard(void 0,"ui"))}onCtrlAndV(e){const{cellCtrl:t,rowCtrl:i}=this.getControlsForEventTarget(e.target);null!==t&&void 0!==t&&t.isEditing()||null!==i&&void 0!==i&&i.isEditing()||this.clipboardService&&!this.gos.get("suppressClipboardPaste")&&this.clipboardService.pasteFromClipboard()}onCtrlAndD(e){this.clipboardService&&!this.gos.get("suppressClipboardPaste")&&this.clipboardService.copyRangeDown(),e.preventDefault()}onCtrlAndZ(e){this.gos.get("undoRedoCellEditing")&&this.undoRedoService&&(e.preventDefault(),e.shiftKey?this.undoRedoService.redo("ui"):this.undoRedoService.undo("ui"))}onCtrlAndY(){var e;null===(e=this.undoRedoService)||void 0===e||e.redo("ui")}},Bs=class extends He{wireBeans(e){this.pinnedWidthService=e.pinnedWidthService}constructor(e){super(),this.element=e}postConstruct(){this.addManagedEventListeners({leftPinnedWidthChanged:this.onPinnedLeftWidthChanged.bind(this)})}onPinnedLeftWidthChanged(){const e=this.pinnedWidthService.getPinnedLeftWidth(),t=e>0;Oi(this.element,t),Zi(this.element,e)}getWidth(){return this.pinnedWidthService.getPinnedLeftWidth()}},Gs=class extends He{wireBeans(e){this.pinnedWidthService=e.pinnedWidthService}constructor(e){super(),this.element=e}postConstruct(){this.addManagedEventListeners({rightPinnedWidthChanged:this.onPinnedRightWidthChanged.bind(this)})}onPinnedRightWidthChanged(){const e=this.pinnedWidthService.getPinnedRightWidth(),t=e>0;Oi(this.element,t),Zi(this.element,e)}getWidth(){return this.pinnedWidthService.getPinnedRightWidth()}},Hs=e=>e.getTopRowCtrls(),zs=e=>e.getStickyTopRowCtrls(),Vs=e=>e.getStickyBottomRowCtrls(),_s=e=>e.getBottomRowCtrls(),Ws=e=>e.getCentreRowCtrls(),Us={center:{type:"center",container:"ag-center-cols-container",viewport:"ag-center-cols-viewport",getRowCtrls:Ws},left:{type:"left",container:"ag-pinned-left-cols-container",pinnedType:"left",getRowCtrls:Ws},right:{type:"right",container:"ag-pinned-right-cols-container",pinnedType:"right",getRowCtrls:Ws},fullWidth:{type:"fullWidth",container:"ag-full-width-container",fullWidth:!0,getRowCtrls:Ws},topCenter:{type:"center",container:"ag-floating-top-container",viewport:"ag-floating-top-viewport",getRowCtrls:Hs},topLeft:{type:"left",container:"ag-pinned-left-floating-top",pinnedType:"left",getRowCtrls:Hs},topRight:{type:"right",container:"ag-pinned-right-floating-top",pinnedType:"right",getRowCtrls:Hs},topFullWidth:{type:"fullWidth",container:"ag-floating-top-full-width-container",fullWidth:!0,getRowCtrls:Hs},stickyTopCenter:{type:"center",container:"ag-sticky-top-container",viewport:"ag-sticky-top-viewport",getRowCtrls:zs},stickyTopLeft:{type:"left",container:"ag-pinned-left-sticky-top",pinnedType:"left",getRowCtrls:zs},stickyTopRight:{type:"right",container:"ag-pinned-right-sticky-top",pinnedType:"right",getRowCtrls:zs},stickyTopFullWidth:{type:"fullWidth",container:"ag-sticky-top-full-width-container",fullWidth:!0,getRowCtrls:zs},stickyBottomCenter:{type:"center",container:"ag-sticky-bottom-container",viewport:"ag-sticky-bottom-viewport",getRowCtrls:Vs},stickyBottomLeft:{type:"left",container:"ag-pinned-left-sticky-bottom",pinnedType:"left",getRowCtrls:Vs},stickyBottomRight:{type:"right",container:"ag-pinned-right-sticky-bottom",pinnedType:"right",getRowCtrls:Vs},stickyBottomFullWidth:{type:"fullWidth",container:"ag-sticky-bottom-full-width-container",fullWidth:!0,getRowCtrls:Vs},bottomCenter:{type:"center",container:"ag-floating-bottom-container",viewport:"ag-floating-bottom-viewport",getRowCtrls:_s},bottomLeft:{type:"left",container:"ag-pinned-left-floating-bottom",pinnedType:"left",getRowCtrls:_s},bottomRight:{type:"right",container:"ag-pinned-right-floating-bottom",pinnedType:"right",getRowCtrls:_s},bottomFullWidth:{type:"fullWidth",container:"ag-floating-bottom-full-width-container",fullWidth:!0,getRowCtrls:_s}};function js(e){return Us[e]}var Ks=["center","left","right","fullWidth"],Ys=["stickyTopCenter","stickyBottomCenter","center","topCenter","bottomCenter"],qs=["left","bottomLeft","topLeft","stickyTopLeft","stickyBottomLeft"],Qs=["right","bottomRight","topRight","stickyTopRight","stickyBottomRight"],$s=["stickyTopCenter","stickyTopLeft","stickyTopRight"],Xs=["stickyBottomCenter","stickyBottomLeft","stickyBottomRight"],Js=[...$s,"stickyTopFullWidth",...Xs,"stickyBottomFullWidth"],Zs=["topCenter","topLeft","topRight","bottomCenter","bottomLeft","bottomRight","center","left","right",...$s,...Xs],ea=class extends He{constructor(e){super(),this.visible=!0,this.EMPTY_CTRLS=[],this.name=e,this.options=js(e)}wireBeans(e){this.dragService=e.dragService,this.ctrlsService=e.ctrlsService,this.columnViewportService=e.columnViewportService,this.resizeObserverService=e.resizeObserverService,this.rowRenderer=e.rowRenderer}postConstruct(){this.enableRtl=this.gos.get("enableRtl"),this.forContainers(["center"],(()=>{this.viewportSizeFeature=this.createManagedBean(new bs(this)),this.addManagedEventListeners({stickyTopOffsetChanged:this.onStickyTopOffsetChanged.bind(this)})}))}onStickyTopOffsetChanged(e){this.comp.setOffsetTop("".concat(e.offset,"px"))}registerWithCtrlsService(){this.options.fullWidth||this.ctrlsService.register(this.name,this)}forContainers(e,t){e.indexOf(this.name)>=0&&t()}getContainerElement(){return this.eContainer}getViewportSizeFeature(){return this.viewportSizeFeature}setComp(e,t,i){this.comp=e,this.eContainer=t,this.eViewport=i,this.createManagedBean(new Ns(this.eContainer)),this.addPreventScrollWhileDragging(),this.listenOnDomOrder();const r=()=>this.onPinnedWidthChanged();this.forContainers(qs,(()=>{this.pinnedWidthFeature=this.createManagedBean(new Bs(this.eContainer)),this.addManagedEventListeners({leftPinnedWidthChanged:r})})),this.forContainers(Qs,(()=>{this.pinnedWidthFeature=this.createManagedBean(new Gs(this.eContainer)),this.addManagedEventListeners({rightPinnedWidthChanged:r})})),this.forContainers(Ks,(()=>this.createManagedBean(new ms(this.eContainer,"center"===this.name?i:void 0)))),this.forContainers(Zs,(()=>this.createManagedBean(new Ss(this.eContainer)))),this.forContainers(Ys,(()=>this.createManagedBean(new qo((e=>this.comp.setContainerWidth("".concat(e,"px"))))))),this.visible=this.isContainerVisible(),this.addListeners(),this.registerWithCtrlsService()}onScrollCallback(e){this.addManagedElementListeners(this.getViewportElement(),{scroll:e})}addListeners(){this.addManagedEventListeners({displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),displayedColumnsWidthChanged:this.onDisplayedColumnsWidthChanged.bind(this),displayedRowsChanged:e=>this.onDisplayedRowsChanged(e.afterScroll)}),this.onDisplayedColumnsChanged(),this.onDisplayedColumnsWidthChanged(),this.onDisplayedRowsChanged()}listenOnDomOrder(){if(Js.indexOf(this.name)>=0)return void this.comp.setDomOrder(!0);const e=()=>{const e=this.gos.get("ensureDomOrder"),t=z(this.gos,"print");this.comp.setDomOrder(e||t)};this.addManagedPropertyListener("domLayout",e),e()}onDisplayedColumnsChanged(){this.forContainers(["center"],(()=>this.onHorizontalViewportChanged()))}onDisplayedColumnsWidthChanged(){this.forContainers(["center"],(()=>this.onHorizontalViewportChanged()))}addPreventScrollWhileDragging(){const e=e=>{this.dragService.isDragging()&&e.cancelable&&e.preventDefault()};this.eContainer.addEventListener("touchmove",e,{passive:!1}),this.addDestroyFunc((()=>this.eContainer.removeEventListener("touchmove",e)))}onHorizontalViewportChanged(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.getCenterWidth(),i=this.getCenterViewportScrollLeft();this.columnViewportService.setScrollPosition(t,i,e)}hasHorizontalScrollGap(){return this.eContainer.clientWidth-this.eViewport.clientWidth<0}hasVerticalScrollGap(){return this.eContainer.clientHeight-this.eViewport.clientHeight<0}getCenterWidth(){return zi(this.eViewport)}getCenterViewportScrollLeft(){return ji(this.eViewport,this.enableRtl)}registerViewportResizeListener(e){const t=this.resizeObserverService.observeResize(this.eViewport,e);this.addDestroyFunc((()=>t()))}isViewportInTheDOMTree(){return Qi(this.eViewport)}getViewportScrollLeft(){return ji(this.eViewport,this.enableRtl)}isHorizontalScrollShowing(){return this.gos.get("alwaysShowHorizontalScroll")||(e=this.eViewport).clientWidth<e.scrollWidth;var e}getViewportElement(){return this.eViewport}setHorizontalScroll(e){this.comp.setHorizontalScroll(e)}getHScrollPosition(){return{left:this.eViewport.scrollLeft,right:this.eViewport.scrollLeft+this.eViewport.offsetWidth}}setCenterViewportScrollLeft(e){Ki(this.eViewport,e,this.enableRtl)}isContainerVisible(){return!(null!=this.options.pinnedType)||!!this.pinnedWidthFeature&&this.pinnedWidthFeature.getWidth()>0}onPinnedWidthChanged(){const e=this.isContainerVisible();this.visible!=e&&(this.visible=e,this.onDisplayedRowsChanged())}onDisplayedRowsChanged(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.options.getRowCtrls(this.rowRenderer);if(!this.visible||0===t.length)return void this.comp.setRowCtrls({rowCtrls:this.EMPTY_CTRLS});const i=z(this.gos,"print"),r=this.gos.get("embedFullWidthRows")||i,n=t.filter((e=>{const t=e.isFullWidth();return this.options.fullWidth?!r&&t:r||!t}));this.comp.setRowCtrls({rowCtrls:n,useFlushSync:e})}},ta="ag-force-vertical-scroll",ia=class extends He{constructor(){super(...arguments),this.stickyTopHeight=0,this.stickyBottomHeight=0}wireBeans(e){this.animationFrameService=e.animationFrameService,this.rowContainerHeightService=e.rowContainerHeightService,this.ctrlsService=e.ctrlsService,this.columnModel=e.columnModel,this.columnSizeService=e.columnSizeService,this.scrollVisibleService=e.scrollVisibleService,this.menuService=e.menuService,this.headerNavigationService=e.headerNavigationService,this.dragAndDropService=e.dragAndDropService,this.pinnedRowModel=e.pinnedRowModel,this.rowRenderer=e.rowRenderer,this.popupService=e.popupService,this.mouseEventService=e.mouseEventService,this.rowModel=e.rowModel,this.filterManager=e.filterManager,this.environment=e.environment}getScrollFeature(){return this.bodyScrollFeature}getBodyViewportElement(){return this.eBodyViewport}setComp(e,t,i,r,n,o,s){var a;this.comp=e,this.eGridBody=t,this.eBodyViewport=i,this.eTop=r,this.eBottom=n,this.eStickyTop=o,this.eStickyBottom=s,this.eCenterColsViewport=i.querySelector(".".concat(js("center").viewport)),this.eFullWidthContainer=i.querySelector(".".concat(js("fullWidth").container)),this.eStickyTopFullWidthContainer=o.querySelector(".".concat(js("stickyTopFullWidth").container)),this.eStickyBottomFullWidthContainer=s.querySelector(".".concat(js("stickyBottomFullWidth").container)),this.setCellTextSelection(this.gos.get("enableCellTextSelection")),this.addManagedPropertyListener("enableCellTextSelection",(e=>this.setCellTextSelection(e.currentValue))),this.createManagedBean(new hs(this.comp)),this.bodyScrollFeature=this.createManagedBean(new ws(this.eBodyViewport)),this.addRowDragListener(),this.setupRowAnimationCssClass(),this.addEventListeners(),this.addFocusListeners([r,i,n,o,s]),this.onGridColumnsChanged(),this.addBodyViewportListener(),this.setFloatingHeights(),this.disableBrowserDragging(),this.addStopEditingWhenGridLosesFocus(),this.updateScrollingClasses(),null===(a=this.filterManager)||void 0===a||a.setupAdvancedFilterHeaderComp(r),this.ctrlsService.register("gridBodyCtrl",this)}getComp(){return this.comp}addEventListeners(){const e=this.setFloatingHeights.bind(this);this.addManagedEventListeners({gridColumnsChanged:this.onGridColumnsChanged.bind(this),scrollVisibilityChanged:this.onScrollVisibilityChanged.bind(this),scrollGapChanged:this.onScrollGapChanged.bind(this),pinnedRowDataChanged:e,pinnedHeightChanged:e,headerHeightChanged:this.onHeaderHeightChanged.bind(this)})}addFocusListeners(e){e.forEach((e=>{this.addManagedElementListeners(e,{focusin:t=>{const{target:i}=t,r=Bi(i,"ag-root",e);e.classList.toggle("ag-has-focus",!r)},focusout:t=>{const{target:i,relatedTarget:r}=t,n=e.contains(r),o=Bi(r,"ag-root",e);Bi(i,"ag-root",e)||n&&!o||e.classList.remove("ag-has-focus")}})}))}setColumnMovingCss(e){this.comp.setColumnMovingCss("ag-column-moving",e)}setCellTextSelection(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.comp.setCellSelectableCss("ag-selectable",e)}onScrollVisibilityChanged(){const e=this.scrollVisibleService.isVerticalScrollShowing();this.setVerticalScrollPaddingVisible(e),this.setStickyWidth(e),this.setStickyBottomOffsetBottom();const t=e&&this.scrollVisibleService.getScrollbarWidth()||0,i=Mi()?16:0,r="calc(100% + ".concat(t+i,"px)");this.animationFrameService.requestAnimationFrame((()=>this.comp.setBodyViewportWidth(r))),this.updateScrollingClasses()}onScrollGapChanged(){this.updateScrollingClasses()}updateScrollingClasses(){this.eGridBody.classList.toggle("ag-body-vertical-content-no-gap",!this.scrollVisibleService.hasVerticalScrollGap()),this.eGridBody.classList.toggle("ag-body-horizontal-content-no-gap",!this.scrollVisibleService.hasHorizontalScrollGap())}onGridColumnsChanged(){const e=this.columnModel.getCols();this.comp.setColumnCount(e.length)}disableBrowserDragging(){this.addManagedElementListeners(this.eGridBody,{dragstart:e=>{if(e.target instanceof HTMLImageElement)return e.preventDefault(),!1}})}addStopEditingWhenGridLosesFocus(){if(!this.gos.get("stopEditingWhenCellsLoseFocus"))return;const e=e=>{const i=e.relatedTarget;if(null===ki(i))return void this.rowRenderer.stopEditing();let r=t.some((e=>e.contains(i)))&&this.mouseEventService.isElementInThisGrid(i);if(!r){const e=this.popupService;r=e.getActivePopups().some((e=>e.contains(i)))||e.isElementWithinCustomPopup(i)}r||this.rowRenderer.stopEditing()},t=[this.eBodyViewport,this.eBottom,this.eTop,this.eStickyTop,this.eStickyBottom];t.forEach((t=>this.addManagedElementListeners(t,{focusout:e})))}updateRowCount(){var e,t;const i=this.headerNavigationService.getHeaderRowCount()+(null!==(e=null===(t=this.filterManager)||void 0===t?void 0:t.getHeaderRowCount())&&void 0!==e?e:0),r=this.rowModel.isLastRowIndexKnown()?this.rowModel.getRowCount():-1,n=-1===r?-1:i+r;this.comp.setRowCount(n)}registerBodyViewportResizeListener(e){this.comp.registerBodyViewportResizeListener(e)}setVerticalScrollPaddingVisible(e){const t=e?"scroll":"hidden";this.comp.setPinnedTopBottomOverflowY(t)}isVerticalScrollShowing(){const e=this.gos.get("alwaysShowVerticalScroll"),t=e?ta:null,i=z(this.gos,"normal");return this.comp.setAlwaysVerticalScrollClass(t,e),e||i&&(r=this.eBodyViewport).clientHeight<r.scrollHeight;var r}setupRowAnimationCssClass(){let e=this.environment.hasMeasuredSizes();const t=()=>{const t=e&&te(this.gos)&&!this.rowContainerHeightService.isStretching(),i=t?"ag-row-animation":"ag-row-no-animation";this.comp.setRowAnimationCssOnBodyViewport(i,t)};t(),this.addManagedEventListeners({heightScaleChanged:t}),this.addManagedPropertyListener("animateRows",t),this.addManagedEventListeners({gridStylesChanged:()=>{!e&&this.environment.hasMeasuredSizes()&&(e=!0,t())}})}getGridBodyElement(){return this.eGridBody}addBodyViewportListener(){const e=this.onBodyViewportContextMenu.bind(this);this.addManagedElementListeners(this.eBodyViewport,{contextmenu:e}),this.mockContextMenuForIPad(e),this.addManagedElementListeners(this.eBodyViewport,{wheel:this.onBodyViewportWheel.bind(this)}),this.addManagedElementListeners(this.eStickyTop,{wheel:this.onStickyWheel.bind(this)}),this.addManagedElementListeners(this.eStickyBottom,{wheel:this.onStickyWheel.bind(this)}),this.addFullWidthContainerWheelListener()}addFullWidthContainerWheelListener(){this.addManagedElementListeners(this.eFullWidthContainer,{wheel:e=>this.onFullWidthContainerWheel(e)})}onFullWidthContainerWheel(e){const{deltaX:t,deltaY:i,shiftKey:r}=e;(r||Math.abs(t)>Math.abs(i))&&this.mouseEventService.isEventFromThisGrid(e)&&this.scrollGridBodyToMatchEvent(e)}onStickyWheel(e){const{deltaX:t,deltaY:i,shiftKey:r}=e,n=r||Math.abs(t)>Math.abs(i),o=e.target;n?(this.eStickyTopFullWidthContainer.contains(o)||this.eStickyBottomFullWidthContainer.contains(o))&&this.scrollGridBodyToMatchEvent(e):(e.preventDefault(),this.scrollVertically(i))}scrollGridBodyToMatchEvent(e){const{deltaX:t,deltaY:i}=e;e.preventDefault(),this.eCenterColsViewport.scrollBy({left:t||i})}onBodyViewportContextMenu(e,t,i){if(!e&&!i)return;if(this.gos.get("preventDefaultOnContextMenu")){(e||i).preventDefault()}const{target:r}=e||t;r!==this.eBodyViewport&&r!==this.ctrlsService.get("center").getViewportElement()||this.menuService.showContextMenu({mouseEvent:e,touchEvent:i,value:null,anchorToElement:this.eGridBody})}mockContextMenuForIPad(e){if(!Pi())return;const t=new vr(this.eBodyViewport);this.addManagedListeners(t,{longTap:t=>{e(void 0,t.touchStart,t.touchEvent)}}),this.addDestroyFunc((()=>t.destroy()))}onBodyViewportWheel(e){this.gos.get("suppressScrollWhenPopupsAreOpen")&&this.popupService.hasAnchoredPopup()&&e.preventDefault()}getGui(){return this.eGridBody}scrollVertically(e){const t=this.eBodyViewport.scrollTop;return this.bodyScrollFeature.setVerticalScrollPosition(t+e),this.eBodyViewport.scrollTop-t}addRowDragListener(){this.rowDragFeature=this.createManagedBean(new Sn(this.eBodyViewport)),this.dragAndDropService.addDropTarget(this.rowDragFeature),this.addDestroyFunc((()=>this.dragAndDropService.removeDropTarget(this.rowDragFeature)))}getRowDragFeature(){return this.rowDragFeature}setFloatingHeights(){const{pinnedRowModel:e}=this,t=e.getPinnedTopTotalHeight(),i=e.getPinnedBottomTotalHeight();this.comp.setTopHeight(t),this.comp.setBottomHeight(i),this.comp.setTopDisplay(t?"inherit":"none"),this.comp.setBottomDisplay(i?"inherit":"none"),this.setStickyTopOffsetTop(),this.setStickyBottomOffsetBottom()}setStickyTopHeight(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.comp.setStickyTopHeight("".concat(e,"px")),this.stickyTopHeight=e}getStickyTopHeight(){return this.stickyTopHeight}setStickyBottomHeight(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.comp.setStickyBottomHeight("".concat(e,"px")),this.stickyBottomHeight=e}getStickyBottomHeight(){return this.stickyBottomHeight}setStickyWidth(e){if(e){const e=this.scrollVisibleService.getScrollbarWidth();this.comp.setStickyTopWidth("calc(100% - ".concat(e,"px)")),this.comp.setStickyBottomWidth("calc(100% - ".concat(e,"px)"))}else this.comp.setStickyTopWidth("100%"),this.comp.setStickyBottomWidth("100%")}onHeaderHeightChanged(){this.setStickyTopOffsetTop()}setStickyTopOffsetTop(){var e,t;const i=this.ctrlsService.get("gridHeaderCtrl").getHeaderHeight()+(null!==(e=null===(t=this.filterManager)||void 0===t?void 0:t.getHeaderHeight())&&void 0!==e?e:0),r=this.pinnedRowModel.getPinnedTopTotalHeight();let n=0;i>0&&(n+=i),r>0&&(n+=r),n>0&&(n+=1),this.comp.setStickyTopTop("".concat(n,"px"))}setStickyBottomOffsetBottom(){const e=this.pinnedRowModel.getPinnedBottomTotalHeight()+(this.scrollVisibleService.isHorizontalScrollShowing()&&this.scrollVisibleService.getScrollbarWidth()||0);this.comp.setStickyBottomBottom("".concat(e,"px"))}sizeColumnsToFit(e,t){const i=this.isVerticalScrollShowing()?this.scrollVisibleService.getScrollbarWidth():0,r=zi(this.eGridBody)-i;r>0?this.columnSizeService.sizeColumnsToFit(r,"sizeColumnsToFit",!1,e):void 0===t?window.setTimeout((()=>{this.sizeColumnsToFit(e,100)}),0):100===t?window.setTimeout((()=>{this.sizeColumnsToFit(e,500)}),100):500===t?window.setTimeout((()=>{this.sizeColumnsToFit(e,-1)}),500):v("tried to call sizeColumnsToFit() but the grid is coming back with zero width, maybe the grid is not visible yet on the screen?")}addScrollEventListener(e){this.eBodyViewport.addEventListener("scroll",e,{passive:!0})}removeScrollEventListener(e){this.eBodyViewport.removeEventListener("scroll",e)}};function ra(e){return e.map((e=>'<ag-row-container name="'.concat(e,'"></ag-row-container>'))).join("")}'<div class="ag-root ag-unselectable" role="treegrid">\n        <ag-header-root></ag-header-root>\n        <div class="ag-floating-top" data-ref="eTop" role="presentation">\n            '.concat(ra(["topLeft","topCenter","topRight","topFullWidth"]),'\n        </div>\n        <div class="ag-body" data-ref="eBody" role="presentation">\n            <div class="ag-body-viewport" data-ref="eBodyViewport" role="presentation">\n            ').concat(ra(["left","center","right","fullWidth"]),'\n            </div>\n            <ag-fake-vertical-scroll></ag-fake-vertical-scroll>\n        </div>\n        <div class="ag-sticky-top" data-ref="eStickyTop" role="presentation">\n            ').concat(ra(["stickyTopLeft","stickyTopCenter","stickyTopRight","stickyTopFullWidth"]),'\n        </div>\n        <div class="ag-sticky-bottom" data-ref="eStickyBottom" role="presentation">\n            ').concat(ra(["stickyBottomLeft","stickyBottomCenter","stickyBottomRight","stickyBottomFullWidth"]),'\n        </div>\n        <div class="ag-floating-bottom" data-ref="eBottom" role="presentation">\n            ').concat(ra(["bottomLeft","bottomCenter","bottomRight","bottomFullWidth"]),"\n        </div>\n        <ag-fake-horizontal-scroll></ag-fake-horizontal-scroll>\n        <ag-overlay-wrapper></ag-overlay-wrapper>\n    </div>");var na=class extends He{constructor(){super(...arguments),this.beanName="scrollVisibleService"}wireBeans(e){this.ctrlsService=e.ctrlsService,this.columnAnimationService=e.columnAnimationService}postConstruct(){this.getScrollbarWidth(),this.addManagedEventListeners({displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),displayedColumnsWidthChanged:this.onDisplayedColumnsWidthChanged.bind(this)})}onDisplayedColumnsChanged(){this.updateScrollVisible()}onDisplayedColumnsWidthChanged(){this.updateScrollVisible()}onCentreViewportResized(){this.updateScrollGap()}updateScrollVisible(){this.columnAnimationService.isActive()?this.columnAnimationService.executeLaterVMTurn((()=>{this.columnAnimationService.executeLaterVMTurn((()=>this.updateScrollVisibleImpl()))})):this.updateScrollVisibleImpl()}updateScrollVisibleImpl(){const e=this.ctrlsService.get("center");if(!e||this.columnAnimationService.isActive())return;const t={horizontalScrollShowing:e.isHorizontalScrollShowing(),verticalScrollShowing:this.isVerticalScrollShowing()};this.setScrollsVisible(t),this.updateScrollGap()}updateScrollGap(){const e=this.ctrlsService.get("center"),t=e.hasHorizontalScrollGap(),i=e.hasVerticalScrollGap();(this.horizontalScrollGap!==t||this.verticalScrollGap!==i)&&(this.horizontalScrollGap=t,this.verticalScrollGap=i,this.eventService.dispatchEvent({type:"scrollGapChanged"}))}setScrollsVisible(e){(this.horizontalScrollShowing!==e.horizontalScrollShowing||this.verticalScrollShowing!==e.verticalScrollShowing)&&(this.horizontalScrollShowing=e.horizontalScrollShowing,this.verticalScrollShowing=e.verticalScrollShowing,this.eventService.dispatchEvent({type:"scrollVisibilityChanged"}))}isHorizontalScrollShowing(){return this.horizontalScrollShowing}isVerticalScrollShowing(){return this.verticalScrollShowing}hasHorizontalScrollGap(){return this.horizontalScrollGap}hasVerticalScrollGap(){return this.verticalScrollGap}getScrollbarWidth(){if(null==this.scrollbarWidth){const e=this.gos.get("scrollbarWidth"),t="number"===typeof e&&e>=0?e:(null==ti&&Ai(),ti);null!=t&&(this.scrollbarWidth=t,this.eventService.dispatchEvent({type:"scrollbarWidthChanged"}))}return this.scrollbarWidth}},oa="__ag_grid_instance",sa=class e extends He{constructor(){super(...arguments),this.beanName="mouseEventService",this.gridInstanceId=e.gridInstanceSequence.next()}wireBeans(e){this.ctrlsService=e.ctrlsService}stampTopLevelGridCompWithGridInstance(e){e[oa]=this.gridInstanceId}getRenderedCellForEvent(e){return Be(this.gos,e.target,Ms.DOM_DATA_KEY_CELL_CTRL)}isEventFromThisGrid(e){return this.isElementInThisGrid(e.target)}isElementInThisGrid(e){let t=e;for(;t;){const e=t[oa];if(F(e)){return e===this.gridInstanceId}t=t.parentElement}return!1}getCellPositionForEvent(e){const t=this.getRenderedCellForEvent(e);return t?t.getCellPosition():null}getNormalisedPosition(e){const t=z(this.gos,"normal"),i=e;let r,n;if(null!=i.clientX||null!=i.clientY?(r=i.clientX,n=i.clientY):(r=i.x,n=i.y),t){const e=this.ctrlsService.getGridBodyCtrl(),t=e.getScrollFeature().getVScrollPosition();r+=e.getScrollFeature().getHScrollPosition().left,n+=t.top}return{x:r,y:n}}};sa.gridInstanceSequence=new or;var aa=sa,la=class extends He{constructor(){super(),this.beanName="navigationService",this.onPageDown=x(this.onPageDown,100),this.onPageUp=x(this.onPageUp,100)}wireBeans(e){this.mouseEventService=e.mouseEventService,this.pageBoundsService=e.pageBoundsService,this.focusService=e.focusService,this.columnModel=e.columnModel,this.visibleColsService=e.visibleColsService,this.rowModel=e.rowModel,this.ctrlsService=e.ctrlsService,this.rowRenderer=e.rowRenderer,this.headerNavigationService=e.headerNavigationService,this.rowPositionUtils=e.rowPositionUtils,this.cellNavigationService=e.cellNavigationService,this.pinnedRowModel=e.pinnedRowModel,this.scrollVisibleService=e.scrollVisibleService,this.rangeService=e.rangeService}postConstruct(){this.ctrlsService.whenReady(this,(e=>{this.gridBodyCon=e.gridBodyCtrl}))}handlePageScrollingKey(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i=e.key,r=e.altKey,n=e.ctrlKey||e.metaKey,o=!!this.rangeService&&e.shiftKey,s=this.mouseEventService.getCellPositionForEvent(e);let a=!1;switch(i){case Tr.PAGE_HOME:case Tr.PAGE_END:n||r||(this.onHomeOrEndKey(i),a=!0);break;case Tr.LEFT:case Tr.RIGHT:case Tr.UP:case Tr.DOWN:if(!s)return!1;!n||r||o||(this.onCtrlUpDownLeftRight(i,s),a=!0);break;case Tr.PAGE_DOWN:case Tr.PAGE_UP:n||r||(a=this.handlePageUpDown(i,s,t))}return a&&e.preventDefault(),a}handlePageUpDown(e,t,i){return i&&(t=this.focusService.getFocusedCell()),!!t&&(e===Tr.PAGE_UP?this.onPageUp(t):this.onPageDown(t),!0)}navigateTo(e){var t;const{scrollIndex:i,scrollType:r,scrollColumn:n,focusIndex:o,focusColumn:s}=e;F(n)&&!n.isPinned()&&this.gridBodyCon.getScrollFeature().ensureColumnVisible(n),F(i)&&this.gridBodyCon.getScrollFeature().ensureIndexVisible(i,r),e.isAsync||this.gridBodyCon.getScrollFeature().ensureIndexVisible(o),this.focusService.setFocusedCell({rowIndex:o,column:s,rowPinned:null,forceBrowserFocus:!0}),null===(t=this.rangeService)||void 0===t||t.setRangeToCell({rowIndex:o,rowPinned:null,column:s})}onPageDown(e){const t=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),i=this.getViewportHeight(),r=this.pageBoundsService.getPixelOffset(),n=t.top+i,o=this.rowModel.getRowIndexAtPixel(n+r);this.columnModel.isAutoRowHeightActive()?this.navigateToNextPageWithAutoHeight(e,o):this.navigateToNextPage(e,o)}onPageUp(e){const t=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),i=this.pageBoundsService.getPixelOffset(),r=t.top,n=this.rowModel.getRowIndexAtPixel(r+i);this.columnModel.isAutoRowHeightActive()?this.navigateToNextPageWithAutoHeight(e,n,!0):this.navigateToNextPage(e,n,!0)}navigateToNextPage(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=this.getViewportHeight(),n=this.pageBoundsService.getFirstRow(),o=this.pageBoundsService.getLastRow(),s=this.pageBoundsService.getPixelOffset(),a=this.rowModel.getRow(e.rowIndex),l=i?(null===a||void 0===a?void 0:a.rowHeight)-r-s:r-s,c=(null===a||void 0===a?void 0:a.rowTop)+l;let u,d=this.rowModel.getRowIndexAtPixel(c+s);if(d===e.rowIndex){const r=i?-1:1;t=d=e.rowIndex+r}i?(u="bottom",d<n&&(d=n),t<n&&(t=n)):(u="top",d>o&&(d=o),t>o&&(t=o)),this.isRowTallerThanView(d)&&(t=d,u="top"),this.navigateTo({scrollIndex:t,scrollType:u,scrollColumn:null,focusIndex:d,focusColumn:e.column})}navigateToNextPageWithAutoHeight(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.navigateTo({scrollIndex:t,scrollType:i?"bottom":"top",scrollColumn:null,focusIndex:t,focusColumn:e.column}),setTimeout((()=>{const r=this.getNextFocusIndexForAutoHeight(e,i);this.navigateTo({scrollIndex:t,scrollType:i?"bottom":"top",scrollColumn:null,focusIndex:r,focusColumn:e.column,isAsync:!0})}),50)}getNextFocusIndexForAutoHeight(e){const t=arguments.length>1&&void 0!==arguments[1]&&arguments[1]?-1:1,i=this.getViewportHeight(),r=this.pageBoundsService.getLastRow();let n=0,o=e.rowIndex;for(;o>=0&&o<=r;){const e=this.rowModel.getRow(o);if(e){var s;const t=null!==(s=e.rowHeight)&&void 0!==s?s:0;if(n+t>i)break;n+=t}o+=t}return Math.max(0,Math.min(o,r))}getViewportHeight(){const e=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),t=this.scrollVisibleService.getScrollbarWidth();let i=e.bottom-e.top;return this.ctrlsService.get("center").isHorizontalScrollShowing()&&(i-=t),i}isRowTallerThanView(e){const t=this.rowModel.getRow(e);if(!t)return!1;const i=t.rowHeight;return"number"===typeof i&&i>this.getViewportHeight()}onCtrlUpDownLeftRight(e,t){const i=this.cellNavigationService.getNextCellToFocus(e,t,!0),{rowIndex:r}=i,n=i.column;this.navigateTo({scrollIndex:r,scrollType:null,scrollColumn:n,focusIndex:r,focusColumn:n})}onHomeOrEndKey(e){const t=e===Tr.PAGE_HOME,i=this.visibleColsService.getAllCols(),r=t?i[0]:ye(i),n=t?this.pageBoundsService.getFirstRow():this.pageBoundsService.getLastRow();this.navigateTo({scrollIndex:n,scrollType:null,scrollColumn:r,focusIndex:n,focusColumn:r})}onTabKeyDown(e,t){const i=t.shiftKey,r=this.tabToNextCellCommon(e,i,t);if(!1===r)if(i){const{rowIndex:i,rowPinned:r}=e.getRowPosition();(r?0===i:i===this.pageBoundsService.getFirstRow())&&(0===this.gos.get("headerHeight")||this.focusService.isHeaderFocusSuppressed()?this.focusService.focusNextGridCoreContainer(!0,!0):(t.preventDefault(),this.focusService.focusPreviousFromFirstCell(t)))}else e instanceof Ms&&e.focusCell(!0),(!i&&this.focusService.focusOverlay(!1)||this.focusService.focusNextGridCoreContainer(i))&&t.preventDefault();else r?t.preventDefault():null===r&&this.focusService.allowFocusForNextGridCoreContainer(i)}tabToNextCell(e,t){const i=this.focusService.getFocusedCell();if(!i)return!1;let r=this.getCellByPosition(i);return!!(r||(r=this.rowRenderer.getRowByPosition(i),r&&r.isFullWidth()))&&!!this.tabToNextCellCommon(r,e,t)}tabToNextCellCommon(e,t,i){let r,n=e.isEditing();if(!n&&e instanceof Ms){const t=e.getRowCtrl();t&&(n=t.isEditing())}return r=n?"fullRow"===this.gos.get("editType")?this.moveToNextEditingRow(e,t,i):this.moveToNextEditingCell(e,t,i):this.moveToNextCellNotEditing(e,t),null===r?r:r||!!this.focusService.getFocusedHeader()}moveToNextEditingCell(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const r=e.getCellPosition();e.getGui().focus(),e.stopEditing();const n=this.findNextCellToFocusOn(r,t,!0);return!1===n?null:null!=n&&(n.startEditing(null,!0,i),n.focusCell(!1),!0)}moveToNextEditingRow(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const r=e.getCellPosition(),n=this.findNextCellToFocusOn(r,t,!0);if(!1===n)return null;if(null==n)return!1;const o=n.getCellPosition(),s=this.isCellEditable(r),a=this.isCellEditable(o),l=o&&r.rowIndex===o.rowIndex&&r.rowPinned===o.rowPinned;if(s&&e.setFocusOutOnEditor(),!l){e.getRowCtrl().stopEditing();n.getRowCtrl().startRowEditing(void 0,void 0,i)}return a?(n.setFocusInOnEditor(),n.focusCell()):n.focusCell(!0),!0}moveToNextCellNotEditing(e,t){const i=this.visibleColsService.getAllCols();let r;r=e instanceof Os?c(c({},e.getRowPosition()),{},{column:t?i[0]:ye(i)}):e.getCellPosition();const n=this.findNextCellToFocusOn(r,t,!1);if(!1===n)return null;if(n instanceof Ms)n.focusCell(!0);else if(n)return this.tryToFocusFullWidthRow(n.getRowPosition(),t);return F(n)}findNextCellToFocusOn(e,t,i){let r=e;for(;;){var n;e!==r&&(e=r),t||(r=this.getLastCellOfColSpan(r)),r=this.cellNavigationService.getNextTabbedCell(r,t);const o=this.gos.getCallback("tabToNextCell");if(F(o)){const n=o({backwards:t,editing:i,previousCellPosition:e,nextCellPosition:r||null});if(!0===n||null===n)null===n&&v("Returning `null` from tabToNextCell is deprecated. Return `true` to stay on the current cell, or `false` to let the browser handle the tab behaviour."),r=e;else{if(!1===n)return!1;r={rowIndex:n.rowIndex,column:n.column,rowPinned:n.rowPinned}}}if(!r)return null;if(r.rowIndex<0){const e=this.headerNavigationService.getHeaderRowCount();return this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:e+r.rowIndex,column:r.column},fromCell:!0}),null}const s="fullRow"===this.gos.get("editType");if(i&&!s){if(!this.isCellEditable(r))continue}this.ensureCellVisible(r);const a=this.getCellByPosition(r);if(!a){const e=this.rowRenderer.getRowByPosition(r);if(!e||!e.isFullWidth()||i)continue;return e}if(!a.isSuppressNavigable())return null===(n=this.rangeService)||void 0===n||n.setRangeToCell(r),a}}isCellEditable(e){const t=this.lookupRowNodeForCell(e);return!!t&&e.column.isCellEditable(t)}getCellByPosition(e){const t=this.rowRenderer.getRowByPosition(e);return t?t.getCellCtrl(e.column):null}lookupRowNodeForCell(e){return"top"===e.rowPinned?this.pinnedRowModel.getPinnedTopRow(e.rowIndex):"bottom"===e.rowPinned?this.pinnedRowModel.getPinnedBottomRow(e.rowIndex):this.rowModel.getRow(e.rowIndex)}navigateToNextCell(e,t,i,r){let n=i,o=!1;for(;n&&(n===i||!this.isValidNavigateCell(n));)this.gos.get("enableRtl")?t===Tr.LEFT&&(n=this.getLastCellOfColSpan(n)):t===Tr.RIGHT&&(n=this.getLastCellOfColSpan(n)),n=this.cellNavigationService.getNextCellToFocus(t,n),o=P(n);if(o&&e&&e.key===Tr.UP&&(n={rowIndex:-1,rowPinned:null,column:i.column}),r){const r=this.gos.getCallback("navigateToNextCell");if(F(r)){const o=r({key:t,previousCellPosition:i,nextCellPosition:n||null,event:e});n=F(o)?{rowPinned:o.rowPinned,rowIndex:o.rowIndex,column:o.column}:null}}if(!n)return;if(n.rowIndex<0){const t=this.headerNavigationService.getHeaderRowCount();return void this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:t+n.rowIndex,column:i.column},event:e||void 0,fromCell:!0})}const s=this.getNormalisedPosition(n);s?this.focusPosition(s):this.tryToFocusFullWidthRow(n)}getNormalisedPosition(e){this.ensureCellVisible(e);const t=this.getCellByPosition(e);return t?(e=t.getCellPosition(),this.ensureCellVisible(e),e):null}tryToFocusFullWidthRow(e,t){const i=this.visibleColsService.getAllCols(),r=this.rowRenderer.getRowByPosition(e);if(!r||!r.isFullWidth())return!1;const n=this.focusService.getFocusedCell(),o={rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:e.column||(t?ye(i):i[0])};this.focusPosition(o);const s=null==t?null!=n&&this.rowPositionUtils.before(o,n):t;return this.eventService.dispatchEvent({type:"fullWidthRowFocused",rowIndex:o.rowIndex,rowPinned:o.rowPinned,column:o.column,isFullWidthCell:!0,fromBelow:s}),!0}focusPosition(e){var t;this.focusService.setFocusedCell({rowIndex:e.rowIndex,column:e.column,rowPinned:e.rowPinned,forceBrowserFocus:!0}),null===(t=this.rangeService)||void 0===t||t.setRangeToCell(e)}isValidNavigateCell(e){return!!this.rowPositionUtils.getRowNode(e)}getLastCellOfColSpan(e){const t=this.getCellByPosition(e);if(!t)return e;const i=t.getColSpanningList();return 1===i.length?e:{rowIndex:e.rowIndex,column:ye(i),rowPinned:e.rowPinned}}ensureCellVisible(e){const t=ie(this.gos),i=this.rowModel.getRow(e.rowIndex);!(t&&(null===i||void 0===i?void 0:i.sticky))&&P(e.rowPinned)&&this.gridBodyCon.getScrollFeature().ensureIndexVisible(e.rowIndex),e.column.isPinned()||this.gridBodyCon.getScrollFeature().ensureColumnVisible(e.column)}},ca=class extends He{constructor(){super(...arguments),this.beanName="horizontalResizeService"}wireBeans(e){this.dragService=e.dragService,this.ctrlsService=e.ctrlsService}addResizeBar(e){const t={dragStartPixels:e.dragStartPixels||0,eElement:e.eResizeBar,onDragStart:this.onDragStart.bind(this,e),onDragStop:this.onDragStop.bind(this,e),onDragging:this.onDragging.bind(this,e),onDragCancel:this.onDragStop.bind(this,e),includeTouch:!0,stopPropagationForTouch:!0};this.dragService.addDragSource(t);return()=>this.dragService.removeDragSource(t)}onDragStart(e,t){this.dragStartX=t.clientX,this.setResizeIcons();const i=t instanceof MouseEvent&&!0===t.shiftKey;e.onResizeStart(i)}setResizeIcons(){const e=this.ctrlsService.get("gridCtrl");e.setResizeCursor(!0),e.disableUserSelect(!0)}onDragStop(e){e.onResizeEnd(this.resizeAmount),this.resetIcons()}resetIcons(){const e=this.ctrlsService.get("gridCtrl");e.setResizeCursor(!1),e.disableUserSelect(!1)}onDragging(e,t){this.resizeAmount=t.clientX-this.dragStartX,e.onResizing(this.resizeAmount)}},ua=class extends He{constructor(){super(...arguments),this.beanName="filterMenuFactory"}wireBeans(e){this.popupService=e.popupService,this.focusService=e.focusService,this.ctrlsService=e.ctrlsService,this.menuService=e.menuService}hideActiveMenu(){this.hidePopup&&this.hidePopup()}showMenuAfterMouseEvent(e,t,i){this.showPopup(e,(r=>{this.popupService.positionPopupUnderMouseEvent({column:e,type:i,mouseEvent:t,ePopup:r})}),i,t.target,this.menuService.isLegacyMenuEnabled())}showMenuAfterButtonClick(e,t,i){let r=-1,n="left";const o=this.menuService.isLegacyMenuEnabled();!o&&this.gos.get("enableRtl")&&(r=1,n="right");const s=o?void 0:4*r,a=o?void 0:4;this.showPopup(e,(r=>{this.popupService.positionPopupByComponent({type:i,eventSource:t,ePopup:r,nudgeX:s,nudgeY:a,alignSide:n,keepWithinBounds:!0,position:"under",column:e})}),i,t,o)}showPopup(e,t,i,r,n){const o=e?this.createBean(new kn(e,"COLUMN_MENU")):void 0;if(this.activeMenu=o,null===o||void 0===o||!o.hasFilter()||!e)throw new Error("AG Grid - unable to show popup filter, filter instantiation failed");const s=document.createElement("div");let a;ci(s,"presentation"),s.classList.add("ag-menu"),n||s.classList.add("ag-filter-menu"),[this.tabListener]=this.addManagedElementListeners(s,{keydown:e=>this.trapFocusWithin(e,s)}),s.appendChild(null===o||void 0===o?void 0:o.getGui());const l=this.menuService.isColumnMenuAnchoringEnabled()?null!==r&&void 0!==r?r:this.ctrlsService.getGridBodyCtrl().getGui():void 0,c=this.localeService.getLocaleTextFunc(),u=n&&"columnFilter"!==i?c("ariaLabelColumnMenu","Column Menu"):c("ariaLabelColumnFilter","Column Filter"),d=this.popupService.addPopup({modal:!0,eChild:s,closeOnEsc:!0,closedCallback:t=>{e.setMenuVisible(!1,"contextMenu");const n=t instanceof KeyboardEvent;if(this.tabListener&&(this.tabListener=this.tabListener()),n&&r&&$i(r)){const e=this.focusService.findTabbableParent(r);e&&e.focus()}null===o||void 0===o||o.afterGuiDetached(),this.destroyBean(this.activeMenu),this.dispatchVisibleChangedEvent(!1,i,e)},positionCallback:()=>t(s),anchorToElement:l,ariaLabel:u});d&&(this.hidePopup=a=d.hideFunc),o.afterInit().then((()=>{t(s),o.afterGuiAttached({container:i,hidePopup:a})})),e.setMenuVisible(!0,"contextMenu"),this.dispatchVisibleChangedEvent(!0,i,e)}trapFocusWithin(e,t){e.key!==Tr.TAB||e.defaultPrevented||this.focusService.findNextFocusableElement(t,!1,e.shiftKey)||(e.preventDefault(),this.focusService.focusInto(t,e.shiftKey))}dispatchVisibleChangedEvent(e,t,i){this.eventService.dispatchEvent({type:"columnMenuVisibleChanged",visible:e,switchingTab:!1,key:t,column:null!==i&&void 0!==i?i:null,columnGroup:null})}isMenuEnabled(e){var t;return e.isFilterAllowed()&&(null!==(t=e.getColDef().menuTabs)&&void 0!==t?t:["filterMenuTab"]).includes("filterMenuTab")}showMenuAfterContextMenuEvent(){}destroy(){this.destroyBean(this.activeMenu),super.destroy()}},da=class extends He{constructor(){super(...arguments),this.beanName="resizeObserverService"}observeResize(e,t){const i=X(this.gos).ResizeObserver,r=i?new i(t):null;return null===r||void 0===r||r.observe(e),()=>null===r||void 0===r?void 0:r.disconnect()}},ha=class extends He{constructor(){super(...arguments),this.beanName="animationFrameService",this.createTasksP1={list:[],sorted:!1},this.createTasksP2={list:[],sorted:!1},this.destroyTasks=[],this.ticking=!1,this.scrollGoingDown=!0,this.lastPage=0,this.lastScrollTop=0,this.taskCount=0,this.cancelledTasks=new Set}wireBeans(e){this.ctrlsService=e.ctrlsService,this.paginationService=e.paginationService}setScrollTop(e){const t=this.gos.get("pagination");if(this.scrollGoingDown=e>=this.lastScrollTop,t&&0===e){var i,r;const e=null!==(i=null===(r=this.paginationService)||void 0===r?void 0:r.getCurrentPage())&&void 0!==i?i:0;e!==this.lastPage&&(this.lastPage=e,this.scrollGoingDown=!0)}this.lastScrollTop=e}postConstruct(){this.useAnimationFrame=!this.gos.get("suppressAnimationFrame")}isOn(){return this.useAnimationFrame}verifyAnimationFrameOn(e){!1===this.useAnimationFrame&&v("AnimationFrameService.".concat(e," called but animation frames are off"))}createTask(e,t,i){this.verifyAnimationFrameOn(i);const r={task:e,index:t,createOrder:++this.taskCount};this.addTaskToList(this[i],r),this.schedule()}cancelTask(e){this.cancelledTasks.add(e)}addTaskToList(e,t){e.list.push(t),e.sorted=!1}sortTaskList(e){if(e.sorted)return;const t=this.scrollGoingDown?1:-1;e.list.sort(((e,i)=>e.index!==i.index?t*(i.index-e.index):i.createOrder-e.createOrder)),e.sorted=!0}addDestroyTask(e){this.verifyAnimationFrameOn("createTasksP3"),this.destroyTasks.push(e),this.schedule()}executeFrame(e){this.verifyAnimationFrameOn("executeFrame");const t=this.createTasksP1,i=t.list,r=this.createTasksP2,n=r.list,o=this.destroyTasks,s=(new Date).getTime();let a=(new Date).getTime()-s;const l=e<=0,c=this.ctrlsService.getGridBodyCtrl();for(;l||a<e;){if(!c.getScrollFeature().scrollGridIfNeeded()){let e;if(i.length)this.sortTaskList(t),e=i.pop().task;else if(n.length)this.sortTaskList(r),e=n.pop().task;else{if(!o.length){this.cancelledTasks.clear();break}e=o.pop()}this.cancelledTasks.has(e)||e()}a=(new Date).getTime()-s}i.length||n.length||o.length?this.requestFrame():this.stopTicking()}stopTicking(){this.ticking=!1}flushAllFrames(){this.useAnimationFrame&&this.executeFrame(-1)}schedule(){this.useAnimationFrame&&(this.ticking||(this.ticking=!0,this.requestFrame()))}requestFrame(){const e=this.executeFrame.bind(this,60);this.requestAnimationFrame(e)}requestAnimationFrame(e){const t=X(this.gos);t.requestAnimationFrame?t.requestAnimationFrame(e):t.webkitRequestAnimationFrame?t.webkitRequestAnimationFrame(e):t.setTimeout(e,0)}isQueueEmpty(){return!this.ticking}debounce(e){let t=!1;return()=>{this.isOn()?t||(t=!0,this.addDestroyTask((()=>{t=!1,e()}))):window.setTimeout(e,0)}}},ga=class extends He{constructor(){super(...arguments),this.beanName="expansionService"}wireBeans(e){this.rowModel=e.rowModel}postConstruct(){this.isClientSideRowModel=G(this.gos)}expandRows(e){if(!this.isClientSideRowModel)return;const t=new Set(e);this.rowModel.forEachNode((e=>{e.id&&t.has(e.id)&&(e.expanded=!0)})),this.onGroupExpandedOrCollapsed()}getExpandedRows(){const e=[];return this.rowModel.forEachNode((t=>{let{expanded:i,id:r}=t;i&&r&&e.push(r)})),e}expandAll(e){this.isClientSideRowModel&&this.rowModel.expandOrCollapseAll(e)}setRowNodeExpanded(e,t,i,r){e&&(i&&e.parent&&-1!==e.parent.level&&this.setRowNodeExpanded(e.parent,t,i,r),e.setExpanded(t,void 0,r))}onGroupExpandedOrCollapsed(){this.isClientSideRowModel&&this.rowModel.refreshModel({step:"map"})}},pa=class extends He{constructor(){super(...arguments),this.beanName="menuService"}wireBeans(e){this.valueService=e.valueService,this.filterMenuFactory=e.filterMenuFactory,this.ctrlsService=e.ctrlsService,this.animationFrameService=e.animationFrameService,this.filterManager=e.filterManager,this.rowRenderer=e.rowRenderer,this.columnChooserFactory=e.columnChooserFactory,this.contextMenuFactory=e.contextMenuFactory,this.enterpriseMenuFactory=e.enterpriseMenuFactory}postConstruct(){var e;this.activeMenuFactory=null!==(e=this.enterpriseMenuFactory)&&void 0!==e?e:this.filterMenuFactory}showColumnMenu(e){this.showColumnMenuCommon(this.activeMenuFactory,e,"columnMenu")}showFilterMenu(e){const t=this.enterpriseMenuFactory&&this.isLegacyMenuEnabled()?this.enterpriseMenuFactory:this.filterMenuFactory;this.showColumnMenuCommon(t,e,e.containerType,!0)}showHeaderContextMenu(e,t,i){this.activeMenuFactory.showMenuAfterContextMenuEvent(e,t,i)}getContextMenuPosition(e,t){const i=this.getRowCtrl(e),r=this.getCellGui(i,t);if(!r)return i?{x:0,y:i.getRowYPosition()}:{x:0,y:0};const n=r.getBoundingClientRect();return{x:n.x+n.width/2,y:n.y+n.height/2}}showContextMenu(e){var t,i,r;const n=e.rowNode,o=e.column;let{anchorToElement:s,value:a}=e;n&&o&&null==a&&(a=this.valueService.getValueForDisplay(o,n)),null==s&&(s=this.getContextMenuAnchorElement(n,o)),null===(t=this.contextMenuFactory)||void 0===t||t.onContextMenu(null!==(i=e.mouseEvent)&&void 0!==i?i:null,null!==(r=e.touchEvent)&&void 0!==r?r:null,null!==n&&void 0!==n?n:null,null!==o&&void 0!==o?o:null,a,s)}showColumnChooser(e){var t;null===(t=this.columnChooserFactory)||void 0===t||t.showColumnChooser(e)}hidePopupMenu(){var e;null===(e=this.contextMenuFactory)||void 0===e||e.hideActiveMenu(),this.activeMenuFactory.hideActiveMenu()}hideColumnChooser(){var e;null===(e=this.columnChooserFactory)||void 0===e||e.hideActiveColumnChooser()}isColumnMenuInHeaderEnabled(e){const{suppressMenu:t,suppressHeaderMenuButton:i}=e.getColDef();return!(null!==i&&void 0!==i?i:t)&&this.activeMenuFactory.isMenuEnabled(e)&&(this.isLegacyMenuEnabled()||!!this.enterpriseMenuFactory)}isFilterMenuInHeaderEnabled(e){var t;return!e.getColDef().suppressHeaderFilterButton&&!(null===(t=this.filterManager)||void 0===t||!t.isFilterAllowed(e))}isHeaderContextMenuEnabled(e){const t=e&&ct(e)?e.getColDef():null===e||void 0===e?void 0:e.getColGroupDef();return!(null!==t&&void 0!==t&&t.suppressHeaderContextMenu)&&"new"===this.getColumnMenuType()}isHeaderMenuButtonAlwaysShowEnabled(){return this.isSuppressMenuHide()}isHeaderMenuButtonEnabled(){const e=!this.isSuppressMenuHide();return!(Pi()&&e)}isHeaderFilterButtonEnabled(e){return this.isFilterMenuInHeaderEnabled(e)&&!this.isLegacyMenuEnabled()&&!this.isFloatingFilterButtonDisplayed(e)}isFilterMenuItemEnabled(e){var t;return!(null===(t=this.filterManager)||void 0===t||!t.isFilterAllowed(e))&&!this.isLegacyMenuEnabled()&&!this.isFilterMenuInHeaderEnabled(e)&&!this.isFloatingFilterButtonDisplayed(e)}isColumnMenuAnchoringEnabled(){return!this.isLegacyMenuEnabled()}areAdditionalColumnMenuItemsEnabled(){return"new"===this.getColumnMenuType()}isLegacyMenuEnabled(){return"legacy"===this.getColumnMenuType()}isFloatingFilterButtonEnabled(e){var t;const i=e.getColDef(),r=null===(t=i.floatingFilterComponentParams)||void 0===t?void 0:t.suppressFilterButton;return null!=r&&v("As of v31.1, 'colDef.floatingFilterComponentParams.suppressFilterButton' is deprecated. Use 'colDef.suppressFloatingFilterButton' instead."),null==i.suppressFloatingFilterButton?!r:!i.suppressFloatingFilterButton}getColumnMenuType(){return this.gos.get("columnMenu")}isFloatingFilterButtonDisplayed(e){return!!e.getColDef().floatingFilter&&this.isFloatingFilterButtonEnabled(e)}isSuppressMenuHide(){const e=this.gos.get("suppressMenuHide");return this.isLegacyMenuEnabled()?!!this.gos.exists("suppressMenuHide")&&e:e}showColumnMenuCommon(e,t,i,r){const{positionBy:n}=t,o=t.column;if("button"===n){const{buttonElement:n}=t;e.showMenuAfterButtonClick(o,n,i,r)}else if("mouse"===n){const{mouseEvent:n}=t;e.showMenuAfterMouseEvent(o,n,i,r)}else o&&(this.ctrlsService.getGridBodyCtrl().getScrollFeature().ensureColumnVisible(o,"auto"),this.animationFrameService.requestAnimationFrame((()=>{var t;const n=null===(t=this.ctrlsService.getHeaderRowContainerCtrl(o.getPinned()))||void 0===t?void 0:t.getHeaderCtrlForColumn(o);n&&e.showMenuAfterButtonClick(o,n.getAnchorElementForMenu(r),i,!0)})))}getRowCtrl(e){const{rowIndex:t,rowPinned:i}=e||{};if(null!=t)return this.rowRenderer.getRowByPosition({rowIndex:t,rowPinned:i})||void 0}getCellGui(e,t){if(!e||!t)return;const i=e.getCellCtrl(t);return(null===i||void 0===i?void 0:i.getGui())||void 0}getContextMenuAnchorElement(e,t){const i=this.ctrlsService.getGridBodyCtrl().getGridBodyElement(),r=this.getRowCtrl(e);if(!r)return i;const n=this.getCellGui(r,t);return n||(r.isFullWidth()?r.getFullWidthElement():i)}},fa={selector:"AG-INPUT-TEXT-AREA",component:class extends Dr{constructor(e){super(e,"ag-text-area",null,"textarea")}setValue(e,t){const i=super.setValue(e,t);return this.eInput.value=e,i}setCols(e){return this.eInput.cols=e,this}setRows(e){return this.eInput.rows=e,this}}},ma=class extends Gr{constructor(e){super('<div class="ag-popup-editor" tabindex="-1"/>'),this.params=e}postConstruct(){q(this.gos,this.getGui(),"popupEditorWrapper",!0),this.addKeyDownListener()}addKeyDownListener(){const e=this.getGui(),t=this.params;this.addManagedElementListeners(e,{keydown:e=>{$n(this.gos,e,t.node,t.column,!0)||t.onKeyDown(e)}})}},va=class extends Gr{constructor(e){super('\n            <div class="ag-cell-edit-wrapper">\n                '.concat(e.getTemplate(),"\n            </div>"),e.getAgComponents()),this.cellEditorInput=e,this.eInput=ur}init(e){this.params=e;const{cellStartedEdit:t,eventKey:i,suppressPreventDefault:r}=e,n=this.eInput;let o;this.cellEditorInput.init(n,e);let s=!0;t?(this.focusAfterAttached=!0,i===Tr.BACKSPACE||i===Tr.DELETE?o="":i&&1===i.length?r?s=!1:o=i:(o=this.cellEditorInput.getStartValue(),i!==Tr.F2&&(this.highlightAllOnFocus=!0))):(this.focusAfterAttached=!1,o=this.cellEditorInput.getStartValue()),s&&null!=o&&n.setStartValue(o),this.addManagedElementListeners(n.getGui(),{keydown:e=>{const{key:t}=e;t!==Tr.PAGE_UP&&t!==Tr.PAGE_DOWN||e.preventDefault()}})}afterGuiAttached(){const e=this.localeService.getLocaleTextFunc(),t=this.eInput;if(t.setInputAriaLabel(e("ariaInputEditor","Input Editor")),!this.focusAfterAttached)return;Ri()||t.getFocusableElement().focus();const i=t.getInputElement();var r,n;this.highlightAllOnFocus?i.select():null===(r=(n=this.cellEditorInput).setCaret)||void 0===r||r.call(n)}focusIn(){const e=this.eInput,t=e.getFocusableElement(),i=e.getInputElement();t.focus(),i.select()}getValue(){return this.cellEditorInput.getValue()}isPopup(){return!1}},Ca=class{getTemplate(){return'<ag-input-text-field class="ag-cell-editor" data-ref="eInput"></ag-input-text-field>'}getAgComponents(){return[Jn]}init(e,t){this.eInput=e,this.params=t,null!=t.maxLength&&e.setMaxLength(t.maxLength)}getValue(){const e=this.eInput.getValue();return F(e)||F(this.params.value)?this.params.parseValue(e):this.params.value}getStartValue(){return this.params.useFormatter||this.params.column.getColDef().refData?this.params.formatValue(this.params.value):this.params.value}setCaret(){const e=this.eInput.getValue(),t=F(e)&&e.length||0;t&&this.eInput.getInputElement().setSelectionRange(t,t)}},wa=class extends va{constructor(){super(new Ca)}},ba=class{getTemplate(){return'<ag-input-number-field class="ag-cell-editor" data-ref="eInput"></ag-input-number-field>'}getAgComponents(){return[eo]}init(e,t){this.eInput=e,this.params=t,null!=t.max&&e.setMax(t.max),null!=t.min&&e.setMin(t.min),null!=t.precision&&e.setPrecision(t.precision),null!=t.step&&e.setStep(t.step);const i=e.getInputElement();t.preventStepping?e.addManagedElementListeners(i,{keydown:this.preventStepping}):t.showStepperButtons&&i.classList.add("ag-number-field-input-stepper")}preventStepping(e){e.key!==Tr.UP&&e.key!==Tr.DOWN||e.preventDefault()}getValue(){const e=this.eInput.getValue();if(!F(e)&&!F(this.params.value))return this.params.value;let t=this.params.parseValue(e);if(null==t)return t;if("string"===typeof t){if(""===t)return null;t=Number(t)}return isNaN(t)?null:t}getStartValue(){return this.params.value}setCaret(){Ri()&&this.eInput.getInputElement().focus({preventScroll:!0})}},Sa={selector:"AG-INPUT-DATE-FIELD",component:class extends Xn{constructor(e){super(e,"ag-date-field","date")}postConstruct(){super.postConstruct();const e=Ri();this.addManagedListeners(this.eInput,{wheel:this.onWheel.bind(this),mousedown:()=>{this.isDisabled()||e||this.eInput.focus()}}),this.eInput.step="any"}onWheel(e){Z(this.gos)===this.eInput&&e.preventDefault()}setMin(e){var t;const i=e instanceof Date?null!==(t=go(null!==e&&void 0!==e?e:null,!1))&&void 0!==t?t:void 0:e;return this.min===i||(this.min=i,rr(this.eInput,"min",i)),this}setMax(e){var t;const i=e instanceof Date?null!==(t=go(null!==e&&void 0!==e?e:null,!1))&&void 0!==t?t:void 0:e;return this.max===i||(this.max=i,rr(this.eInput,"max",i)),this}setStep(e){return this.step===e||(this.step=e,rr(this.eInput,"step",e)),this}getDate(){var e;if(this.eInput.validity.valid)return null!==(e=mo(this.getValue()))&&void 0!==e?e:void 0}setDate(e,t){this.setValue(go(null!==e&&void 0!==e?e:null,!1),t)}}},ya=class{getTemplate(){return'<ag-input-date-field class="ag-cell-editor" data-ref="eInput"></ag-input-date-field>'}getAgComponents(){return[Sa]}init(e,t){this.eInput=e,this.params=t,null!=t.min&&e.setMin(t.min),null!=t.max&&e.setMax(t.max),null!=t.step&&e.setStep(t.step)}getValue(){const e=this.eInput.getDate();return F(e)||F(this.params.value)?null!==e&&void 0!==e?e:null:this.params.value}getStartValue(){const{value:e}=this.params;if(e instanceof Date)return go(e,!1)}},Ra=class{constructor(e){this.getDataTypeService=e}getTemplate(){return'<ag-input-date-field class="ag-cell-editor" data-ref="eInput"></ag-input-date-field>'}getAgComponents(){return[Sa]}init(e,t){this.eInput=e,this.params=t,null!=t.min&&e.setMin(t.min),null!=t.max&&e.setMax(t.max),null!=t.step&&e.setStep(t.step)}getValue(){const e=this.formatDate(this.eInput.getDate());return F(e)||F(this.params.value)?this.params.parseValue(null!==e&&void 0!==e?e:""):this.params.value}getStartValue(){var e,t;return go(null!==(e=this.parseDate(null!==(t=this.params.value)&&void 0!==t?t:void 0))&&void 0!==e?e:null,!1)}parseDate(e){var t;const i=this.getDataTypeService();return i?i.getDateParserFunction(this.params.column)(e):null!==(t=mo(e))&&void 0!==t?t:void 0}formatDate(e){var t;const i=this.getDataTypeService();return i?i.getDateFormatterFunction(this.params.column)(e):null!==(t=go(null!==e&&void 0!==e?e:null,!1))&&void 0!==t?t:void 0}},Ea=class{constructor(e){this.cellValueChanges=e}},xa=class extends Ea{constructor(e,t,i,r){super(e),this.initialRange=t,this.finalRange=i,this.ranges=r}},Ta=class{constructor(e){this.actionStack=[],this.maxStackSize=e||10,this.actionStack=new Array(this.maxStackSize)}pop(){return this.actionStack.pop()}push(e){e.cellValueChanges&&e.cellValueChanges.length>0&&(this.actionStack.length===this.maxStackSize&&this.actionStack.shift(),this.actionStack.push(e))}clear(){this.actionStack=[]}getCurrentStackSize(){return this.actionStack.length}};function Fa(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"auto";e.frameworkOverrides.wrapIncoming((()=>e.ctrlsService.getGridBodyCtrl().getScrollFeature().ensureColumnVisible(t,i)),"ensureVisible")}function Pa(e,t,i){e.frameworkOverrides.wrapIncoming((()=>e.ctrlsService.getGridBodyCtrl().getScrollFeature().ensureIndexVisible(t,i)),"ensureVisible")}var Da={version:Do,moduleName:"@ag-grid-community/edit-core",beans:[class extends He{constructor(){super(...arguments),this.beanName="editService"}wireBeans(e){this.navigationService=e.navigationService,this.userComponentFactory=e.userComponentFactory,this.valueService=e.valueService}startEditing(e){var t;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const o=this.createCellEditorParams(e,i,r),s=e.getColumn().getColDef(),a=this.userComponentFactory.getCellEditorDetails(s,o),l=null!=(null===a||void 0===a?void 0:a.popupFromSelector)?a.popupFromSelector:!!s.cellEditorPopup,c=null!=(null===a||void 0===a?void 0:a.popupPositionFromSelector)?a.popupPositionFromSelector:s.cellEditorPopupPosition;return e.setEditing(!0,a),e.getComp().setEditDetails(a,l,c,this.gos.get("reactiveCustomComponents")),this.eventService.dispatchEvent(e.createEvent(n,"cellEditingStarted")),!(null!==a&&void 0!==a&&null!==(t=a.params)&&void 0!==t&&t.suppressPreventDefault)}stopEditing(e,t){const i=e.getComp(),{newValue:r,newValueExists:n}=this.takeValueFromCellEditor(t,i),o=e.getRowNode(),s=e.getColumn(),a=this.valueService.getValueForDisplay(s,o);let l=!1;return n&&(l=this.saveNewValue(e,a,r,o,s)),e.setEditing(!1,void 0),i.setEditDetails(),e.updateAndFormatValue(!1),e.refreshCell({forceRefresh:!0,suppressFlash:!0}),this.eventService.dispatchEvent(c(c({},e.createEvent(null,"cellEditingStopped")),{},{oldValue:a,newValue:r,valueChanged:l})),l}handleColDefChanged(e){const t=e.getCellEditor();if(null!==t&&void 0!==t&&t.refresh){const{eventKey:i,cellStartedEdit:r}=e.getEditCompDetails().params,n=this.createCellEditorParams(e,i,r),o=e.getColumn().getColDef(),s=this.userComponentFactory.getCellEditorDetails(o,n);t.refresh(s.params)}}setFocusOutOnEditor(e){const t=e.getComp().getCellEditor();t&&t.focusOut&&t.focusOut()}setFocusInOnEditor(e){const t=e.getComp(),i=t.getCellEditor();null!==i&&void 0!==i&&i.focusIn?i.focusIn():(e.focusCell(!0),e.onCellEditorAttached((()=>{var e,i;return null===(e=t.getCellEditor())||void 0===e||null===(i=e.focusIn)||void 0===i?void 0:i.call(e)})))}stopEditingAndFocus(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e.stopRowOrCellEdit(),e.focusCell(!0),t||this.navigateAfterEdit(i,e.getCellPosition())}createPopupEditorWrapper(e){return new ma(e)}takeValueFromCellEditor(e,t){const i={newValueExists:!1};if(e)return i;const r=t.getCellEditor();if(!r)return i;if(r.isCancelAfterEnd&&r.isCancelAfterEnd())return i;return{newValue:r.getValue(),newValueExists:!0}}saveNewValue(e,t,i,r,n){if(i===t)return!1;e.setSuppressRefreshCell(!0);const o=r.setDataValue(n,i,"edit");return e.setSuppressRefreshCell(!1),o}createCellEditorParams(e,t,i){const r=e.getColumn(),n=e.getRowNode();return this.gos.addGridCommonParams({value:this.valueService.getValueForDisplay(r,n),eventKey:t,column:r,colDef:r.getColDef(),rowIndex:e.getCellPosition().rowIndex,node:n,data:n.data,cellStartedEdit:i,onKeyDown:e.onKeyDown.bind(e),stopEditing:e.stopEditingAndFocus.bind(e),eGridCell:e.getGui(),parseValue:t=>this.valueService.parseValue(r,n,t,e.getValue()),formatValue:e.formatValue.bind(e)})}navigateAfterEdit(e,t){if(this.gos.get("enterNavigatesVerticallyAfterEdit")){const i=e?Tr.UP:Tr.DOWN;this.navigationService.navigateToNextCell(null,i,t,!1)}}}]},ka={version:Do,moduleName:"@ag-grid-community/edit-api",apiFunctions:{undoCellEditing:function(e){var t;null===(t=e.undoRedoService)||void 0===t||t.undo("api")},redoCellEditing:function(e){var t;null===(t=e.undoRedoService)||void 0===t||t.redo("api")},getCellEditorInstances:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.rowRenderer.getCellEditorInstances(t).map(gn)},getEditingCells:function(e){return e.rowRenderer.getEditingCells()},stopEditing:function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.rowRenderer.stopEditing(t)},startEditingCell:function(e,t){const i=e.columnModel.getCol(t.colKey);if(!i)return void v("no column found for ".concat(t.colKey));const r={rowIndex:t.rowIndex,rowPinned:t.rowPinned||null,column:i};null==t.rowPinned&&Pa(e,t.rowIndex),Fa(e,t.colKey);const n=e.navigationService.getCellByPosition(r);if(!n)return;const{focusService:o,gos:s}=e,a=s.get("stopEditingWhenCellsLoseFocus")&&(()=>{const e=Z(s),t=n.getGui();return e!==t&&!(null===t||void 0===t||!t.contains(e))})();!a&&o.isCellFocused(r)||o.setFocusedCell(c(c({},r),{},{forceBrowserFocus:a,preventScrollOnBrowserFocus:!0})),n.startRowOrCellEdit(t.key)},getCurrentUndoSize:function(e){var t,i;return null!==(t=null===(i=e.undoRedoService)||void 0===i?void 0:i.getCurrentUndoStackSize())&&void 0!==t?t:0},getCurrentRedoSize:function(e){var t,i;return null!==(t=null===(i=e.undoRedoService)||void 0===i?void 0:i.getCurrentRedoStackSize())&&void 0!==t?t:0}},dependantModules:[Da]},Aa={version:Do,moduleName:"@ag-grid-community/default-editor",userComponents:[{name:"agCellEditor",classImp:wa}],dependantModules:[Da]},Ma={version:Do,moduleName:"@ag-grid-community/editing",dependantModules:[Da,{version:Do,moduleName:"@ag-grid-community/undo-redo-edit",beans:[class extends He{constructor(){super(...arguments),this.beanName="undoRedoService",this.cellValueChanges=[],this.activeCellEdit=null,this.activeRowEdit=null,this.isPasting=!1,this.isRangeInAction=!1,this.onCellValueChanged=e=>{const t={column:e.column,rowIndex:e.rowIndex,rowPinned:e.rowPinned},i=null!==this.activeCellEdit&&this.cellPositionUtils.equals(this.activeCellEdit,t),r=null!==this.activeRowEdit&&this.rowPositionUtils.sameRow(this.activeRowEdit,t);if(!(i||r||this.isPasting||this.isRangeInAction))return;const{rowPinned:n,rowIndex:o,column:s,oldValue:a,value:l}=e,c={rowPinned:n,rowIndex:o,columnId:s.getColId(),newValue:l,oldValue:a};this.cellValueChanges.push(c)},this.clearStacks=()=>{this.undoStack.clear(),this.redoStack.clear()}}wireBeans(e){this.focusService=e.focusService,this.ctrlsService=e.ctrlsService,this.cellPositionUtils=e.cellPositionUtils,this.rowPositionUtils=e.rowPositionUtils,this.columnModel=e.columnModel,this.rangeService=e.rangeService}postConstruct(){if(!this.gos.get("undoRedoCellEditing"))return;const e=this.gos.get("undoRedoCellEditingLimit");if(e<=0)return;this.undoStack=new Ta(e),this.redoStack=new Ta(e),this.addListeners();const t=this.clearStacks.bind(this);this.addManagedEventListeners({cellValueChanged:this.onCellValueChanged.bind(this),modelUpdated:e=>{e.keepUndoRedoStack||this.clearStacks()},columnPivotModeChanged:t,newColumnsLoaded:t,columnGroupOpened:t,columnRowGroupChanged:t,columnMoved:t,columnPinned:t,columnVisible:t,rowDragEnd:t}),this.ctrlsService.whenReady(this,(e=>{this.gridBodyCtrl=e.gridBodyCtrl}))}getCurrentUndoStackSize(){return this.undoStack?this.undoStack.getCurrentStackSize():0}getCurrentRedoStackSize(){return this.redoStack?this.redoStack.getCurrentStackSize():0}undo(e){this.eventService.dispatchEvent({type:"undoStarted",source:e});const t=this.undoRedo(this.undoStack,this.redoStack,"initialRange","oldValue","undo");this.eventService.dispatchEvent({type:"undoEnded",source:e,operationPerformed:t})}redo(e){this.eventService.dispatchEvent({type:"redoStarted",source:e});const t=this.undoRedo(this.redoStack,this.undoStack,"finalRange","newValue","redo");this.eventService.dispatchEvent({type:"redoEnded",source:e,operationPerformed:t})}undoRedo(e,t,i,r,n){if(!e)return!1;const o=e.pop();return!(!o||!o.cellValueChanges)&&(this.processAction(o,(e=>e[r]),n),o instanceof xa?this.processRange(this.rangeService,o.ranges||[o[i]]):this.processCell(o.cellValueChanges),t.push(o),!0)}processAction(e,t,i){e.cellValueChanges.forEach((e=>{const{rowIndex:r,rowPinned:n,columnId:o}=e,s={rowIndex:r,rowPinned:n},a=this.rowPositionUtils.getRowNode(s);a.displayed&&a.setDataValue(o,t(e),i)}))}processRange(e,t){let i;e.removeAllCellRanges(!0),t.forEach(((r,n)=>{if(!r)return;const o=r.startRow,s=r.endRow;n===t.length-1&&(i={rowPinned:o.rowPinned,rowIndex:o.rowIndex,columnId:r.startColumn.getColId()},this.setLastFocusedCell(i));const a={rowStartIndex:o.rowIndex,rowStartPinned:o.rowPinned,rowEndIndex:s.rowIndex,rowEndPinned:s.rowPinned,columnStart:r.startColumn,columns:r.columns};e.addCellRange(a)}))}processCell(e){const t=e[0],{rowIndex:i,rowPinned:r}=t,n={rowIndex:i,rowPinned:r},o=this.rowPositionUtils.getRowNode(n),s={rowPinned:t.rowPinned,rowIndex:o.rowIndex,columnId:t.columnId};this.setLastFocusedCell(s,this.rangeService)}setLastFocusedCell(e,t){const{rowIndex:i,columnId:r,rowPinned:n}=e,o=this.gridBodyCtrl.getScrollFeature(),s=this.columnModel.getCol(r);if(!s)return;o.ensureIndexVisible(i),o.ensureColumnVisible(s);const a={rowIndex:i,column:s,rowPinned:n};this.focusService.setFocusedCell(c(c({},a),{},{forceBrowserFocus:!0})),null===t||void 0===t||t.setRangeToCell(a)}addListeners(){this.addManagedEventListeners({rowEditingStarted:e=>{this.activeRowEdit={rowIndex:e.rowIndex,rowPinned:e.rowPinned}},rowEditingStopped:()=>{const e=new Ea(this.cellValueChanges);this.pushActionsToUndoStack(e),this.activeRowEdit=null},cellEditingStarted:e=>{this.activeCellEdit={column:e.column,rowIndex:e.rowIndex,rowPinned:e.rowPinned}},cellEditingStopped:e=>{this.activeCellEdit=null;if(e.valueChanged&&!this.activeRowEdit&&!this.isPasting&&!this.isRangeInAction){const e=new Ea(this.cellValueChanges);this.pushActionsToUndoStack(e)}},pasteStart:()=>{this.isPasting=!0},pasteEnd:()=>{const e=new Ea(this.cellValueChanges);this.pushActionsToUndoStack(e),this.isPasting=!1},fillStart:()=>{this.isRangeInAction=!0},fillEnd:e=>{const t=new xa(this.cellValueChanges,e.initialRange,e.finalRange);this.pushActionsToUndoStack(t),this.isRangeInAction=!1},keyShortcutChangedCellStart:()=>{this.isRangeInAction=!0},keyShortcutChangedCellEnd:()=>{let e;e=this.rangeService&&he(this.gos)?new xa(this.cellValueChanges,void 0,void 0,[...this.rangeService.getCellRanges()]):new Ea(this.cellValueChanges),this.pushActionsToUndoStack(e),this.isRangeInAction=!1}})}pushActionsToUndoStack(e){this.undoStack.push(e),this.cellValueChanges=[],this.redoStack.clear()}}],dependantModules:[Da]},{version:Do,moduleName:"@ag-grid-community/full-row-edit",beans:[class extends He{constructor(){super(...arguments),this.beanName="rowEditService"}startEditing(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=!0;return e.getAllCellCtrls().reduce(((e,o)=>{const s=o===i;return s?n=o.startEditing(t,s,r):o.startEditing(null,s,r),!!e||o.isEditing()}),!1)&&this.setEditing(e,!0),n}stopEditing(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i=e.getAllCellCtrls(),r=e.isEditing();e.setStoppingRowEdit(!0);let n=!1;for(const o of i){const e=o.stopEditing(t);r&&!t&&!n&&e&&(n=!0)}n&&this.eventService.dispatchEvent(e.createRowEvent("rowValueChanged")),r&&this.setEditing(e,!1),e.setStoppingRowEdit(!1)}setEditing(e,t){e.setEditingRow(t),e.forEachGui(void 0,(e=>e.rowComp.addOrRemoveCssClass("ag-row-editing",t)));const i=t?e.createRowEvent("rowEditingStarted"):e.createRowEvent("rowEditingStopped");this.eventService.dispatchEvent(i)}}],dependantModules:[Da]},{version:Do,moduleName:"@ag-grid-community/all-editors",dependantModules:[Aa,{version:Do,moduleName:"@ag-grid-community/data-type-editors",userComponents:[{name:"agTextCellEditor",classImp:wa},{name:"agNumberCellEditor",classImp:class extends va{constructor(){super(new ba)}},params:{suppressPreventDefault:!0}},{name:"agDateCellEditor",classImp:class extends va{constructor(){super(new ya)}}},{name:"agDateStringCellEditor",classImp:class extends va{wireBeans(e){this.dataTypeService=e.dataTypeService}constructor(){super(new Ra((()=>this.dataTypeService)))}}},{name:"agCheckboxCellEditor",classImp:class extends Gr{constructor(){super('\n            <div class="ag-cell-wrapper ag-cell-edit-wrapper ag-checkbox-edit">\n                <ag-checkbox role="presentation" data-ref="eCheckbox"></ag-checkbox>\n            </div>',[Ar]),this.eCheckbox=ur}init(e){var t;this.params=e;const i=null!==(t=e.value)&&void 0!==t?t:void 0;this.eCheckbox.setValue(i);this.eCheckbox.getInputElement().setAttribute("tabindex","-1"),this.setAriaLabel(i),this.addManagedListeners(this.eCheckbox,{fieldValueChanged:e=>this.setAriaLabel(e.selected)})}getValue(){return this.eCheckbox.getValue()}focusIn(){this.eCheckbox.getFocusableElement().focus()}afterGuiAttached(){this.params.cellStartedEdit&&this.focusIn()}isPopup(){return!1}setAriaLabel(e){const t=this.localeService.getLocaleTextFunc(),i=yi(t,e),r=t("ariaToggleCellValue","Press SPACE to toggle cell value");this.eCheckbox.setInputAriaLabel("".concat(r," (").concat(i,")"))}}}],dependantModules:[Aa]},{version:Do,moduleName:"@ag-grid-community/select-editor",userComponents:[{name:"agSelectCellEditor",classImp:class extends Gr{constructor(){super('<div class="ag-cell-edit-wrapper">\n                <ag-select class="ag-cell-editor" data-ref="eSelect"></ag-select>\n            </div>',[jn]),this.eSelect=ur,this.startedByEnter=!1}wireBeans(e){this.valueService=e.valueService}init(e){this.focusAfterAttached=e.cellStartedEdit;const{eSelect:t,valueService:i,gos:r}=this,{values:n,value:o,eventKey:s}=e;if(P(n))return void v("no values found for select cellEditor");this.startedByEnter=null!=s&&s===Tr.ENTER;let a=!1;n.forEach((r=>{const n={value:r},s=i.formatValue(e.column,null,r),l=null!==s&&void 0!==s;n.text=l?s:r,t.addOption(n),a=a||o===r})),a?t.setValue(e.value,!0):e.values.length&&t.setValue(e.values[0],!0);const{valueListGap:l,valueListMaxWidth:c,valueListMaxHeight:u}=e;null!=l&&t.setPickerGap(l),null!=u&&t.setPickerMaxHeight(u),null!=c&&t.setPickerMaxWidth(c),"fullRow"!==r.get("editType")&&this.addManagedListeners(this.eSelect,{selectedItem:()=>e.stopEditing()})}afterGuiAttached(){this.focusAfterAttached&&this.eSelect.getFocusableElement().focus(),this.startedByEnter&&setTimeout((()=>{this.isAlive()&&this.eSelect.showPicker()}))}focusIn(){this.eSelect.getFocusableElement().focus()}getValue(){return this.eSelect.getValue()}isPopup(){return!1}}}],dependantModules:[Da]},{version:Do,moduleName:"@ag-grid-community/large-text-editor",userComponents:[{name:"agLargeTextCellEditor",classImp:class extends Gr{constructor(){super('<div class="ag-large-text">\n        <ag-input-text-area data-ref="eTextArea" class="ag-large-text-input"></ag-input-text-area>\n        </div>',[fa]),this.eTextArea=ur}init(e){this.params=e,this.focusAfterAttached=e.cellStartedEdit,this.eTextArea.setMaxLength(e.maxLength||200).setCols(e.cols||60).setRows(e.rows||10),F(e.value,!0)&&this.eTextArea.setValue(e.value.toString(),!0),this.addGuiEventListener("keydown",this.onKeyDown.bind(this)),this.activateTabIndex()}onKeyDown(e){const t=e.key;(t===Tr.LEFT||t===Tr.UP||t===Tr.RIGHT||t===Tr.DOWN||e.shiftKey&&t===Tr.ENTER)&&e.stopPropagation()}afterGuiAttached(){const e=this.localeService.getLocaleTextFunc();this.eTextArea.setInputAriaLabel(e("ariaInputEditor","Input Editor")),this.focusAfterAttached&&this.eTextArea.getFocusableElement().focus()}getValue(){const e=this.eTextArea.getValue();return F(e)||F(this.params.value)?this.params.parseValue(e):this.params.value}}}],dependantModules:[Da]}]},ka]},Ia=class extends He{constructor(){super(...arguments),this.beanName="autoWidthCalculator"}wireBeans(e){this.rowRenderer=e.rowRenderer,this.ctrlsService=e.ctrlsService}postConstruct(){this.ctrlsService.whenReady(this,(e=>{this.centerRowContainerCtrl=e.center}))}getPreferredWidthForColumn(e,t){const i=this.getHeaderCellForColumn(e);if(!i)return-1;const r=this.rowRenderer.getAllCellsForColumn(e);return t||r.push(i),this.addElementsToContainerAndGetWidth(r)}getPreferredWidthForColumnGroup(e){const t=this.getHeaderCellForColumn(e);return t?this.addElementsToContainerAndGetWidth([t]):-1}addElementsToContainerAndGetWidth(e){const t=document.createElement("form");t.style.position="fixed";const i=this.centerRowContainerCtrl.getContainerElement();e.forEach((e=>this.cloneItemIntoDummy(e,t))),i.appendChild(t);const r=t.offsetWidth;i.removeChild(t);return r+this.getAutoSizePadding()}getAutoSizePadding(){return this.gos.get("autoSizePadding")}getHeaderCellForColumn(e){let t=null;return this.ctrlsService.getHeaderRowContainerCtrls().forEach((i=>{const r=i.getHtmlElementForColumnHeader(e);null!=r&&(t=r)})),t}cloneItemIntoDummy(e,t){const i=e.cloneNode(!0);i.style.width="",i.style.position="static",i.style.left="";const r=document.createElement("div"),n=r.classList;["ag-header-cell","ag-header-group-cell"].some((e=>i.classList.contains(e)))?(n.add("ag-header","ag-header-row"),r.style.position="static"):n.add("ag-row");let o=e.parentElement;for(;o;){if(["ag-header-row","ag-row"].some((e=>o.classList.contains(e)))){for(let e=0;e<o.classList.length;e++){const t=o.classList[e];"ag-row-position-absolute"!=t&&n.add(t)}break}o=o.parentElement}r.appendChild(i),t.appendChild(r)}},La=class extends He{constructor(e,t){super(),this.createRowCon=e,this.destroyRowCtrls=t,this.stickyTopRowCtrls=[],this.stickyBottomRowCtrls=[],this.extraTopHeight=0,this.extraBottomHeight=0}wireBeans(e){this.rowModel=e.rowModel,this.rowRenderer=e.rowRenderer,this.ctrlsService=e.ctrlsService,this.pageBoundsService=e.pageBoundsService}postConstruct(){this.isClientSide=G(this.gos),this.ctrlsService.whenReady(this,(e=>{this.gridBodyCtrl=e.gridBodyCtrl})),this.resetStickyContainers()}getStickyTopRowCtrls(){return this.stickyTopRowCtrls}getStickyBottomRowCtrls(){return this.stickyBottomRowCtrls}setOffsetTop(e){this.extraTopHeight!==e&&(this.extraTopHeight=e,this.eventService.dispatchEvent({type:"stickyTopOffsetChanged",offset:e}))}setOffsetBottom(e){this.extraBottomHeight!==e&&(this.extraBottomHeight=e)}resetOffsets(){this.setOffsetBottom(0),this.setOffsetTop(0)}getExtraTopHeight(){return this.extraTopHeight}getExtraBottomHeight(){return this.extraBottomHeight}getLastPixelOfGroup(e){return this.isClientSide?this.getClientSideLastPixelOfGroup(e):this.getServerSideLastPixelOfGroup(e)}getFirstPixelOfGroup(e){return e.footer?e.sibling.rowTop+e.sibling.rowHeight-1:e.hasChildren()?e.rowTop-1:0}getServerSideLastPixelOfGroup(e){if(this.isClientSide)throw new Error("This func should only be called in server side row model.");if(e.isExpandable()||e.footer){if(e.master)return e.detailNode.rowTop+e.detailNode.rowHeight;if(!e.sibling||1===Math.abs(e.sibling.rowIndex-e.rowIndex)){var t,i,r,n,o;let a=null===(t=e.childStore)||void 0===t?void 0:t.getStoreBounds();var s;if(e.footer)a=null===(s=e.sibling.childStore)||void 0===s?void 0:s.getStoreBounds();return(null!==(i=null===(r=a)||void 0===r?void 0:r.heightPx)&&void 0!==i?i:0)+(null!==(n=null===(o=a)||void 0===o?void 0:o.topPx)&&void 0!==n?n:0)}return e.footer?e.rowTop+e.rowHeight:e.sibling.rowTop+e.sibling.rowHeight}return Number.MAX_SAFE_INTEGER}getClientSideLastPixelOfGroup(e){if(!this.isClientSide)throw new Error("This func should only be called in client side row model.");if(e.isExpandable()||e.footer){if(e.footer&&0===e.rowIndex)return Number.MAX_SAFE_INTEGER;if(!e.sibling||1===Math.abs(e.sibling.rowIndex-e.rowIndex)){let t=e.footer?e.sibling:e;for(;t.isExpandable()&&t.expanded;)if(t.master)t=t.detailNode;else if(t.childrenAfterSort){if(0===t.childrenAfterSort.length)break;t=ye(t.childrenAfterSort)}return t.rowTop+t.rowHeight}return e.footer?e.rowTop+e.rowHeight:e.sibling.rowTop+e.sibling.rowHeight}return Number.MAX_SAFE_INTEGER}updateStickyRows(e){const t="top"===e;let i=0;if(!this.canRowsBeSticky())return this.refreshNodesAndContainerHeight(e,new Set,i);const r=t?this.rowRenderer.getFirstVisibleVerticalPixel()-this.extraTopHeight:this.rowRenderer.getLastVisibleVerticalPixel()-this.extraTopHeight,n=new Set,o=e=>{if(n.add(e),t){const t=this.getLastPixelOfGroup(e),n=r+i+e.rowHeight;e.stickyRowTop=t<n?i+(t-n):i}else{const t=this.getFirstPixelOfGroup(e),n=r-(i+e.rowHeight);e.stickyRowTop=t>n?i-(t-n):i}i=0,n.forEach((e=>{const t=e.stickyRowTop+e.rowHeight;i<t&&(i=t)}))},s=this.areFooterRowsStickySuppressed(),a=this.gos.get("suppressGroupRowsSticky"),l=t=>{if(!t.displayed)return!1;if(t.footer){if(!0===s)return!1;if("grand"===s&&-1===t.level)return!1;if("group"===s&&t.level>-1)return!1;const i=!!t.sibling.rowIndex&&t.sibling.rowIndex+1===t.rowIndex;if("bottom"===e&&i)return!1;return!n.has(t)}if(t.isExpandable()){if(!0===a)return!1;if("bottom"===e)return!1;return!n.has(t)&&t.expanded}return!1};for(let c=0;c<100;c++){let e=r+i;t||(e=r-i);const n=this.rowModel.getRowIndexAtPixel(e),s=this.rowModel.getRow(n);if(null==s)break;const a=this.getStickyAncestors(s).find((e=>(t?e.rowIndex<n:e.rowIndex>n)&&l(e)));if(a){o(a);continue}if(!(t?s.rowTop<e:s.rowTop+s.rowHeight>e)||!l(s))break;o(s)}return t||n.forEach((e=>{e.stickyRowTop=i-(e.stickyRowTop+e.rowHeight)})),this.refreshNodesAndContainerHeight(e,n,i)}areFooterRowsStickySuppressed(){const e=this.gos.get("suppressStickyTotalRow");if(!0===e)return!0;const t=!!this.gos.get("groupIncludeFooter")||"group"===e,i=!!this.gos.get("groupIncludeTotalFooter")||"grand"===e;return!(!t||!i)||(i?"grand":!!t&&"group")}canRowsBeSticky(){const e=ie(this.gos),t=this.areFooterRowsStickySuppressed(),i=this.gos.get("suppressGroupRowsSticky");return e&&(!t||!i)}getStickyAncestors(e){const t=[];let i=e.footer?e.sibling:e.parent;for(;i;)i.sibling&&t.push(i.sibling),t.push(i),i=i.parent;return t.reverse()}checkStickyRows(){const e=this.updateStickyRows("top"),t=this.updateStickyRows("bottom");return e||t}destroyStickyCtrls(){this.resetStickyContainers()}resetStickyContainers(){this.refreshNodesAndContainerHeight("top",new Set,0),this.refreshNodesAndContainerHeight("bottom",new Set,0)}refreshStickyNode(e){const t=new Set;if(this.stickyTopRowCtrls.some((t=>t.getRowNode()===e))){for(let i=0;i<this.stickyTopRowCtrls.length;i++){const r=this.stickyTopRowCtrls[i].getRowNode();r!==e&&t.add(r)}this.refreshNodesAndContainerHeight("top",t,this.topContainerHeight)&&this.checkStickyRows()}else{for(let i=0;i<this.stickyBottomRowCtrls.length;i++){const r=this.stickyBottomRowCtrls[i].getRowNode();r!==e&&t.add(r)}this.refreshNodesAndContainerHeight("bottom",t,this.bottomContainerHeight)&&this.checkStickyRows()}}refreshNodesAndContainerHeight(e,t,i){const r="top"===e,n=r?this.stickyTopRowCtrls:this.stickyBottomRowCtrls,o={},s=[];for(let h=0;h<n.length;h++){const e=n[h].getRowNode();!t.has(e)?(o[e.id]=n[h],e.sticky=!1):s.push(n[h])}const a=new Set;for(let h=0;h<s.length;h++)a.add(s[h].getRowNode());const l=[];t.forEach((e=>{a.has(e)||(e.sticky=!0,l.push(this.createRowCon(e,!1,!1)))}));let c=!!l.length||s.length!==n.length;r?this.topContainerHeight!==i&&(this.topContainerHeight=i,this.gridBodyCtrl.setStickyTopHeight(i),c=!0):this.bottomContainerHeight!==i&&(this.bottomContainerHeight=i,this.gridBodyCtrl.setStickyBottomHeight(i),c=!0),this.destroyRowCtrls(o,!1);const u=[...s,...l];u.sort(((e,t)=>t.getRowNode().rowIndex-e.getRowNode().rowIndex)),r||u.reverse(),u.forEach((e=>e.setRowTop(e.getRowNode().stickyRowTop)));let d=0;return r?(t.forEach((e=>{e.rowIndex<this.pageBoundsService.getFirstRow()&&(d+=e.rowHeight)})),d>this.topContainerHeight&&(d=this.topContainerHeight),this.setOffsetTop(d)):(t.forEach((e=>{e.rowIndex>this.pageBoundsService.getLastRow()&&(d+=e.rowHeight)})),d>this.bottomContainerHeight&&(d=this.bottomContainerHeight),this.setOffsetBottom(d)),!!c&&(r?this.stickyTopRowCtrls=u:this.stickyBottomRowCtrls=u,!0)}ensureRowHeightsValid(){let e=!1;const t=t=>{const i=t.getRowNode();if(i.rowHeightEstimated){const t=U(this.gos,i);i.setRowHeight(t.height),e=!0}};return this.stickyTopRowCtrls.forEach(t),this.stickyBottomRowCtrls.forEach(t),e}},Oa=class extends He{constructor(){super(...arguments),this.beanName="rowRenderer",this.destroyFuncsForColumnListeners=[],this.rowCtrlsByRowIndex={},this.zombieRowCtrls={},this.allRowCtrls=[],this.topRowCtrls=[],this.bottomRowCtrls=[],this.refreshInProgress=!1,this.dataFirstRenderedFired=!1,this.setupRangeSelectionListeners=()=>{const e=()=>{this.getAllCellCtrls().forEach((e=>e.onCellSelectionChanged()))},t=()=>{this.getAllCellCtrls().forEach((e=>e.updateRangeBordersIfRangeCount()))},i=()=>{this.eventService.addEventListener("cellSelectionChanged",e),this.eventService.addEventListener("columnMoved",t),this.eventService.addEventListener("columnPinned",t),this.eventService.addEventListener("columnVisible",t)},r=()=>{this.eventService.removeEventListener("cellSelectionChanged",e),this.eventService.removeEventListener("columnMoved",t),this.eventService.removeEventListener("columnPinned",t),this.eventService.removeEventListener("columnVisible",t)};this.addDestroyFunc((()=>r())),this.addManagedPropertyListeners(["enableRangeSelection","cellSelection"],(()=>{he(this.gos)?i():r()}));he(this.gos)&&i()}}wireBeans(e){this.animationFrameService=e.animationFrameService,this.paginationService=e.paginationService,this.pageBoundsService=e.pageBoundsService,this.columnModel=e.columnModel,this.visibleColsService=e.visibleColsService,this.pinnedRowModel=e.pinnedRowModel,this.rowModel=e.rowModel,this.focusService=e.focusService,this.beans=e,this.rowContainerHeightService=e.rowContainerHeightService,this.ctrlsService=e.ctrlsService,this.environment=e.environment}postConstruct(){this.ctrlsService.whenReady(this,(e=>{this.gridBodyCtrl=e.gridBodyCtrl,this.initialise()}))}initialise(){this.addManagedEventListeners({paginationChanged:this.onPageLoaded.bind(this),pinnedRowDataChanged:this.onPinnedRowDataChanged.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),bodyScroll:this.onBodyScroll.bind(this),bodyHeightChanged:this.redraw.bind(this,{})}),this.addManagedPropertyListeners(["domLayout","embedFullWidthRows"],(()=>this.onDomLayoutChanged())),this.addManagedPropertyListeners(["suppressMaxRenderedRowRestriction","rowBuffer"],(()=>this.redraw())),this.addManagedPropertyListener("suppressCellFocus",(e=>this.onSuppressCellFocusChanged(e.currentValue))),this.addManagedPropertyListeners(["groupSuppressBlankHeader","getBusinessKeyForNode","fullWidthCellRenderer","fullWidthCellRendererParams","suppressStickyTotalRow","groupRowRenderer","groupRowRendererParams","loadingCellRenderer","loadingCellRendererParams","detailCellRenderer","detailCellRendererParams","enableRangeSelection","enableCellTextSelection","rowSelection"],(()=>this.redrawRows())),ie(this.gos)&&(G(this.gos)||H(this.gos))&&(this.stickyRowFeature=this.createManagedBean(new La(this.createRowCon.bind(this),this.destroyRowCtrls.bind(this)))),this.registerCellEventListeners(),this.initialiseCache(),this.printLayout=z(this.gos,"print"),this.embedFullWidthRows=this.printLayout||this.gos.get("embedFullWidthRows"),this.redrawAfterModelUpdate()}initialiseCache(){if(this.gos.get("keepDetailRows")){const e=this.getKeepDetailRowsCount(),t=null!=e?e:3;this.cachedRowCtrls=new Na(t)}}getKeepDetailRowsCount(){return this.gos.get("keepDetailRowsCount")}getStickyTopRowCtrls(){return this.stickyRowFeature?this.stickyRowFeature.getStickyTopRowCtrls():[]}getStickyBottomRowCtrls(){return this.stickyRowFeature?this.stickyRowFeature.getStickyBottomRowCtrls():[]}updateAllRowCtrls(){const e=it(this.rowCtrlsByRowIndex),t=it(this.zombieRowCtrls),i=this.cachedRowCtrls?this.cachedRowCtrls.getEntries():[];t.length>0||i.length>0?this.allRowCtrls=[...e,...t,...i]:this.allRowCtrls=e}onCellFocusChanged(e){this.getAllCellCtrls().forEach((t=>t.onCellFocused(e))),this.getFullWidthRowCtrls().forEach((t=>t.onFullWidthRowFocused(e)))}onSuppressCellFocusChanged(e){this.getAllCellCtrls().forEach((t=>t.onSuppressCellFocusChanged(e))),this.getFullWidthRowCtrls().forEach((t=>t.onSuppressCellFocusChanged(e)))}registerCellEventListeners(){this.addManagedEventListeners({cellFocused:e=>{this.onCellFocusChanged(e)},cellFocusCleared:()=>this.onCellFocusChanged(),flashCells:e=>{this.getAllCellCtrls().forEach((t=>t.onFlashCells(e)))},columnHoverChanged:()=>{this.getAllCellCtrls().forEach((e=>e.onColumnHover()))},displayedColumnsChanged:()=>{this.getAllCellCtrls().forEach((e=>e.onDisplayedColumnsChanged()))},displayedColumnsWidthChanged:()=>{this.printLayout&&this.getAllCellCtrls().forEach((e=>e.onLeftChanged()))}}),this.setupRangeSelectionListeners(),this.refreshListenersToColumnsForCellComps(),this.addManagedEventListeners({gridColumnsChanged:this.refreshListenersToColumnsForCellComps.bind(this)}),this.addDestroyFunc(this.removeGridColumnListeners.bind(this))}removeGridColumnListeners(){this.destroyFuncsForColumnListeners.forEach((e=>e())),this.destroyFuncsForColumnListeners.length=0}refreshListenersToColumnsForCellComps(){this.removeGridColumnListeners();this.columnModel.getCols().forEach((e=>{const t=t=>{this.getAllCellCtrls().forEach((i=>{i.getColumn()===e&&t(i)}))},i=()=>{t((e=>e.onLeftChanged()))},r=()=>{t((e=>e.onWidthChanged()))},n=()=>{t((e=>e.onFirstRightPinnedChanged()))},o=()=>{t((e=>e.onLastLeftPinnedChanged()))},s=()=>{t((e=>e.onColDefChanged()))};e.addEventListener("leftChanged",i),e.addEventListener("widthChanged",r),e.addEventListener("firstRightPinnedChanged",n),e.addEventListener("lastLeftPinnedChanged",o),e.addEventListener("colDefChanged",s),this.destroyFuncsForColumnListeners.push((()=>{e.removeEventListener("leftChanged",i),e.removeEventListener("widthChanged",r),e.removeEventListener("firstRightPinnedChanged",n),e.removeEventListener("lastLeftPinnedChanged",o),e.removeEventListener("colDefChanged",s)}))}))}onDomLayoutChanged(){const e=z(this.gos,"print"),t=e||this.gos.get("embedFullWidthRows"),i=t!==this.embedFullWidthRows||this.printLayout!==e;this.printLayout=e,this.embedFullWidthRows=t,i&&this.redrawAfterModelUpdate({domLayoutChanged:!0})}datasourceChanged(){this.firstRenderedRow=0,this.lastRenderedRow=-1;const e=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(e)}onPageLoaded(e){const t={recycleRows:e.keepRenderedRows,animate:e.animate,newData:e.newData,newPage:e.newPage,onlyBody:!0};this.redrawAfterModelUpdate(t)}getAllCellsForColumn(e){const t=[];return this.getAllRowCtrls().forEach((i=>{const r=i.getCellElement(e);r&&t.push(r)})),t}refreshFloatingRowComps(){this.refreshFloatingRows(this.topRowCtrls,"top"),this.refreshFloatingRows(this.bottomRowCtrls,"bottom")}getTopRowCtrls(){return this.topRowCtrls}getCentreRowCtrls(){return this.allRowCtrls}getBottomRowCtrls(){return this.bottomRowCtrls}refreshFloatingRows(e,t){const{pinnedRowModel:i,beans:r,printLayout:n}=this,o=Object.fromEntries(e.map((e=>[e.getRowNode().id,e])));i.forEachPinnedRow(t,((s,a)=>{const l=e[a];l&&void 0===i.getPinnedRowById(l.getRowNode().id,t)&&(l.destroyFirstPass(),l.destroySecondPass()),s.id in o?(e[a]=o[s.id],delete o[s.id]):e[a]=new Os(s,r,!1,!1,n)}));const s="top"===t?i.getPinnedTopRowCount():i.getPinnedBottomRowCount();e.length=s}onPinnedRowDataChanged(){this.redrawAfterModelUpdate({recycleRows:!0})}redrawRow(e){var t;let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.sticky)this.stickyRowFeature.refreshStickyNode(e);else{if(null!==(t=this.cachedRowCtrls)&&void 0!==t&&t.has(e))return void this.cachedRowCtrls.removeRow(e);{const t=t=>{const i=t[e.rowIndex];i&&i.getRowNode()===e&&(i.destroyFirstPass(),i.destroySecondPass(),t[e.rowIndex]=this.createRowCon(e,!1,!1))};switch(e.rowPinned){case"top":t(this.topRowCtrls);break;case"bottom":t(this.bottomRowCtrls);break;default:t(this.rowCtrlsByRowIndex),this.updateAllRowCtrls()}}}i||this.dispatchDisplayedRowsChanged(!1)}redrawRows(e){if(null!=e)return null===e||void 0===e||e.forEach((e=>this.redrawRow(e,!0))),void this.dispatchDisplayedRowsChanged(!1);this.redrawAfterModelUpdate()}getCellToRestoreFocusToAfterRefresh(e){const t=null!==e&&void 0!==e&&e.suppressKeepFocus?null:this.focusService.getFocusCellToUseAfterRefresh();if(null==t)return null;const i=Z(this.gos),r=Y(this.gos,i,Ms.DOM_DATA_KEY_CELL_CTRL),n=Y(this.gos,i,Os.DOM_DATA_KEY_ROW_CTRL);return r||n?t:null}redrawAfterModelUpdate(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.getLockOnRefresh();const t=this.getCellToRestoreFocusToAfterRefresh(e);this.updateContainerHeights(),this.scrollToTopIfNewData(e);const i=!e.domLayoutChanged&&!!e.recycleRows,r=e.animate&&te(this.gos),n=i?this.getRowsToRecycle():null;if(i||this.removeAllRowComps(),this.workOutFirstAndLastRowsToRender(),this.stickyRowFeature){this.stickyRowFeature.checkStickyRows();const e=this.stickyRowFeature.getExtraTopHeight()+this.stickyRowFeature.getExtraBottomHeight();e&&this.updateContainerHeights(e)}this.recycleRows(n,r),this.gridBodyCtrl.updateRowCount(),e.onlyBody||this.refreshFloatingRowComps(),this.dispatchDisplayedRowsChanged(),null!=t&&this.restoreFocusedCell(t),this.releaseLockOnRefresh()}scrollToTopIfNewData(e){const t=e.newData||e.newPage,i=this.gos.get("suppressScrollOnNewData");var r;t&&!i&&(this.gridBodyCtrl.getScrollFeature().scrollToTop(),null===(r=this.stickyRowFeature)||void 0===r||r.resetOffsets())}updateContainerHeights(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this.printLayout)return void this.rowContainerHeightService.setModelHeight(null);let t=this.pageBoundsService.getCurrentPageHeight();0===t&&(t=1),this.rowContainerHeightService.setModelHeight(t+e)}getLockOnRefresh(){var e,t;if(this.refreshInProgress)throw new Error("AG Grid: cannot get grid to draw rows when it is in the middle of drawing rows. Your code probably called a grid API method while the grid was in the render stage. To overcome this, put the API call into a timeout, e.g. instead of api.redrawRows(), call setTimeout(function() { api.redrawRows(); }, 0). To see what part of your code that caused the refresh check this stacktrace.");this.refreshInProgress=!0,null===(e=(t=this.frameworkOverrides).getLockOnRefresh)||void 0===e||e.call(t)}releaseLockOnRefresh(){var e,t;this.refreshInProgress=!1,null===(e=(t=this.frameworkOverrides).releaseLockOnRefresh)||void 0===e||e.call(t)}isRefreshInProgress(){return this.refreshInProgress}restoreFocusedCell(e){e&&this.focusService.restoreFocusedCell(e,(()=>{this.onCellFocusChanged(this.gos.addGridCommonParams({rowIndex:e.rowIndex,column:e.column,rowPinned:e.rowPinned,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0,type:"cellFocused"}))}))}stopEditing(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.getAllRowCtrls().forEach((t=>{t.stopEditing(e)}))}getAllCellCtrls(){const e=[],t=this.getAllRowCtrls(),i=t.length;for(let r=0;r<i;r++){const i=t[r].getAllCellCtrls(),n=i.length;for(let t=0;t<n;t++)e.push(i[t])}return e}getAllRowCtrls(){const e=this.stickyRowFeature&&this.stickyRowFeature.getStickyTopRowCtrls()||[],t=this.stickyRowFeature&&this.stickyRowFeature.getStickyBottomRowCtrls()||[],i=[...this.topRowCtrls,...this.bottomRowCtrls,...e,...t];for(const r in this.rowCtrlsByRowIndex)i.push(this.rowCtrlsByRowIndex[r]);return i}addRenderedRowListener(e,t,i){const r=this.rowCtrlsByRowIndex[t];r&&r.addEventListener(e,i)}flashCells(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.getCellCtrls(e.rowNodes,e.columns).forEach((t=>t.flashCell(e)))}refreshCells(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t={forceRefresh:e.force,newData:!1,suppressFlash:e.suppressFlash};for(const i of this.getCellCtrls(e.rowNodes,e.columns))i.refreshOrDestroyCell(t);this.refreshFullWidth(e.rowNodes)}refreshFullWidth(e){if(!e)return;let t=null;this.stickyRowFeature&&Di()&&(t=this.getCellToRestoreFocusToAfterRefresh()||null);for(const i of this.getRowCtrls(e)){if(!i.isFullWidth())continue;i.refreshFullWidth()||this.redrawRow(i.getRowNode(),!0)}this.dispatchDisplayedRowsChanged(!1),t&&this.restoreFocusedCell(t)}getCellRendererInstances(e){var t;const i=this.getCellCtrls(e.rowNodes,e.columns).map((e=>e.getCellRenderer())).filter((e=>null!=e));if(null!==(t=e.columns)&&void 0!==t&&t.length)return i;const r=[],n=this.mapRowNodes(e.rowNodes);return this.getAllRowCtrls().forEach((e=>{if(n&&!this.isRowInMap(e.getRowNode(),n))return;if(!e.isFullWidth())return;const t=e.getFullWidthCellRenderers();for(let i=0;i<t.length;i++){const e=t[i];null!=e&&r.push(e)}})),[...r,...i]}getCellEditorInstances(e){const t=[];return this.getCellCtrls(e.rowNodes,e.columns).forEach((e=>{const i=e.getCellEditor();i&&t.push(i)})),t}getEditingCells(){const e=[];return this.getAllCellCtrls().forEach((t=>{if(t.isEditing()){const i=t.getCellPosition();e.push(i)}})),e}mapRowNodes(e){if(!e)return;const t={top:{},bottom:{},normal:{}};return e.forEach((e=>{const i=e.id;switch(e.rowPinned){case"top":t.top[i]=e;break;case"bottom":t.bottom[i]=e;break;default:t.normal[i]=e}})),t}isRowInMap(e,t){const i=e.id;switch(e.rowPinned){case"top":return null!=t.top[i];case"bottom":return null!=t.bottom[i];default:return null!=t.normal[i]}}getRowCtrls(e){const t=this.mapRowNodes(e),i=this.getAllRowCtrls();return e&&t?i.filter((e=>{const i=e.getRowNode();return this.isRowInMap(i,t)})):i}getCellCtrls(e,t){let i;F(t)&&(i={},t.forEach((e=>{const t=this.columnModel.getCol(e);F(t)&&(i[t.getId()]=!0)})));const r=[];return this.getRowCtrls(e).forEach((e=>{e.getAllCellCtrls().forEach((e=>{const t=e.getColumn().getId();i&&!i[t]||r.push(e)}))})),r}destroy(){this.removeAllRowComps(!0),super.destroy()}removeAllRowComps(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(t,e),this.stickyRowFeature&&this.stickyRowFeature.destroyStickyCtrls()}getRowsToRecycle(){const e=[];Ze(this.rowCtrlsByRowIndex,((t,i)=>{null==i.getRowNode().id&&e.push(t)})),this.removeRowCtrls(e);const t={};return Ze(this.rowCtrlsByRowIndex,((e,i)=>{const r=i.getRowNode();t[r.id]=i})),this.rowCtrlsByRowIndex={},t}removeRowCtrls(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.forEach((e=>{const i=this.rowCtrlsByRowIndex[e];i&&(i.destroyFirstPass(t),i.destroySecondPass()),delete this.rowCtrlsByRowIndex[e]}))}onBodyScroll(e){"vertical"===e.direction&&this.redraw({afterScroll:!0})}redraw(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{afterScroll:t}=e;let i;this.stickyRowFeature&&Di()&&(i=this.getCellToRestoreFocusToAfterRefresh()||void 0);const r=this.firstRenderedRow,n=this.lastRenderedRow;this.workOutFirstAndLastRowsToRender();let o=!1;if(this.stickyRowFeature){o=this.stickyRowFeature.checkStickyRows();const e=this.stickyRowFeature.getExtraTopHeight()+this.stickyRowFeature.getExtraBottomHeight();e&&this.updateContainerHeights(e)}const s=this.firstRenderedRow!==r||this.lastRenderedRow!==n;if((!t||o||s)&&(this.getLockOnRefresh(),this.recycleRows(null,!1,t),this.releaseLockOnRefresh(),this.dispatchDisplayedRowsChanged(t&&!o),null!=i)){const e=this.getCellToRestoreFocusToAfterRefresh();null!=i&&null==e&&(this.animationFrameService.flushAllFrames(),this.restoreFocusedCell(i))}}removeRowCompsNotToDraw(e,t){const i={};e.forEach((e=>i[e]=!0));const r=Object.keys(this.rowCtrlsByRowIndex).filter((e=>!i[e]));this.removeRowCtrls(r,t)}calculateIndexesToDraw(e){const t=function(e,t){const i=[];for(let r=e;r<=t;r++)i.push(r);return i}(this.firstRenderedRow,this.lastRenderedRow),i=(e,i)=>{const r=i.getRowNode().rowIndex;null!=r&&(r<this.firstRenderedRow||r>this.lastRenderedRow)&&this.doNotUnVirtualiseRow(i)&&t.push(r)};Ze(this.rowCtrlsByRowIndex,i),Ze(e,i),t.sort(((e,t)=>e-t));const r=[];for(let n=0;n<t.length;n++){const e=t[n],i=this.rowModel.getRow(e);i&&!i.sticky&&r.push(e)}return r}recycleRows(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=this.calculateIndexesToDraw(e);(this.printLayout||i)&&(t=!1),this.removeRowCompsNotToDraw(r,!t);const n=[];if(r.forEach((r=>{const o=this.createOrUpdateRowCtrl(r,e,t,i);F(o)&&n.push(o)})),e){i&&!this.gos.get("suppressAnimationFrame")&&!this.printLayout?this.beans.animationFrameService.addDestroyTask((()=>{this.destroyRowCtrls(e,t),this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged()})):this.destroyRowCtrls(e,t)}this.updateAllRowCtrls()}dispatchDisplayedRowsChanged(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.eventService.dispatchEvent({type:"displayedRowsChanged",afterScroll:e})}onDisplayedColumnsChanged(){const e=this.visibleColsService.isPinningLeft(),t=this.visibleColsService.isPinningRight();(this.pinningLeft!==e||t!==this.pinningRight)&&(this.pinningLeft=e,this.pinningRight=t,this.embedFullWidthRows&&this.redrawFullWidthEmbeddedRows())}redrawFullWidthEmbeddedRows(){const e=[];this.getFullWidthRowCtrls().forEach((t=>{const i=t.getRowNode().rowIndex;e.push(i.toString())})),this.refreshFloatingRowComps(),this.removeRowCtrls(e),this.redraw({afterScroll:!0})}getFullWidthRowCtrls(e){const t=this.mapRowNodes(e);return this.getAllRowCtrls().filter((e=>{if(!e.isFullWidth())return!1;const i=e.getRowNode();return!(null!=t&&!this.isRowInMap(i,t))}))}createOrUpdateRowCtrl(e,t,i,r){let n,o=this.rowCtrlsByRowIndex[e];o||(n=this.rowModel.getRow(e),F(n)&&F(t)&&t[n.id]&&n.alreadyRendered&&(o=t[n.id],t[n.id]=null));if(!o){if(n||(n=this.rowModel.getRow(e)),!F(n))return;o=this.createRowCon(n,i,r)}return n&&(n.alreadyRendered=!0),this.rowCtrlsByRowIndex[e]=o,o}destroyRowCtrls(e,t){const i=[];Ze(e,((e,r)=>{if(r)if(this.cachedRowCtrls&&r.isCacheable())this.cachedRowCtrls.addRow(r);else if(r.destroyFirstPass(!t),t){const e=r.instanceId;this.zombieRowCtrls[e]=r,i.push((()=>{r.destroySecondPass(),delete this.zombieRowCtrls[e]}))}else r.destroySecondPass()})),t&&(i.push((()=>{this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged()})),b(i))}getRowBuffer(){return this.gos.get("rowBuffer")}getRowBufferInPixels(){return this.getRowBuffer()*j(this.gos)}workOutFirstAndLastRowsToRender(){let e,t;if(this.rowContainerHeightService.updateOffset(),this.rowModel.isRowsToRender())if(this.printLayout)this.environment.refreshRowHeightVariable(),e=this.pageBoundsService.getFirstRow(),t=this.pageBoundsService.getLastRow();else{const i=this.getRowBufferInPixels(),r=this.ctrlsService.getGridBodyCtrl(),n=this.gos.get("suppressRowVirtualisation");let o,s,a=!1;do{const e=this.pageBoundsService.getPixelOffset(),{pageFirstPixel:t,pageLastPixel:l}=this.pageBoundsService.getCurrentPagePixelRange(),c=this.rowContainerHeightService.getDivStretchOffset(),u=r.getScrollFeature().getVScrollPosition(),d=u.top,h=u.bottom;n?(o=t+c,s=l+c):(o=Math.max(d+e-i,t)+c,s=Math.min(h+e+i,l)+c),this.firstVisibleVPixel=Math.max(d+e,t)+c,this.lastVisibleVPixel=Math.min(h+e,l)+c,a=this.ensureAllRowsInRangeHaveHeightsCalculated(o,s)}while(a);let l=this.rowModel.getRowIndexAtPixel(o),c=this.rowModel.getRowIndexAtPixel(s);const u=this.pageBoundsService.getFirstRow(),d=this.pageBoundsService.getLastRow();l<u&&(l=u),c>d&&(c=d),e=l,t=c}else e=0,t=-1;const i=z(this.gos,"normal"),r=this.gos.get("suppressMaxRenderedRowRestriction"),n=Math.max(this.getRowBuffer(),500);i&&!r&&t-e>n&&(t=e+n);const o=e!==this.firstRenderedRow,s=t!==this.lastRenderedRow;(o||s)&&(this.firstRenderedRow=e,this.lastRenderedRow=t,this.eventService.dispatchEvent({type:"viewportChanged",firstRow:e,lastRow:t}))}dispatchFirstDataRenderedEvent(){this.dataFirstRenderedFired||(this.dataFirstRenderedFired=!0,window.requestAnimationFrame((()=>{this.beans.eventService.dispatchEvent({type:"firstDataRendered",firstRow:this.firstRenderedRow,lastRow:this.lastRenderedRow})})))}ensureAllRowsInRangeHaveHeightsCalculated(e,t){var i,r;const n=null===(i=this.pinnedRowModel)||void 0===i?void 0:i.ensureRowHeightsValid(),o=null===(r=this.stickyRowFeature)||void 0===r?void 0:r.ensureRowHeightsValid(),s=this.rowModel.ensureRowHeightsValid(e,t,this.pageBoundsService.getFirstRow(),this.pageBoundsService.getLastRow());return(s||o)&&this.eventService.dispatchEvent({type:"recalculateRowBounds"}),!!(o||s||n)&&(this.updateContainerHeights(),!0)}getFirstVisibleVerticalPixel(){return this.firstVisibleVPixel}getLastVisibleVerticalPixel(){return this.lastVisibleVPixel}getFirstVirtualRenderedRow(){return this.firstRenderedRow}getLastVirtualRenderedRow(){return this.lastRenderedRow}doNotUnVirtualiseRow(e){const t=!1,i=e.getRowNode(),r=this.focusService.isRowNodeFocused(i),n=e.isEditing(),o=i.detail;if(!(r||n||o))return t;return!!this.isRowPresent(i)||t}isRowPresent(e){return!!this.rowModel.isRowPresent(e)&&(!this.paginationService||this.paginationService.isRowPresent(e))}createRowCon(e,t,i){const r=this.cachedRowCtrls?this.cachedRowCtrls.getRow(e):null;if(r)return r;const n=this.gos.get("suppressAnimationFrame"),o=i&&!n&&!this.printLayout;return new Os(e,this.beans,t,o,this.printLayout)}getRenderedNodes(){const e=this.rowCtrlsByRowIndex;return Object.values(e).map((e=>e.getRowNode()))}getRowByPosition(e){let t;const{rowIndex:i}=e;switch(e.rowPinned){case"top":t=this.topRowCtrls[i];break;case"bottom":t=this.bottomRowCtrls[i];break;default:t=this.rowCtrlsByRowIndex[i],t||(t=this.getStickyTopRowCtrls().find((e=>e.getRowNode().rowIndex===i))||null,t||(t=this.getStickyBottomRowCtrls().find((e=>e.getRowNode().rowIndex===i))||null))}return t}isRangeInRenderedViewport(e,t){if(null==e||null==t)return!1;const i=e>this.lastRenderedRow;return!(t<this.firstRenderedRow)&&!i}},Na=class{constructor(e){this.entriesMap={},this.entriesList=[],this.maxCount=e}addRow(e){if(this.entriesMap[e.getRowNode().id]=e,this.entriesList.push(e),e.setCached(!0),this.entriesList.length>this.maxCount){const e=this.entriesList[0];e.destroyFirstPass(),e.destroySecondPass(),this.removeFromCache(e)}}getRow(e){if(null==e||null==e.id)return null;const t=this.entriesMap[e.id];if(!t)return null;this.removeFromCache(t),t.setCached(!1);return t.getRowNode()!=e?null:t}has(e){return null!=this.entriesMap[e.id]}removeRow(e){const t=e.id,i=this.entriesMap[t];delete this.entriesMap[t],xe(this.entriesList,i)}removeFromCache(e){const t=e.getRowNode().id;delete this.entriesMap[t],xe(this.entriesList,e)}getEntries(){return this.entriesList}},Ba=class extends He{constructor(){super(...arguments),this.beanName="pinnedRowModel",this.nextId=0,this.pinnedTopRows=new Ga,this.pinnedBottomRows=new Ga}wireBeans(e){this.beans=e}postConstruct(){this.setPinnedRowData(this.gos.get("pinnedTopRowData"),"top"),this.setPinnedRowData(this.gos.get("pinnedBottomRowData"),"bottom"),this.addManagedPropertyListener("pinnedTopRowData",(e=>this.setPinnedRowData(e.currentValue,"top"))),this.addManagedPropertyListener("pinnedBottomRowData",(e=>this.setPinnedRowData(e.currentValue,"bottom"))),this.addManagedEventListeners({gridStylesChanged:this.onGridStylesChanges.bind(this)})}isEmpty(e){return("top"===e?this.pinnedTopRows:this.pinnedBottomRows).isEmpty()}isRowsToRender(e){return!this.isEmpty(e)}onGridStylesChanges(e){if(e.rowHeightChanged){const e=e=>{e.setRowHeight(e.rowHeight,!0)};this.pinnedBottomRows.forEach(e),this.pinnedTopRows.forEach(e)}}ensureRowHeightsValid(){var e,t;let i=!1,r=0;const n=e=>{if(e.rowHeightEstimated){const t=U(this.gos,e);e.setRowTop(r),e.setRowHeight(t.height),r+=t.height,i=!0}};return null===(e=this.pinnedBottomRows)||void 0===e||e.forEach(n),r=0,null===(t=this.pinnedTopRows)||void 0===t||t.forEach(n),this.eventService.dispatchEvent({type:"pinnedHeightChanged"}),i}setPinnedRowData(e,t){this.updateNodesFromRowData(e,t),this.eventService.dispatchEvent({type:"pinnedRowDataChanged"})}updateNodesFromRowData(e,t){const i="top"===t?this.pinnedTopRows:this.pinnedBottomRows;if(void 0===e)return void i.clear();const r=ce(this.gos),n="top"===t?Dn.ID_PREFIX_TOP_PINNED:Dn.ID_PREFIX_BOTTOM_PINNED,o=i.getIds(),s=[],a=new Set;let l=0,c=-1;for(const d of e){var u;const e=null!==(u=null===r||void 0===r?void 0:r({data:d,level:0,rowPinned:t}))&&void 0!==u?u:n+this.nextId++;if(a.has(e)){v("Duplicate ID",e,"found for pinned row with data",d,"When `getRowId` is defined, it must return unique IDs for all pinned rows. Use the `rowPinned` parameter.");continue}c++,a.add(e),s.push(e);const h=i.getById(e);if(void 0!==h)h.data!==d&&h.setData(d),l+=this.setRowTopAndRowIndex(h,l,c),o.delete(e);else{const r=new Dn(this.beans);r.id=e,r.data=d,r.rowPinned=t,l+=this.setRowTopAndRowIndex(r,l,c),i.push(r)}}o.forEach((e=>{var t;null===(t=i.getById(e))||void 0===t||t.clearRowTopAndRowIndex()})),i.removeAllById(o),i.setOrder(s)}setRowTopAndRowIndex(e,t,i){return e.setRowTop(t),e.setRowHeight(U(this.gos,e).height),e.setRowIndex(i),e.rowHeight}getPinnedTopTotalHeight(){return this.getTotalHeight(this.pinnedTopRows)}getPinnedBottomTotalHeight(){return this.getTotalHeight(this.pinnedBottomRows)}getPinnedTopRowCount(){return this.pinnedTopRows.getSize()}getPinnedBottomRowCount(){return this.pinnedBottomRows.getSize()}getPinnedTopRow(e){return this.pinnedTopRows.getByIndex(e)}getPinnedBottomRow(e){return this.pinnedBottomRows.getByIndex(e)}getPinnedRowById(e,t){return"top"===t?this.pinnedTopRows.getById(e):this.pinnedBottomRows.getById(e)}forEachPinnedRow(e,t){return"top"===e?this.pinnedTopRows.forEach(t):this.pinnedBottomRows.forEach(t)}getTotalHeight(e){const t=e.getSize();if(0===t)return 0;const i=e.getByIndex(t-1);return void 0===i?0:i.rowTop+i.rowHeight}},Ga=class{constructor(){this.cache={},this.ordering=[]}getById(e){return this.cache[e]}getByIndex(e){const t=this.ordering[e];return this.cache[t]}push(e){this.cache[e.id]=e,this.ordering.push(e.id)}removeAllById(e){for(const t of e)delete this.cache[t];this.ordering=this.ordering.filter((t=>!e.has(t)))}setOrder(e){this.ordering=e}forEach(e){this.ordering.forEach(((t,i)=>{const r=this.cache[t];r&&e(r,i)}))}clear(){this.ordering.length=0,this.cache={}}isEmpty(){return 0===this.ordering.length}getSize(){return this.ordering.length}getIds(){return new Set(this.ordering)}},Ha=class extends He{constructor(e){super(),this.state="needsLoading",this.version=0,this.id=e}getId(){return this.id}load(){this.state="loading",this.loadFromDatasource()}getVersion(){return this.version}setStateWaitingToLoad(){this.version++,this.state="needsLoading"}getState(){return this.state}pageLoadFailed(e){this.isRequestMostRecentAndLive(e)&&(this.state="failed",this.processServerFail()),this.dispatchLoadCompleted(!1)}success(e,t){this.successCommon(e,t)}pageLoaded(e,t,i){this.successCommon(e,{rowData:t,rowCount:i})}isRequestMostRecentAndLive(e){const t=e===this.version,i=this.isAlive();return t&&i}successCommon(e,t){this.dispatchLoadCompleted();this.isRequestMostRecentAndLive(e)&&(this.state="loaded",this.processServerResult(t))}dispatchLoadCompleted(){const e={type:"loadComplete",success:!(arguments.length>0&&void 0!==arguments[0])||arguments[0],block:this};this.dispatchLocalEvent(e)}},za={version:Do,moduleName:"@ag-grid-community/row-node-block",beans:[class extends He{constructor(){super(...arguments),this.beanName="rowNodeBlockLoader",this.activeBlockLoadsCount=0,this.blocks=[],this.active=!0}wireBeans(e){this.rowModel=e.rowModel}postConstruct(){this.maxConcurrentRequests=this.getMaxConcurrentDatasourceRequests();const e=this.gos.get("blockLoadDebounceMillis");e&&e>0&&(this.checkBlockToLoadDebounce=E(this.performCheckBlocksToLoad.bind(this),e))}getMaxConcurrentDatasourceRequests(){const e=this.gos.get("maxConcurrentDatasourceRequests");return null==e?2:e<=0?void 0:e}addBlock(e){this.blocks.push(e),e.addEventListener("loadComplete",this.loadComplete.bind(this)),this.checkBlockToLoad()}removeBlock(e){xe(this.blocks,e)}destroy(){super.destroy(),this.active=!1}loadComplete(){this.activeBlockLoadsCount--,this.checkBlockToLoad(),this.dispatchLocalEvent({type:"blockLoaded"}),0==this.activeBlockLoadsCount&&this.dispatchLocalEvent({type:"blockLoaderFinished"})}checkBlockToLoad(){this.checkBlockToLoadDebounce?this.checkBlockToLoadDebounce():this.performCheckBlocksToLoad()}performCheckBlocksToLoad(){if(!this.active)return;if(this.printCacheStatus(),null!=this.maxConcurrentRequests&&this.activeBlockLoadsCount>=this.maxConcurrentRequests)return void(this.gos.get("debug")&&m("RowNodeBlockLoader - checkBlockToLoad: max loads exceeded"));const e=this.getAvailableLoadingCount(),t=this.blocks.filter((e=>"needsLoading"===e.getState())).slice(0,e);this.registerLoads(t.length),t.forEach((e=>e.load())),this.printCacheStatus()}getBlockState(){if(H(this.gos)){return this.rowModel.getBlockStates()}const e={};return this.blocks.forEach((t=>{const{id:i,state:r}=t.getBlockStateJson();e[i]=r})),e}printCacheStatus(){this.gos.get("debug")&&m("RowNodeBlockLoader - printCacheStatus: activePageLoadsCount = ".concat(this.activeBlockLoadsCount,", blocks = ").concat(JSON.stringify(this.getBlockState())))}isLoading(){return this.activeBlockLoadsCount>0}registerLoads(e){this.activeBlockLoadsCount+=e}getAvailableLoadingCount(){return void 0!==this.maxConcurrentRequests?this.maxConcurrentRequests-this.activeBlockLoadsCount:void 0}}]},Va=class{constructor(){this.root=null,this.end=null,this.cachedRange=[]}init(e){this.rowModel=e}reset(){this.root=null,this.end=null,this.cachedRange.length=0}setRoot(e){this.root=e,this.end=null,this.cachedRange.length=0}setEndRange(e){this.end=e,this.cachedRange.length=0}getRange(){if(0===this.cachedRange.length){const e=this.getRoot(),t=this.getEnd();if(null==e||null==t)return this.cachedRange;this.cachedRange=this.rowModel.getNodesInRangeForSelection(e,t)}return this.cachedRange}isInRange(e){return null!==this.root&&this.getRange().some((t=>t.id===e.id))}getRoot(){var e,t;this.root&&null===(null===(e=this.root)||void 0===e?void 0:e.key)&&(this.root=null!==(t=this.rowModel.getRowNode(this.root.id))&&void 0!==t?t:null);return this.root}getEnd(){var e,t;this.end&&null===(null===(e=this.end)||void 0===e?void 0:e.key)&&(this.end=null!==(t=this.rowModel.getRowNode(this.end.id))&&void 0!==t?t:null);return this.end}truncate(e){const t=this.getRange();if(0===t.length)return{keep:[],discard:[]};const i=t[0].id===this.root.id,r=t.findIndex((t=>t.id===e.id));if(r>-1){const n=t.slice(0,r),o=t.slice(r+1);return this.setEndRange(e),i?{keep:n,discard:o}:{keep:o,discard:n}}return{keep:t,discard:[]}}extend(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i=this.getRoot();if(null==i){const i=this.getRange().slice();return t&&e.depthFirstSearch((e=>!e.group&&i.push(e))),i.push(e),this.setRoot(e),{keep:i,discard:[]}}if(this.rowModel.getNodesInRangeForSelection(i,e).find((e=>{var t;return e.id===(null===(t=this.end)||void 0===t?void 0:t.id)})))return this.setEndRange(e),{keep:this.getRange(),discard:[]};{const t=this.getRange().slice();return this.setEndRange(e),{keep:this.getRange(),discard:t}}}},_a=class extends He{constructor(){super(...arguments),this.beanName="stylingService"}wireBeans(e){this.expressionService=e.expressionService}processAllCellClasses(e,t,i,r){this.processClassRules(void 0,e.cellClassRules,t,i,r),this.processStaticCellClasses(e,t,i)}processClassRules(e,t,i,r,n){if(null==t&&null==e)return;const o={},s={},a=(e,t)=>{e.split(" ").forEach((e=>{""!=e.trim()&&t(e)}))};if(t){const e=Object.keys(t);for(let r=0;r<e.length;r++){const n=e[r],l=t[n];let c;"string"===typeof l?c=this.expressionService.evaluate(l,i):"function"===typeof l&&(c=l(i)),a(n,(e=>{c?o[e]=!0:s[e]=!0}))}}e&&n&&Object.keys(e).forEach((e=>a(e,(e=>{o[e]||(s[e]=!0)})))),n&&Object.keys(s).forEach(n),Object.keys(o).forEach(r)}getStaticCellClasses(e,t){const{cellClass:i}=e;if(!i)return[];let r;if("function"===typeof i){r=i(t)}else r=i;return"string"===typeof r&&(r=[r]),r||[]}processStaticCellClasses(e,t,i){this.getStaticCellClasses(e,t).forEach((e=>{i(e)}))}},Wa=(e=>(e.TAB_GUARD="ag-tab-guard",e.TAB_GUARD_TOP="ag-tab-guard-top",e.TAB_GUARD_BOTTOM="ag-tab-guard-bottom",e))(Wa||{}),Ua=class extends He{constructor(e){super(),this.skipTabGuardFocus=!1,this.forcingFocusOut=!1,this.allowFocus=!1;const{comp:t,eTopGuard:i,eBottomGuard:r,focusTrapActive:n,forceFocusOutWhenTabGuardsAreEmpty:o,isFocusableContainer:s,focusInnerElement:a,onFocusIn:l,onFocusOut:c,shouldStopEventPropagation:u,onTabKeyDown:d,handleKeyDown:h,eFocusableElement:g}=e;this.comp=t,this.eTopGuard=i,this.eBottomGuard=r,this.providedFocusInnerElement=a,this.eFocusableElement=g,this.focusTrapActive=!!n,this.forceFocusOutWhenTabGuardsAreEmpty=!!o,this.isFocusableContainer=!!s,this.providedFocusIn=l,this.providedFocusOut=c,this.providedShouldStopEventPropagation=u,this.providedOnTabKeyDown=d,this.providedHandleKeyDown=h}wireBeans(e){this.focusService=e.focusService}postConstruct(){this.createManagedBean(new Nn(this.eFocusableElement,{shouldStopEventPropagation:()=>this.shouldStopEventPropagation(),onTabKeyDown:e=>this.onTabKeyDown(e),handleKeyDown:e=>this.handleKeyDown(e),onFocusIn:e=>this.onFocusIn(e),onFocusOut:e=>this.onFocusOut(e)})),this.activateTabGuards(),[this.eTopGuard,this.eBottomGuard].forEach((e=>this.addManagedElementListeners(e,{focus:this.onFocus.bind(this)})))}handleKeyDown(e){this.providedHandleKeyDown&&this.providedHandleKeyDown(e)}tabGuardsAreActive(){return!!this.eTopGuard&&this.eTopGuard.hasAttribute("tabIndex")}shouldStopEventPropagation(){return!!this.providedShouldStopEventPropagation&&this.providedShouldStopEventPropagation()}activateTabGuards(){if(this.forcingFocusOut)return;const e=this.gos.get("tabIndex");this.comp.setTabIndex(e.toString())}deactivateTabGuards(){this.comp.setTabIndex()}onFocus(e){if(this.isFocusableContainer&&!this.eFocusableElement.contains(e.relatedTarget)&&!this.allowFocus)return void this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard);if(this.skipTabGuardFocus)return void(this.skipTabGuardFocus=!1);if(this.forceFocusOutWhenTabGuardsAreEmpty){if(0===this.focusService.findFocusableElements(this.eFocusableElement,".ag-tab-guard").length)return void this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard)}if(this.isFocusableContainer&&this.eFocusableElement.contains(e.relatedTarget))return;const t=e.target===this.eBottomGuard;this.providedFocusInnerElement?this.providedFocusInnerElement(t):this.focusInnerElement(t)}findNextElementOutsideAndFocus(e){var t;const i=Q(this.gos),r=this.focusService.findFocusableElements(i.body,null,!0),n=r.indexOf(e?this.eTopGuard:this.eBottomGuard);if(-1===n)return;let o,s;e?(o=0,s=n):(o=n+1,s=r.length);const a=r.slice(o,s),l=this.gos.get("tabIndex");a.sort(((e,t)=>{const i=parseInt(e.getAttribute("tabindex")||"0"),r=parseInt(t.getAttribute("tabindex")||"0");return r===l?1:i===l?-1:0===i?1:0===r?-1:i-r})),null===(t=a[e?a.length-1:0])||void 0===t||t.focus()}onFocusIn(e){this.focusTrapActive||this.forcingFocusOut||(this.providedFocusIn&&this.providedFocusIn(e),this.isFocusableContainer||this.deactivateTabGuards())}onFocusOut(e){this.focusTrapActive||(this.providedFocusOut&&this.providedFocusOut(e),this.eFocusableElement.contains(e.relatedTarget)||this.activateTabGuards())}onTabKeyDown(e){if(this.providedOnTabKeyDown)return void this.providedOnTabKeyDown(e);if(this.focusTrapActive)return;if(e.defaultPrevented)return;const t=this.tabGuardsAreActive();t&&this.deactivateTabGuards();const i=this.getNextFocusableElement(e.shiftKey);t&&setTimeout((()=>this.activateTabGuards()),0),i&&(i.focus(),e.preventDefault())}focusInnerElement(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.focusService.findFocusableElements(this.eFocusableElement);this.tabGuardsAreActive()&&(t.splice(0,1),t.splice(t.length-1,1)),t.length&&t[e?t.length-1:0].focus({preventScroll:!0})}getNextFocusableElement(e){return this.focusService.findNextFocusableElement(this.eFocusableElement,!1,e)}forceFocusOutOfContainer(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.forcingFocusOut)return;const t=e?this.eTopGuard:this.eBottomGuard;this.activateTabGuards(),this.skipTabGuardFocus=!0,this.forcingFocusOut=!0,t.focus(),window.setTimeout((()=>{this.forcingFocusOut=!1,this.activateTabGuards()}))}isTabGuard(e,t){return e===this.eTopGuard&&!t||e===this.eBottomGuard&&(null===t||void 0===t||t)}setAllowFocus(e){this.allowFocus=e}},ja=class extends He{constructor(e){super(),this.comp=e}initialiseTabGuard(e){this.eTopGuard=this.createTabGuard("top"),this.eBottomGuard=this.createTabGuard("bottom"),this.eFocusableElement=this.comp.getFocusableElement();const{eTopGuard:t,eBottomGuard:i,eFocusableElement:r}=this,n=[t,i],o={setTabIndex:e=>{n.forEach((t=>null!=e?t.setAttribute("tabindex",e):t.removeAttribute("tabindex")))}};this.addTabGuards(t,i);const{focusTrapActive:s=!1,onFocusIn:a,onFocusOut:l,focusInnerElement:c,handleKeyDown:u,onTabKeyDown:d,shouldStopEventPropagation:h,forceFocusOutWhenTabGuardsAreEmpty:g,isFocusableContainer:p}=e;this.tabGuardCtrl=this.createManagedBean(new Ua({comp:o,focusTrapActive:s,eTopGuard:t,eBottomGuard:i,eFocusableElement:r,onFocusIn:a,onFocusOut:l,focusInnerElement:c,handleKeyDown:u,onTabKeyDown:d,shouldStopEventPropagation:h,forceFocusOutWhenTabGuardsAreEmpty:g,isFocusableContainer:p}))}getTabGuardCtrl(){return this.tabGuardCtrl}createTabGuard(e){const t=Q(this.gos).createElement("div"),i="top"===e?"ag-tab-guard-top":"ag-tab-guard-bottom";return t.classList.add("ag-tab-guard",i),ci(t,"presentation"),t}addTabGuards(e,t){this.eFocusableElement.insertAdjacentElement("afterbegin",e),this.eFocusableElement.insertAdjacentElement("beforeend",t)}removeAllChildrenExceptTabGuards(){const e=[this.eTopGuard,this.eBottomGuard];Yi(this.comp.getFocusableElement()),this.addTabGuards(...e)}forceFocusOutOfContainer(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.tabGuardCtrl.forceFocusOutOfContainer(e)}appendChild(e,t,i){ir(t)||(t=t.getGui());const{eBottomGuard:r}=this;r?r.insertAdjacentElement("beforebegin",t):e(t,i)}},Ka=class extends dr{initialiseTabGuard(e){this.tabGuardFeature=this.createManagedBean(new ja(this)),this.tabGuardFeature.initialiseTabGuard(e)}forceFocusOutOfContainer(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.tabGuardFeature.forceFocusOutOfContainer(e)}appendChild(e,t){this.tabGuardFeature.appendChild(super.appendChild.bind(this),e,t)}},Ya=0,qa=class extends He{constructor(){super(...arguments),this.beanName="popupService",this.popupList=[]}wireBeans(e){this.ctrlsService=e.ctrlsService,this.resizeObserverService=e.resizeObserverService,this.environment=e.environment}postConstruct(){this.ctrlsService.whenReady(this,(e=>{this.gridCtrl=e.gridCtrl})),this.addManagedEventListeners({gridStylesChanged:this.handleThemeChange.bind(this)})}getPopupParent(){const e=this.gos.get("popupParent");return e||this.gridCtrl.getGui()}positionPopupForMenu(e){const{eventSource:t,ePopup:i}=e,r=this.getPopupIndex(i);if(-1!==r){this.popupList[r].alignedToElement=t}const n=t.getBoundingClientRect(),o=this.getParentRect(),s=this.keepXYWithinBounds(i,n.top-o.top,0),a=i.clientWidth>0?i.clientWidth:200;i.style.minWidth="".concat(a,"px");const l=o.right-o.left-a;let c;function u(){return n.right-o.left-2}function d(){return n.left-o.left-a}this.gos.get("enableRtl")?(c=d(),c<0&&(c=u(),this.setAlignedStyles(i,"left")),c>l&&(c=0,this.setAlignedStyles(i,"right"))):(c=u(),c>l&&(c=d(),this.setAlignedStyles(i,"right")),c<0&&(c=0,this.setAlignedStyles(i,"left"))),i.style.left="".concat(c,"px"),i.style.top="".concat(s,"px")}positionPopupUnderMouseEvent(e){const{ePopup:t,nudgeX:i,nudgeY:r,skipObserver:n}=e;this.positionPopup({ePopup:t,nudgeX:i,nudgeY:r,keepWithinBounds:!0,skipObserver:n,updatePosition:()=>this.calculatePointerAlign(e.mouseEvent),postProcessCallback:()=>this.callPostProcessPopup(e.type,e.ePopup,null,e.mouseEvent,e.column,e.rowNode)})}calculatePointerAlign(e){const t=this.getParentRect();return{x:e.clientX-t.left,y:e.clientY-t.top}}positionPopupByComponent(e){const{ePopup:t,nudgeX:i,nudgeY:r,keepWithinBounds:n,eventSource:o,alignSide:s="left",position:a="over",column:l,rowNode:c,type:u}=e,d=o.getBoundingClientRect(),h=this.getParentRect(),g=this.getPopupIndex(t);if(-1!==g){this.popupList[g].alignedToElement=o}this.positionPopup({ePopup:t,nudgeX:i,nudgeY:r,keepWithinBounds:n,updatePosition:()=>{let i,n=d.left-h.left;if("right"===s&&(n-=t.offsetWidth-d.width),"over"===a)i=d.top-h.top,this.setAlignedStyles(t,"over");else{this.setAlignedStyles(t,"under");i="under"===this.shouldRenderUnderOrAbove(t,d,h,e.nudgeY||0)?d.top-h.top+d.height:d.top-t.offsetHeight-2*(r||0)-h.top}return{x:n,y:i}},postProcessCallback:()=>this.callPostProcessPopup(u,t,o,null,l,c)})}shouldRenderUnderOrAbove(e,t,i,r){const n=i.bottom-t.bottom,o=t.top-i.top,s=e.offsetHeight+r;return n>s?"under":o>s||o>n?"above":"under"}setAlignedStyles(e,t){const i=this.getPopupIndex(e);if(-1===i)return;const r=this.popupList[i],{alignedToElement:n}=r;if(!n)return;["right","left","over","above","under"].forEach((t=>{n.classList.remove("ag-has-popup-positioned-".concat(t)),e.classList.remove("ag-popup-positioned-".concat(t))})),t&&(n.classList.add("ag-has-popup-positioned-".concat(t)),e.classList.add("ag-popup-positioned-".concat(t)))}callPostProcessPopup(e,t,i,r,n,o){const s=this.gos.getCallback("postProcessPopup");if(s){s({column:n,rowNode:o,ePopup:t,type:e,eventSource:i,mouseEvent:r})}}positionPopup(e){var t=this;const{ePopup:i,keepWithinBounds:r,nudgeX:n,nudgeY:o,skipObserver:s,updatePosition:a}=e,l={width:0,height:0},c=function(){let s=arguments.length>0&&void 0!==arguments[0]&&arguments[0],{x:c,y:u}=a();s&&i.clientWidth===l.width&&i.clientHeight===l.height||(l.width=i.clientWidth,l.height=i.clientHeight,n&&(c+=n),o&&(u+=o),r&&(c=t.keepXYWithinBounds(i,c,1),u=t.keepXYWithinBounds(i,u,0)),i.style.left="".concat(c,"px"),i.style.top="".concat(u,"px"),e.postProcessCallback&&e.postProcessCallback())};if(c(),!s){const e=this.resizeObserverService.observeResize(i,(()=>c(!0)));setTimeout((()=>e()),200)}}getActivePopups(){return this.popupList.map((e=>e.element))}getPopupList(){return this.popupList}getParentRect(){const e=Q(this.gos);let t=this.getPopupParent();return t===e.body?t=e.documentElement:"static"===getComputedStyle(t).position&&(t=t.offsetParent),Wi(t)}keepXYWithinBounds(e,t,i){const r=0===i,n=r?"clientHeight":"clientWidth",o=r?"top":"left",s=r?"height":"width",a=r?"scrollTop":"scrollLeft",l=Q(this.gos),c=l.documentElement,u=this.getPopupParent(),d=e.getBoundingClientRect(),h=u.getBoundingClientRect(),g=l.documentElement.getBoundingClientRect(),p=u===l.body,f=Math.ceil(d[s]);let m=p?(r?Vi:_i)(c)+c[a]:u[n];p&&(m-=Math.abs(g[o]-h[o]));const v=m-f;return Math.min(Math.max(t,0),Math.abs(v))}addPopup(e){const t=Q(this.gos),{eChild:i,ariaLabel:r,alwaysOnTop:n,positionCallback:o,anchorToElement:s}=e;if(!t)return v("could not find the document, document is empty"),{hideFunc:()=>{}};const a=this.getPopupIndex(i);if(-1!==a){return{hideFunc:this.popupList[a].hideFunc}}this.initialisePopupPosition(i);const l=this.createPopupWrapper(i,r,!!n),u=this.addEventListenersToPopup(c(c({},e),{},{wrapperEl:l}));return o&&o(),this.addPopupToPopupList(i,l,u,s),{hideFunc:u}}initialisePopupPosition(e){const t=this.getPopupParent().getBoundingClientRect();F(e.style.top)||(e.style.top="".concat(-1*t.top,"px")),F(e.style.left)||(e.style.left="".concat(-1*t.left,"px"))}createPopupWrapper(e,t,i){const r=this.getPopupParent(),n=document.createElement("div");return this.environment.applyThemeClasses(n),n.classList.add("ag-popup"),e.classList.add(this.gos.get("enableRtl")?"ag-rtl":"ag-ltr","ag-popup-child"),e.hasAttribute("role")||ci(e,"dialog"),ui(e,t),n.appendChild(e),r.appendChild(n),i?this.setAlwaysOnTop(e,!0):this.bringPopupToFront(e),n}handleThemeChange(e){if(e.themeChanged)for(const t of this.popupList)this.environment.applyThemeClasses(t.wrapper)}addEventListenersToPopup(e){var t=this;const i=Q(this.gos),r=this.getPopupParent(),{wrapperEl:n,eChild:o,closedCallback:s,afterGuiAttached:a,closeOnEsc:l,modal:c}=e;let u=!1;const d=e=>{if(!n.contains(Z(this.gos)))return;e.key!==Tr.ESCAPE||Oe(e)||p({keyboardEvent:e})},h=e=>p({mouseEvent:e}),g=e=>p({touchEvent:e}),p=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{mouseEvent:a,touchEvent:l,keyboardEvent:c,forceHide:p}=e;(p||!t.isEventFromCurrentPopup({mouseEvent:a,touchEvent:l},o)&&!u)&&(u=!0,r.removeChild(n),i.removeEventListener("keydown",d),i.removeEventListener("mousedown",h),i.removeEventListener("touchstart",g),i.removeEventListener("contextmenu",h),t.eventService.removeEventListener("dragStarted",h),s&&s(a||l||c),t.removePopupFromPopupList(o))};return a&&a({hidePopup:p}),window.setTimeout((()=>{l&&i.addEventListener("keydown",d),c&&(i.addEventListener("mousedown",h),this.eventService.addEventListener("dragStarted",h),i.addEventListener("touchstart",g),i.addEventListener("contextmenu",h))}),0),p}addPopupToPopupList(e,t,i,r){this.popupList.push({element:e,wrapper:t,hideFunc:i,instanceId:Ya++,isAnchored:!!r}),r&&this.setPopupPositionRelatedToElement(e,r)}getPopupIndex(e){return this.popupList.findIndex((t=>t.element===e))}setPopupPositionRelatedToElement(e,t){const i=this.getPopupIndex(e);if(-1===i)return;const r=this.popupList[i];if(r.stopAnchoringPromise&&r.stopAnchoringPromise.then((e=>e&&e())),r.stopAnchoringPromise=void 0,r.isAnchored=!1,!t)return;const n=this.keepPopupPositionedRelativeTo({element:t,ePopup:e,hidePopup:r.hideFunc});return r.stopAnchoringPromise=n,r.isAnchored=!0,n}removePopupFromPopupList(e){this.setAlignedStyles(e,null),this.setPopupPositionRelatedToElement(e,null),this.popupList=this.popupList.filter((t=>t.element!==e))}keepPopupPositionedRelativeTo(e){const t=this.getPopupParent(),i=t.getBoundingClientRect(),{element:r,ePopup:n}=e,o=r.getBoundingClientRect(),s=e=>parseInt(e.substring(0,e.length-1),10),a=(e,t)=>{const r=i[e]-o[e],a=s(n.style[e]);return{initialDiff:r,lastDiff:r,initial:a,last:a,direction:t}},l=a("top",0),c=a("left",1),u=this.getFrameworkOverrides();return new Wr((i=>{u.wrapIncoming((()=>{u.setInterval((()=>{const i=t.getBoundingClientRect(),o=r.getBoundingClientRect();if(0==o.top&&0==o.left&&0==o.height&&0==o.width)return void e.hidePopup();const a=(e,t)=>{const r=s(n.style[t]);e.last!==r&&(e.initial=r,e.last=r);const a=i[t]-o[t];if(a!=e.lastDiff){const i=this.keepXYWithinBounds(n,e.initial+e.initialDiff-a,e.direction);n.style[t]="".concat(i,"px"),e.last=i}e.lastDiff=a};a(l,"top"),a(c,"left")}),200).then((e=>{i((()=>{null!=e&&window.clearInterval(e)}))}))}),"popupPositioning")}))}hasAnchoredPopup(){return this.popupList.some((e=>e.isAnchored))}isEventFromCurrentPopup(e,t){const{mouseEvent:i,touchEvent:r}=e,n=i||r;if(!n)return!1;const o=this.getPopupIndex(t);if(-1===o)return!1;for(let s=o;s<this.popupList.length;s++){if(Ge(this.popupList[s].element,n))return!0}return this.isElementWithinCustomPopup(n.target)}isElementWithinCustomPopup(e){const t=Q(this.gos);for(;e&&e!==t.body;){if(e.classList.contains("ag-custom-component-popup")||null===e.parentElement)return!0;e=e.parentElement}return!1}getWrapper(e){for(;!e.classList.contains("ag-popup")&&e.parentElement;)e=e.parentElement;return e.classList.contains("ag-popup")?e:null}setAlwaysOnTop(e,t){const i=this.getWrapper(e);i&&(i.classList.toggle("ag-always-on-top",!!t),t&&this.bringPopupToFront(i))}bringPopupToFront(e){const t=this.getPopupParent(),i=Array.prototype.slice.call(t.querySelectorAll(".ag-popup")),r=i.length,n=this.getWrapper(e);if(!n||r<=1||!t.contains(e))return;const o=[],s=[];for(const u of i)u!==n&&(u.classList.contains("ag-always-on-top")?s.push(u):o.push(u));const a=[],l=s.length,c=n.classList.contains("ag-always-on-top")||!l?[...o,...s,n]:[...o,n,...s];for(let u=0;u<=r;u++){const e=c[u];if(i[u]===c[u]||e===n)continue;e.querySelectorAll("div").forEach((e=>{0!==e.scrollTop&&a.push([e,e.scrollTop])})),0===u?t.insertAdjacentElement("afterbegin",e):c[u-1].insertAdjacentElement("afterend",e)}for(;a.length;){const e=a.pop();e[0].scrollTop=e[1]}}},Qa=["touchstart","touchend","touchmove","touchcancel"],$a=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"javascript";this.frameworkName=e,this.renderingEngine="vanilla",this.wrapIncoming=e=>e(),this.wrapOutgoing=e=>e()}setInterval(e,t){return new Wr((i=>{i(window.setInterval(e,t))}))}addEventListener(e,t,i,r){const n=Pe(Qa,t);e.addEventListener(t,i,{capture:!!r,passive:n})}get shouldWrapOutgoing(){return!1}frameworkComponent(e){return null}isFrameworkComponent(e){return!1}getDocLink(e){const t="solid"===this.frameworkName?"react":this.frameworkName;return"https://www.ag-grid.com/".concat(t,"-data-grid").concat(e?"/".concat(e):"")}},Xa=class extends He{constructor(){super(...arguments),this.beanName="cellNavigationService"}wireBeans(e){this.visibleColsService=e.visibleColsService,this.rowModel=e.rowModel,this.rowRenderer=e.rowRenderer,this.pinnedRowModel=e.pinnedRowModel,this.paginationService=e.paginationService,this.pageBoundsService=e.pageBoundsService}getNextCellToFocus(e,t){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?this.getNextCellToFocusWithCtrlPressed(e,t):this.getNextCellToFocusWithoutCtrlPressed(e,t)}getNextCellToFocusWithCtrlPressed(e,t){const i=e===Tr.UP,r=e===Tr.DOWN,n=e===Tr.LEFT;let o,s;if(i||r)s=i?this.pageBoundsService.getFirstRow():this.pageBoundsService.getLastRow(),o=t.column;else{const e=this.visibleColsService.getAllCols(),i=this.gos.get("enableRtl");s=t.rowIndex,o=n!==i?e[0]:ye(e)}return{rowIndex:s,rowPinned:null,column:o}}getNextCellToFocusWithoutCtrlPressed(e,t){let i=t,r=!1;for(;!r;){switch(e){case Tr.UP:i=this.getCellAbove(i);break;case Tr.DOWN:i=this.getCellBelow(i);break;case Tr.RIGHT:i=this.gos.get("enableRtl")?this.getCellToLeft(i):this.getCellToRight(i);break;case Tr.LEFT:i=this.gos.get("enableRtl")?this.getCellToRight(i):this.getCellToLeft(i);break;default:i=null,v("unknown key for navigation ",e)}r=!i||this.isCellGoodToFocusOn(i)}return i}isCellGoodToFocusOn(e){const t=e.column;let i;switch(e.rowPinned){case"top":i=this.pinnedRowModel.getPinnedTopRow(e.rowIndex);break;case"bottom":i=this.pinnedRowModel.getPinnedBottomRow(e.rowIndex);break;default:i=this.rowModel.getRow(e.rowIndex)}if(!i)return!1;return!t.isSuppressNavigable(i)}getCellToLeft(e){if(!e)return null;const t=this.visibleColsService.getColBefore(e.column);return t?{rowIndex:e.rowIndex,column:t,rowPinned:e.rowPinned}:null}getCellToRight(e){if(!e)return null;const t=this.visibleColsService.getColAfter(e.column);return t?{rowIndex:e.rowIndex,column:t,rowPinned:e.rowPinned}:null}getRowBelow(e){const t=e.rowIndex,i=e.rowPinned;let r=!1;if(this.isLastRowInContainer(e))switch(i){case"bottom":return null;case"top":return this.rowModel.isRowsToRender()?{rowIndex:this.pageBoundsService.getFirstRow(),rowPinned:null}:this.pinnedRowModel.isRowsToRender("bottom")?{rowIndex:0,rowPinned:"bottom"}:null;default:return this.pinnedRowModel.isRowsToRender("bottom")?{rowIndex:0,rowPinned:"bottom"}:null}else i&&(r=!0);const n=this.rowModel.getRow(e.rowIndex),o=r?void 0:this.getNextStickyPosition(n);return o||{rowIndex:t+1,rowPinned:i}}getNextStickyPosition(e,t){if(!ie(this.gos)||!e||!e.sticky)return;let i=[];i=this.rowRenderer.getStickyTopRowCtrls().some((t=>t.getRowNode().rowIndex===e.rowIndex))?[...this.rowRenderer.getStickyTopRowCtrls()].sort(((e,t)=>e.getRowNode().rowIndex-t.getRowNode().rowIndex)):[...this.rowRenderer.getStickyBottomRowCtrls()].sort(((e,t)=>t.getRowNode().rowIndex-e.getRowNode().rowIndex));const r=t?-1:1,n=i.findIndex((t=>t.getRowNode().rowIndex===e.rowIndex)),o=i[n+r];return o?{rowIndex:o.getRowNode().rowIndex,rowPinned:null}:void 0}getCellBelow(e){if(!e)return null;const t=this.getRowBelow(e);return t?{rowIndex:t.rowIndex,column:e.column,rowPinned:t.rowPinned}:null}isLastRowInContainer(e){const t=e.rowPinned,i=e.rowIndex;if("top"===t){return this.pinnedRowModel.getPinnedTopRowCount()-1<=i}if("bottom"===t){return this.pinnedRowModel.getPinnedBottomRowCount()-1<=i}return this.pageBoundsService.getLastRow()<=i}getRowAbove(e){const t=e.rowIndex,i=e.rowPinned;let r=!1;if(i?0===t:t===this.pageBoundsService.getFirstRow())return"top"===i?null:i&&this.rowModel.isRowsToRender()?this.getLastBodyCell():this.pinnedRowModel.isRowsToRender("top")?this.getLastFloatingTopRow():null;i&&(r=!0);const n=this.rowModel.getRow(e.rowIndex),o=r?void 0:this.getNextStickyPosition(n,!0);return o||{rowIndex:t-1,rowPinned:i}}getCellAbove(e){if(!e)return null;const t=this.getRowAbove({rowIndex:e.rowIndex,rowPinned:e.rowPinned});return t?{rowIndex:t.rowIndex,column:e.column,rowPinned:t.rowPinned}:null}getLastBodyCell(){return{rowIndex:this.pageBoundsService.getLastRow(),rowPinned:null}}getLastFloatingTopRow(){return{rowIndex:this.pinnedRowModel.getPinnedTopRowCount()-1,rowPinned:"top"}}getNextTabbedCell(e,t){return t?this.getNextTabbedCellBackwards(e):this.getNextTabbedCellForwards(e)}getNextTabbedCellForwards(e){const t=this.visibleColsService.getAllCols();let i=e.rowIndex,r=e.rowPinned,n=this.visibleColsService.getColAfter(e.column);if(!n){var o,s;n=t[0];const a=this.getRowBelow(e);if(P(a))return null;if(!a.rowPinned&&null!==(o=null===(s=this.paginationService)||void 0===s?void 0:s.isRowInPage(a))&&void 0!==o&&!o)return null;i=a?a.rowIndex:null,r=a?a.rowPinned:null}return{rowIndex:i,column:n,rowPinned:r}}getNextTabbedCellBackwards(e){const t=this.visibleColsService.getAllCols();let i=e.rowIndex,r=e.rowPinned,n=this.visibleColsService.getColBefore(e.column);if(!n){var o,s;n=ye(t);const a=this.getRowAbove({rowIndex:e.rowIndex,rowPinned:e.rowPinned});if(P(a))return null;if(!a.rowPinned&&null!==(o=null===(s=this.paginationService)||void 0===s?void 0:s.isRowInPage(a))&&void 0!==o&&!o)return null;i=a?a.rowIndex:null,r=a?a.rowPinned:null}return{rowIndex:i,column:n,rowPinned:r}}},Ja=(e,t)=>{for(const i in t)t[i]=e;return t},Za=c(c(c(c(c(c(c(c(c(c(c(c(c(c(c({},Ja("@ag-grid-community/core",{dispatchEvent:0,destroy:0,getGridId:0,getGridOption:0,isDestroyed:0,setGridOption:0,updateGridOptions:0,getState:0,setNodesSelected:0,selectAll:0,deselectAll:0,selectAllFiltered:0,deselectAllFiltered:0,selectAllOnCurrentPage:0,deselectAllOnCurrentPage:0,getSelectedNodes:0,getSelectedRows:0,redrawRows:0,setRowNodeExpanded:0,getRowNode:0,addRenderedRowListener:0,getRenderedNodes:0,forEachNode:0,getFirstDisplayedRow:0,getFirstDisplayedRowIndex:0,getLastDisplayedRow:0,getLastDisplayedRowIndex:0,getDisplayedRowAtIndex:0,getDisplayedRowCount:0,getModel:0,getVerticalPixelRange:0,getHorizontalPixelRange:0,ensureColumnVisible:0,ensureIndexVisible:0,ensureNodeVisible:0,getFocusedCell:0,clearFocusedCell:0,setFocusedCell:0,tabToNextCell:0,tabToPreviousCell:0,setFocusedHeader:0,addEventListener:0,addGlobalListener:0,removeEventListener:0,removeGlobalListener:0,expireValueCache:0,getValue:0,getCellValue:0,showColumnMenuAfterButtonClick:0,showColumnMenuAfterMouseClick:0,showColumnMenu:0,hidePopupMenu:0,onSortChanged:0,getPinnedTopRowCount:0,getPinnedBottomRowCount:0,getPinnedTopRow:0,getPinnedBottomRow:0,showLoadingOverlay:0,showNoRowsOverlay:0,hideOverlay:0,setGridAriaProperty:0,refreshCells:0,flashCells:0,refreshHeader:0,isAnimationFrameQueueEmpty:0,flushAllAnimationFrames:0,getSizesForCurrentTheme:0,getCellRendererInstances:0,addRowDropZone:0,removeRowDropZone:0,getRowDropZoneParams:0,getColumnDef:0,getColumnDefs:0,sizeColumnsToFit:0,setColumnGroupOpened:0,getColumnGroup:0,getProvidedColumnGroup:0,getDisplayNameForColumn:0,getDisplayNameForColumnGroup:0,getColumn:0,getColumns:0,applyColumnState:0,getColumnState:0,resetColumnState:0,getColumnGroupState:0,setColumnGroupState:0,resetColumnGroupState:0,isPinning:0,isPinningLeft:0,isPinningRight:0,getDisplayedColAfter:0,getDisplayedColBefore:0,setColumnVisible:0,setColumnsVisible:0,setColumnPinned:0,setColumnsPinned:0,getAllGridColumns:0,getDisplayedLeftColumns:0,getDisplayedCenterColumns:0,getDisplayedRightColumns:0,getAllDisplayedColumns:0,getAllDisplayedVirtualColumns:0,moveColumn:0,moveColumnByIndex:0,moveColumns:0,setColumnWidth:0,setColumnWidths:0,getLeftDisplayedColumnGroups:0,getCenterDisplayedColumnGroups:0,getRightDisplayedColumnGroups:0,getAllDisplayedColumnGroups:0,autoSizeColumn:0,autoSizeColumns:0,autoSizeAllColumns:0,undoCellEditing:0,redoCellEditing:0,getCellEditorInstances:0,getEditingCells:0,stopEditing:0,startEditingCell:0,getCurrentUndoSize:0,getCurrentRedoSize:0,isAnyFilterPresent:0,onFilterChanged:0,isColumnFilterPresent:0,getFilterInstance:0,getColumnFilterInstance:0,destroyFilter:0,setFilterModel:0,getFilterModel:0,getColumnFilterModel:0,setColumnFilterModel:0,showColumnFilter:0,isQuickFilterPresent:0,getQuickFilter:0,resetQuickFilter:0,paginationIsLastPageFound:0,paginationGetPageSize:0,paginationGetCurrentPage:0,paginationGetTotalPages:0,paginationGetRowCount:0,paginationGoToNextPage:0,paginationGoToPreviousPage:0,paginationGoToFirstPage:0,paginationGoToLastPage:0,paginationGoToPage:0,expandAll:0,collapseAll:0,onRowHeightChanged:0,setRowCount:0,getCacheBlockState:0,isLastRowIndexKnown:0})),Ja("@ag-grid-community/client-side-row-model",{onGroupExpandedOrCollapsed:0,refreshClientSideRowModel:0,isRowDataEmpty:0,forEachLeafNode:0,forEachNodeAfterFilter:0,forEachNodeAfterFilterAndSort:0,resetRowHeights:0,applyTransaction:0,applyTransactionAsync:0,flushAsyncTransactions:0,getBestCostNodeSelection:0})),Ja("@ag-grid-community/csv-export",{getDataAsCsv:0,exportDataAsCsv:0})),Ja("@ag-grid-community/infinite-row-model",{refreshInfiniteCache:0,purgeInfiniteCache:0,getInfiniteRowCount:0})),Ja("@ag-grid-enterprise/advanced-filter",{getAdvancedFilterModel:0,setAdvancedFilterModel:0,showAdvancedFilterBuilder:0,hideAdvancedFilterBuilder:0})),Ja("@ag-grid-enterprise/charts",{getChartModels:0,getChartRef:0,getChartImageDataURL:0,downloadChart:0,openChartToolPanel:0,closeChartToolPanel:0,createRangeChart:0,createPivotChart:0,createCrossFilterChart:0,updateChart:0,restoreChart:0})),Ja("@ag-grid-enterprise/clipboard",{copyToClipboard:0,cutToClipboard:0,copySelectedRowsToClipboard:0,copySelectedRangeToClipboard:0,copySelectedRangeDown:0,pasteFromClipboard:0})),Ja("@ag-grid-enterprise/excel-export",{getDataAsExcel:0,exportDataAsExcel:0,getSheetDataForExcel:0,getMultipleSheetsAsExcel:0,exportMultipleSheetsAsExcel:0})),Ja("@ag-grid-enterprise/master-detail",{addDetailGridInfo:0,removeDetailGridInfo:0,getDetailGridInfo:0,forEachDetailGridInfo:0})),Ja("@ag-grid-enterprise/menu",{showContextMenu:0,showColumnChooser:0,hideColumnChooser:0})),Ja("@ag-grid-enterprise/range-selection",{getCellRanges:0,addCellRange:0,clearRangeSelection:0,clearCellSelection:0})),Ja("@ag-grid-enterprise/row-grouping",{addAggFunc:0,addAggFuncs:0,clearAggFuncs:0,setColumnAggFunc:0,isPivotMode:0,getPivotResultColumn:0,setValueColumns:0,getValueColumns:0,removeValueColumn:0,removeValueColumns:0,addValueColumn:0,addValueColumns:0,setRowGroupColumns:0,removeRowGroupColumn:0,removeRowGroupColumns:0,addRowGroupColumn:0,addRowGroupColumns:0,getRowGroupColumns:0,moveRowGroupColumn:0,setPivotColumns:0,removePivotColumn:0,removePivotColumns:0,addPivotColumn:0,addPivotColumns:0,getPivotColumns:0,setPivotResultColumns:0,getPivotResultColumns:0})),Ja("@ag-grid-enterprise/server-side-row-model",{getServerSideSelectionState:0,setServerSideSelectionState:0,applyServerSideTransaction:0,applyServerSideTransactionAsync:0,applyServerSideRowData:0,retryServerSideLoads:0,flushServerSideAsyncTransactions:0,refreshServerSide:0,getServerSideGroupLevelState:0})),Ja("@ag-grid-enterprise/side-bar",{isSideBarVisible:0,setSideBarVisible:0,setSideBarPosition:0,openToolPanel:0,closeToolPanel:0,getOpenedToolPanel:0,refreshToolPanel:0,isToolPanelShowing:0,getToolPanelInstance:0,getSideBar:0})),Ja("@ag-grid-enterprise/status-bar",{getStatusPanel:0})),el={isDestroyed:()=>!0,destroy(){},preConstruct(){},postConstruct(){},preWireBeans(){},wireBeans(){}},tl=(e,t)=>e.eventService.dispatchEvent(t),il=class{};Reflect.defineProperty(il,"name",{value:"GridApi"});var rl=class extends He{constructor(){super(),this.beanName="apiFunctionService",this.api=new il,this.fns=c(c({},el),{},{dispatchEvent:tl}),this.beans=null,this.preDestroyLink="";const{api:e}=this;for(const t in Za)e[t]=this.makeApi(t)[t]}wireBeans(e){this.beans=e}postConstruct(){this.preDestroyLink=this.frameworkOverrides.getDocLink("grid-lifecycle/#grid-pre-destroyed")}addFunction(e,t){const{fns:i,beans:r}=this;var n,o;i!==el&&(i[e]=null!==(n=null===r||void 0===r||null===(o=r.validationService)||void 0===o?void 0:o.validateApiFunction(e,t))&&void 0!==n?n:t)}makeApi(e){var t=this;return{[e]:function(){const{beans:i,fns:{[e]:r}}=t;for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return r?r(i,...o):t.apiNotFound(e)}}}apiNotFound(e){const{beans:t,gos:i,preDestroyLink:r}=this;if(t){const t=Za[e];i.assertModuleRegistered(t,"api.".concat(e))&&v("API function '".concat(e,"' not registered to module '").concat(t,"'"))}else v("Grid API function ".concat(e,"() cannot be called as the grid has been destroyed.\nEither clear local references to the grid api, when it is destroyed, or check gridApi.isDestroyed() to avoid calling methods against a destroyed grid.\nTo run logic when the grid is about to be destroyed use the gridPreDestroy event. See: ").concat(r))}destroy(){super.destroy(),this.fns=el,this.beans=null}};function nl(e){return{beanName:"gridApi",bean:e.getBean("apiFunctionService").api}}var ol=class extends He{constructor(){super(...arguments),this.beanName="columnDefFactory"}buildColumnDefs(e,t,i){const r=[],n={};return e.forEach((e=>{let o=!0,s=this.createDefFromColumn(e,t,i),a=e.getOriginalParent(),l=null;for(;a;){let e=null;if(a.isPadding()){a=a.getOriginalParent();continue}const t=n[a.getGroupId()];if(t){t.children.push(s),o=!1;break}if(e=this.createDefFromGroup(a),e&&(e.children=[s],n[e.groupId]=e,s=e,a=a.getOriginalParent()),null!=a&&l===a){o=!1;break}l=a}o&&r.push(s)})),r}createDefFromGroup(e){const t=tt(e.getColGroupDef(),["children"]);return t&&(t.groupId=e.getGroupId()),t}createDefFromColumn(e,t,i){const r=tt(e.getColDef());return r.colId=e.getColId(),r.width=e.getActualWidth(),r.rowGroup=e.isRowGroupActive(),r.rowGroupIndex=e.isRowGroupActive()?t.indexOf(e):null,r.pivot=e.isPivotActive(),r.pivotIndex=e.isPivotActive()?i.indexOf(e):null,r.aggFunc=e.isValueActive()?e.getAggFunc():null,r.hide=!e.isVisible()||void 0,r.pinned=e.isPinned()?e.getPinned():null,r.sort=e.getSort()?e.getSort():null,r.sortIndex=null!=e.getSortIndex()?e.getSortIndex():null,r}},sl=class extends He{constructor(){super(...arguments),this.beanName="columnEventDispatcher"}visibleCols(e){this.eventService.dispatchEvent({type:"displayedColumnsChanged",source:e})}gridColumns(){this.eventService.dispatchEvent({type:"gridColumnsChanged"})}headerHeight(e){this.eventService.dispatchEvent({type:"columnHeaderHeightChanged",column:e,columns:[e],source:"autosizeColumnHeaderHeight"})}groupHeaderHeight(e){this.eventService.dispatchEvent({type:"columnGroupHeaderHeightChanged",columnGroup:e,source:"autosizeColumnGroupHeaderHeight"})}groupOpened(e){this.eventService.dispatchEvent({type:"columnGroupOpened",columnGroup:1===e.length?e[0]:void 0,columnGroups:e})}rowGroupChanged(e,t){this.eventService.dispatchEvent({type:"columnRowGroupChanged",columns:e,column:1===e.length?e[0]:null,source:t})}genericColumnEvent(e,t,i){this.eventService.dispatchEvent({type:e,columns:t,column:1===t.length?t[0]:null,source:i})}pivotModeChanged(){this.eventService.dispatchEvent({type:"columnPivotModeChanged"})}virtualColumnsChanged(e){this.eventService.dispatchEvent({type:"virtualColumnsChanged",afterScroll:e})}newColumnsLoaded(e){this.eventService.dispatchEvent({type:"newColumnsLoaded",source:e})}everythingChanged(e){this.eventService.dispatchEvent({type:"columnEverythingChanged",source:e})}columnMoved(e){const{movedColumns:t,source:i,toIndex:r,finished:n}=e;this.eventService.dispatchEvent({type:"columnMoved",columns:t,column:t&&1===t.length?t[0]:null,toIndex:r,finished:n,source:i})}columnPinned(e,t){if(!e.length)return;const i=1===e.length?e[0]:null,r=this.getCommonValue(e,(e=>e.getPinned()));this.eventService.dispatchEvent({type:"columnPinned",pinned:null!=r?r:null,columns:e,column:i,source:t})}columnVisible(e,t){if(!e.length)return;const i=1===e.length?e[0]:null,r=this.getCommonValue(e,(e=>e.isVisible()));this.eventService.dispatchEvent({type:"columnVisible",visible:r,columns:e,column:i,source:t})}getCommonValue(e,t){if(!e||0==e.length)return;const i=t(e[0]);for(let r=1;r<e.length;r++)if(i!==t(e[r]))return;return i}columnChanged(e,t,i){this.eventService.dispatchEvent({type:e,columns:t,column:t&&1==t.length?t[0]:null,source:i})}columnResized(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e&&e.length&&this.eventService.dispatchEvent({type:"columnResized",columns:e,column:1===e.length?e[0]:null,flexColumns:r,finished:t,source:i})}},al=class extends He{constructor(){super(...arguments),this.beanName="columnGetStateService"}wireBeans(e){this.columnModel=e.columnModel,this.funcColsService=e.funcColsService}getColumnState(){if(P(this.columnModel.getColDefCols())||!this.columnModel.isAlive())return[];const e=this.columnModel.getAllCols().map((e=>this.createStateItemFromColumn(e)));return this.orderColumnStateList(e),e}createStateItemFromColumn(e){const t=this.funcColsService.getRowGroupColumns(),i=this.funcColsService.getPivotColumns(),r=e.isRowGroupActive()?t.indexOf(e):null,n=e.isPivotActive()?i.indexOf(e):null,o=e.isValueActive()?e.getAggFunc():null,s=null!=e.getSort()?e.getSort():null,a=null!=e.getSortIndex()?e.getSortIndex():null,l=null!=e.getFlex()&&e.getFlex()>0?e.getFlex():null;return{colId:e.getColId(),width:e.getActualWidth(),hide:!e.isVisible(),pinned:e.getPinned(),sort:s,sortIndex:a,aggFunc:o,rowGroup:e.isRowGroupActive(),rowGroupIndex:r,pivot:e.isPivotActive(),pivotIndex:n,flex:l}}orderColumnStateList(e){const t=this.columnModel.getCols(),i=new Map(t.map(((e,t)=>[e.getColId(),t])));e.sort(((e,t)=>(i.has(e.colId)?i.get(e.colId):-1)-(i.has(t.colId)?i.get(t.colId):-1)))}},ll=class extends He{constructor(){super(...arguments),this.beanName="columnGroupStateService"}wireBeans(e){this.columnModel=e.columnModel,this.columnAnimationService=e.columnAnimationService,this.eventDispatcher=e.columnEventDispatcher,this.visibleColsService=e.visibleColsService}getColumnGroupState(){const e=[];return pt(null,this.columnModel.getColTree(),(t=>{ze(t)&&e.push({groupId:t.getGroupId(),open:t.isExpanded()})})),e}resetColumnGroupState(e){const t=this.columnModel.getColDefColTree();if(!t)return;const i=[];pt(null,t,(e=>{if(ze(e)){const t=e.getColGroupDef(),r={groupId:e.getGroupId(),open:t?t.openByDefault:void 0};i.push(r)}})),this.setColumnGroupState(i,e)}setColumnGroupState(e,t){if(!this.columnModel.getColTree())return;this.columnAnimationService.start();const i=[];e.forEach((e=>{const t=e.groupId,r=e.open,n=this.columnModel.getProvidedColGroup(t);n&&n.isExpanded()!==r&&(n.setExpanded(r),i.push(n))})),this.visibleColsService.refresh(t,!0),i.length&&this.eventDispatcher.groupOpened(i),this.columnAnimationService.finish()}},cl=class extends He{constructor(){super(...arguments),this.beanName="columnViewportService",this.colsWithinViewport=[],this.headerColsWithinViewport=[],this.colsWithinViewportHash="",this.rowsOfHeadersToRenderLeft={},this.rowsOfHeadersToRenderRight={},this.rowsOfHeadersToRenderCenter={}}wireBeans(e){this.visibleColsService=e.visibleColsService,this.columnModel=e.columnModel,this.eventDispatcher=e.columnEventDispatcher}postConstruct(){this.suppressColumnVirtualisation=this.gos.get("suppressColumnVirtualisation")}setScrollPosition(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=this.visibleColsService.isBodyWidthDirty();if(!(e===this.scrollWidth&&t===this.scrollPosition&&!r)){if(this.scrollWidth=e,this.scrollPosition=t,this.visibleColsService.setBodyWidthDirty(),this.gos.get("enableRtl")){const e=this.visibleColsService.getBodyContainerWidth();this.viewportLeft=e-this.scrollPosition-this.scrollWidth,this.viewportRight=e-this.scrollPosition}else this.viewportLeft=this.scrollPosition,this.viewportRight=this.scrollWidth+this.scrollPosition;this.columnModel.isReady()&&this.checkViewportColumns(i)}}getHeadersToRender(e,t){let i;switch(e){case"left":i=this.rowsOfHeadersToRenderLeft[t];break;case"right":i=this.rowsOfHeadersToRenderRight[t];break;default:i=this.rowsOfHeadersToRenderCenter[t]}return i||[]}extractViewportColumns(){const e=this.visibleColsService.getCenterCols();this.isColumnVirtualisationSuppressed()?(this.colsWithinViewport=e,this.headerColsWithinViewport=e):(this.colsWithinViewport=e.filter(this.isColumnInRowViewport.bind(this)),this.headerColsWithinViewport=e.filter(this.isColumnInHeaderViewport.bind(this)))}isColumnVirtualisationSuppressed(){return this.suppressColumnVirtualisation||0===this.viewportRight}clear(){this.rowsOfHeadersToRenderLeft={},this.rowsOfHeadersToRenderRight={},this.rowsOfHeadersToRenderCenter={},this.colsWithinViewportHash=""}isColumnInHeaderViewport(e){return!(!e.isAutoHeaderHeight()&&!this.isAnyParentAutoHeaderHeight(e))||this.isColumnInRowViewport(e)}isAnyParentAutoHeaderHeight(e){for(;e;){if(e.isAutoHeaderHeight())return!0;e=e.getParent()}return!1}isColumnInRowViewport(e){if(e.isAutoHeight())return!0;const t=e.getLeft()||0,i=t+e.getActualWidth(),r=this.viewportLeft-200,n=this.viewportRight+200;return!(t<r&&i<r)&&!(t>n&&i>n)}getViewportColumns(){const e=this.visibleColsService.getLeftCols(),t=this.visibleColsService.getRightCols();return this.colsWithinViewport.concat(e).concat(t)}getColsWithinViewport(e){if(!this.columnModel.isColSpanActive())return this.colsWithinViewport;const t=this.isColumnVirtualisationSuppressed()?void 0:this.isColumnInRowViewport.bind(this),i=this.visibleColsService.getColsCenter();return this.visibleColsService.getColsForRow(e,i,t,(e=>{const t=e.getLeft();return F(t)&&t>this.viewportLeft}))}checkViewportColumns(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.extractViewport()&&this.eventDispatcher.virtualColumnsChanged(e)}calculateHeaderRows(){this.rowsOfHeadersToRenderLeft={},this.rowsOfHeadersToRenderRight={},this.rowsOfHeadersToRenderCenter={};const e={},t=this.visibleColsService.getLeftCols(),i=this.visibleColsService.getRightCols();this.headerColsWithinViewport.concat(t).concat(i).forEach((t=>e[t.getId()]=!0));const r=(t,i,n)=>{let o=!1;for(let s=0;s<t.length;s++){const a=t[s];let l=!1;if(ct(a))l=!0===e[a.getId()];else{const e=a.getDisplayedChildren();e&&(l=r(e,i,n+1))}l&&(o=!0,i[n]||(i[n]=[]),i[n].push(a))}return o};r(this.visibleColsService.getTreeLeft(),this.rowsOfHeadersToRenderLeft,0),r(this.visibleColsService.getTreeRight(),this.rowsOfHeadersToRenderRight,0),r(this.visibleColsService.getTreeCenter(),this.rowsOfHeadersToRenderCenter,0)}extractViewport(){this.extractViewportColumns();const e=this.getViewportColumns().map((e=>"".concat(e.getId(),"-").concat(e.getPinned()||"normal"))).join("#"),t=this.colsWithinViewportHash!==e;return t&&(this.colsWithinViewportHash=e,this.calculateHeaderRows()),t}},ul=class extends He{constructor(){super(...arguments),this.beanName="agComponentUtils"}wireBeans(e){this.componentMetadataProvider=e.componentMetadataProvider}adaptFunction(e,t){const i=this.componentMetadataProvider.retrieve(e);return i&&i.functionAdapter?i.functionAdapter(t):null}adaptCellRendererFunction(e){return class{refresh(){return!1}getGui(){return this.eGui}init(t){const i=e(t),r=typeof i;this.eGui="string"!==r&&"number"!==r&&"boolean"!==r?null!=i?i:Xi("<span></span>"):Xi("<span>"+i+"</span>")}}}doesImplementIComponent(e){return!!e&&(e.prototype&&"getGui"in e.prototype)}},dl=class extends He{constructor(){super(...arguments),this.beanName="componentMetadataProvider"}wireBeans(e){this.agComponentUtils=e.agComponentUtils}postConstruct(){this.componentMetaData={dateComponent:{mandatoryMethodList:["getDate","setDate"],optionalMethodList:["afterGuiAttached","setInputPlaceholder","setInputAriaLabel","setDisabled","onParamsUpdated","refresh"]},detailCellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},dragAndDropImageComponent:{mandatoryMethodList:["setIcon","setLabel"],optionalMethodList:[]},headerComponent:{mandatoryMethodList:[],optionalMethodList:["refresh"]},headerGroupComponent:{mandatoryMethodList:[],optionalMethodList:[]},loadingCellRenderer:{mandatoryMethodList:[],optionalMethodList:[],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},loadingOverlayComponent:{mandatoryMethodList:[],optionalMethodList:["refresh"]},noRowsOverlayComponent:{mandatoryMethodList:[],optionalMethodList:["refresh"]},floatingFilterComponent:{mandatoryMethodList:["onParentModelChanged"],optionalMethodList:["afterGuiAttached","onParamsUpdated","refresh"]},cellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh","afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},cellEditor:{mandatoryMethodList:["getValue"],optionalMethodList:["isPopup","isCancelBeforeStart","isCancelAfterEnd","getPopupPosition","focusIn","focusOut","afterGuiAttached","refresh"]},innerRenderer:{mandatoryMethodList:[],optionalMethodList:["afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},fullWidthCellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh","afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},groupRowRenderer:{mandatoryMethodList:[],optionalMethodList:["afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},filter:{mandatoryMethodList:["isFilterActive","doesFilterPass","getModel","setModel"],optionalMethodList:["afterGuiAttached","afterGuiDetached","onNewRowsLoaded","getModelAsString","onFloatingFilterChanged","onAnyFilterChanged","refresh"]},statusPanel:{mandatoryMethodList:[],optionalMethodList:["refresh"]},toolPanel:{mandatoryMethodList:[],optionalMethodList:["refresh","getState"]},tooltipComponent:{mandatoryMethodList:[],optionalMethodList:[]},menuItem:{mandatoryMethodList:[],optionalMethodList:["setActive","select","setExpanded","configureDefaults"]}}}retrieve(e){return this.componentMetaData[e]}},hl=Object.fromEntries(["rowPositionUtils","cellPositionUtils","headerPositionUtils","paginationAutoPageSizeService","apiFunctionService","gridApi","userComponentRegistry","agComponentUtils","componentMetadataProvider","resizeObserverService","userComponentFactory","rowContainerHeightService","horizontalResizeService","localeService","validationService","pinnedRowModel","dragService","visibleColsService","eventService","gos","popupService","selectionService","columnFilterService","quickFilterService","filterManager","columnModel","headerNavigationService","pageBoundsService","paginationService","pageBoundsListener","rowRenderer","expressionService","columnFactory","alignedGridsService","navigationService","valueCache","valueService","loggerFactory","autoWidthCalculator","filterMenuFactory","dragAndDropService","focusService","mouseEventService","environment","cellNavigationService","stylingService","scrollVisibleService","sortController","columnHoverService","columnAnimationService","selectableService","autoColService","controlsColService","changeDetectionService","animationFrameService","undoRedoService","columnDefFactory","rowCssClassCalculator","rowNodeBlockLoader","rowNodeSorter","ctrlsService","pinnedWidthService","rowNodeEventThrottle","ctrlsFactory","dataTypeService","syncService","overlayService","stateService","expansionService","apiEventService","ariaAnnouncementService","menuService","columnApplyStateService","columnEventDispatcher","columnMoveService","columnAutosizeService","columnGetStateService","columnGroupStateService","columnSizeService","funcColsService","columnNameService","columnViewportService","pivotResultColsService","showRowGroupColsService"].map(((e,t)=>[e,t])));function gl(e,t){var i,r;return(null!==(i=e.beanName?hl[e.beanName]:void 0)&&void 0!==i?i:Number.MAX_SAFE_INTEGER)-(null!==(r=t.beanName?hl[t.beanName]:void 0)&&void 0!==r?r:Number.MAX_SAFE_INTEGER)}function pl(e,t){return"gridDestroyService"===(null===e||void 0===e?void 0:e.beanName)?-1:0}var fl=class extends He{constructor(){super(...arguments),this.beanName="ctrlsFactory",this.registry={}}register(e){this.registry[e.name]=e.classImp}getInstance(e){const t=this.registry[e];if(null!=t){for(var i=arguments.length,r=new Array(i>1?i-1:0),n=1;n<i;n++)r[n-1]=arguments[n];return new t(...r)}}},ml=class extends He{constructor(){super(...arguments),this.beanName="ctrlsService",this.params={gridCtrl:void 0,gridBodyCtrl:void 0,center:void 0,left:void 0,right:void 0,bottomCenter:void 0,bottomLeft:void 0,bottomRight:void 0,topCenter:void 0,topLeft:void 0,topRight:void 0,stickyTopCenter:void 0,stickyTopLeft:void 0,stickyTopRight:void 0,stickyBottomCenter:void 0,stickyBottomLeft:void 0,stickyBottomRight:void 0,fakeHScrollComp:void 0,fakeVScrollComp:void 0,gridHeaderCtrl:void 0,centerHeader:void 0,leftHeader:void 0,rightHeader:void 0},this.ready=!1,this.readyCallbacks=[],this.runReadyCallbacksAsync=!1}wireBeans(e){var t,i,r;this.runReadyCallbacksAsync=null!==(t=null===(i=(r=e.frameworkOverrides).runWhenReadyAsync)||void 0===i?void 0:i.call(r))&&void 0!==t&&t}postConstruct(){this.addEventListener("ready",(()=>{this.updateReady(),this.ready&&(this.readyCallbacks.forEach((e=>e(this.params))),this.readyCallbacks.length=0)}),this.runReadyCallbacksAsync)}updateReady(){this.ready=Object.values(this.params).every((e=>{var t;return null!==(t=null===e||void 0===e?void 0:e.isAlive())&&void 0!==t&&t}))}whenReady(e,t){this.ready?t(this.params):this.readyCallbacks.push(t),e.addDestroyFunc((()=>{const e=this.readyCallbacks.indexOf(t);e>=0&&this.readyCallbacks.splice(e,1)}))}register(e,t){this.params[e]=t,this.updateReady(),this.ready&&this.dispatchLocalEvent({type:"ready"}),t.addDestroyFunc((()=>{this.updateReady()}))}get(e){return this.params[e]}getGridBodyCtrl(){return this.params.gridBodyCtrl}getHeaderRowContainerCtrls(){const{leftHeader:e,centerHeader:t,rightHeader:i}=this.params;return[e,i,t]}getHeaderRowContainerCtrl(e){const t=this.params;switch(e){case"left":return t.leftHeader;case"right":return t.rightHeader;default:return t.centerHeader}}},vl=class extends He{constructor(){super(...arguments),this.beanName="cellPositionUtils"}createId(e){const{rowIndex:t,rowPinned:i,column:r}=e;return this.createIdFromValues({rowIndex:t,column:r,rowPinned:i})}createIdFromValues(e){const{rowIndex:t,rowPinned:i,column:r}=e;return"".concat(t,".").concat(null==i?"null":i,".").concat(r.getId())}equals(e,t){const i=e.column===t.column,r=e.rowPinned===t.rowPinned,n=e.rowIndex===t.rowIndex;return i&&r&&n}},Cl=class extends He{constructor(){super(...arguments),this.beanName="rowNodeEventThrottle",this.events=[]}wireBeans(e){this.animationFrameService=e.animationFrameService,this.rowModel=e.rowModel}postConstruct(){G(this.gos)&&(this.clientSideRowModel=this.rowModel)}dispatchExpanded(e,t){if(null==this.clientSideRowModel)return void this.eventService.dispatchEvent(e);this.events.push(e);const i=()=>{this.clientSideRowModel&&this.clientSideRowModel.onRowGroupOpened(),this.events.forEach((e=>this.eventService.dispatchEvent(e))),this.events=[]};t?i():(null==this.dispatchExpandedDebounced&&(this.dispatchExpandedDebounced=this.animationFrameService.debounce(i)),this.dispatchExpandedDebounced())}},wl=class extends He{constructor(){super(...arguments),this.beanName="rowPositionUtils"}wireBeans(e){this.rowModel=e.rowModel,this.pinnedRowModel=e.pinnedRowModel,this.pageBoundsService=e.pageBoundsService}getFirstRow(){let e,t=0;return this.pinnedRowModel.getPinnedTopRowCount()?e="top":this.rowModel.getRowCount()?(e=null,t=this.pageBoundsService.getFirstRow()):this.pinnedRowModel.getPinnedBottomRowCount()&&(e="bottom"),void 0===e?null:{rowIndex:t,rowPinned:e}}getLastRow(){let e,t=null;const i=this.pinnedRowModel.getPinnedBottomRowCount(),r=this.pinnedRowModel.getPinnedTopRowCount();return i?(t="bottom",e=i-1):this.rowModel.getRowCount()?(t=null,e=this.pageBoundsService.getLastRow()):r&&(t="top",e=r-1),void 0===e?null:{rowIndex:e,rowPinned:t}}getRowNode(e){switch(e.rowPinned){case"top":return this.pinnedRowModel.getPinnedTopRow(e.rowIndex);case"bottom":return this.pinnedRowModel.getPinnedBottomRow(e.rowIndex);default:return this.rowModel.getRow(e.rowIndex)}}sameRow(e,t){return!e&&!t||!(e&&!t||!e&&t)&&(e.rowIndex===t.rowIndex&&e.rowPinned==t.rowPinned)}before(e,t){switch(e.rowPinned){case"top":if("top"!==t.rowPinned)return!0;break;case"bottom":if("bottom"!==t.rowPinned)return!1;break;default:if(F(t.rowPinned))return"top"!==t.rowPinned}return e.rowIndex<t.rowIndex}},bl={cssName:"--ag-row-height",changeKey:"rowHeightChanged",defaultValue:42},Sl={cssName:"--ag-header-height",changeKey:"headerHeightChanged",defaultValue:48},yl={cssName:"--ag-list-item-height",changeKey:"listItemHeightChanged",defaultValue:24},Rl=class extends He{constructor(){super(...arguments),this.beanName="environment",this.sizeEls=new Map,this.lastKnownValues=new Map,this.ancestorThemeClasses=[],this.sizesMeasured=!1,this.gridTheme=null}wireBeans(e){this.resizeObserverService=e.resizeObserverService,this.eGridDiv=e.eGridDiv}postConstruct(){this.addManagedPropertyListener("theme",(()=>this.handleThemeGridOptionChange())),this.handleThemeGridOptionChange(),this.addDestroyFunc((()=>this.stopUsingTheme())),this.addManagedPropertyListener("rowHeight",(()=>this.refreshRowHeightVariable())),this.ancestorThemeClasses=this.readAncestorThemeClasses(),this.setUpThemeClassObservers(),this.getSizeEl(bl),this.getSizeEl(Sl),this.getSizeEl(yl)}getDefaultRowHeight(){return this.getCSSVariablePixelValue(bl)}getDefaultHeaderHeight(){return this.getCSSVariablePixelValue(Sl)}getDefaultColumnMinWidth(){return Math.min(36,this.getDefaultRowHeight())}getDefaultListItemHeight(){return this.getCSSVariablePixelValue(yl)}hasMeasuredSizes(){return this.sizesMeasured}getGridThemeClass(){var e;return(null===(e=this.gridTheme)||void 0===e?void 0:e.getCssClass())||null}getThemeClasses(){return this.gridTheme?[this.gridTheme.getCssClass()]:this.ancestorThemeClasses}applyThemeClasses(e){const t=this.getThemeClasses();for(const i of Array.from(e.classList))i.startsWith("ag-theme-")&&!t.includes(i)&&e.classList.remove(i);e.classList.add(...t)}refreshRowHeightVariable(){const e=this.eGridDiv.style.getPropertyValue("--ag-line-height").trim(),t=this.gos.get("rowHeight");if(null==t||isNaN(t)||!isFinite(t))return null!==e&&this.eGridDiv.style.setProperty("--ag-line-height",null),-1;const i="".concat(t,"px");return e!=i?(this.eGridDiv.style.setProperty("--ag-line-height",i),t):""!=e?parseFloat(e):-1}getCSSVariablePixelValue(e){const t=this.lastKnownValues.get(e);if(null!=t)return t;const i=this.measureSizeEl(e);return"detached"===i||"no-styles"===i?e.defaultValue:(this.lastKnownValues.set(e,i),i)}measureSizeEl(e){const t=this.getSizeEl(e);if(null==t.offsetParent)return"detached";const i=t.offsetWidth;return i===xl?"no-styles":(this.sizesMeasured=!0,i)}getSizeEl(e){let t=this.sizeEls.get(e);if(t)return t;let i=this.eMeasurementContainer;i||(i=this.eMeasurementContainer=document.createElement("div"),i.className="ag-measurement-container",this.gos.get("theme")&&this.applyThemeClasses(i),this.eGridDiv.appendChild(i)),t=document.createElement("div"),t.style.width="var(".concat(e.cssName,", ").concat(xl,"px)"),i.appendChild(t),this.sizeEls.set(e,t);let r=this.measureSizeEl(e);"no-styles"===r&&v("no value for ".concat(e.cssName,". This usually means that the grid has been initialised before styles have been loaded. The default value of ").concat(e.defaultValue," will be used and updated when styles load."));const n=this.resizeObserverService.observeResize(t,(()=>{const t=this.measureSizeEl(e);"detached"!==t&&"no-styles"!==t&&(this.lastKnownValues.set(e,t),t!==r&&(r=t,this.fireGridStylesChangedEvent(e.changeKey)))}));return this.addDestroyFunc((()=>n())),t}fireGridStylesChangedEvent(e){this.eventService.dispatchEvent({type:"gridStylesChanged",[e]:!0})}setUpThemeClassObservers(){const e=new MutationObserver((()=>{const e=this.readAncestorThemeClasses();El(e,this.ancestorThemeClasses)||(this.ancestorThemeClasses=e,this.fireGridStylesChangedEvent("themeChanged"))}));let t=this.eGridDiv;for(;t;)e.observe(t||this.eGridDiv,{attributes:!0,attributeFilter:["class"]}),t=t.parentElement;this.addDestroyFunc((()=>e.disconnect()))}readAncestorThemeClasses(){let e=this.eGridDiv;const t=[];for(;e;){const i=Array.from(e.classList).filter((e=>e.startsWith("ag-theme-")));for(const e of i)t.includes(e)||t.unshift(e);e=e.parentElement}return Object.freeze(t)}handleThemeGridOptionChange(){const{gos:e,eMeasurementContainer:t,gridTheme:i}=this,r=e.get("theme")||null;r!==i&&(null===i||void 0===i||i.stopUse(),this.gridTheme=r,null===r||void 0===r||r.startUse({loadThemeGoogleFonts:e.get("loadThemeGoogleFonts"),container:this.eGridDiv}),t&&this.applyThemeClasses(t),this.fireGridStylesChangedEvent("themeChanged"))}stopUsingTheme(){var e;null===(e=this.gridTheme)||void 0===e||e.stopUse(),this.gridTheme=null}},El=(e,t)=>e.length===t.length&&-1===e.findIndex(((i,r)=>e[r]!==t[r])),xl=15538,Tl=class extends He{constructor(){super(...arguments),this.beanName="eventService",this.globalEventService=new h}wireBeans(e){this.globalEventListener=e.globalEventListener,this.globalSyncEventListener=e.globalSyncEventListener}postConstruct(){if(this.globalEventListener){const e=_(this.gos);this.addGlobalListener(this.globalEventListener,e)}this.globalSyncEventListener&&this.addGlobalListener(this.globalSyncEventListener,!1)}addEventListener(e,t,i){this.globalEventService.addEventListener(e,t,i)}removeEventListener(e,t,i){this.globalEventService.removeEventListener(e,t,i)}addGlobalListener(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.globalEventService.addGlobalListener(e,t)}removeGlobalListener(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.globalEventService.removeGlobalListener(e,t)}dispatchLocalEvent(){}dispatchEvent(e){this.globalEventService.dispatchEvent(this.gos.addGridCommonParams(e))}dispatchEventOnce(e){this.globalEventService.dispatchEventOnce(this.gos.addGridCommonParams(e))}},Fl=class e extends He{constructor(){super(...arguments),this.beanName="focusService"}wireBeans(e){this.eGridDiv=e.eGridDiv,this.columnModel=e.columnModel,this.visibleColsService=e.visibleColsService,this.headerNavigationService=e.headerNavigationService,this.headerPositionUtils=e.headerPositionUtils,this.rowRenderer=e.rowRenderer,this.rowPositionUtils=e.rowPositionUtils,this.cellPositionUtils=e.cellPositionUtils,this.navigationService=e.navigationService,this.ctrlsService=e.ctrlsService,this.filterManager=e.filterManager,this.rangeService=e.rangeService,this.advancedFilterService=e.advancedFilterService,this.overlayService=e.overlayService}static addKeyboardModeEvents(t){this.instanceCount>0||(t.addEventListener("keydown",e.toggleKeyboardMode),t.addEventListener("mousedown",e.toggleKeyboardMode))}static removeKeyboardModeEvents(t){this.instanceCount>0||(t.removeEventListener("keydown",e.toggleKeyboardMode),t.removeEventListener("mousedown",e.toggleKeyboardMode))}static toggleKeyboardMode(t){const i=e.keyboardModeActive,r="keydown"===t.type;r&&(t.ctrlKey||t.metaKey||t.altKey)||i!==r&&(e.keyboardModeActive=r)}postConstruct(){const e=this.clearFocusedCell.bind(this);this.addManagedEventListeners({columnPivotModeChanged:e,newColumnsLoaded:this.onColumnEverythingChanged.bind(this),columnGroupOpened:e,columnRowGroupChanged:e}),this.registerKeyboardFocusEvents(),this.ctrlsService.whenReady(this,(e=>{this.gridCtrl=e.gridCtrl}))}registerKeyboardFocusEvents(){const t=Q(this.gos);e.addKeyboardModeEvents(t),e.instanceCount++,this.addDestroyFunc((()=>{e.instanceCount--,e.removeKeyboardModeEvents(t)}))}onColumnEverythingChanged(){if(!this.focusedCellPosition)return;const e=this.focusedCellPosition.column,t=this.columnModel.getCol(e.getId());e!==t&&this.clearFocusedCell()}isKeyboardMode(){return e.keyboardModeActive}getFocusCellToUseAfterRefresh(){return this.gos.get("suppressFocusAfterRefresh")||!this.focusedCellPosition||this.isDomDataMissingInHierarchy(Z(this.gos),Os.DOM_DATA_KEY_ROW_CTRL)?null:this.focusedCellPosition}getFocusHeaderToUseAfterRefresh(){return this.gos.get("suppressFocusAfterRefresh")||!this.focusedHeaderPosition||this.isDomDataMissingInHierarchy(Z(this.gos),Fo.DOM_DATA_KEY_HEADER_CTRL)?null:this.focusedHeaderPosition}isDomDataMissingInHierarchy(e,t){let i=e;for(;i;){if(Y(this.gos,i,t))return!1;i=i.parentNode}return!0}getFocusedCell(){return this.focusedCellPosition}shouldRestoreFocus(e){return!!this.isCellRestoreFocused(e)&&(setTimeout((()=>{this.restoredFocusedCellPosition=null}),0),!0)}clearRestoreFocus(){this.restoredFocusedCellPosition=null,this.awaitRestoreFocusedCell=!1}restoreFocusedCell(e,t){this.awaitRestoreFocusedCell=!0,setTimeout((()=>{this.awaitRestoreFocusedCell&&(this.setRestoreFocusedCell(e),t())}))}isCellRestoreFocused(e){return null!=this.restoredFocusedCellPosition&&this.cellPositionUtils.equals(e,this.restoredFocusedCellPosition)}setRestoreFocusedCell(e){"react"===this.getFrameworkOverrides().renderingEngine&&(this.restoredFocusedCellPosition=e)}getFocusEventParams(e){const{rowIndex:t,rowPinned:i,column:r}=e,n={rowIndex:t,rowPinned:i,column:r,isFullWidthCell:!1},o=this.rowRenderer.getRowByPosition({rowIndex:t,rowPinned:i});return o&&(n.isFullWidthCell=o.isFullWidth()),n}clearFocusedCell(){if(this.restoredFocusedCellPosition=null,null==this.focusedCellPosition)return;const e=this.getFocusEventParams(this.focusedCellPosition);this.focusedCellPosition=null,this.eventService.dispatchEvent(c({type:"cellFocusCleared"},e))}setFocusedCell(e){const{column:t,rowIndex:i,rowPinned:r,forceBrowserFocus:n=!1,preventScrollOnBrowserFocus:o=!1}=e,s=this.columnModel.getCol(t);s?(this.focusedCellPosition={rowIndex:i,rowPinned:T(r),column:s},this.eventService.dispatchEvent(c(c({type:"cellFocused"},this.getFocusEventParams(this.focusedCellPosition)),{},{forceBrowserFocus:n,preventScrollOnBrowserFocus:o}))):this.focusedCellPosition=null}isCellFocused(e){return null!=this.focusedCellPosition&&this.cellPositionUtils.equals(e,this.focusedCellPosition)}isRowNodeFocused(e){return this.isRowFocused(e.rowIndex,e.rowPinned)}isHeaderWrapperFocused(e){if(null==this.focusedHeaderPosition)return!1;const t=e.getColumnGroupChild(),i=e.getRowIndex(),r=e.getPinned(),{column:n,headerRowIndex:o}=this.focusedHeaderPosition;return t===n&&i===o&&r==n.getPinned()}clearFocusedHeader(){this.focusedHeaderPosition=null}getFocusedHeader(){return this.focusedHeaderPosition}setFocusedHeader(e,t){this.focusedHeaderPosition={headerRowIndex:e,column:t}}isHeaderFocusSuppressed(){return this.gos.get("suppressHeaderFocus")||this.overlayService.isExclusive()}isCellFocusSuppressed(){return this.gos.get("suppressCellFocus")||this.overlayService.isExclusive()}focusHeaderPosition(e){var t;if(this.isHeaderFocusSuppressed())return!1;const{direction:i,fromTab:r,allowUserOverride:n,event:o,fromCell:s,rowWithoutSpanValue:a}=e;let{headerPosition:l}=e;if(s&&null!==(t=this.filterManager)&&void 0!==t&&t.isAdvancedFilterHeaderActive())return this.focusAdvancedFilter(l);if(n){const e=this.getFocusedHeader(),t=this.headerNavigationService.getHeaderRowCount();if(r){const r=this.gos.getCallback("tabToNextHeader");r&&(l=this.getHeaderPositionFromUserFunc({userFunc:r,direction:i,currentPosition:e,headerPosition:l,headerRowCount:t}))}else{const i=this.gos.getCallback("navigateToNextHeader");if(i&&o){l=i({key:o.key,previousHeaderPosition:e,nextHeaderPosition:l,headerRowCount:t,event:o})}}}return!!l&&this.focusProvidedHeaderPosition({headerPosition:l,direction:i,event:o,fromCell:s,rowWithoutSpanValue:a})}focusHeaderPositionFromUserFunc(e){if(this.isHeaderFocusSuppressed())return!1;const{userFunc:t,headerPosition:i,direction:r,event:n}=e,o=this.getFocusedHeader(),s=this.headerNavigationService.getHeaderRowCount(),a=this.getHeaderPositionFromUserFunc({userFunc:t,direction:r,currentPosition:o,headerPosition:i,headerRowCount:s});return!!a&&this.focusProvidedHeaderPosition({headerPosition:a,direction:r,event:n})}getHeaderPositionFromUserFunc(e){const{userFunc:t,direction:i,currentPosition:r,headerPosition:n,headerRowCount:o}=e,s=t({backwards:"Before"===i,previousHeaderPosition:r,nextHeaderPosition:n,headerRowCount:o});return!0===s||null===s?(null===s&&v("Since v31.3 Returning `null` from tabToNextHeader is deprecated. Return `true` to stay on the current header, or `false` to let the browser handle the tab behaviour."),r):!1===s?null:s}focusProvidedHeaderPosition(e){const{headerPosition:t,direction:i,fromCell:r,rowWithoutSpanValue:n,event:o}=e,{column:s,headerRowIndex:a}=t;var l;if(-1===a)return null!==(l=this.filterManager)&&void 0!==l&&l.isAdvancedFilterHeaderActive()?this.focusAdvancedFilter(t):this.focusGridView(s);this.headerNavigationService.scrollToColumn(s,i);const c=this.ctrlsService.getHeaderRowContainerCtrl(s.getPinned()),u=(null===c||void 0===c?void 0:c.focusHeader(t.headerRowIndex,s,o))||!1;return u&&(null!=n||r)&&this.headerNavigationService.setCurrentHeaderRowWithoutSpan(null!==n&&void 0!==n?n:-1),u}focusFirstHeader(){if(this.overlayService.isExclusive()&&this.focusOverlay())return!0;let e=this.visibleColsService.getAllCols()[0];if(!e)return!1;e.getParent()&&(e=this.visibleColsService.getColGroupAtLevel(e,0));const t=this.headerPositionUtils.getHeaderIndexToFocus(e,0);return this.focusHeaderPosition({headerPosition:t,rowWithoutSpanValue:0})}focusLastHeader(e){if(this.overlayService.isExclusive()&&this.focusOverlay(!0))return!0;const t=this.headerNavigationService.getHeaderRowCount()-1,i=ye(this.visibleColsService.getAllCols());return this.focusHeaderPosition({headerPosition:{headerRowIndex:t,column:i},rowWithoutSpanValue:-1,event:e})}focusPreviousFromFirstCell(e){var t;return null!==(t=this.filterManager)&&void 0!==t&&t.isAdvancedFilterHeaderActive()?this.focusAdvancedFilter(null):this.focusLastHeader(e)}isAnyCellFocused(){return!!this.focusedCellPosition}isRowFocused(e,t){return null!=this.focusedCellPosition&&(this.focusedCellPosition.rowIndex===e&&this.focusedCellPosition.rowPinned===T(t))}findFocusableElements(e,t){let i=Ii;t&&(i+=", "+t),arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&(i+=', [tabindex="-1"]');const r=Array.prototype.slice.apply(e.querySelectorAll("[tabindex], input, select, button, textarea, [href]")).filter((e=>$i(e))),n=Array.prototype.slice.apply(e.querySelectorAll(i));if(!n.length)return r;return o=n,r.filter((e=>-1===o.indexOf(e)));var o}focusInto(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=this.findFocusableElements(e,null,i),n=t?ye(r):r[0];return!!n&&(n.focus({preventScroll:!0}),!0)}findFocusableElementBeforeTabGuard(e,t){if(!t)return null;const i=this.findFocusableElements(e),r=i.indexOf(t);if(-1===r)return null;let n=-1;for(let o=r-1;o>=0;o--)if(i[o].classList.contains("ag-tab-guard-top")){n=o;break}return n<=0?null:i[n-1]}findNextFocusableElement(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.eGridDiv,t=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;const r=this.findFocusableElements(e,t?':not([tabindex="-1"])':null),n=Z(this.gos);let o;o=t?r.findIndex((e=>e.contains(n))):r.indexOf(n);const s=o+(i?-1:1);return s<0||s>=r.length?null:r[s]}isTargetUnderManagedComponent(e,t){if(!t)return!1;const i=e.querySelectorAll(".".concat(Nn.FOCUS_MANAGED_CLASS));if(!i.length)return!1;for(let r=0;r<i.length;r++)if(i[r].contains(t))return!0;return!1}findTabbableParent(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,i=0;for(;e&&null===ki(e)&&++i<=t;)e=e.parentElement;return null===ki(e)?null:e}focusOverlay(e){var t;const i=this.overlayService.isVisible()&&(null===(t=this.overlayService.getOverlayWrapper())||void 0===t?void 0:t.getGui());return!!i&&this.focusInto(i,e)}focusGridViewFailed(e,t){return t&&this.focusOverlay(e)||e&&this.focusLastHeader()}focusGridView(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.overlayService.isExclusive())return i&&this.focusOverlay(t);if(this.isCellFocusSuppressed())return t&&!this.isHeaderFocusSuppressed()?this.focusLastHeader():!(!i||!this.focusOverlay(t))||this.focusNextGridCoreContainer(!1);const r=t?this.rowPositionUtils.getLastRow():this.rowPositionUtils.getFirstRow();if(r){var n,o;const{rowIndex:i,rowPinned:a}=r;if(null!==(n=e)&&void 0!==n||(e=null===(o=this.getFocusedHeader())||void 0===o?void 0:o.column),e&&void 0!==i&&null!==i){var s;if(this.navigationService.ensureCellVisible({rowIndex:i,column:e,rowPinned:a}),t){const e=this.rowRenderer.getRowByPosition(r);if(null!==e&&void 0!==e&&e.isFullWidth()&&this.navigationService.tryToFocusFullWidthRow(r,t))return!0}return this.setFocusedCell({rowIndex:i,column:e,rowPinned:T(a),forceBrowserFocus:!0}),null===(s=this.rangeService)||void 0===s||s.setRangeToCell({rowIndex:i,rowPinned:a,column:e}),!0}}return!(!i||!this.focusOverlay(t))||!(!t||!this.focusLastHeader())}isGridFocused(){const e=Z(this.gos);return!!e&&this.eGridDiv.contains(e)}focusNextGridCoreContainer(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!(t||!this.gridCtrl.focusNextInnerContainer(e))||((t||!e&&!this.gridCtrl.isDetailGrid())&&this.gridCtrl.forceFocusOutOfContainer(e),!1)}focusAdvancedFilter(e){var t,i;return this.advancedFilterFocusColumn=null===e||void 0===e?void 0:e.column,null!==(t=null===(i=this.advancedFilterService)||void 0===i?void 0:i.getCtrl().focusHeaderComp())&&void 0!==t&&t}focusNextFromAdvancedFilter(e,t){var i,r;const n=null!==(i=t?void 0:this.advancedFilterFocusColumn)&&void 0!==i?i:null===(r=this.visibleColsService.getAllCols())||void 0===r?void 0:r[0];return e?this.focusHeaderPosition({headerPosition:{column:n,headerRowIndex:this.headerNavigationService.getHeaderRowCount()-1}}):this.focusGridView(n)}clearAdvancedFilterColumn(){this.advancedFilterFocusColumn=void 0}addFocusableContainer(e){this.gridCtrl.addFocusableContainer(e)}removeFocusableContainer(e){this.gridCtrl.removeFocusableContainer(e)}focusGridInnerElement(e){return this.gridCtrl.focusInnerElement(e)}allowFocusForNextGridCoreContainer(e){this.gridCtrl.allowFocusForNextCoreContainer(e)}};Fl.keyboardModeActive=!1,Fl.instanceCount=0;var Pl=Fl,Dl=class extends He{constructor(){super(...arguments),this.beanName="pinnedWidthService"}wireBeans(e){this.visibleColsService=e.visibleColsService}postConstruct(){const e=this.checkContainerWidths.bind(this);this.addManagedEventListeners({displayedColumnsChanged:e,displayedColumnsWidthChanged:e}),this.addManagedPropertyListener("domLayout",e)}checkContainerWidths(){const e=z(this.gos,"print"),t=e?0:this.visibleColsService.getColsLeftWidth(),i=e?0:this.visibleColsService.getDisplayedColumnsRightWidth();t!=this.leftWidth&&(this.leftWidth=t,this.eventService.dispatchEvent({type:"leftPinnedWidthChanged"})),i!=this.rightWidth&&(this.rightWidth=i,this.eventService.dispatchEvent({type:"rightPinnedWidthChanged"}))}getPinnedRightWidth(){return this.rightWidth}getPinnedLeftWidth(){return this.leftWidth}},kl=class extends He{constructor(){super(...arguments),this.additionalFocusableContainers=new Set}wireBeans(e){this.beans=e,this.focusService=e.focusService,this.visibleColsService=e.visibleColsService}setComp(e,t,i){this.view=e,this.eGridHostDiv=t,this.eGui=i,this.eGui.setAttribute("grid-id",this.beans.context.getGridId());const{dragAndDropService:r,mouseEventService:n,ctrlsService:o,resizeObserverService:s}=this.beans,a={getContainer:()=>this.eGui,isInterestedIn:e=>1===e||0===e,getIconName:()=>"notAllowed"};r.addDropTarget(a),this.addDestroyFunc((()=>r.removeDropTarget(a))),n.stampTopLevelGridCompWithGridInstance(t),this.createManagedBean(new hs(this.view)),this.view.setRtlClass(this.gos.get("enableRtl")?"ag-rtl":"ag-ltr"),this.updateGridThemeClass(),this.addManagedEventListeners({gridStylesChanged:this.handleThemeChange.bind(this)});const l=s.observeResize(this.eGridHostDiv,this.onGridSizeChanged.bind(this));this.addDestroyFunc((()=>l())),o.register("gridCtrl",this)}isDetailGrid(){var e;const t=this.focusService.findTabbableParent(this.getGui());return(null===t||void 0===t||null===(e=t.getAttribute("row-id"))||void 0===e?void 0:e.startsWith("detail"))||!1}getOptionalSelectors(){var e,t,i,r,n;const o=this.beans;return{paginationSelector:null===(e=o.paginationService)||void 0===e?void 0:e.getPaginationSelector(),gridHeaderDropZonesSelector:null===(t=o.columnDropZonesService)||void 0===t?void 0:t.getDropZoneSelector(),sideBarSelector:null===(i=o.sideBarService)||void 0===i?void 0:i.getSideBarSelector(),statusBarSelector:null===(r=o.statusBarService)||void 0===r?void 0:r.getStatusPanelSelector(),watermarkSelector:null===(n=o.licenseManager)||void 0===n?void 0:n.getWatermarkSelector()}}onGridSizeChanged(){this.eventService.dispatchEvent({type:"gridSizeChanged",clientWidth:this.eGridHostDiv.clientWidth,clientHeight:this.eGridHostDiv.clientHeight})}destroyGridUi(){this.view.destroyGridUi()}getGui(){return this.eGui}setResizeCursor(e){this.view.setCursor(e?"ew-resize":null)}disableUserSelect(e){this.view.setUserSelect(e?"none":null)}focusNextInnerContainer(e){const t=this.getFocusableContainers(),{indexWithFocus:i,nextIndex:r}=this.getNextFocusableIndex(t,e);if(r<0||r>=t.length)return!1;if(0===r){if(i>0){const e=ye(this.visibleColsService.getAllCols());if(this.focusService.focusGridView(e,!0))return!0}return!1}return this.focusContainer(t[r],e)}focusInnerElement(e){const t=this.gos.getCallback("focusGridInnerElement");if(t&&t({fromBottom:!!e}))return!0;const i=this.getFocusableContainers(),r=this.visibleColsService.getAllCols();if(e){if(i.length>1)return this.focusContainer(ye(i),!0);const e=ye(r);if(this.focusService.focusGridView(e,!0))return!0}if(0===this.gos.get("headerHeight")||this.focusService.isHeaderFocusSuppressed()){if(this.focusService.focusGridView(r[0]))return!0;for(let e=1;e<i.length;e++)if(this.focusService.focusInto(i[e].getGui()))return!0;return!1}return this.focusService.focusFirstHeader()}forceFocusOutOfContainer(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.view.forceFocusOutOfContainer(e)}addFocusableContainer(e){this.additionalFocusableContainers.add(e)}removeFocusableContainer(e){this.additionalFocusableContainers.delete(e)}allowFocusForNextCoreContainer(e){var t;const i=this.view.getFocusableContainers(),{nextIndex:r,indexWithFocus:n}=this.getNextFocusableIndex(i,e);if(-1===n||r<0||r>=i.length)return;const o=i[r];null===(t=o.setAllowFocus)||void 0===t||t.call(o,!0),setTimeout((()=>{var e;null===(e=o.setAllowFocus)||void 0===e||e.call(o,!1)}))}getNextFocusableIndex(e,t){const i=Z(this.gos),r=e.findIndex((e=>e.getGui().contains(i)));return{indexWithFocus:r,nextIndex:r+(t?-1:1)}}focusContainer(e,t){var i,r;null===(i=e.setAllowFocus)||void 0===i||i.call(e,!0);const n=this.focusService.focusInto(e.getGui(),t);return null===(r=e.setAllowFocus)||void 0===r||r.call(e,!1),n}getFocusableContainers(){return[...this.view.getFocusableContainers(),...this.additionalFocusableContainers]}updateGridThemeClass(){const e=this.beans.environment.getGridThemeClass();e&&this.view.setGridThemeClass(e)}handleThemeChange(e){e.themeChanged&&this.updateGridThemeClass()}destroy(){this.additionalFocusableContainers.clear(),super.destroy()}},Al={version:Do,moduleName:"@ag-grid-community/aligned-grid",beans:[class extends He{constructor(){super(...arguments),this.beanName="alignedGridsService",this.consuming=!1}wireBeans(e){this.columnModel=e.columnModel,this.columnSizeService=e.columnSizeService,this.ctrlsService=e.ctrlsService,this.columnApplyStateService=e.columnApplyStateService}getAlignedGridApis(){var e;let t=null!==(e=this.gos.get("alignedGrids"))&&void 0!==e?e:[];const i="function"===typeof t;"function"===typeof t&&(t=t());const r=()=>"See ".concat(this.getFrameworkOverrides().getDocLink("aligned-grids"));return t.map((e=>{if(!e)return C("alignedGrids contains an undefined option."),i||C('You may want to configure via a callback to avoid setup race conditions:\n                     "alignedGrids: () => [linkedGrid]"'),void C(r());if(this.isGridApi(e))return e;const t=e;var n;return"current"in t?null===(n=t.current)||void 0===n?void 0:n.api:(t.api||C("alignedGrids - No api found on the linked grid. If you are passing gridOptions to alignedGrids since v31 this is no longer valid. ".concat(r())),t.api)})).filter((e=>!!e&&!e.isDestroyed()))}isGridApi(e){return!!e&&!!e.dispatchEvent}postConstruct(){const e=this.fireColumnEvent.bind(this);this.addManagedEventListeners({columnMoved:e,columnVisible:e,columnPinned:e,columnGroupOpened:e,columnResized:e,bodyScroll:this.fireScrollEvent.bind(this),alignedGridColumn:e=>{let{event:t}=e;return this.onColumnEvent(t)},alignedGridScroll:e=>{let{event:t}=e;return this.onScrollEvent(t)}})}fireEvent(e){this.consuming||this.getAlignedGridApis().forEach((t=>{t.isDestroyed()||t.dispatchEvent(e)}))}onEvent(e){this.consuming=!0,e(),this.consuming=!1}fireColumnEvent(e){this.fireEvent({type:"alignedGridColumn",event:e})}fireScrollEvent(e){"horizontal"===e.direction&&this.fireEvent({type:"alignedGridScroll",event:e})}onScrollEvent(e){this.onEvent((()=>{this.ctrlsService.getGridBodyCtrl().getScrollFeature().setHorizontalScrollPosition(e.left,!0)}))}extractDataFromEvent(e,t){const i=[];return e.columns?e.columns.forEach((e=>{i.push(t(e))})):e.column&&i.push(t(e.column)),i}getMasterColumns(e){return this.extractDataFromEvent(e,(e=>e))}getColumnIds(e){return this.extractDataFromEvent(e,(e=>e.getColId()))}onColumnEvent(e){this.onEvent((()=>{switch(e.type){case"columnMoved":case"columnVisible":case"columnPinned":case"columnResized":this.processColumnEvent(e);break;case"columnGroupOpened":this.processGroupOpenedEvent(e);break;case"columnPivotChanged":v("pivoting is not supported with aligned grids. You can only use one of these features at a time in a grid.")}}))}processGroupOpenedEvent(e){const{columnModel:t}=this;e.columnGroups.forEach((e=>{let i=null;e&&(i=t.getProvidedColGroup(e.getGroupId())),e&&!i||t.setColumnGroupOpened(i,e.isExpanded(),"alignedGridChanged")}))}processColumnEvent(e){const t=e.column;let i=null;if(t&&(i=this.columnModel.getColDefCol(t.getColId())),t&&!i)return;const r=this.getMasterColumns(e),{columnApplyStateService:n,columnSizeService:o,ctrlsService:s}=this;switch(e.type){case"columnMoved":{const t=e.api.getColumnState().map((e=>({colId:e.colId})));n.applyColumnState({state:t,applyOrder:!0},"alignedGridChanged")}break;case"columnVisible":{const t=e.api.getColumnState().map((e=>({colId:e.colId,hide:e.hide})));n.applyColumnState({state:t},"alignedGridChanged")}break;case"columnPinned":{const t=e.api.getColumnState().map((e=>({colId:e.colId,pinned:e.pinned})));n.applyColumnState({state:t},"alignedGridChanged")}break;case"columnResized":{var a;const t=e,i={};r.forEach((e=>{i[e.getId()]={key:e.getColId(),newWidth:e.getActualWidth()}})),null===(a=t.flexColumns)||void 0===a||a.forEach((e=>{i[e.getId()]&&delete i[e.getId()]})),o.setColumnWidths(Object.values(i),!1,t.finished,"alignedGridChanged");break}}const l=s.getGridBodyCtrl().isVerticalScrollShowing();this.getAlignedGridApis().forEach((e=>{e.setGridOption("alwaysShowVerticalScroll",l)}))}}]};var Ml={version:Do,moduleName:"@ag-grid-community/data-type",beans:[class extends He{constructor(){super(...arguments),this.beanName="dataTypeService",this.dataTypeDefinitions={},this.isWaitingForRowData=!1,this.isColumnTypeOverrideInDataTypeDefinitions=!1,this.columnStateUpdatesPendingInference={},this.columnStateUpdateListenerDestroyFuncs=[]}wireBeans(e){this.rowModel=e.rowModel,this.columnModel=e.columnModel,this.funcColsService=e.funcColsService,this.valueService=e.valueService,this.columnApplyStateService=e.columnApplyStateService,this.filterManager=e.filterManager}postConstruct(){this.groupHideOpenParents=this.gos.get("groupHideOpenParents"),this.addManagedPropertyListener("groupHideOpenParents",(()=>{this.groupHideOpenParents=this.gos.get("groupHideOpenParents")})),this.processDataTypeDefinitions(),this.addManagedPropertyListener("dataTypeDefinitions",(e=>{this.processDataTypeDefinitions(),this.columnModel.recreateColumnDefs(mt(e.source))}))}processDataTypeDefinitions(){var e;const t=this.getDefaultDataTypes();this.dataTypeDefinitions={},this.formatValueFuncs={};const i=e=>t=>{const{column:i,node:r,value:n}=t;let o=i.getColDef().valueFormatter;return o===e.groupSafeValueFormatter&&(o=e.valueFormatter),this.valueService.formatValue(i,r,n,o)};Object.entries(t).forEach((e=>{let[t,r]=e;const n=c(c({},r),{},{groupSafeValueFormatter:this.createGroupSafeValueFormatter(r)});this.dataTypeDefinitions[t]=n,this.formatValueFuncs[t]=i(n)}));const r=null!==(e=this.gos.get("dataTypeDefinitions"))&&void 0!==e?e:{};this.dataTypeMatchers={},Object.entries(r).forEach((e=>{let[n,o]=e;const s=this.processDataTypeDefinition(o,r,[n],t);s&&(this.dataTypeDefinitions[n]=s,o.dataTypeMatcher&&(this.dataTypeMatchers[n]=o.dataTypeMatcher),this.formatValueFuncs[n]=i(s))})),this.checkObjectValueHandlers(t),["dateString","text","number","boolean","date"].forEach((e=>{const i=this.dataTypeMatchers[e];i&&delete this.dataTypeMatchers[e],this.dataTypeMatchers[e]=null!==i&&void 0!==i?i:t[e].dataTypeMatcher}))}mergeDataTypeDefinitions(e,t){const i=c(c({},e),t);return e.columnTypes&&t.columnTypes&&t.appendColumnTypes&&(i.columnTypes=[...$e(e.columnTypes),...$e(t.columnTypes)]),i}processDataTypeDefinition(e,t,i,r){let n;const o=e.extendsDataType;if(e.columnTypes&&(this.isColumnTypeOverrideInDataTypeDefinitions=!0),e.extendsDataType===e.baseDataType){let i=r[o];const s=t[o];if(i&&s&&(i=s),!this.validateDataTypeDefinition(e,i,o))return;n=this.mergeDataTypeDefinitions(i,e)}else{if(i.includes(o))return void v('Data type definition hierarchies (via the "extendsDataType" property) cannot contain circular references.');const s=t[o];if(!this.validateDataTypeDefinition(e,s,o))return;const a=this.processDataTypeDefinition(s,t,[...i,o],r);if(!a)return;n=this.mergeDataTypeDefinitions(a,e)}return c(c({},n),{},{groupSafeValueFormatter:this.createGroupSafeValueFormatter(n)})}validateDataTypeDefinition(e,t,i){return t?t.baseDataType===e.baseDataType||(v('The "baseDataType" property of a data type definition must match that of its parent.'),!1):(v("The data type definition ".concat(i," does not exist.")),!1)}createGroupSafeValueFormatter(e){if(e.valueFormatter)return t=>{var i;if(null!==(i=t.node)&&void 0!==i&&i.group){var r;const i=(null!==(r=t.colDef.pivotValueColumn)&&void 0!==r?r:t.column).getAggFunc();if(i){if("first"===i||"last"===i)return e.valueFormatter(t);if("number"===e.baseDataType&&"count"!==i){if("number"===typeof t.value)return e.valueFormatter(t);if("object"===typeof t.value){if(!t.value)return;if("toNumber"in t.value)return e.valueFormatter(c(c({},t),{},{value:t.value.toNumber()}));if("value"in t.value)return e.valueFormatter(c(c({},t),{},{value:t.value.value}))}}return}if((this.gos.get("suppressGroupMaintainValueType")||"groupRows"===this.gos.get("groupDisplayType"))&&!this.gos.get("treeData"))return}else if(this.groupHideOpenParents&&t.column.isRowGroupActive()){var n;if("string"===typeof t.value&&(null===(n=e.dataTypeMatcher)||void 0===n||!n.call(e,t.value)))return}return e.valueFormatter(t)}}updateColDefAndGetColumnType(e,t,i){let{cellDataType:r}=t;const{field:n}=t;if(void 0===r&&(r=e.cellDataType),null!=r&&!0!==r||(r=!!this.canInferCellDataType(e,t)&&this.inferCellDataType(n,i)),!r)return void(e.cellDataType=!1);const o=this.dataTypeDefinitions[r];if(o)return e.cellDataType=r,o.groupSafeValueFormatter&&(e.valueFormatter=o.groupSafeValueFormatter),o.valueParser&&(e.valueParser=o.valueParser),o.suppressDefaultProperties||this.setColDefPropertiesForBaseDataType(e,r,o,i),o.columnTypes;v('Missing data type definition - "'.concat(r,'"'))}addColumnListeners(e){if(!this.isWaitingForRowData)return;const t=this.columnStateUpdatesPendingInference[e.getColId()];if(!t)return;const i=e=>{t.add(e.key)};e.addEventListener("columnStateUpdated",i),this.columnStateUpdateListenerDestroyFuncs.push((()=>e.removeEventListener("columnStateUpdated",i)))}canInferCellDataType(e,t){if(!G(this.gos))return!1;const i={cellRenderer:!0,valueGetter:!0,valueParser:!0,refData:!0};if(this.doColDefPropsPreventInference(t,i))return!1;const r=null===t.type?e.type:t.type;if(r){var n;const e=null!==(n=this.gos.get("columnTypes"))&&void 0!==n?n:{};if($e(r).some((t=>{const r=e[t.trim()];return r&&this.doColDefPropsPreventInference(r,i)})))return!1}return!this.doColDefPropsPreventInference(e,i)}doColDefPropsPreventInference(e,t){return[["cellRenderer","agSparklineCellRenderer"],["valueGetter",void 0],["valueParser",void 0],["refData",void 0]].some((i=>{let[r,n]=i;return this.doesColDefPropPreventInference(e,t,r,n)}))}doesColDefPropPreventInference(e,t,i,r){if(!t[i])return!1;const n=e[i];return null===n?(t[i]=!1,!1):void 0===r?!!n:n===r}inferCellDataType(e,t){var i;if(!e)return;let r;const n=this.getInitialData();if(n){const t=e.indexOf(".")>=0&&!this.gos.get("suppressFieldDotNotation");r=nt(n,e,t)}else this.initWaitForRowData(t);if(null==r)return;const[o]=null!==(i=Object.entries(this.dataTypeMatchers).find((e=>{let[t,i]=e;return i(r)})))&&void 0!==i?i:["object"];return o}getInitialData(){const e=this.gos.get("rowData");if(null!==e&&void 0!==e&&e.length)return e[0];if(this.initialData)return this.initialData;{const e=this.rowModel.getRootNode().allLeafChildren;if(null!==e&&void 0!==e&&e.length)return e[0].data}return null}initWaitForRowData(e){if(this.columnStateUpdatesPendingInference[e]=new Set,this.isWaitingForRowData)return;this.isWaitingForRowData=!0;const t=this.isColumnTypeOverrideInDataTypeDefinitions;t&&this.columnModel.queueResizeOperations();const[i]=this.addManagedEventListeners({rowDataUpdateStarted:e=>{const{firstRowData:r}=e;r&&(null===i||void 0===i||i(),this.isWaitingForRowData=!1,this.processColumnsPendingInference(r,t),this.columnStateUpdatesPendingInference={},t&&this.columnModel.processResizeOperations(),this.eventService.dispatchEvent({type:"dataTypesInferred"}))}})}isPendingInference(){return this.isWaitingForRowData}processColumnsPendingInference(e,t){this.initialData=e;const i=[];this.destroyColumnStateUpdateListeners();const r={},n={};Object.entries(this.columnStateUpdatesPendingInference).forEach((e=>{let[o,s]=e;const a=this.columnModel.getCol(o);if(!a)return;const l=a.getColDef();if(!this.columnModel.resetColDefIntoCol(a,"cellDataTypeInferred"))return;const c=a.getColDef();if(t&&c.type&&c.type!==l.type){const e=this.getUpdatedColumnState(a,s);e.rowGroup&&null==e.rowGroupIndex&&(r[o]=e),e.pivot&&null==e.pivotIndex&&(n[o]=e),i.push(e)}})),t&&i.push(...this.funcColsService.generateColumnStateForRowGroupAndPivotIndexes(r,n)),i.length&&this.columnApplyStateService.applyColumnState({state:i},"cellDataTypeInferred"),this.initialData=null}getUpdatedColumnState(e,t){const i=this.columnApplyStateService.getColumnStateFromColDef(e);return t.forEach((e=>{delete i[e],"rowGroup"===e?delete i.rowGroupIndex:"pivot"===e&&delete i.pivotIndex})),i}checkObjectValueHandlers(e){const t=this.dataTypeDefinitions.object,i=e.object;this.hasObjectValueParser=t.valueParser!==i.valueParser,this.hasObjectValueFormatter=t.valueFormatter!==i.valueFormatter}getDateStringTypeDefinition(e){var t;return e&&null!==(t=this.getDataTypeDefinition(e))&&void 0!==t?t:this.dataTypeDefinitions.dateString}getDateParserFunction(e){return this.getDateStringTypeDefinition(e).dateParser}getDateFormatterFunction(e){return this.getDateStringTypeDefinition(e).dateFormatter}getDataTypeDefinition(e){const t=e.getColDef();if(t.cellDataType)return this.dataTypeDefinitions[t.cellDataType]}getBaseDataType(e){var t;return null===(t=this.getDataTypeDefinition(e))||void 0===t?void 0:t.baseDataType}checkType(e,t){var i;if(null==t)return!0;const r=null===(i=this.getDataTypeDefinition(e))||void 0===i?void 0:i.dataTypeMatcher;return!r||r(t)}validateColDef(e){const t=e=>v('Cell data type is "object" but no Value '.concat(e," has been provided. Please either provide an object data type definition with a Value ").concat(e,', or set "colDef.value').concat(e,'"'));"object"===e.cellDataType&&(e.valueFormatter!==this.dataTypeDefinitions.object.groupSafeValueFormatter||this.hasObjectValueFormatter||t("Formatter"),e.editable&&e.valueParser===this.dataTypeDefinitions.object.valueParser&&!this.hasObjectValueParser&&t("Parser"))}getFormatValue(e){return this.formatValueFuncs[e]}setColDefPropertiesForBaseDataType(e,t,i,r){var n;const o=this.formatValueFuncs[t];switch(i.baseDataType){case"number":e.cellEditor="agNumberCellEditor";break;case"boolean":e.cellEditor="agCheckboxCellEditor",e.cellRenderer="agCheckboxCellRenderer",e.suppressKeyboardEvent=e=>!!e.colDef.editable&&e.event.key===Tr.SPACE;break;case"date":e.cellEditor="agDateCellEditor",e.keyCreator=o;break;case"dateString":e.cellEditor="agDateStringCellEditor",e.keyCreator=o;break;case"object":e.cellEditorParams={useFormatter:!0},e.comparator=(e,t)=>{const i=this.columnModel.getColDefCol(r),n=null===i||void 0===i?void 0:i.getColDef();if(!i||!n)return 0;const s=null==e?"":o({column:i,node:null,value:e}),a=null==t?"":o({column:i,node:null,value:t});return s===a?0:s>a?1:-1},e.keyCreator=o}null===(n=this.filterManager)||void 0===n||n.setColDefPropertiesForDataType(e,i,o)}getDefaultDataTypes(){const e=e=>!!e.match("^\\d{4}-\\d{2}-\\d{2}$"),t=this.localeService.getLocaleTextFunc();return{number:{baseDataType:"number",valueParser:e=>{var t,i;return""===(null===(t=e.newValue)||void 0===t||null===(i=t.trim)||void 0===i?void 0:i.call(t))?null:Number(e.newValue)},valueFormatter:e=>null==e.value?"":"number"!==typeof e.value||isNaN(e.value)?t("invalidNumber","Invalid Number"):String(e.value),dataTypeMatcher:e=>"number"===typeof e},text:{baseDataType:"text",valueParser:e=>""===e.newValue?null:k(e.newValue),dataTypeMatcher:e=>"string"===typeof e},boolean:{baseDataType:"boolean",valueParser:e=>{var t,i;return null==e.newValue?e.newValue:""===(null===(t=e.newValue)||void 0===t||null===(i=t.trim)||void 0===i?void 0:i.call(t))?null:"true"===String(e.newValue).toLowerCase()},valueFormatter:e=>null==e.value?"":String(e.value),dataTypeMatcher:e=>"boolean"===typeof e},date:{baseDataType:"date",valueParser:e=>mo(null==e.newValue?null:String(e.newValue)),valueFormatter:e=>{var i;return null==e.value?"":e.value instanceof Date&&!isNaN(e.value.getTime())?null!==(i=go(e.value,!1))&&void 0!==i?i:"":t("invalidDate","Invalid Date")},dataTypeMatcher:e=>e instanceof Date},dateString:{baseDataType:"dateString",dateParser:e=>{var t;return null!==(t=mo(e))&&void 0!==t?t:void 0},dateFormatter:e=>{var t;return null!==(t=go(null!==e&&void 0!==e?e:null,!1))&&void 0!==t?t:void 0},valueParser:t=>e(String(t.newValue))?t.newValue:null,valueFormatter:t=>e(String(t.value))?t.value:"",dataTypeMatcher:t=>"string"===typeof t&&e(t)},object:{baseDataType:"object",valueParser:()=>null,valueFormatter:e=>{var t;return null!==(t=k(e.value))&&void 0!==t?t:""}}}}destroyColumnStateUpdateListeners(){this.columnStateUpdateListenerDestroyFuncs.forEach((e=>e())),this.columnStateUpdateListenerDestroyFuncs=[]}destroy(){this.dataTypeDefinitions={},this.dataTypeMatchers={},this.formatValueFuncs={},this.columnStateUpdatesPendingInference={},this.destroyColumnStateUpdateListeners(),super.destroy()}}]},Il={version:Do,moduleName:"@ag-grid-community/column-api",apiFunctions:{getColumnDef:function(e,t){const i=e.columnModel.getColDefCol(t);return i?i.getColDef():null},getColumnDefs:function(e){return e.columnModel.getColumnDefs()},sizeColumnsToFit:function(e,t){"number"===typeof t?e.columnSizeService.sizeColumnsToFit(t,"api"):e.ctrlsService.getGridBodyCtrl().sizeColumnsToFit(t)},setColumnGroupOpened:function(e,t,i){e.columnModel.setColumnGroupOpened(t,i,"api")},getColumnGroup:function(e,t,i){return e.visibleColsService.getColumnGroup(t,i)},getProvidedColumnGroup:function(e,t){return e.columnModel.getProvidedColGroup(t)},getDisplayNameForColumn:function(e,t,i){return e.columnNameService.getDisplayNameForColumn(t,i)||""},getDisplayNameForColumnGroup:function(e,t,i){return e.columnNameService.getDisplayNameForColumnGroup(t,i)||""},getColumn:function(e,t){return e.columnModel.getColDefCol(t)},getColumns:function(e){return e.columnModel.getColDefCols()},applyColumnState:function(e,t){return e.columnApplyStateService.applyColumnState(t,"api")},getColumnState:function(e){return e.columnGetStateService.getColumnState()},resetColumnState:function(e){e.columnApplyStateService.resetColumnState("api")},getColumnGroupState:function(e){return e.columnGroupStateService.getColumnGroupState()},setColumnGroupState:function(e,t){e.columnGroupStateService.setColumnGroupState(t,"api")},resetColumnGroupState:function(e){e.columnGroupStateService.resetColumnGroupState("api")},isPinning:function(e){return e.visibleColsService.isPinningLeft()||e.visibleColsService.isPinningRight()},isPinningLeft:function(e){return e.visibleColsService.isPinningLeft()},isPinningRight:function(e){return e.visibleColsService.isPinningRight()},getDisplayedColAfter:function(e,t){return e.visibleColsService.getColAfter(t)},getDisplayedColBefore:function(e,t){return e.visibleColsService.getColBefore(t)},setColumnVisible:function(e,t,i){e.columnModel.setColsVisible([t],i,"api")},setColumnsVisible:function(e,t,i){e.columnModel.setColsVisible(t,i,"api")},setColumnPinned:function(e,t,i){e.columnModel.setColsPinned([t],i,"api")},setColumnsPinned:function(e,t,i){e.columnModel.setColsPinned(t,i,"api")},getAllGridColumns:function(e){return e.columnModel.getCols()},getDisplayedLeftColumns:function(e){return e.visibleColsService.getLeftCols()},getDisplayedCenterColumns:function(e){return e.visibleColsService.getCenterCols()},getDisplayedRightColumns:function(e){return e.visibleColsService.getRightCols()},getAllDisplayedColumns:function(e){return e.visibleColsService.getAllCols()},getAllDisplayedVirtualColumns:function(e){return e.columnViewportService.getViewportColumns()},moveColumn:function(e,t,i){e.columnMoveService.moveColumns([t],i,"api")},moveColumnByIndex:function(e,t,i){e.columnMoveService.moveColumnByIndex(t,i,"api")},moveColumns:function(e,t,i){e.columnMoveService.moveColumns(t,i,"api")},setColumnWidth:function(e,t,i){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"api";e.columnSizeService.setColumnWidths([{key:t,newWidth:i}],!1,r,n)},setColumnWidths:function(e,t){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"api";e.columnSizeService.setColumnWidths(t,!1,i,r)},getLeftDisplayedColumnGroups:function(e){return e.visibleColsService.getTreeLeft()},getCenterDisplayedColumnGroups:function(e){return e.visibleColsService.getTreeCenter()},getRightDisplayedColumnGroups:function(e){return e.visibleColsService.getTreeRight()},getAllDisplayedColumnGroups:function(e){return e.visibleColsService.getAllTrees()},autoSizeColumn:function(e,t,i){return e.columnAutosizeService.autoSizeCols({colKeys:[t],skipHeader:i,source:"api"})},autoSizeColumns:function(e,t,i){e.columnAutosizeService.autoSizeCols({colKeys:t,skipHeader:i,source:"api"})},autoSizeAllColumns:function(e,t){e.columnAutosizeService.autoSizeAllColumns("api",t)}}};function Ll(e,t){var i;const{colKey:r,rowNode:n,useFormatter:o}=t,s=null!==(i=e.columnModel.getColDefCol(r))&&void 0!==i?i:e.columnModel.getCol(r);if(P(s))return null;const a=e.valueService.getValueForDisplay(s,n);if(o){const t=e.valueService.formatValue(s,n,a);return null!==t&&void 0!==t?t:Pt(a,!0)}return a}function Ol(e,t){e.gos.updateGridOptions({options:t})}function Nl(e){return e.rowRenderer.getFirstVirtualRenderedRow()}function Bl(e){return e.rowRenderer.getLastVirtualRenderedRow()}var Gl={version:Do,moduleName:"@ag-grid-community/api",dependantModules:[{version:Do,moduleName:"@ag-grid-community/core-api",apiFunctions:{getGridId:function(e){return e.context.getGridId()},destroy:function(e){e.gridDestroyService.destroy()},isDestroyed:function(e){return e.gridDestroyService.isDestroyCalled()},getGridOption:function(e,t){return e.gos.get(t)},setGridOption:function(e,t,i){Ol(e,{[t]:i})},updateGridOptions:Ol}},{version:Do,moduleName:"@ag-grid-community/pinned-row-api",apiFunctions:{getPinnedTopRowCount:function(e){return e.pinnedRowModel.getPinnedTopRowCount()},getPinnedBottomRowCount:function(e){return e.pinnedRowModel.getPinnedBottomRowCount()},getPinnedTopRow:function(e,t){return e.pinnedRowModel.getPinnedTopRow(t)},getPinnedBottomRow:function(e,t){return e.pinnedRowModel.getPinnedBottomRow(t)}}},{version:Do,moduleName:"@ag-grid-community/row-selection-api",apiFunctions:{setNodesSelected:function(e,t){if(!t.nodes.every((e=>e.rowPinned?(v("cannot select pinned rows"),!1):void 0!==e.id||(v("cannot select node until id for node is known"),!1))))return;const{nodes:i,source:r,newValue:n}=t,o=i;e.selectionService.setNodesSelected({nodes:o,source:null!==r&&void 0!==r?r:"api",newValue:n})},selectAll:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"apiSelectAll";e.selectionService.selectAllRowNodes({source:t})},deselectAll:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"apiSelectAll";e.selectionService.deselectAllRowNodes({source:t})},selectAllFiltered:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"apiSelectAllFiltered";e.selectionService.selectAllRowNodes({source:t,justFiltered:!0})},deselectAllFiltered:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"apiSelectAllFiltered";e.selectionService.deselectAllRowNodes({source:t,justFiltered:!0})},selectAllOnCurrentPage:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"apiSelectAllCurrentPage";e.selectionService.selectAllRowNodes({source:t,justCurrentPage:!0})},deselectAllOnCurrentPage:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"apiSelectAllCurrentPage";e.selectionService.deselectAllRowNodes({source:t,justCurrentPage:!0})},getSelectedNodes:function(e){return e.selectionService.getSelectedNodes()},getSelectedRows:function(e){return e.selectionService.getSelectedRows()}}},Il,{version:Do,moduleName:"@ag-grid-community/row-api",apiFunctions:{redrawRows:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=t?t.rowNodes:void 0;e.frameworkOverrides.wrapIncoming((()=>e.rowRenderer.redrawRows(i)))},setRowNodeExpanded:function(e,t,i,r,n){e.expansionService.setRowNodeExpanded(t,i,r,n)},getRowNode:function(e,t){return e.rowModel.getRowNode(t)},addRenderedRowListener:function(e,t,i,r){e.rowRenderer.addRenderedRowListener(t,i,r)},getRenderedNodes:function(e){return e.rowRenderer.getRenderedNodes()},forEachNode:function(e,t,i){e.rowModel.forEachNode(t,i)},getFirstDisplayedRow:function(e){return Nl(e)},getFirstDisplayedRowIndex:Nl,getLastDisplayedRow:function(e){return Bl(e)},getLastDisplayedRowIndex:Bl,getDisplayedRowAtIndex:function(e,t){return e.rowModel.getRow(t)},getDisplayedRowCount:function(e){return e.rowModel.getRowCount()},getModel:function(e){return e.rowModel}}},{version:Do,moduleName:"@ag-grid-community/drag-api",apiFunctions:{addRowDropZone:function(e,t){e.ctrlsService.getGridBodyCtrl().getRowDragFeature().addRowDropZone(t)},removeRowDropZone:function(e,t){const i=e.dragAndDropService.findExternalZone(t);i&&e.dragAndDropService.removeDropTarget(i)},getRowDropZoneParams:function(e,t){return e.ctrlsService.getGridBodyCtrl().getRowDragFeature().getRowDropZone(t)}}},{version:Do,moduleName:"@ag-grid-community/scroll-api",apiFunctions:{getVerticalPixelRange:function(e){return e.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition()},getHorizontalPixelRange:function(e){return e.ctrlsService.getGridBodyCtrl().getScrollFeature().getHScrollPosition()},ensureColumnVisible:Fa,ensureIndexVisible:Pa,ensureNodeVisible:function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.frameworkOverrides.wrapIncoming((()=>e.ctrlsService.getGridBodyCtrl().getScrollFeature().ensureNodeVisible(t,i)),"ensureVisible")}}},{version:Do,moduleName:"@ag-grid-community/overlay-api",apiFunctions:{showLoadingOverlay:function(e){e.overlayService.showLoadingOverlay()},showNoRowsOverlay:function(e){e.overlayService.showNoRowsOverlay()},hideOverlay:function(e){e.overlayService.hideOverlay()}}},{version:Do,moduleName:"@ag-grid-community/keyboard-navigation-api",apiFunctions:{getFocusedCell:function(e){return e.focusService.getFocusedCell()},clearFocusedCell:function(e){return e.focusService.clearFocusedCell()},setFocusedCell:function(e,t,i,r){e.focusService.setFocusedCell({rowIndex:t,column:i,rowPinned:r,forceBrowserFocus:!0})},setFocusedHeader:function(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=e.headerNavigationService.getHeaderPositionForColumn(t,i);r&&e.focusService.focusHeaderPosition({headerPosition:r})},tabToNextCell:function(e,t){return e.navigationService.tabToNextCell(!1,t)},tabToPreviousCell:function(e,t){return e.navigationService.tabToNextCell(!0,t)}}},{version:Do,moduleName:"@ag-grid-community/event-api",apiFunctions:{addEventListener:function(e,t,i){e.apiEventService.addEventListener(t,i)},addGlobalListener:function(e,t){e.apiEventService.addGlobalListener(t)},removeEventListener:function(e,t,i){e.apiEventService.removeEventListener(t,i)},removeGlobalListener:function(e,t){e.apiEventService.removeGlobalListener(t)}}},{version:Do,moduleName:"@ag-grid-community/render-api",apiFunctions:{setGridAriaProperty:function(e,t,i){if(!t)return;const r=e.ctrlsService.getGridBodyCtrl().getGui(),n="aria-".concat(t);null===i?r.removeAttribute(n):r.setAttribute(n,i)},refreshCells:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.frameworkOverrides.wrapIncoming((()=>e.rowRenderer.refreshCells(t)))},flashCells:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=e=>v("Since v31.1 api.flashCells parameter '".concat(e,"Delay' is deprecated. Please use '").concat(e,"Duration' instead."));F(t.fadeDelay)&&i("fade"),F(t.flashDelay)&&i("flash"),e.frameworkOverrides.wrapIncoming((()=>e.rowRenderer.flashCells(t)))},refreshHeader:function(e){e.frameworkOverrides.wrapIncoming((()=>e.ctrlsService.getHeaderRowContainerCtrls().forEach((e=>e.refresh()))))},isAnimationFrameQueueEmpty:function(e){return e.animationFrameService.isQueueEmpty()},flushAllAnimationFrames:function(e){e.animationFrameService.flushAllFrames()},getSizesForCurrentTheme:function(e){return{rowHeight:j(e.gos),headerHeight:e.columnModel.getHeaderHeight()}},getCellRendererInstances:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.rowRenderer.getCellRendererInstances(t).map(gn)}}},{version:Do,moduleName:"@ag-grid-community/cell-api",apiFunctions:{expireValueCache:function(e){e.valueCache.expire()},getValue:function(e,t,i){return Ll(e,{colKey:t,rowNode:i})},getCellValue:Ll}},{version:Do,moduleName:"@ag-grid-community/menu-api",apiFunctions:{showColumnMenuAfterButtonClick:function(e,t,i){const r=e.columnModel.getCol(t);e.menuService.showColumnMenu({column:r,buttonElement:i,positionBy:"button"})},showColumnMenuAfterMouseClick:function(e,t,i){let r=e.columnModel.getCol(t);r||(r=e.columnModel.getColDefCol(t)),r?e.menuService.showColumnMenu({column:r,mouseEvent:i,positionBy:"mouse"}):C("column '".concat(t,"' not found"))},showColumnMenu:function(e,t){const i=e.columnModel.getCol(t);i?e.menuService.showColumnMenu({column:i,positionBy:"auto"}):C("column '".concat(t,"' not found"))},hidePopupMenu:function(e){e.menuService.hidePopupMenu()}}},{version:Do,moduleName:"@ag-grid-community/sort-api",apiFunctions:{onSortChanged:function(e){e.sortController.onSortChanged("api")}}}]};function Hl(e){if((e=c({},e)).version||(e.version="32.1.0"),"32.1.0"===e.version)e=function(e){return e.cellSelection=function(e,t){if(e&&"object"===typeof e)return e[t]}(e,"rangeSelection"),e}(e);return e}var zl={version:Do,moduleName:"@ag-grid-community/state-core",beans:[class extends He{constructor(){super(...arguments),this.beanName="stateService",this.suppressEvents=!0,this.queuedUpdateSources=new Set,this.dispatchStateUpdateEventDebounced=E((()=>this.dispatchQueuedStateUpdateEvents()),0),this.onRowGroupOpenedDebounced=E((()=>this.updateCachedState("rowGroupExpansion",this.getRowGroupExpansionState())),0),this.onRowSelectedDebounced=E((()=>{this.staleStateKeys.delete("rowSelection"),this.updateCachedState("rowSelection",this.getRowSelectionState())}),0),this.staleStateKeys=new Set}wireBeans(e){this.filterManager=e.filterManager,this.ctrlsService=e.ctrlsService,this.pivotResultColsService=e.pivotResultColsService,this.focusService=e.focusService,this.columnModel=e.columnModel,this.visibleColsService=e.visibleColsService,this.columnGroupStateService=e.columnGroupStateService,this.columnGetStateService=e.columnGetStateService,this.paginationService=e.paginationService,this.selectionService=e.selectionService,this.expansionService=e.expansionService,this.columnAnimationService=e.columnAnimationService,this.columnApplyStateService=e.columnApplyStateService,this.sideBarService=e.sideBarService,this.rangeService=e.rangeService}postConstruct(){this.isClientSideRowModel=G(this.gos),this.cachedState=this.getInitialState(),this.setCachedStateValue("version",Do),this.ctrlsService.whenReady(this,(()=>this.suppressEventsAndDispatchInitEvent((()=>this.setupStateOnGridReady()))));const[e,t,i]=this.addManagedEventListeners({newColumnsLoaded:t=>{let{source:i}=t;"gridInitializing"===i&&(e(),this.suppressEventsAndDispatchInitEvent((()=>this.setupStateOnColumnsInitialised())))},rowCountReady:()=>{null===t||void 0===t||t(),this.suppressEventsAndDispatchInitEvent((()=>this.setupStateOnRowCountReady()))},firstDataRendered:()=>{null===i||void 0===i||i(),this.suppressEventsAndDispatchInitEvent((()=>this.setupStateOnFirstDataRendered()))}})}getInitialState(){var e;return Hl(null!==(e=this.gos.get("initialState"))&&void 0!==e?e:{})}getState(){return this.staleStateKeys.size&&this.refreshStaleState(),this.cachedState}setupStateOnGridReady(){this.updateCachedState("sideBar",this.getSideBarState());const e=()=>this.updateCachedState("sideBar",this.getSideBarState());this.addManagedEventListeners({toolPanelVisibleChanged:e,sideBarUpdated:e})}setupStateOnColumnsInitialised(){const e=this.getInitialState();this.setColumnState(e),this.setColumnGroupState(e),this.updateColumnState(["aggregation","columnOrder","columnPinning","columnSizing","columnVisibility","pivot","pivot","rowGroup","sort"]),this.updateCachedState("columnGroup",this.getColumnGroupState());const t=e=>()=>this.updateColumnState([e]);this.addManagedEventListeners({columnValueChanged:t("aggregation"),columnMoved:t("columnOrder"),columnPinned:t("columnPinning"),columnResized:t("columnSizing"),columnVisible:t("columnVisibility"),columnPivotChanged:t("pivot"),columnPivotModeChanged:t("pivot"),columnRowGroupChanged:t("rowGroup"),sortChanged:t("sort"),newColumnsLoaded:()=>this.updateColumnState(["aggregation","columnOrder","columnPinning","columnSizing","columnVisibility","pivot","rowGroup","sort"]),columnGroupOpened:()=>this.updateCachedState("columnGroup",this.getColumnGroupState())})}setupStateOnRowCountReady(){const{filter:e,rowGroupExpansion:t,rowSelection:i,pagination:r}=this.getInitialState(),n=this.gos.get("advancedFilterModel");(e||n)&&this.setFilterState(e,n),t&&this.setRowGroupExpansionState(t),i&&this.setRowSelectionState(i),r&&this.setPaginationState(r),this.updateCachedState("filter",this.getFilterState()),this.updateCachedState("rowGroupExpansion",this.getRowGroupExpansionState()),this.updateCachedState("rowSelection",this.getRowSelectionState()),this.updateCachedState("pagination",this.getPaginationState());const o=()=>this.updateCachedState("rowGroupExpansion",this.getRowGroupExpansionState());this.addManagedEventListeners({filterChanged:()=>this.updateCachedState("filter",this.getFilterState()),rowGroupOpened:()=>this.onRowGroupOpenedDebounced(),expandOrCollapseAll:o,columnRowGroupChanged:o,rowDataUpdated:()=>{0!==this.gos.get("groupDefaultExpanded")&&setTimeout((()=>{o()}))},selectionChanged:()=>{this.staleStateKeys.add("rowSelection"),this.onRowSelectedDebounced()},paginationChanged:e=>{(e.newPage||e.newPageSize)&&this.updateCachedState("pagination",this.getPaginationState())}})}setupStateOnFirstDataRendered(){const{scroll:e,cellSelection:t,focusedCell:i,columnOrder:r}=this.getInitialState();i&&this.setFocusedCellState(i),t&&this.setCellSelectionState(t),e&&this.setScrollState(e),this.setColumnPivotState(!(null===r||void 0===r||!r.orderedColIds)),this.updateCachedState("sideBar",this.getSideBarState()),this.updateCachedState("focusedCell",this.getFocusedCellState());const n=this.getRangeSelectionState();this.updateCachedState("rangeSelection",n),this.updateCachedState("cellSelection",n),this.updateCachedState("scroll",this.getScrollState()),this.addManagedEventListeners({cellFocused:()=>this.updateCachedState("focusedCell",this.getFocusedCellState()),cellSelectionChanged:e=>{if(e.finished){const e=this.getRangeSelectionState();this.updateCachedState("rangeSelection",e),this.updateCachedState("cellSelection",e)}},bodyScrollEnd:()=>this.updateCachedState("scroll",this.getScrollState())})}getColumnState(){const e=this.columnModel.isPivotMode(),t=[],i=[],r=[],n=[],o=[],s=[],a=[],l=[],c=[];let u=0;const d=this.columnGetStateService.getColumnState();for(let h=0;h<d.length;h++){const{colId:e,sort:g,sortIndex:p,rowGroup:f,rowGroupIndex:m,aggFunc:v,pivot:C,pivotIndex:w,pinned:b,hide:S,width:y,flex:R}=d[h];c.push(e),g&&(t[null!==p&&void 0!==p?p:u++]={colId:e,sort:g}),f&&(i[null!==m&&void 0!==m?m:0]=e),"string"===typeof v&&r.push({colId:e,aggFunc:v}),C&&(n[null!==w&&void 0!==w?w:0]=e),b&&("right"===b?s:o).push(e),S&&a.push(e),(R||y)&&l.push({colId:e,flex:null!==R&&void 0!==R?R:void 0,width:y})}return{sort:t.length?{sortModel:t}:void 0,rowGroup:i.length?{groupColIds:i}:void 0,aggregation:r.length?{aggregationModel:r}:void 0,pivot:n.length||e?{pivotMode:e,pivotColIds:n}:void 0,columnPinning:o.length||s.length?{leftColIds:o,rightColIds:s}:void 0,columnVisibility:a.length?{hiddenColIds:a}:void 0,columnSizing:l.length?{columnSizingModel:l}:void 0,columnOrder:c.length?{orderedColIds:c}:void 0}}setColumnState(e){const{sort:t,rowGroup:i,aggregation:r,pivot:n,columnPinning:o,columnVisibility:s,columnSizing:a,columnOrder:l,partialColumnState:c}=e,u={},d=e=>{let t=u[e];return t||(t={colId:e},u[e]=t,t)},h=c?{}:{sort:null,sortIndex:null,rowGroup:null,rowGroupIndex:null,aggFunc:null,pivot:null,pivotIndex:null,pinned:null,hide:null,flex:null};t&&(t.sortModel.forEach(((e,t)=>{let{colId:i,sort:r}=e;const n=d(i);n.sort=r,n.sortIndex=t})),h.sort=null,h.sortIndex=null),i&&(i.groupColIds.forEach(((e,t)=>{const i=d(e);i.rowGroup=!0,i.rowGroupIndex=t})),h.rowGroup=null,h.rowGroupIndex=null),r&&(r.aggregationModel.forEach((e=>{let{colId:t,aggFunc:i}=e;d(t).aggFunc=i})),h.aggFunc=null),n&&(n.pivotColIds.forEach(((e,t)=>{const i=d(e);i.pivot=!0,i.pivotIndex=t})),this.gos.updateGridOptions({options:{pivotMode:n.pivotMode},source:"gridInitializing"}),h.pivot=null,h.pivotIndex=null),o&&(o.leftColIds.forEach((e=>{d(e).pinned="left"})),o.rightColIds.forEach((e=>{d(e).pinned="right"})),h.pinned=null),s&&(s.hiddenColIds.forEach((e=>{d(e).hide=!0})),h.hide=null),a&&(a.columnSizingModel.forEach((e=>{let{colId:t,flex:i,width:r}=e;const n=d(t);n.flex=null!==i&&void 0!==i?i:null,n.width=r})),h.flex=null);const g=null===l||void 0===l?void 0:l.orderedColIds,p=!(null===g||void 0===g||!g.length),f=p?g.map((e=>d(e))):Object.values(u);f.length&&(this.columnStates=f,this.columnApplyStateService.applyColumnState({state:f,applyOrder:p,defaultState:h},"gridInitializing"))}setColumnPivotState(e){const t=this.columnStates;this.columnStates=void 0;const i=this.columnGroupStates;if(this.columnGroupStates=void 0,this.pivotResultColsService.isPivotResultColsPresent()){if(t){const i=[];for(const e of t)this.pivotResultColsService.getPivotResultCol(e.colId)&&i.push(e);this.columnApplyStateService.applyColumnState({state:i,applyOrder:e},"gridInitializing")}i&&this.columnGroupStateService.setColumnGroupState(i,"gridInitializing")}}getColumnGroupState(){const e=this.columnGroupStateService.getColumnGroupState(),t=[];return e.forEach((e=>{let{groupId:i,open:r}=e;r&&t.push(i)})),t.length?{openColumnGroupIds:t}:void 0}setColumnGroupState(e){var t;if(!Object.prototype.hasOwnProperty.call(e,"columnGroup"))return;const i=new Set(null===(t=e.columnGroup)||void 0===t?void 0:t.openColumnGroupIds),r=this.columnGroupStateService.getColumnGroupState().map((e=>{let{groupId:t}=e;const r=i.has(t);return r&&i.delete(t),{groupId:t,open:r}}));i.forEach((e=>{r.push({groupId:e,open:!0})})),r.length&&(this.columnGroupStates=r),this.columnGroupStateService.setColumnGroupState(r,"gridInitializing")}getFilterState(){var e,t,i;let r=null===(e=this.filterManager)||void 0===e?void 0:e.getFilterModel();r&&0===Object.keys(r).length&&(r=void 0);const n=null!==(t=null===(i=this.filterManager)||void 0===i?void 0:i.getAdvancedFilterModel())&&void 0!==t?t:void 0;return r||n?{filterModel:r,advancedFilterModel:n}:void 0}setFilterState(e,t){const{filterModel:i,advancedFilterModel:r}=null!==e&&void 0!==e?e:{advancedFilterModel:t};var n,o;i&&(null===(n=this.filterManager)||void 0===n||n.setFilterModel(i,"columnFilter"));r&&(null===(o=this.filterManager)||void 0===o||o.setAdvancedFilterModel(r))}getRangeSelectionState(){var e;const t=null===(e=this.rangeService)||void 0===e?void 0:e.getCellRanges().map((e=>{const{id:t,type:i,startRow:r,endRow:n,columns:o,startColumn:s}=e;return{id:t,type:i,startRow:r,endRow:n,colIds:o.map((e=>e.getColId())),startColId:s.getColId()}}));return null!==t&&void 0!==t&&t.length?{cellRanges:t}:void 0}setCellSelectionState(e){const{gos:t,rangeService:i,columnModel:r,visibleColsService:n}=this;if(!he(t)||!i)return;const o=[];if(e.cellRanges.forEach((e=>{const t=[];if(e.colIds.forEach((e=>{const i=r.getCol(e);i&&t.push(i)})),!t.length)return;let i=r.getCol(e.startColId);if(!i){const e=n.getAllCols(),r=new Set(t);i=e.find((e=>r.has(e)))}o.push(c(c({},e),{},{columns:t,startColumn:i}))})),function(e){return void 0!==e.get("cellSelection")}(t)&&function(e){var t;const i=e.get("cellSelection");return void 0!==i?"boolean"!==typeof i&&null!==(t=null===i||void 0===i?void 0:i.suppressMultiRanges)&&void 0!==t&&t:e.get("suppressMultiRangeSelection")}(t)&&o.length>1)return v("cannot add multiple ranges when `cellSelection.suppressMultiRanges = true`");i.setCellRanges(o)}getScrollState(){var e,t,i;if(!this.isClientSideRowModel)return;const r=null===(e=this.ctrlsService.getGridBodyCtrl())||void 0===e?void 0:e.getScrollFeature(),{left:n}=null!==(t=null===r||void 0===r?void 0:r.getHScrollPosition())&&void 0!==t?t:{left:0},{top:o}=null!==(i=null===r||void 0===r?void 0:r.getVScrollPosition())&&void 0!==i?i:{top:0};return o||n?{top:o,left:n}:void 0}setScrollState(e){var t;if(!this.isClientSideRowModel)return;const{top:i,left:r}=e;null===(t=this.ctrlsService.getGridBodyCtrl())||void 0===t||t.getScrollFeature().setScrollPosition(i,r)}getSideBarState(){var e;return null===(e=this.sideBarService)||void 0===e||null===(e=e.getSideBarComp())||void 0===e?void 0:e.getState()}getFocusedCellState(){if(!this.isClientSideRowModel)return;const e=this.focusService.getFocusedCell();if(e){const{column:t,rowIndex:i,rowPinned:r}=e;return{colId:t.getColId(),rowIndex:i,rowPinned:r}}}setFocusedCellState(e){if(!this.isClientSideRowModel)return;const{colId:t,rowIndex:i,rowPinned:r}=e;this.focusService.setFocusedCell({column:this.columnModel.getCol(t),rowIndex:i,rowPinned:r,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0})}getPaginationState(){if(!this.paginationService)return;const e=this.paginationService.getCurrentPage(),t=this.gos.get("paginationAutoPageSize")?void 0:this.paginationService.getPageSize();return e||t?{page:e,pageSize:t}:void 0}setPaginationState(e){this.paginationService&&(e.pageSize&&!this.gos.get("paginationAutoPageSize")&&this.paginationService.setPageSize(e.pageSize,"initialState"),"number"===typeof e.page&&this.paginationService.setPage(e.page))}getRowSelectionState(){var e;const t=this.selectionService.getSelectionState();return!t||!Array.isArray(t)&&(!1===t.selectAll||!1===t.selectAllChildren)&&!(null!==t&&void 0!==t&&null!==(e=t.toggledNodes)&&void 0!==e&&e.length)?void 0:t}setRowSelectionState(e){this.selectionService.setSelectionState(e,"gridInitializing")}getRowGroupExpansionState(){const e=this.expansionService.getExpandedRows();return e.length?{expandedRowGroupIds:e}:void 0}setRowGroupExpansionState(e){this.expansionService.expandRows(e.expandedRowGroupIds)}updateColumnState(e){const t=this.getColumnState();let i=!1;Object.entries(t).forEach((e=>{let[t,r]=e;L(r,this.cachedState[t])||(i=!0)})),this.cachedState=c(c({},this.cachedState),t),i&&this.dispatchStateUpdateEvent(e)}updateCachedState(e,t){const i=this.cachedState[e];this.setCachedStateValue(e,t),L(t,i)||this.dispatchStateUpdateEvent([e])}setCachedStateValue(e,t){this.cachedState=c(c({},this.cachedState),{},{[e]:t})}refreshStaleState(){this.staleStateKeys.forEach((e=>{if("rowSelection"===e)this.setCachedStateValue(e,this.getRowSelectionState())})),this.staleStateKeys.clear()}dispatchStateUpdateEvent(e){this.suppressEvents||(e.forEach((e=>this.queuedUpdateSources.add(e))),this.dispatchStateUpdateEventDebounced())}dispatchQueuedStateUpdateEvents(){const e=Array.from(this.queuedUpdateSources);this.queuedUpdateSources.clear(),this.eventService.dispatchEvent({type:"stateUpdated",sources:e,state:this.cachedState})}suppressEventsAndDispatchInitEvent(e){this.suppressEvents=!0,this.columnAnimationService.setSuppressAnimation(!0),e(),setTimeout((()=>{this.suppressEvents=!1,this.queuedUpdateSources.clear(),this.isAlive()&&(this.columnAnimationService.setSuppressAnimation(!1),this.dispatchStateUpdateEvent(["gridInitializing"]))}))}}]},Vl={version:Do,moduleName:"@ag-grid-community/state",dependantModules:[zl,{version:Do,moduleName:"@ag-grid-community/state-api",apiFunctions:{getState:function(e){var t,i;return null!==(t=null===(i=e.stateService)||void 0===i?void 0:i.getState())&&void 0!==t?t:{}}},dependantModules:[zl]}]};var _l="paginationPageSizeSelector",Wl={selector:"AG-PAGE-SIZE-SELECTOR",component:class extends dr{constructor(){super('<span class="ag-paging-page-size"></span>'),this.hasEmptyOption=!1,this.handlePageSizeItemSelected=()=>{if(!this.selectPageSizeComp)return;const e=this.selectPageSizeComp.getValue();if(!e)return;const t=Number(e);isNaN(t)||t<1||t===this.paginationService.getPageSize()||(this.paginationService.setPageSize(t,"pageSizeSelector"),this.hasEmptyOption&&this.toggleSelectDisplay(!0),this.selectPageSizeComp.getFocusableElement().focus())}}wireBeans(e){this.paginationService=e.paginationService}postConstruct(){this.addManagedPropertyListener(_l,(()=>{this.onPageSizeSelectorValuesChange()})),this.addManagedEventListeners({paginationChanged:e=>this.handlePaginationChanged(e)})}handlePaginationChanged(e){if(!this.selectPageSizeComp||null===e||void 0===e||!e.newPageSize)return;const t=this.paginationService.getPageSize();this.getPageSizeSelectorValues().includes(t)?this.selectPageSizeComp.setValue(t.toString()):this.hasEmptyOption?this.selectPageSizeComp.setValue(""):this.toggleSelectDisplay(!0)}toggleSelectDisplay(e){this.selectPageSizeComp&&!e&&this.reset(),e&&(this.reloadPageSizesSelector(),this.selectPageSizeComp)}reset(){Yi(this.getGui()),this.selectPageSizeComp&&(this.selectPageSizeComp=this.destroyBean(this.selectPageSizeComp))}onPageSizeSelectorValuesChange(){this.selectPageSizeComp&&this.shouldShowPageSizeSelector()&&this.reloadPageSizesSelector()}shouldShowPageSizeSelector(){return this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel")&&!this.gos.get("paginationAutoPageSize")&&!1!==this.gos.get(_l)}reloadPageSizesSelector(){const e=this.getPageSizeSelectorValues(),t=this.paginationService.getPageSize(),i=!t||!e.includes(t);if(i){const i=this.gos.exists("paginationPageSize"),r=!0!==this.gos.get(_l);v("'paginationPageSize=".concat(t,"'").concat(i?"":" (default value)",", but ").concat(t," is not included in").concat(r?"":" the default"," paginationPageSizeSelector=[").concat(e.join(", "),"].")),r||v("Either set '".concat(_l,"' to an array that includes ").concat(t," or to 'false' to disable the page size selector.")),e.unshift("")}const r=String(i?"":t);this.selectPageSizeComp?(Re(this.pageSizeOptions,e)||(this.selectPageSizeComp.clearOptions().addOptions(this.createPageSizeSelectOptions(e)),this.pageSizeOptions=e),this.selectPageSizeComp.setValue(r,!0)):this.createPageSizeSelectorComp(e,r),this.hasEmptyOption=i}createPageSizeSelectOptions(e){return e.map((e=>({value:String(e)})))}createPageSizeSelectorComp(e,t){const i=this.localeService.getLocaleTextFunc(),r=i("pageSizeSelectorLabel","Page Size:"),n=i("ariaPageSizeSelectorLabel","Page Size");this.selectPageSizeComp=this.createManagedBean(new Un).addOptions(this.createPageSizeSelectOptions(e)).setValue(t).setAriaLabel(n).setLabel(r).onValueChange((()=>this.handlePageSizeItemSelected())),this.appendChild(this.selectPageSizeComp)}getPageSizeSelectorValues(){const e=[20,50,100],t=this.gos.get(_l);return!Array.isArray(t)||D(t)?e:[...t].sort(((e,t)=>e-t))}destroy(){this.toggleSelectDisplay(!1),super.destroy()}}},Ul={selector:"AG-PAGINATION",component:class extends Ka{constructor(){super(),this.btFirst=ur,this.btPrevious=ur,this.btNext=ur,this.btLast=ur,this.lbRecordCount=ur,this.lbFirstRowOnPage=ur,this.lbLastRowOnPage=ur,this.lbCurrent=ur,this.lbTotal=ur,this.pageSizeComp=ur,this.previousAndFirstButtonsDisabled=!1,this.nextButtonDisabled=!1,this.lastButtonDisabled=!1,this.areListenersSetup=!1,this.allowFocusInnerElement=!1}wireBeans(e){this.rowModel=e.rowModel,this.paginationService=e.paginationService,this.focusService=e.focusService,this.ariaAnnouncementService=e.ariaAnnouncementService}postConstruct(){const e=this.gos.get("enableRtl");this.setTemplate(this.getTemplate(),[Wl]);const{btFirst:t,btPrevious:i,btNext:r,btLast:n}=this;this.activateTabIndex([t,i,r,n]),t.insertAdjacentElement("afterbegin",pr(e?"last":"first",this.gos)),i.insertAdjacentElement("afterbegin",pr(e?"next":"previous",this.gos)),r.insertAdjacentElement("afterbegin",pr(e?"previous":"next",this.gos)),n.insertAdjacentElement("afterbegin",pr(e?"first":"last",this.gos)),this.addManagedPropertyListener("pagination",this.onPaginationChanged.bind(this)),this.addManagedPropertyListener("suppressPaginationPanel",this.onPaginationChanged.bind(this)),this.addManagedPropertyListeners(["paginationPageSizeSelector","paginationAutoPageSize","suppressPaginationPanel"],(()=>this.onPageSizeRelatedOptionsChange())),this.pageSizeComp.toggleSelectDisplay(this.pageSizeComp.shouldShowPageSizeSelector()),this.initialiseTabGuard({onTabKeyDown:()=>{},focusInnerElement:e=>{this.allowFocusInnerElement?this.tabGuardFeature.getTabGuardCtrl().focusInnerElement(e):this.focusService.focusGridInnerElement(e)},forceFocusOutWhenTabGuardsAreEmpty:!0}),this.onPaginationChanged()}setAllowFocus(e){this.allowFocusInnerElement=e}onPaginationChanged(){const e=this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel");this.setDisplayed(e),e&&(this.setupListeners(),this.enableOrDisableButtons(),this.updateLabels(),this.onPageSizeRelatedOptionsChange())}onPageSizeRelatedOptionsChange(){this.pageSizeComp.toggleSelectDisplay(this.pageSizeComp.shouldShowPageSizeSelector())}setupListeners(){var e,t,i;this.areListenersSetup||(this.addManagedEventListeners({paginationChanged:this.onPaginationChanged.bind(this)}),[{el:this.btFirst,fn:this.onBtFirst.bind(this)},{el:this.btPrevious,fn:this.onBtPrevious.bind(this)},{el:this.btNext,fn:this.onBtNext.bind(this)},{el:this.btLast,fn:this.onBtLast.bind(this)}].forEach((e=>{const{el:t,fn:i}=e;this.addManagedListeners(t,{click:i,keydown:e=>{e.key!==Tr.ENTER&&e.key!==Tr.SPACE||(e.preventDefault(),i())}})})),e=this,t=this.getGui(),i=this.focusService,e.addManagedElementListeners(t,{keydown:e=>{if(!e.defaultPrevented&&e.key===Tr.TAB){const r=e.shiftKey;i.findNextFocusableElement(t,!1,r)||i.focusNextGridCoreContainer(r)&&e.preventDefault()}}}),this.areListenersSetup=!0)}onBtFirst(){this.previousAndFirstButtonsDisabled||this.paginationService.goToFirstPage()}formatNumber(e){const t=this.gos.getCallback("paginationNumberFormatter");if(t){return t({value:e})}const i=this.localeService.getLocaleTextFunc();return ho(e,i("thousandSeparator",","),i("decimalSeparator","."))}getTemplate(){const e=this.localeService.getLocaleTextFunc(),t=e("page","Page"),i=e("to","to"),r=e("of","of"),n=e("firstPage","First Page"),o=e("previousPage","Previous Page"),s=e("nextPage","Next Page"),a=e("lastPage","Last Page"),l=this.getCompId();return'<div class="ag-paging-panel ag-unselectable" id="ag-'.concat(l,'">\n                <ag-page-size-selector data-ref="pageSizeComp"></ag-page-size-selector>\n                <span class="ag-paging-row-summary-panel">\n                    <span id="ag-').concat(l,'-first-row" data-ref="lbFirstRowOnPage" class="ag-paging-row-summary-panel-number"></span>\n                    <span id="ag-').concat(l,'-to">').concat(i,'</span>\n                    <span id="ag-').concat(l,'-last-row" data-ref="lbLastRowOnPage" class="ag-paging-row-summary-panel-number"></span>\n                    <span id="ag-').concat(l,'-of">').concat(r,'</span>\n                    <span id="ag-').concat(l,'-row-count" data-ref="lbRecordCount" class="ag-paging-row-summary-panel-number"></span>\n                </span>\n                <span class="ag-paging-page-summary-panel" role="presentation">\n                    <div data-ref="btFirst" class="ag-button ag-paging-button" role="button" aria-label="').concat(n,'"></div>\n                    <div data-ref="btPrevious" class="ag-button ag-paging-button" role="button" aria-label="').concat(o,'"></div>\n                    <span class="ag-paging-description">\n                        <span id="ag-').concat(l,'-start-page">').concat(t,'</span>\n                        <span id="ag-').concat(l,'-start-page-number" data-ref="lbCurrent" class="ag-paging-number"></span>\n                        <span id="ag-').concat(l,'-of-page">').concat(r,'</span>\n                        <span id="ag-').concat(l,'-of-page-number" data-ref="lbTotal" class="ag-paging-number"></span>\n                    </span>\n                    <div data-ref="btNext" class="ag-button ag-paging-button" role="button" aria-label="').concat(s,'"></div>\n                    <div data-ref="btLast" class="ag-button ag-paging-button" role="button" aria-label="').concat(a,'"></div>\n                </span>\n            </div>')}onBtNext(){this.nextButtonDisabled||this.paginationService.goToNextPage()}onBtPrevious(){this.previousAndFirstButtonsDisabled||this.paginationService.goToPreviousPage()}onBtLast(){this.lastButtonDisabled||this.paginationService.goToLastPage()}enableOrDisableButtons(){const e=this.paginationService.getCurrentPage(),t=this.rowModel.isLastRowIndexKnown(),i=this.paginationService.getTotalPages();this.previousAndFirstButtonsDisabled=0===e,this.toggleButtonDisabled(this.btFirst,this.previousAndFirstButtonsDisabled),this.toggleButtonDisabled(this.btPrevious,this.previousAndFirstButtonsDisabled);const r=this.isZeroPagesToDisplay(),n=e===i-1;this.nextButtonDisabled=n||r,this.lastButtonDisabled=!t||r||e===i-1,this.toggleButtonDisabled(this.btNext,this.nextButtonDisabled),this.toggleButtonDisabled(this.btLast,this.lastButtonDisabled)}toggleButtonDisabled(e,t){!function(e,t){oi(e,"disabled",t)}(e,t),e.classList.toggle("ag-disabled",t)}isZeroPagesToDisplay(){const e=this.rowModel.isLastRowIndexKnown(),t=this.paginationService.getTotalPages();return e&&0===t}updateLabels(){const e=this.rowModel.isLastRowIndexKnown(),t=this.paginationService.getTotalPages(),i=this.paginationService.getMasterRowCount(),r=e?i:null;if(1===r){const e=this.rowModel.getRow(0);if(e&&e.group&&!(e.groupData||e.aggData))return void this.setTotalLabelsToZero()}const n=this.paginationService.getCurrentPage(),o=this.paginationService.getPageSize();let s,a;this.isZeroPagesToDisplay()?s=a=0:(s=o*n+1,a=s+o-1,e&&a>r&&(a=r));const l=!e&&i<s+o-1,c=this.formatNumber(s);let u;this.lbFirstRowOnPage.textContent=c;const d=this.localeService.getLocaleTextFunc();u=l?d("pageLastRowUnknown","?"):this.formatNumber(a),this.lbLastRowOnPage.textContent=u;const h=t>0?n+1:0,g=this.formatNumber(h);let p,f;if(this.lbCurrent.textContent=g,e)p=this.formatNumber(t),f=this.formatNumber(r);else{const e=d("more","more");p=e,f=e}this.lbTotal.textContent=p,this.lbRecordCount.textContent=f,this.announceAriaStatus(c,u,f,g,p)}announceAriaStatus(e,t,i,r,n){const o=this.localeService.getLocaleTextFunc(),s=o("page","Page"),a=o("to","to"),l=o("of","of"),c="".concat(e," ").concat(a," ").concat(t," ").concat(l," ").concat(i),u="".concat(s," ").concat(r," ").concat(l," ").concat(n);c!==this.ariaRowStatus&&(this.ariaRowStatus=c,this.ariaAnnouncementService.announceValue(c,"paginationRow")),u!==this.ariaPageStatus&&(this.ariaPageStatus=u,this.ariaAnnouncementService.announceValue(u,"paginationPage"))}setTotalLabelsToZero(){const e=this.formatNumber(0);this.lbFirstRowOnPage.textContent=e,this.lbCurrent.textContent=e,this.lbLastRowOnPage.textContent=e,this.lbTotal.textContent=e,this.lbRecordCount.textContent=e,this.announceAriaStatus(e,e,e,e,e)}}},jl={version:Do,moduleName:"@ag-grid-community/pagination-core",beans:[class extends He{constructor(){super(...arguments),this.beanName="paginationService",this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=0,this.masterRowCount=0}wireBeans(e){this.rowModel=e.rowModel,this.pageBoundsService=e.pageBoundsService}postConstruct(){this.active=this.gos.get("pagination"),this.pageSizeFromGridOptions=this.gos.get("paginationPageSize"),this.paginateChildRows=this.isPaginateChildRows(),this.addManagedPropertyListener("pagination",this.onPaginationGridOptionChanged.bind(this)),this.addManagedPropertyListener("paginationPageSize",this.onPageSizeGridOptionChanged.bind(this))}getPaginationSelector(){return Ul}isPaginateChildRows(){return!(!this.gos.get("groupRemoveSingleChildren")&&!this.gos.get("groupRemoveLowestSingleChildren"))||this.gos.get("paginateChildRows")}onPaginationGridOptionChanged(){this.active=this.gos.get("pagination"),this.calculatePages(),this.dispatchPaginationChangedEvent({keepRenderedRows:!0})}onPageSizeGridOptionChanged(){this.setPageSize(this.gos.get("paginationPageSize"),"gridOptions")}goToPage(e){this.active&&this.currentPage!==e&&"number"===typeof this.currentPage&&(this.currentPage=e,this.calculatePages(),this.dispatchPaginationChangedEvent({newPage:!0}))}isRowPresent(e){return e.rowIndex>=this.topDisplayedRowIndex&&e.rowIndex<=this.bottomDisplayedRowIndex}getPageForIndex(e){return Math.floor(e/this.pageSize)}goToPageWithIndex(e){if(!this.active)return;const t=this.getPageForIndex(e);this.goToPage(t)}isRowInPage(e){if(!this.active)return!0;return this.getPageForIndex(e.rowIndex)===this.currentPage}getCurrentPage(){return this.currentPage}goToNextPage(){this.goToPage(this.currentPage+1)}goToPreviousPage(){this.goToPage(this.currentPage-1)}goToFirstPage(){this.goToPage(0)}goToLastPage(){const e=this.rowModel.getRowCount(),t=Math.floor(e/this.pageSize);this.goToPage(t)}getPageSize(){return this.pageSize}getTotalPages(){return this.totalPages}setPage(e){this.currentPage=e}get pageSize(){return F(this.pageSizeAutoCalculated)&&this.gos.get("paginationAutoPageSize")?this.pageSizeAutoCalculated:F(this.pageSizeFromPageSizeSelector)?this.pageSizeFromPageSizeSelector:F(this.pageSizeFromInitialState)?this.pageSizeFromInitialState:F(this.pageSizeFromGridOptions)?this.pageSizeFromGridOptions:this.defaultPageSize}calculatePages(){this.active?this.paginateChildRows?this.calculatePagesAllRows():this.calculatePagesMasterRowsOnly():this.calculatedPagesNotActive(),this.pageBoundsService.calculateBounds(this.topDisplayedRowIndex,this.bottomDisplayedRowIndex)}unsetAutoCalculatedPageSize(){if(void 0===this.pageSizeAutoCalculated)return;const e=this.pageSizeAutoCalculated;this.pageSizeAutoCalculated=void 0,this.pageSize!==e&&(this.calculatePages(),this.dispatchPaginationChangedEvent({newPageSize:!0}))}setPageSize(e,t){const i=this.pageSize;switch(t){case"autoCalculated":this.pageSizeAutoCalculated=e;break;case"pageSizeSelector":this.pageSizeFromPageSizeSelector=e,0!==this.currentPage&&this.goToFirstPage();break;case"initialState":this.pageSizeFromInitialState=e;break;case"gridOptions":this.pageSizeFromGridOptions=e,this.pageSizeFromInitialState=void 0,this.pageSizeFromPageSizeSelector=void 0,0!==this.currentPage&&this.goToFirstPage()}i!==this.pageSize&&(this.calculatePages(),this.dispatchPaginationChangedEvent({newPageSize:!0,keepRenderedRows:!0}))}setZeroRows(){this.masterRowCount=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=-1,this.currentPage=0,this.totalPages=0}adjustCurrentPageIfInvalid(){this.currentPage>=this.totalPages&&(this.currentPage=this.totalPages-1),(!isFinite(this.currentPage)||isNaN(this.currentPage)||this.currentPage<0)&&(this.currentPage=0)}calculatePagesMasterRowsOnly(){if(this.masterRowCount=this.rowModel.getTopLevelRowCount(),this.masterRowCount<=0)return void this.setZeroRows();const e=this.masterRowCount-1;this.totalPages=Math.floor(e/this.pageSize)+1,this.adjustCurrentPageIfInvalid();const t=this.pageSize*this.currentPage;let i=this.pageSize*(this.currentPage+1)-1;if(i>e&&(i=e),this.topDisplayedRowIndex=this.rowModel.getTopLevelRowDisplayedIndex(t),i===e)this.bottomDisplayedRowIndex=this.rowModel.getRowCount()-1;else{const e=this.rowModel.getTopLevelRowDisplayedIndex(i+1);this.bottomDisplayedRowIndex=e-1}}getMasterRowCount(){return this.masterRowCount}calculatePagesAllRows(){if(this.masterRowCount=this.rowModel.getRowCount(),0===this.masterRowCount)return void this.setZeroRows();const e=this.masterRowCount-1;this.totalPages=Math.floor(e/this.pageSize)+1,this.adjustCurrentPageIfInvalid(),this.topDisplayedRowIndex=this.pageSize*this.currentPage,this.bottomDisplayedRowIndex=this.pageSize*(this.currentPage+1)-1,this.bottomDisplayedRowIndex>e&&(this.bottomDisplayedRowIndex=e)}calculatedPagesNotActive(){this.setPageSize(void 0,"autoCalculated"),this.totalPages=1,this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=this.rowModel.getRowCount()-1}dispatchPaginationChangedEvent(e){const{keepRenderedRows:t=!1,newPage:i=!1,newPageSize:r=!1}=e;this.eventService.dispatchEvent({type:"paginationChanged",animate:!1,newData:!1,newPage:i,newPageSize:r,keepRenderedRows:t})}},class extends He{constructor(){super(...arguments),this.beanName="paginationAutoPageSizeService"}wireBeans(e){this.ctrlsService=e.ctrlsService,this.paginationService=e.paginationService}postConstruct(){this.ctrlsService.whenReady(this,(e=>{this.centerRowsCtrl=e.center;const t=this.checkPageSize.bind(this);this.addManagedEventListeners({bodyHeightChanged:t,scrollVisibilityChanged:t}),this.addManagedPropertyListener("paginationAutoPageSize",this.onPaginationAutoSizeChanged.bind(this)),this.checkPageSize()}))}notActive(){return!this.gos.get("paginationAutoPageSize")||null==this.centerRowsCtrl}onPaginationAutoSizeChanged(){this.notActive()?this.paginationService.unsetAutoCalculatedPageSize():this.checkPageSize()}checkPageSize(){if(this.notActive())return;const e=this.centerRowsCtrl.getViewportSizeFeature().getBodyHeight();if(e>0){const t=()=>{const t=Math.max(j(this.gos),1),i=Math.floor(e/t);this.paginationService.setPageSize(i,"autoCalculated")};this.isBodyRendered?E((()=>t()),50)():(t(),this.isBodyRendered=!0)}else this.isBodyRendered=!1}}]},Kl={version:Do,moduleName:"@ag-grid-community/pagination",dependantModules:[jl,{version:Do,moduleName:"@ag-grid-community/pagination-api",dependantModules:[jl],apiFunctions:{paginationIsLastPageFound:function(e){return e.rowModel.isLastRowIndexKnown()},paginationGetPageSize:function(e){var t,i;return null!==(t=null===(i=e.paginationService)||void 0===i?void 0:i.getPageSize())&&void 0!==t?t:100},paginationGetCurrentPage:function(e){var t,i;return null!==(t=null===(i=e.paginationService)||void 0===i?void 0:i.getCurrentPage())&&void 0!==t?t:0},paginationGetTotalPages:function(e){var t,i;return null!==(t=null===(i=e.paginationService)||void 0===i?void 0:i.getTotalPages())&&void 0!==t?t:1},paginationGetRowCount:function(e){return e.paginationService?e.paginationService.getMasterRowCount():e.rowModel.getRowCount()},paginationGoToNextPage:function(e){var t;null===(t=e.paginationService)||void 0===t||t.goToNextPage()},paginationGoToPreviousPage:function(e){var t;null===(t=e.paginationService)||void 0===t||t.goToPreviousPage()},paginationGoToFirstPage:function(e){var t;null===(t=e.paginationService)||void 0===t||t.goToFirstPage()},paginationGoToLastPage:function(e){var t;null===(t=e.paginationService)||void 0===t||t.goToLastPage()},paginationGoToPage:function(e,t){var i;null===(i=e.paginationService)||void 0===i||i.goToPage(t)}}}]},Yl="clientSide",ql="serverSide",Ql="infinite",$l={onGroupExpandedOrCollapsed:[Yl],refreshClientSideRowModel:[Yl],isRowDataEmpty:[Yl],forEachLeafNode:[Yl],forEachNodeAfterFilter:[Yl],forEachNodeAfterFilterAndSort:[Yl],resetRowHeights:[Yl],applyTransaction:[Yl],applyTransactionAsync:[Yl],flushAsyncTransactions:[Yl],getBestCostNodeSelection:[Yl],getServerSideSelectionState:[ql],setServerSideSelectionState:[ql],applyServerSideTransaction:[ql],applyServerSideTransactionAsync:[ql],applyServerSideRowData:[ql],retryServerSideLoads:[ql],flushServerSideAsyncTransactions:[ql],refreshServerSide:[ql],getServerSideGroupLevelState:[ql],refreshInfiniteCache:[Ql],purgeInfiniteCache:[Ql],getInfiniteRowCount:[Ql],isLastRowIndexKnown:[Ql,ql],expandAll:[Yl,ql],collapseAll:[Yl,ql],onRowHeightChanged:[Yl,ql],setRowCount:[Ql,ql],getCacheBlockState:[Ql,ql]},Xl={getValue:{version:"v31.3",new:"getCellValue"},getFirstDisplayedRow:{version:"v31.1",new:"getFirstDisplayedRowIndex"},getLastDisplayedRow:{version:"v31.1",new:"getLastDisplayedRowIndex"},getModel:{version:"v31.1",message:"Please use the appropriate grid API methods instead."},setColumnVisible:{version:"v31.1",old:"setColumnVisible(key,visible)",new:"setColumnsVisible([key],visible)"},setColumnPinned:{version:"v31.1",old:"setColumnPinned(key,pinned)",new:"setColumnsPinned([key],pinned)"},moveColumn:{version:"v31.1",old:"moveColumn(key, toIndex)",new:"moveColumns([key], toIndex)"},setColumnWidth:{version:"v31.1",old:"setColumnWidth(col, width)",new:"setColumnWidths([{key: col, newWidth: width}])"},autoSizeColumn:{version:"v31.1",old:"autoSizeColumn(key, skipHeader)",new:"autoSizeColumns([key], skipHeader)"},addAggFunc:{version:"v31.1",old:"addAggFunc(key, func)",new:"addAggFuncs({ key: func })"},removeValueColumn:{version:"v31.1",old:"removeValueColumn(colKey)",new:"removeValueColumns([colKey])"},addValueColumn:{version:"v31.1",old:"addValueColumn(colKey)",new:"addValueColumns([colKey])"},removeRowGroupColumn:{version:"v31.1",old:"removeRowGroupColumn(colKey)",new:"removeRowGroupColumns([colKey])"},addRowGroupColumn:{version:"v31.1",old:"addRowGroupColumn(colKey)",new:"addRowGroupColumns([colKey])"},removePivotColumn:{version:"v31.1",old:"removePivotColumn(colKey)",new:"removePivotColumns([colKey])"},addPivotColumn:{version:"v31.1",old:"addPivotColumn(colKey)",new:"addPivotColumns([colKey])"},showColumnMenuAfterButtonClick:{version:"v31.1",message:"Use 'IHeaderParams.showColumnMenu' within a header component, or 'api.showColumnMenu' elsewhere."},showColumnMenuAfterMouseClick:{version:"v31.1",message:"Use 'IHeaderParams.showColumnMenuAfterMouseClick' within a header component, or 'api.showColumnMenu' elsewhere."},getFilterInstance:{version:"v31.1",message:"'getFilterInstance' is deprecated. To get/set individual filter models, use 'getColumnFilterModel' or 'setColumnFilterModel' instead. To get hold of the filter instance, use 'getColumnFilterInstance' which returns the instance asynchronously."},showLoadingOverlay:{version:"v32",message:'`showLoadingOverlay` is deprecated. Use the grid option "loading"=true instead or setGridOption("loading", true).'},clearRangeSelection:{version:"v32.2",message:"Use `clearCellSelection` instead."},getInfiniteRowCount:{version:"v32.2",old:"getInfiniteRowCount()",new:"getDisplayedRowCount()"}};var Jl=(e,t)=>{var i;const r=null!==(i=t.rowModelType)&&void 0!==i?i:"clientSide";return"clientSide"===r||"serverSide"===r?{module:"@ag-grid-enterprise/row-grouping"}:null},Zl={enableRowGroup:Jl,rowGroup:Jl,rowGroupIndex:Jl,enablePivot:Jl,enableValue:Jl,pivot:Jl,pivotIndex:Jl,aggFunc:Jl,cellEditor:e=>"agRichSelect"===e.cellEditor||"agRichSelectCellEditor"===e.cellEditor?{module:"@ag-grid-enterprise/rich-select"}:null,menuTabs:e=>{var t;const i=["columnsMenuTab","generalMenuTab"];return null!==(t=e.menuTabs)&&void 0!==t&&t.some((e=>i.includes(e)))?{module:"@ag-grid-enterprise/menu"}:null},columnsMenuParams:{module:["@ag-grid-enterprise/menu","@ag-grid-enterprise/column-tool-panel"]},columnChooserParams:{module:["@ag-grid-enterprise/menu","@ag-grid-enterprise/column-tool-panel"]},headerCheckboxSelection:{supportedRowModels:["clientSide","serverSide"],validate:(e,t)=>{let{rowSelection:i}=t;return"multiple"===i?null:"headerCheckboxSelection is only supported with rowSelection=multiple"}},headerCheckboxSelectionFilteredOnly:{supportedRowModels:["clientSide"],validate:(e,t)=>{let{rowSelection:i}=t;return"multiple"===i?null:"headerCheckboxSelectionFilteredOnly is only supported with rowSelection=multiple"}},headerCheckboxSelectionCurrentPageOnly:{supportedRowModels:["clientSide"],validate:(e,t)=>{let{rowSelection:i}=t;return"multiple"===i?null:"headerCheckboxSelectionCurrentPageOnly is only supported with rowSelection=multiple"}},children:()=>ec},ec={objectName:"colDef",allProperties:Object.keys({headerName:void 0,columnGroupShow:void 0,headerClass:void 0,toolPanelClass:void 0,headerValueGetter:void 0,pivotKeys:void 0,groupId:void 0,colId:void 0,sort:void 0,initialSort:void 0,field:void 0,type:void 0,cellDataType:void 0,tooltipComponent:void 0,tooltipField:void 0,headerTooltip:void 0,cellClass:void 0,showRowGroup:void 0,filter:void 0,initialAggFunc:void 0,defaultAggFunc:void 0,aggFunc:void 0,pinned:void 0,initialPinned:void 0,chartDataType:void 0,cellAriaRole:void 0,cellEditorPopupPosition:void 0,headerGroupComponent:void 0,headerGroupComponentParams:void 0,cellStyle:void 0,cellRenderer:void 0,cellRendererParams:void 0,cellEditor:void 0,cellEditorParams:void 0,filterParams:void 0,pivotValueColumn:void 0,headerComponent:void 0,headerComponentParams:void 0,floatingFilterComponent:void 0,floatingFilterComponentParams:void 0,tooltipComponentParams:void 0,refData:void 0,columnsMenuParams:void 0,columnChooserParams:void 0,children:void 0,sortingOrder:void 0,allowedAggFuncs:void 0,menuTabs:void 0,pivotTotalColumnIds:void 0,cellClassRules:void 0,icons:void 0,sortIndex:void 0,initialSortIndex:void 0,flex:void 0,initialFlex:void 0,width:void 0,initialWidth:void 0,minWidth:void 0,maxWidth:void 0,rowGroupIndex:void 0,initialRowGroupIndex:void 0,pivotIndex:void 0,initialPivotIndex:void 0,suppressCellFlash:void 0,suppressColumnsToolPanel:void 0,suppressFiltersToolPanel:void 0,openByDefault:void 0,marryChildren:void 0,suppressStickyLabel:void 0,hide:void 0,initialHide:void 0,rowGroup:void 0,initialRowGroup:void 0,pivot:void 0,initialPivot:void 0,checkboxSelection:void 0,showDisabledCheckboxes:void 0,headerCheckboxSelection:void 0,headerCheckboxSelectionFilteredOnly:void 0,headerCheckboxSelectionCurrentPageOnly:void 0,suppressMenu:void 0,suppressHeaderMenuButton:void 0,suppressMovable:void 0,lockPosition:void 0,lockVisible:void 0,lockPinned:void 0,unSortIcon:void 0,suppressSizeToFit:void 0,suppressAutoSize:void 0,enableRowGroup:void 0,enablePivot:void 0,enableValue:void 0,editable:void 0,suppressPaste:void 0,suppressNavigable:void 0,enableCellChangeFlash:void 0,rowDrag:void 0,dndSource:void 0,autoHeight:void 0,wrapText:void 0,sortable:void 0,resizable:void 0,singleClickEdit:void 0,floatingFilter:void 0,cellEditorPopup:void 0,suppressFillHandle:void 0,wrapHeaderText:void 0,autoHeaderHeight:void 0,dndSourceOnRowDrag:void 0,valueGetter:void 0,valueSetter:void 0,filterValueGetter:void 0,keyCreator:void 0,valueFormatter:void 0,valueParser:void 0,comparator:void 0,equals:void 0,pivotComparator:void 0,suppressKeyboardEvent:void 0,suppressHeaderKeyboardEvent:void 0,colSpan:void 0,rowSpan:void 0,getQuickFilterText:void 0,onCellValueChanged:void 0,onCellClicked:void 0,onCellDoubleClicked:void 0,onCellContextMenu:void 0,rowDragText:void 0,tooltipValueGetter:void 0,cellRendererSelector:void 0,cellEditorSelector:void 0,suppressSpanHeaderHeight:void 0,useValueFormatterForExport:void 0,useValueParserForImport:void 0,mainMenuItems:void 0,contextMenuItems:void 0,suppressFloatingFilterButton:void 0,suppressHeaderFilterButton:void 0,suppressHeaderContextMenu:void 0,loadingCellRenderer:void 0,loadingCellRendererParams:void 0,loadingCellRendererSelector:void 0,context:void 0}),docsUrl:"column-properties/",deprecations:{columnsMenuParams:{version:"31.1",message:"Use `columnChooserParams` instead."},suppressMenu:{version:"31.1",message:"Use `suppressHeaderMenuButton` instead."},suppressCellFlash:{version:"31.2",message:"Use `enableCellChangeFlash={false}` in the ColDef"},checkboxSelection:{version:"32.2",message:"Use `rowSelection.checkboxes` in `GridOptions` instead."},headerCheckboxSelection:{version:"32.2",message:"Use `rowSelection.headerCheckbox = true` in `GridOptions` instead."},headerCheckboxSelectionFilteredOnly:{version:"32.2",message:'Use `rowSelection.selectAll = "filtered"` in `GridOptions` instead.'},headerCheckboxSelectionCurrentPageOnly:{version:"32.2",message:'Use `rowSelection.selectAll = "currentPage"` in `GridOptions` instead.'},showDisabledCheckboxes:{version:"32.2",message:"Use `rowSelection.hideDisabledCheckboxes = true` in `GridOptions` instead."}},validations:Zl},tc={suppressContextMenu:!1,preventDefaultOnContextMenu:!1,allowContextMenuWithControlKey:!1,suppressMenuHide:!0,enableBrowserTooltips:!1,tooltipTrigger:"hover",tooltipShowDelay:2e3,tooltipHideDelay:1e4,tooltipMouseTrack:!1,tooltipShowMode:"standard",tooltipInteraction:!1,copyHeadersToClipboard:!1,copyGroupHeadersToClipboard:!1,clipboardDelimiter:"\t",suppressCopyRowsToClipboard:!1,suppressCopySingleCellRanges:!1,suppressLastEmptyLineOnPaste:!1,suppressClipboardPaste:!1,suppressClipboardApi:!1,suppressCutToClipboard:!1,maintainColumnOrder:!1,enableStrictPivotColumnOrder:!1,suppressFieldDotNotation:!1,allowDragFromColumnsToolPanel:!1,suppressMovableColumns:!1,suppressColumnMoveAnimation:!1,suppressMoveWhenColumnDragging:!1,suppressDragLeaveHidesColumns:!1,suppressRowGroupHidesColumns:!1,suppressAutoSize:!1,autoSizePadding:20,skipHeaderOnAutoSize:!1,singleClickEdit:!1,suppressClickEdit:!1,readOnlyEdit:!1,stopEditingWhenCellsLoseFocus:!1,enterNavigatesVertically:!1,enterNavigatesVerticallyAfterEdit:!1,enableCellEditingOnBackspace:!1,undoRedoCellEditing:!1,undoRedoCellEditingLimit:10,suppressCsvExport:!1,suppressExcelExport:!1,cacheQuickFilter:!1,includeHiddenColumnsInQuickFilter:!1,excludeChildrenWhenTreeDataFiltering:!1,enableAdvancedFilter:!1,includeHiddenColumnsInAdvancedFilter:!1,enableCharts:!1,masterDetail:!1,keepDetailRows:!1,keepDetailRowsCount:10,detailRowAutoHeight:!1,tabIndex:0,rowBuffer:10,valueCache:!1,valueCacheNeverExpires:!1,enableCellExpressions:!1,suppressTouch:!1,suppressFocusAfterRefresh:!1,suppressAsyncEvents:!1,suppressBrowserResizeObserver:!1,suppressPropertyNamesCheck:!1,suppressChangeDetection:!1,debug:!1,suppressLoadingOverlay:!1,suppressNoRowsOverlay:!1,pagination:!1,paginationPageSize:100,paginationPageSizeSelector:!0,paginationAutoPageSize:!1,paginateChildRows:!1,suppressPaginationPanel:!1,pivotMode:!1,pivotPanelShow:"never",pivotDefaultExpanded:0,pivotSuppressAutoColumn:!1,suppressExpandablePivotGroups:!1,functionsReadOnly:!1,suppressAggFuncInHeader:!1,alwaysAggregateAtRootLevel:!1,aggregateOnlyChangedColumns:!1,suppressAggFilteredOnly:!1,removePivotHeaderRowWhenSingleValueColumn:!1,animateRows:!0,enableCellChangeFlash:!1,cellFlashDelay:500,cellFlashDuration:500,cellFadeDelay:1e3,cellFadeDuration:1e3,allowShowChangeAfterFilter:!1,domLayout:"normal",ensureDomOrder:!1,enableRtl:!1,suppressColumnVirtualisation:!1,suppressMaxRenderedRowRestriction:!1,suppressRowVirtualisation:!1,rowDragManaged:!1,suppressRowDrag:!1,suppressMoveWhenRowDragging:!1,rowDragEntireRow:!1,rowDragMultiRow:!1,embedFullWidthRows:!1,groupDisplayType:"singleColumn",groupDefaultExpanded:0,groupMaintainOrder:!1,groupSelectsChildren:!1,groupIncludeTotalFooter:!1,groupSuppressBlankHeader:!1,groupSelectsFiltered:!1,showOpenedGroup:!1,groupRemoveSingleChildren:!1,groupRemoveLowestSingleChildren:!1,groupHideOpenParents:!1,groupAllowUnbalanced:!1,rowGroupPanelShow:"never",suppressMakeColumnVisibleAfterUnGroup:!1,treeData:!1,rowGroupPanelSuppressSort:!1,suppressGroupRowsSticky:!1,rowModelType:"clientSide",asyncTransactionWaitMillis:50,suppressModelUpdateAfterUpdateTransaction:!1,cacheOverflowSize:1,infiniteInitialRowCount:1,serverSideInitialRowCount:1,suppressServerSideInfiniteScroll:!1,cacheBlockSize:100,maxBlocksInCache:-1,maxConcurrentDatasourceRequests:2,blockLoadDebounceMillis:0,purgeClosedRowNodes:!1,serverSideSortAllLevels:!1,serverSideOnlyRefreshFilteredGroups:!1,serverSideSortOnServer:!1,serverSideFilterOnServer:!1,serverSidePivotResultFieldSeparator:"_",viewportRowModelPageSize:5,viewportRowModelBufferSize:5,alwaysShowHorizontalScroll:!1,alwaysShowVerticalScroll:!1,debounceVerticalScrollbar:!1,suppressHorizontalScroll:!1,suppressScrollOnNewData:!1,suppressScrollWhenPopupsAreOpen:!1,suppressAnimationFrame:!1,suppressMiddleClickScrolls:!1,suppressPreventDefaultOnMouseWheel:!1,rowMultiSelectWithClick:!1,suppressRowDeselection:!1,suppressRowClickSelection:!1,suppressCellFocus:!1,suppressHeaderFocus:!1,suppressMultiRangeSelection:!1,enableCellTextSelection:!1,enableRangeSelection:!1,enableRangeHandle:!1,enableFillHandle:!1,fillHandleDirection:"xy",suppressClearOnFillReduction:!1,accentedSort:!1,unSortIcon:!1,suppressMultiSort:!1,alwaysMultiSort:!1,suppressMaintainUnsortedOrder:!1,suppressRowHoverHighlight:!1,suppressRowTransform:!1,columnHoverHighlight:!1,deltaSort:!1,enableGroupEdit:!1,suppressGroupMaintainValueType:!1,groupLockGroupColumns:0,serverSideEnableClientSideSort:!1,suppressServerSideFullWidthLoadingRow:!1,pivotMaxGeneratedColumns:-1,columnMenu:"new",reactiveCustomComponents:!0,suppressSetFilterByDefault:!1};var ic={version:Do,moduleName:"@ag-grid-community/core"},rc={version:Do,moduleName:"@ag-grid-community/core-validations",beans:[class extends He{constructor(){super(...arguments),this.beanName="validationService"}wireBeans(e){this.beans=e,this.gridOptions=e.gridOptions}postConstruct(){this.processGridOptions(this.gridOptions)}processGridOptions(e){this.processOptions(e,{objectName:"gridOptions",allProperties:[...Wt.ALL_PROPERTIES,...jt.EVENT_CALLBACKS],propertyExceptions:["api"],docsUrl:"grid-options/",deprecations:{advancedFilterModel:{version:"31",message:"Use `initialState.filter.advancedFilterModel` instead."},suppressAsyncEvents:{version:"31",message:"Events should be handled asynchronously."},cellFadeDelay:{version:"31.1",renamed:"cellFadeDuration"},cellFlashDelay:{version:"31.1",renamed:"cellFlashDuration"},suppressServerSideInfiniteScroll:{version:"31.1"},serverSideSortOnServer:{version:"31.1"},serverSideFilterOnServer:{version:"31.1"},enableCellChangeFlash:{version:"31.2",message:"Use `enableCellChangeFlash` in the `ColDef` or `defaultColDef` for all columns."},groupIncludeFooter:{version:"31.3",message:"Use `groupTotalRow` instead."},groupIncludeTotalFooter:{version:"31.3",message:"Use `grandTotalRow` instead."},suppressLoadingOverlay:{version:"32",message:"Use `loading`=false instead."},enableFillHandle:{version:"32.2",message:"Use `cellSelection.handle` instead."},enableRangeHandle:{version:"32.2",message:"Use `cellSelection.handle` instead."},enableRangeSelection:{version:"32.2",message:"Use `cellSelection = true` instead."},suppressMultiRangeSelection:{version:"32.2",message:"Use `cellSelection.suppressMultiRanges` instead."},suppressClearOnFillReduction:{version:"32.2",message:"Use `cellSelection.handle.suppressClearOnFillReduction` instead."},fillHandleDirection:{version:"32.2",message:"Use `cellSelection.handle.direction` instead."},fillOperation:{version:"32.2",message:"Use `cellSelection.handle.setFillValue` instead."},suppressRowClickSelection:{version:"32.2",message:"Use `rowSelection.enableClickSelection` instead."},suppressRowDeselection:{version:"32.2",message:"Use `rowSelection.enableClickSelection` instead."},rowMultiSelectWithClick:{version:"32.2",message:"Use `rowSelection.enableSelectionWithoutKeys` instead."},groupSelectsChildren:{version:"32.2",message:'Use `rowSelection.groupSelects = "descendants"` instead.'},groupSelectsFiltered:{version:"32.2",message:'Use `rowSelection.groupSelects = "filteredDescendants"` instead.'},isRowSelectable:{version:"32.2",message:"Use `selectionOptions.isRowSelectable` instead."},suppressCopySingleCellRanges:{version:"32.2",message:"Use `rowSelection.copySelectedRows` instead."},suppressCopyRowsToClipboard:{version:"32.2",message:"Use `rowSelection.copySelectedRows` instead."},onRangeSelectionChanged:{version:"32.2",message:"Use `onCellSelectionChanged` instead."},onRangeDeleteStart:{version:"32.2",message:"Use `onCellSelectionDeleteStart` instead."},onRangeDeleteEnd:{version:"32.2",message:"Use `onCellSelectionDeleteEnd` instead."},suppressBrowserResizeObserver:{version:"32.2",message:"The grid always uses the browser's ResizeObserver, this grid option has no effect."},onColumnEverythingChanged:{version:"32.2",message:"Either use `onDisplayedColumnsChanged` which is fired at the same time, or use one of the more specific column events."}},validations:{sideBar:{module:"@ag-grid-enterprise/side-bar"},statusBar:{module:"@ag-grid-enterprise/status-bar"},enableCharts:{module:"@ag-grid-enterprise/charts"},getMainMenuItems:{module:"@ag-grid-enterprise/menu"},getContextMenuItems:{module:"@ag-grid-enterprise/menu"},allowContextMenuWithControlKey:{module:"@ag-grid-enterprise/menu"},enableAdvancedFilter:{module:"@ag-grid-enterprise/advanced-filter"},treeData:{supportedRowModels:["clientSide","serverSide"],module:"@ag-grid-enterprise/row-grouping",validate:e=>{var t;const i=null!==(t=e.rowModelType)&&void 0!==t?t:"clientSide";switch(i){case"clientSide":{const t="treeData requires 'getDataPath' in the ".concat(i," row model.");return e.getDataPath?null:t}case"serverSide":{const t="treeData requires 'isServerSideGroup' and 'getServerSideGroupKey' in the ".concat(i," row model.");return e.isServerSideGroup&&e.getServerSideGroupKey?null:t}}return null}},masterDetail:{module:"@ag-grid-enterprise/master-detail"},enableRangeSelection:{module:"@ag-grid-enterprise/range-selection"},enableRangeHandle:{dependencies:{enableRangeSelection:[!0]}},enableFillHandle:{dependencies:{enableRangeSelection:[!0]}},groupDefaultExpanded:{supportedRowModels:["clientSide"]},groupIncludeFooter:{supportedRowModels:["clientSide","serverSide"],validate:e=>{var t;switch(null!==(t=e.rowModelType)&&void 0!==t?t:"clientSide"){case"clientSide":return null;case"serverSide":{const t="groupIncludeFooter is not supported alongside suppressServerSideInfiniteScroll";return e.suppressServerSideInfiniteScroll?t:null}}return null}},groupHideOpenParents:{supportedRowModels:["clientSide","serverSide"],dependencies:{groupTotalRow:[void 0,"bottom"]}},groupIncludeTotalFooter:{supportedRowModels:["clientSide"]},groupRemoveSingleChildren:{dependencies:{groupHideOpenParents:[void 0,!1],groupRemoveLowestSingleChildren:[void 0,!1]}},groupRemoveLowestSingleChildren:{dependencies:{groupHideOpenParents:[void 0,!1],groupRemoveSingleChildren:[void 0,!1]}},groupSelectsChildren:{dependencies:{rowSelection:["multiple"]}},viewportDatasource:{supportedRowModels:["viewport"],module:"@ag-grid-enterprise/viewport-row-model"},serverSideDatasource:{supportedRowModels:["serverSide"],module:"@ag-grid-enterprise/server-side-row-model"},cacheBlockSize:{supportedRowModels:["serverSide","infinite"]},datasource:{supportedRowModels:["infinite"],module:"@ag-grid-community/infinite-row-model"},rowData:{supportedRowModels:["clientSide"],module:"@ag-grid-community/client-side-row-model"},paginationPageSizeSelector:{validate:e=>{const t=e.paginationPageSizeSelector;return"boolean"===typeof t||null==t||t.length?null:"'paginationPageSizeSelector' cannot be an empty array.\n                    If you want to hide the page size selector, set paginationPageSizeSelector to false."}},rowSelection:{validate(e){let{rowSelection:t}=e;return t&&"string"===typeof t?'As of version 32.2.1, using `rowSelection` with the values "single" or "multiple" has been deprecated. Use the object value instead.':t&&"object"!==typeof t?"Expected `RowSelectionOptions` object for the `rowSelection` property.":null}},cellSelection:{module:"@ag-grid-enterprise/range-selection"},columnDefs:()=>ec,defaultColDef:()=>ec,defaultColGroupDef:()=>ec,autoGroupColumnDef:()=>ec,selectionColumnDef:()=>ec}})}validateApiFunction(e,t){return function(e,t,i){const r=Xl[e];if(r){const{version:i,new:n,old:o,message:s}=r,a=null!==o&&void 0!==o?o:e;return function(){const e=n?"Please use ".concat(n," instead. "):"";v("Since ".concat(i," api.").concat(a," is deprecated. ").concat(e).concat(null!==s&&void 0!==s?s:""));for(var r=arguments.length,o=new Array(r),l=0;l<r;l++)o[l]=arguments[l];return t.apply(t,o)}}const n=$l[e];return n?function(){const r=i.rowModel.getType();if(n.includes(r)){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(t,s)}C("api.".concat(e," can only be called when gridOptions.rowModelType is ").concat(n.join(" or ")))}:t}(e,t,this.beans)}processOptions(e,t){const{validations:i,deprecations:r,allProperties:n,propertyExceptions:o,objectName:s,docsUrl:a}=t;n&&!0!==this.gridOptions.suppressPropertyNamesCheck&&this.checkProperties(e,[...null!==o&&void 0!==o?o:[],...Object.keys(r)],n,s,a);const l=new Set;Object.keys(e).forEach((t=>{const n=r[t];if(n)if("renamed"in n){const{renamed:i,version:r}=n;l.add("As of v".concat(r,", ").concat(String(t)," is deprecated. Please use ").concat(String(i)," instead.")),e[i]=e[t]}else{const{message:e,version:i}=n;l.add("As of v".concat(i,", ").concat(String(t)," is deprecated. ").concat(null!==e&&void 0!==e?e:""))}const o=e[t];if(null==o||!1===o)return;const s=i[t];let a;if(!s)return;if("function"===typeof s){const i=s(e,this.gridOptions);if(!i)return;if("objectName"in i){const r=e[t];return Array.isArray(r)?void r.forEach((e=>{this.processOptions(e,i)})):void this.processOptions(e[t],i)}a=i}else a=s;const{module:c,dependencies:u,validate:d,supportedRowModels:h}=a;if(h){var g;const e=null!==(g=this.gridOptions.rowModelType)&&void 0!==g?g:"clientSide";if(!h.includes(e))return void l.add("".concat(String(t)," is not supported with the '").concat(e,"' row model."))}if(c){const e=Array.isArray(c)?c:[c];let i=!0;if(e.forEach((e=>{this.gos.assertModuleRegistered(e,String(t))||(i=!1,l.add("".concat(String(t)," is only available when ").concat(e," is loaded.")))})),!i)return}if(u){const i=this.checkForRequiredDependencies(t,u,e);if(i)return void l.add(i)}if(d){const t=d(e,this.gridOptions);if(t)return void l.add(t)}})),l.size>0&&l.forEach((e=>{v(e)}))}checkForRequiredDependencies(e,t,i){const r=Object.entries(t).find((e=>{let[t,r]=e;const n=i[t];return!r.includes(n)}));if(!r)return null;const[n,o]=r;return o.length>1?"'".concat(String(e),"' requires '").concat(n,"' to be one of [").concat(o.join(", "),"]."):"'".concat(String(e),"' requires '").concat(n,"' to be ").concat(o[0],".")}checkProperties(e,t,i,r,n){const o=function(e,t,i){const r={},n=e.filter((e=>!t.some((t=>t===e))));n.length>0&&n.forEach((e=>r[e]=zr({inputValue:e,allSuggestions:i}).values));return r}(Object.getOwnPropertyNames(e),["__ob__","__v_skip","__metadata__",...t,...i],i);if(Ze(o,((e,t)=>{let n="invalid ".concat(r," property '").concat(e,"' did you mean any of these: ").concat(t.slice(0,8).join(", "),".");i.includes("context")&&(n+="\nIf you are trying to annotate ".concat(r," with application data, use the '").concat(r,".context' property instead.")),v(n)})),Object.keys(o).length>0&&n){const e=this.getFrameworkOverrides().getDocLink(n);v("to see all the valid ".concat(r," properties please check: ").concat(e))}}}]},nc={version:Do,moduleName:"@ag-grid-community/core-community-features",dependantModules:[ic,rc,Ma,Uo,Vl,Ml,Al,Kl,Gl]},oc=class extends He{constructor(){super(...arguments),this.beanName="gridDestroyService",this.destroyCalled=!1}wireBeans(e){this.beans=e}destroy(){var e,t,i;this.destroyCalled||(this.eventService.dispatchEvent({type:"gridPreDestroyed",state:null!==(e=null===(t=this.beans.stateService)||void 0===t?void 0:t.getState())&&void 0!==e?e:{}}),this.destroyCalled=!0,null===(i=this.beans.ctrlsService.get("gridCtrl"))||void 0===i||i.destroyGridUi(),this.beans.context.destroy(),super.destroy())}isDestroyCalled(){return this.destroyCalled}},sc=new Set(["gridPreDestroyed","fillStart","pasteStart"]),ac=new Map([...Wt.BOOLEAN_PROPERTIES.map((e=>[e,I])),...Wt.NUMBER_PROPERTIES.map((e=>[e,lo])),["groupAggFiltering",e=>"function"===typeof e?e:I(e)],["pageSize",co(1)],["autoSizePadding",co(0)],["keepDetailRowsCount",co(1)],["rowBuffer",co(0)],["infiniteInitialRowCount",co(1)],["cacheOverflowSize",co(1)],["cacheBlockSize",co(1)],["serverSideInitialRowCount",co(1)],["viewportRowModelPageSize",co(1)],["viewportRowModelBufferSize",co(0)]]);function lc(e,t){const i=ac.get(e);return i?i(t):t}var cc=class e extends He{constructor(){super(...arguments),this.beanName="gos",this.domDataKey="__AG_"+Math.random().toString(),this.propertyEventService=new h,this.globalEventHandlerFactory=e=>(t,i)=>{if(!this.isAlive())return;const r=sc.has(t);if(r&&!e||!r&&e)return;const n=jt.getCallbackForEvent(t),o=this.gridOptions[n];"function"===typeof o&&this.frameworkOverrides.wrapOutgoing((()=>{o(i)}))}}wireBeans(e){this.gridOptions=e.gridOptions,this.eGridDiv=e.eGridDiv,this.validationService=e.validationService,this.environment=e.environment,this.api=e.gridApi,this.gridId=e.context.getGridId()}get gridOptionsContext(){return this.gridOptions.context}postConstruct(){const e=!this.get("suppressAsyncEvents");this.eventService.addGlobalListener(this.globalEventHandlerFactory().bind(this),e),this.eventService.addGlobalListener(this.globalEventHandlerFactory(!0).bind(this),!1),this.propertyEventService.setFrameworkOverrides(this.frameworkOverrides),this.addManagedEventListeners({gridOptionsChanged:e=>{let{options:t}=e;this.updateGridOptions({options:t,force:!0,source:"gridOptionsUpdated"})}})}get(e){var t;return null!==(t=this.gridOptions[e])&&void 0!==t?t:tc[e]}getCallback(e){return this.mergeGridCommonParams(this.gridOptions[e])}exists(e){return F(this.gridOptions[e])}mergeGridCommonParams(e){if(e){return t=>{const i=t;return i.api=this.api,i.context=this.gridOptionsContext,e(i)}}return e}updateGridOptions(t){var i;let{options:r,force:n,source:o="api"}=t;const s={id:e.changeSetId++,properties:[]},a=[];Object.entries(r).forEach((e=>{let[t,i]=e;"api"===o&&Vt[t]&&v("".concat(t," is an initial property and cannot be updated."));const r=lc(t,i),l=n||"object"===typeof r&&"api"===o,c=this.gridOptions[t];if(l||c!==r){this.gridOptions[t]=r;const e={type:t,currentValue:r,previousValue:c,changeSet:s,source:o};a.push(e)}})),null===(i=this.validationService)||void 0===i||i.processGridOptions(this.gridOptions),s.properties=a.map((e=>e.type)),a.forEach((e=>{this.gridOptions.debug&&m("Updated property ".concat(e.type," from"),e.previousValue," to ",e.currentValue),this.propertyEventService.dispatchEvent(e)}))}addPropertyEventListener(e,t){this.propertyEventService.addEventListener(e,t)}removePropertyEventListener(e,t){this.propertyEventService.removeEventListener(e,t)}getDomDataKey(){return this.domDataKey}getGridCommonParams(){return{api:this.api,context:this.gridOptionsContext}}addGridCommonParams(e){const t=e;return t.api=this.api,t.context=this.gridOptionsContext,t}assertModuleRegistered(e,t){return fn.__assertRegistered(e,t,this.gridId)}isModuleRegistered(e){return fn.__isRegistered(e,this.gridId)}};cc.changeSetId=0;var uc=cc,dc=class extends He{constructor(){super(...arguments),this.beanName="headerPositionUtils"}wireBeans(e){this.visibleColsService=e.visibleColsService,this.ctrlsService=e.ctrlsService}findHeader(e,t){let i,r;if(It(e.column)?i=this.visibleColsService.getGroupAtDirection(e.column,t):(r="getCol".concat(t),i=this.visibleColsService[r](e.column)),!i)return;const{headerRowIndex:n}=e;if("filter"!==this.getHeaderRowType(n)){const e=[i];for(;i.getParent();)i=i.getParent(),e.push(i);i=e[e.length-1-n]}const{column:o,headerRowIndex:s}=this.getHeaderIndexToFocus(i,n);return{column:o,headerRowIndex:s}}getHeaderIndexToFocus(e,t){let i;if(It(e)&&this.isAnyChildSpanningHeaderHeight(e)&&e.isPadding()){const r=e;i=r.getLeafColumns()[0];let n=i;for(;n!==r;)t++,n=n.getParent()}return{column:i||e,headerRowIndex:t}}isAnyChildSpanningHeaderHeight(e){return!!e&&e.getLeafColumns().some((e=>e.isSpanHeaderHeight()))}getColumnVisibleParent(e,t){const i=this.getHeaderRowType(t),r="column"===i;let n="filter"===i?e:e.getParent(),o=t-1,s=o;if(r&&this.isAnyChildSpanningHeaderHeight(e.getParent())){for(;n&&n.isPadding();)n=n.getParent(),o--;s=o,o<0&&(n=e,o=t,s=void 0)}return{column:n,headerRowIndex:o,headerRowIndexWithoutSpan:s}}getColumnVisibleChild(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"After";let r=e,n=t+1;const o=n;if("group"===this.getHeaderRowType(t)){const t=e.getDisplayedLeafColumns(),o="After"===i?t[0]:ye(t),s=[];let a=o;for(;a.getParent()!==e;)a=a.getParent(),s.push(a);if(r=o,o.isSpanHeaderHeight())for(let e=s.length-1;e>=0;e--){const t=s[e];if(!t.isPadding()){r=t;break}n++}else r=ye(s),r||(r=o)}return{column:r,headerRowIndex:n,headerRowIndexWithoutSpan:o}}getHeaderRowType(e){const t=this.ctrlsService.getHeaderRowContainerCtrl();if(t)return t.getRowType(e)}findColAtEdgeForHeaderRow(e,t){const i=this.visibleColsService.getAllCols(),r=i["start"===t?0:i.length-1];if(!r)return;const n=this.ctrlsService.getHeaderRowContainerCtrl(r.getPinned()),o=null===n||void 0===n?void 0:n.getRowType(e);if("group"==o){return{headerRowIndex:e,column:this.visibleColsService.getColGroupAtLevel(r,e)}}return{headerRowIndex:null==o?-1:e,column:r}}},hc=class extends He{constructor(){super(...arguments),this.beanName="localeService"}getLocaleTextFunc(){const e=this.gos.getCallback("getLocaleText");if(e)return(t,i,r)=>e({key:t,defaultValue:i,variableValues:r});const t=this.gos.get("localeText");return(e,i,r)=>{var n;let o=t&&t[e];if(o&&r&&r.length){let e=0;for(;!(e>=r.length);){if(-1===o.indexOf("${variable}"))break;o=o.replace("${variable}",r[e++])}}return null!==(n=o)&&void 0!==n?n:i}}},gc=class extends He{constructor(){super(...arguments),this.beanName="apiEventService",this.syncEventListeners=new Map,this.asyncEventListeners=new Map,this.syncGlobalEventListeners=new Set,this.globalEventListenerPairs=new Map}postConstruct(){this.frameworkEventWrappingService=new Xe(this.getFrameworkOverrides())}addEventListener(e,t){const i=this.frameworkEventWrappingService.wrap(t),r=_(this.gos)&&!sc.has(e),n=r?this.asyncEventListeners:this.syncEventListeners;n.has(e)||n.set(e,new Set),n.get(e).add(i),this.eventService.addEventListener(e,i,r)}removeEventListener(e,t){const i=this.frameworkEventWrappingService.unwrap(t),r=this.asyncEventListeners.get(e),n=!(null===r||void 0===r||!r.delete(i));var o;n||(null===(o=this.syncEventListeners.get(e))||void 0===o||o.delete(i));this.eventService.removeEventListener(e,i,n)}addGlobalListener(e){const t=this.frameworkEventWrappingService.wrapGlobal(e);if(_(this.gos)){const i=(e,i)=>{sc.has(e)&&t(e,i)},r=(e,i)=>{sc.has(e)||t(e,i)};this.globalEventListenerPairs.set(e,{syncListener:i,asyncListener:r}),this.eventService.addGlobalListener(i,!1),this.eventService.addGlobalListener(r,!0)}else this.syncGlobalEventListeners.add(t),this.eventService.addGlobalListener(t,!1)}removeGlobalListener(e){const t=this.frameworkEventWrappingService.unwrapGlobal(e);if(this.globalEventListenerPairs.has(t)){const{syncListener:i,asyncListener:r}=this.globalEventListenerPairs.get(t);this.eventService.removeGlobalListener(i,!1),this.eventService.removeGlobalListener(r,!0),this.globalEventListenerPairs.delete(e)}else this.syncGlobalEventListeners.delete(t),this.eventService.removeGlobalListener(t,!1)}destroyEventListeners(e,t){e.forEach(((e,i)=>{e.forEach((e=>this.eventService.removeEventListener(i,e,t))),e.clear()})),e.clear()}destroyGlobalListeners(e,t){e.forEach((e=>this.eventService.removeGlobalListener(e,t))),e.clear()}destroy(){super.destroy(),this.destroyEventListeners(this.syncEventListeners,!1),this.destroyEventListeners(this.asyncEventListeners,!0),this.destroyGlobalListeners(this.syncGlobalEventListeners,!1),this.globalEventListenerPairs.forEach((e=>{let{syncListener:t,asyncListener:i}=e;this.eventService.removeGlobalListener(t,!1),this.eventService.removeGlobalListener(i,!0)})),this.globalEventListenerPairs.clear()}},pc=class extends He{constructor(){super(...arguments),this.beanName="pageBoundsListener"}wireBeans(e){this.rowModel=e.rowModel,this.paginationService=e.paginationService,this.pageBoundsService=e.pageBoundsService}postConstruct(){this.addManagedEventListeners({modelUpdated:this.onModelUpdated.bind(this),recalculateRowBounds:this.calculatePages.bind(this)}),this.onModelUpdated()}onModelUpdated(e){var t,i,r,n,o;this.calculatePages(),this.eventService.dispatchEvent({type:"paginationChanged",animate:null!==(t=null===e||void 0===e?void 0:e.animate)&&void 0!==t&&t,newData:null!==(i=null===e||void 0===e?void 0:e.newData)&&void 0!==i&&i,newPage:null!==(r=null===e||void 0===e?void 0:e.newPage)&&void 0!==r&&r,newPageSize:null!==(n=null===e||void 0===e?void 0:e.newPageSize)&&void 0!==n&&n,keepRenderedRows:null!==(o=null===e||void 0===e?void 0:e.keepRenderedRows)&&void 0!==o&&o})}calculatePages(){this.paginationService?this.paginationService.calculatePages():this.pageBoundsService.calculateBounds(0,this.rowModel.getRowCount()-1)}},fc=class extends He{constructor(){super(...arguments),this.beanName="pageBoundsService",this.pixelOffset=0}wireBeans(e){this.rowModel=e.rowModel}getFirstRow(){return this.topRowBounds?this.topRowBounds.rowIndex:-1}getLastRow(){return this.bottomRowBounds?this.bottomRowBounds.rowIndex:-1}getCurrentPageHeight(){return P(this.topRowBounds)||P(this.bottomRowBounds)?0:Math.max(this.bottomRowBounds.rowTop+this.bottomRowBounds.rowHeight-this.topRowBounds.rowTop,0)}getCurrentPagePixelRange(){return{pageFirstPixel:this.topRowBounds?this.topRowBounds.rowTop:0,pageLastPixel:this.bottomRowBounds?this.bottomRowBounds.rowTop+this.bottomRowBounds.rowHeight:0}}calculateBounds(e,t){this.topRowBounds=this.rowModel.getRowBounds(e),this.topRowBounds&&(this.topRowBounds.rowIndex=e),this.bottomRowBounds=this.rowModel.getRowBounds(t),this.bottomRowBounds&&(this.bottomRowBounds.rowIndex=t),this.calculatePixelOffset()}getPixelOffset(){return this.pixelOffset}calculatePixelOffset(){const e=F(this.topRowBounds)?this.topRowBounds.rowTop:0;this.pixelOffset!==e&&(this.pixelOffset=e,this.eventService.dispatchEvent({type:"paginationPixelOffsetChanged"}))}},mc=class extends He{constructor(){super(),this.beanName="ariaAnnouncementService",this.descriptionContainer=null,this.pendingAnnouncements=new Map,this.updateAnnouncement=E(this.updateAnnouncement.bind(this),200)}wireBeans(e){this.eGridDiv=e.eGridDiv}postConstruct(){const e=Q(this.gos),t=this.descriptionContainer=e.createElement("div");t.classList.add("ag-aria-description-container"),hi(t,"polite"),oi(t,"relevant","additions text"),function(e,t){oi(e,"atomic",t)}(t,!0),this.eGridDiv.appendChild(t)}announceValue(e,t){this.pendingAnnouncements.set(t,e),this.updateAnnouncement()}updateAnnouncement(){if(!this.descriptionContainer)return;const e=Array.from(this.pendingAnnouncements.values()).join(". ");this.pendingAnnouncements.clear(),this.descriptionContainer.textContent="",setTimeout((()=>{this.isAlive()&&this.descriptionContainer&&(this.descriptionContainer.textContent=e)}),50)}destroy(){super.destroy();const{descriptionContainer:e}=this;e&&(Yi(e),e.parentElement&&e.parentElement.removeChild(e)),this.descriptionContainer=null,this.eGridDiv=null,this.pendingAnnouncements.clear()}},vc=class extends He{constructor(){super(...arguments),this.beanName="columnAnimationService",this.executeNextFuncs=[],this.executeLaterFuncs=[],this.active=!1,this.activeNext=!1,this.suppressAnimation=!1,this.animationThreadCount=0}wireBeans(e){this.ctrlsService=e.ctrlsService}postConstruct(){this.ctrlsService.whenReady(this,(e=>this.gridBodyCtrl=e.gridBodyCtrl))}isActive(){return this.active&&!this.suppressAnimation}setSuppressAnimation(e){this.suppressAnimation=e}start(){this.active||this.gos.get("suppressColumnMoveAnimation")||this.gos.get("enableRtl")||(this.ensureAnimationCssClassPresent(),this.active=!0,this.activeNext=!0)}finish(){this.active&&this.flush((()=>this.activeNext=!1),(()=>this.active=!1))}executeNextVMTurn(e){this.activeNext?this.executeNextFuncs.push(e):e()}executeLaterVMTurn(e){this.active?this.executeLaterFuncs.push(e):e()}ensureAnimationCssClassPresent(){this.animationThreadCount++;const e=this.animationThreadCount;this.gridBodyCtrl.setColumnMovingCss(!0),this.executeLaterFuncs.push((()=>{this.animationThreadCount===e&&this.gridBodyCtrl.setColumnMovingCss(!1)}))}flush(e,t){if(0===this.executeNextFuncs.length&&0===this.executeLaterFuncs.length)return e(),void t();const i=e=>{for(;e.length;){const t=e.pop();t&&t()}};this.getFrameworkOverrides().wrapIncoming((()=>{window.setTimeout((()=>{e(),i(this.executeNextFuncs)}),0),window.setTimeout((()=>{t(),i(this.executeLaterFuncs)}),200)}))}},Cc=class extends He{constructor(){super(...arguments),this.beanName="columnHoverService"}setMouseOver(e){this.updateState(e)}clearMouseOver(){this.updateState(null)}isHovered(e){return!!this.selectedColumns&&this.selectedColumns.indexOf(e)>=0}updateState(e){this.selectedColumns=e,this.eventService.dispatchEvent({type:"columnHoverChanged"})}},wc=class extends He{constructor(){super(...arguments),this.beanName="overlayService",this.state=0,this.showInitialOverlay=!0,this.wrapperPadding=0}wireBeans(e){this.userComponentFactory=e.userComponentFactory,this.rowModel=e.rowModel,this.columnModel=e.columnModel,this.ctrlsService=e.ctrlsService}postConstruct(){this.isClientSide=G(this.gos);const e=()=>this.updateOverlayVisibility();this.addManagedEventListeners({newColumnsLoaded:e,rowDataUpdated:e,gridSizeChanged:this.onGridSizeChanged.bind(this),rowCountReady:()=>{this.showInitialOverlay=!1,this.updateOverlayVisibility()}}),this.addManagedPropertyListener("loading",e)}setOverlayWrapperComp(e){this.overlayWrapperComp=e,this.updateOverlayVisibility()}isVisible(){return 0!==this.state&&!!this.overlayWrapperComp}isExclusive(){return 1===this.state&&!!this.overlayWrapperComp}getOverlayWrapper(){return this.overlayWrapperComp}showLoadingOverlay(){this.showInitialOverlay=!1;const e=this.gos.get("loading");(e||void 0===e&&!this.gos.get("suppressLoadingOverlay"))&&this.doShowLoadingOverlay()}showNoRowsOverlay(){this.showInitialOverlay=!1,this.gos.get("loading")||this.gos.get("suppressNoRowsOverlay")||this.doShowNoRowsOverlay()}hideOverlay(){this.showInitialOverlay=!1,this.gos.get("loading")?v("Since v32, `api.hideOverlay()` does not hide the loading overlay when `loading=true`. Set `loading=false` instead."):this.doHideOverlay()}updateOverlayVisibility(){if(!this.overlayWrapperComp)return void(this.state=0);let e=this.gos.get("loading");this.showInitialOverlay&&void 0===e&&!this.gos.get("suppressLoadingOverlay")&&(e=!this.gos.get("columnDefs")||!this.columnModel.isReady()||!this.gos.get("rowData")&&this.isClientSide),e?1!==this.state&&this.doShowLoadingOverlay():(this.showInitialOverlay=!1,this.rowModel.isEmpty()&&!this.gos.get("suppressNoRowsOverlay")&&this.isClientSide?2!==this.state&&this.doShowNoRowsOverlay():0!==this.state&&this.doHideOverlay())}doShowLoadingOverlay(){this.overlayWrapperComp&&(this.state=1,this.showOverlay(this.userComponentFactory.getLoadingOverlayCompDetails({}),"ag-overlay-loading-wrapper","loadingOverlayComponentParams"),this.updateExclusive())}doShowNoRowsOverlay(){this.overlayWrapperComp&&(this.state=2,this.showOverlay(this.userComponentFactory.getNoRowsOverlayCompDetails({}),"ag-overlay-no-rows-wrapper","noRowsOverlayComponentParams"),this.updateExclusive())}doHideOverlay(){this.overlayWrapperComp&&(this.state=0,this.overlayWrapperComp.hideOverlay(),this.updateExclusive())}showOverlay(e,t,i){var r;const n=e.newAgStackInstance();null===(r=this.overlayWrapperComp)||void 0===r||r.showOverlay(n,t,this.isExclusive(),i),this.refreshWrapperPadding()}updateExclusive(){const e=this.exclusive;this.exclusive=this.isExclusive(),this.exclusive!==e&&this.eventService.dispatchEvent({type:"overlayExclusiveChanged"})}onGridSizeChanged(){this.refreshWrapperPadding()}refreshWrapperPadding(){if(!this.overlayWrapperComp)return;let e=0;if(2===this.state){const t=this.ctrlsService.get("gridHeaderCtrl");e=(null===t||void 0===t?void 0:t.getHeaderHeight())||0}else 0!==this.wrapperPadding&&(e=0);this.wrapperPadding!==e&&(this.wrapperPadding=e,this.overlayWrapperComp.updateOverlayWrapperPaddingTop(e))}},bc=class extends He{constructor(){super(...arguments),this.beanName="rowCssClassCalculator"}wireBeans(e){this.stylingService=e.stylingService}getInitialRowClasses(e){const t=[];return F(e.extraCssClass)&&t.push(e.extraCssClass),t.push("ag-row"),t.push(e.rowFocused?"ag-row-focus":"ag-row-no-focus"),e.fadeRowIn&&t.push("ag-opacity-zero"),t.push(e.rowIsEven?"ag-row-even":"ag-row-odd"),e.rowNode.isRowPinned()&&t.push("ag-row-pinned"),e.rowNode.isSelected()&&t.push("ag-row-selected"),e.rowNode.footer&&t.push("ag-row-footer"),t.push("ag-row-level-"+e.rowLevel),e.rowNode.stub&&t.push("ag-row-loading"),e.fullWidthRow&&t.push("ag-full-width-row"),e.expandable&&(t.push("ag-row-group"),t.push(e.rowNode.expanded?"ag-row-group-expanded":"ag-row-group-contracted")),e.rowNode.dragging&&t.push("ag-row-dragging"),ke(t,this.processClassesFromGridOptions(e.rowNode)),ke(t,this.preProcessRowClassRules(e.rowNode)),t.push(e.printLayout?"ag-row-position-relative":"ag-row-position-absolute"),e.firstRowOnPage&&t.push("ag-row-first"),e.lastRowOnPage&&t.push("ag-row-last"),e.fullWidthRow&&("left"===e.pinned&&t.push("ag-cell-last-left-pinned"),"right"===e.pinned&&t.push("ag-cell-first-right-pinned")),t}processClassesFromGridOptions(e){const t=[],i=e=>{"string"===typeof e?t.push(e):Array.isArray(e)&&e.forEach((e=>t.push(e)))},r=this.gos.get("rowClass");if(r){if("function"===typeof r)return v("rowClass should not be a function, please use getRowClass instead"),[];i(r)}const n=this.gos.getCallback("getRowClass");if(n){i(n({data:e.data,node:e,rowIndex:e.rowIndex}))}return t}preProcessRowClassRules(e){const t=[];return this.processRowClassRules(e,(e=>{t.push(e)}),(()=>{})),t}processRowClassRules(e,t,i){const r=this.gos.addGridCommonParams({data:e.data,node:e,rowIndex:e.rowIndex});this.stylingService.processClassRules(void 0,this.gos.get("rowClassRules"),r,t,i)}calculateRowLevel(e){return e.group?e.level:e.parent?e.parent.level+1:0}},Sc=class extends He{constructor(){super(...arguments),this.beanName="rowContainerHeightService",this.scrollY=0,this.uiBodyHeight=0}wireBeans(e){this.ctrlsService=e.ctrlsService}postConstruct(){this.addManagedEventListeners({bodyHeightChanged:this.updateOffset.bind(this)}),this.maxDivHeight=function(){if(void 0!==ii)return ii;if(!document.body)return-1;let e=1e6;const t=Ti()?6e6:1e9,i=document.createElement("div");for(document.body.appendChild(i);;){const r=2*e;if(i.style.height=r+"px",r>t||i.clientHeight!==r)break;e=r}return document.body.removeChild(i),ii=e,e}(),this.gos.get("debug")&&m("RowContainerHeightService - maxDivHeight = "+this.maxDivHeight)}isStretching(){return this.stretching}getDivStretchOffset(){return this.divStretchOffset}updateOffset(){if(!this.stretching)return;const e=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition().top,t=this.getUiBodyHeight();(e!==this.scrollY||t!==this.uiBodyHeight)&&(this.scrollY=e,this.uiBodyHeight=t,this.calculateOffset())}calculateOffset(){this.setUiContainerHeight(this.maxDivHeight),this.pixelsToShave=this.modelHeight-this.uiContainerHeight,this.maxScrollY=this.uiContainerHeight-this.uiBodyHeight;const e=this.scrollY/this.maxScrollY,t=e*this.pixelsToShave;this.gos.get("debug")&&m("RowContainerHeightService - Div Stretch Offset = ".concat(t," (").concat(this.pixelsToShave," * ").concat(e,")")),this.setDivStretchOffset(t)}setUiContainerHeight(e){e!==this.uiContainerHeight&&(this.uiContainerHeight=e,this.eventService.dispatchEvent({type:"rowContainerHeightChanged"}))}clearOffset(){this.setUiContainerHeight(this.modelHeight),this.pixelsToShave=0,this.setDivStretchOffset(0)}setDivStretchOffset(e){const t="number"===typeof e?Math.floor(e):null;this.divStretchOffset!==t&&(this.divStretchOffset=t,this.eventService.dispatchEvent({type:"heightScaleChanged"}))}setModelHeight(e){this.modelHeight=e,this.stretching=null!=e&&this.maxDivHeight>0&&e>this.maxDivHeight,this.stretching?this.calculateOffset():this.clearOffset()}getUiContainerHeight(){return this.uiContainerHeight}getRealPixelPosition(e){return e-this.divStretchOffset}getUiBodyHeight(){const e=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition();return e.bottom-e.top}getScrollPositionForPixel(e){if(this.pixelsToShave<=0)return e;const t=e/(this.modelHeight-this.getUiBodyHeight());return this.maxScrollY*t}},yc=class extends He{constructor(){super(...arguments),this.beanName="rowNodeSorter"}wireBeans(e){this.valueService=e.valueService,this.columnModel=e.columnModel,this.showRowGroupColsService=e.showRowGroupColsService}postConstruct(){this.isAccentedSort=this.gos.get("accentedSort"),this.primaryColumnsSortGroups=re(this.gos),this.addManagedPropertyListener("accentedSort",(e=>this.isAccentedSort=e.currentValue)),this.addManagedPropertyListener("autoGroupColumnDef",(()=>this.primaryColumnsSortGroups=re(this.gos)))}doFullSort(e,t){const i=e.map(((e,t)=>({currentPos:t,rowNode:e})));return i.sort(this.compareRowNodes.bind(this,t)),i.map((e=>e.rowNode))}compareRowNodes(e,t,i){const r=t.rowNode,n=i.rowNode;for(let o=0,s=e.length;o<s;o++){const t=e[o],i="desc"===t.sort,s=this.getValue(r,t.column),a=this.getValue(n,t.column);let l;const c=this.getComparator(t,r);l=c?c(s,a,r,n,i):O(s,a,this.isAccentedSort);if(!isNaN(l)&&0!==l)return"asc"===t.sort?l:-1*l}return t.currentPos-i.currentPos}getComparator(e,t){const i=e.column,r=i.getColDef().comparator;if(null!=r)return r;if(!i.getColDef().showRowGroup)return;const n=!t.group&&i.getColDef().field;if(!n)return;const o=this.columnModel.getColDefCol(n);return o?o.getColDef().comparator:void 0}getValue(e,t){if(!this.primaryColumnsSortGroups)return this.valueService.getValue(t,e,!1,!1);if(e.rowGroupColumn===t){var i,r;if(le(this.gos,this.columnModel.isPivotActive())){var n;const i=null===(n=e.allLeafChildren)||void 0===n?void 0:n[0];return i?this.valueService.getValue(t,i,!1,!1):void 0}const o=null===(i=this.showRowGroupColsService)||void 0===i?void 0:i.getShowRowGroupCol(t.getId());if(!o)return;return null===(r=e.groupData)||void 0===r?void 0:r[o.getId()]}return e.group&&t.getColDef().showRowGroup?void 0:this.valueService.getValue(t,e,!1,!1)}},Rc=class{constructor(e,t){this.active=!0,this.nodeIdsToColumns={},this.mapToItems={},this.keepingColumns=e,this.pathRoot={rowNode:t,children:null},this.mapToItems[t.id]=this.pathRoot}setInactive(){this.active=!1}isActive(){return this.active}depthFirstSearchChangedPath(e,t){if(e.children)for(let i=0;i<e.children.length;i++)this.depthFirstSearchChangedPath(e.children[i],t);t(e.rowNode)}depthFirstSearchEverything(e,t,i){if(e.childrenAfterGroup)for(let r=0;r<e.childrenAfterGroup.length;r++){const n=e.childrenAfterGroup[r];n.childrenAfterGroup?this.depthFirstSearchEverything(e.childrenAfterGroup[r],t,i):i&&t(n)}t(e)}forEachChangedNodeDepthFirst(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.active&&!i?this.depthFirstSearchChangedPath(this.pathRoot,e):this.depthFirstSearchEverything(this.pathRoot.rowNode,e,t)}executeFromRootNode(e){e(this.pathRoot.rowNode)}createPathItems(e){let t=e,i=0;for(;!this.mapToItems[t.id];){const e={rowNode:t,children:null};this.mapToItems[t.id]=e,i++,t=t.parent}return i}populateColumnsMap(e,t){if(!this.keepingColumns||!t)return;let i=e;for(;i;)this.nodeIdsToColumns[i.id]||(this.nodeIdsToColumns[i.id]={}),t.forEach((e=>this.nodeIdsToColumns[i.id][e.getId()]=!0)),i=i.parent}linkPathItems(e,t){let i=e;for(let r=0;r<t;r++){const e=this.mapToItems[i.id],t=this.mapToItems[i.parent.id];t.children||(t.children=[]),t.children.push(e),i=i.parent}}addParentNode(e,t){if(!e||e.isRowPinned())return;const i=this.createPathItems(e);this.linkPathItems(e,i),this.populateColumnsMap(e,t)}canSkip(e){return this.active&&!this.mapToItems[e.id]}getValueColumnsForNode(e,t){if(!this.keepingColumns)return t;const i=this.nodeIdsToColumns[e.id];return t.filter((e=>i[e.getId()]))}getNotValueColumnsForNode(e,t){if(!this.keepingColumns)return null;const i=this.nodeIdsToColumns[e.id];return t.filter((e=>!i[e.getId()]))}},Ec=class extends He{constructor(){super(...arguments),this.beanName="selectionService",this.selectedNodes=new Map,this.selectionCtx=new Va,this.rowSelectionMode=void 0}wireBeans(e){this.rowModel=e.rowModel,this.pageBoundsService=e.pageBoundsService}postConstruct(){const{gos:e,rowModel:t,onRowSelected:i}=this;this.selectionCtx.init(t),this.rowSelectionMode=ve(e),this.groupSelectsChildren=be(e),this.addManagedPropertyListeners(["groupSelectsChildren","rowSelection"],(()=>{const t=be(e),i=ve(e);t===this.groupSelectsChildren&&i===this.rowSelectionMode||(this.groupSelectsChildren=t,this.rowSelectionMode=i,this.deselectAllRowNodes({source:"api"}))})),this.addManagedEventListeners({rowSelected:i.bind(this)})}destroy(){super.destroy(),this.resetNodes(),this.selectionCtx.reset()}isMultiSelect(){return"multiRow"===this.rowSelectionMode}overrideSelectionValue(e,t){var i;if(!(e=>"checkboxSelected"===e||"rowClicked"===e||"spaceKey"===e||"uiSelectAll"===e||"uiSelectAllCurrentPage"===e||"uiSelectAllFiltered"===e)(t))return e;const r=this.selectionCtx.getRoot();return!r||null!==(i=r.isSelected())&&void 0!==i&&i}setNodesSelected(e){const{newValue:t,clearSelection:i,suppressFinishActions:r,rangeSelect:n,nodes:o,event:s,source:a}=e;if(0===o.length)return 0;if(o.length>1&&!this.isMultiSelect())return v("cannot multi select unless selection mode is 'multiRow'"),0;const l=this.groupSelectsChildren&&!0===e.groupSelectsFiltered,c=o.map((e=>e.footer?e.sibling:e));if(n){if(c.length>1)return v("cannot range select while selecting multiple rows"),0;const e=c[0],i=this.overrideSelectionValue(t,a);if(this.isMultiSelect()){if(this.selectionCtx.isInRange(e)){const t=this.selectionCtx.truncate(e);return i&&this.selectRange(t.discard,!1,a),this.selectRange(t.keep,i,a)}if(this.selectionCtx.getRoot()!==e){const t=this.selectionCtx.extend(e,this.groupSelectsChildren);return i&&this.selectRange(t.discard,!1,a),this.selectRange(t.keep,i,a)}}else;}r||this.selectionCtx.setRoot(c[0]);let u=0;for(let h=0;h<c.length;h++){var d;const e=c[h];if(!(l&&e.group)){e.selectThisNode(t,s,a)&&u++}this.groupSelectsChildren&&null!==(d=e.childrenAfterGroup)&&void 0!==d&&d.length&&(u+=this.selectChildren(e,t,l,a))}if(!r){t&&(i||!this.isMultiSelect())&&(u+=this.clearOtherNodes(c[0],a)),u>0&&(this.updateGroupsFromChildrenSelections(a),this.dispatchSelectionChanged(a))}return u}selectRange(e,t,i){let r=0;return e.forEach((e=>{if(e.group&&this.groupSelectsChildren)return;e.selectThisNode(t,void 0,i)&&r++})),r>0&&(this.updateGroupsFromChildrenSelections(i),this.dispatchSelectionChanged(i)),r}selectChildren(e,t,i,r){const n=i?e.childrenAfterAggFilter:e.childrenAfterGroup;return P(n)?0:this.setNodesSelected({newValue:t,clearSelection:!1,suppressFinishActions:!0,groupSelectsFiltered:i,source:r,nodes:n})}getSelectedNodes(){const e=[];return this.selectedNodes.forEach((t=>{t&&e.push(t)})),e}getSelectedRows(){const e=[];return this.selectedNodes.forEach((t=>{t&&t.data&&e.push(t.data)})),e}getSelectionCount(){return this.selectedNodes.size}filterFromSelection(e){const t=new Map;this.selectedNodes.forEach(((i,r)=>{i&&e(i)&&t.set(r,i)})),this.selectedNodes=t}updateGroupsFromChildrenSelections(e,t){if(!this.groupSelectsChildren)return!1;if(!G(this.gos))return!1;const i=this.rowModel.getRootNode();t||(t=new Rc(!0,i)).setInactive();let r=!1;return t.forEachChangedNodeDepthFirst((t=>{if(t!==i){const i=t.calculateSelectedFromChildren();r=t.selectThisNode(null!==i&&i,void 0,e)||r}})),r}clearOtherNodes(e,t){const i=new Map;let r=0;return this.selectedNodes.forEach((n=>{if(n&&n.id!==e.id){const e=this.selectedNodes.get(n.id);r+=e.setSelectedParams({newValue:!1,clearSelection:!1,suppressFinishActions:!0,source:t}),this.groupSelectsChildren&&n.parent&&i.set(n.parent.id,n.parent)}})),i.forEach((e=>{const i=e.calculateSelectedFromChildren();e.selectThisNode(null!==i&&i,void 0,t)})),r}onRowSelected(e){const t=e.node;this.groupSelectsChildren&&t.group||(t.isSelected()?this.selectedNodes.set(t.id,t):this.selectedNodes.delete(t.id))}syncInRowNode(e,t){this.syncInOldRowNode(e,t),this.syncInNewRowNode(e)}syncInOldRowNode(e,t){if(F(t)&&e.id!==t.id&&t){const i=t.id;this.selectedNodes.get(i)==e&&this.selectedNodes.set(t.id,t)}}syncInNewRowNode(e){this.selectedNodes.has(e.id)?(e.setSelectedInitialValue(!0),this.selectedNodes.set(e.id,e)):e.setSelectedInitialValue(!1)}reset(e){const t=this.getSelectionCount();this.resetNodes(),t&&this.dispatchSelectionChanged(e)}resetNodes(){var e;null===(e=this.selectedNodes)||void 0===e||e.clear()}getBestCostNodeSelection(){if(!G(this.gos))return;const e=this.rowModel.getTopLevelNodes();if(null===e)return;const t=[];return function e(i){for(let r=0,n=i.length;r<n;r++){const n=i[r];if(n.isSelected())t.push(n);else{const t=n;t.group&&t.children&&e(t.children)}}}(e),t}isEmpty(){let e=0;return this.selectedNodes.forEach((t=>{t&&e++})),0===e}deselectAllRowNodes(e){const t=e=>e.selectThisNode(!1,void 0,r),i=G(this.gos),{source:r,justFiltered:n,justCurrentPage:o}=e;if(o||n){if(!i)return void C("selecting just filtered only works when gridOptions.rowModelType='clientSide'");this.getNodesToSelect(n,o).forEach(t)}else this.selectedNodes.forEach((e=>{e&&t(e)})),this.reset(r);this.selectionCtx.reset(),i&&this.groupSelectsChildren&&this.updateGroupsFromChildrenSelections(r),this.dispatchSelectionChanged(r)}getSelectedCounts(e,t){let i=0,r=0;return this.getNodesToSelect(e,t).forEach((e=>{this.groupSelectsChildren&&e.group||(e.isSelected()?i++:e.selectable&&r++)})),{selectedCount:i,notSelectedCount:r}}getSelectAllState(e,t){const{selectedCount:i,notSelectedCount:r}=this.getSelectedCounts(e,t);return(0!==i||0!==r)&&(i>0&&r>0?null:i>0)}hasNodesToSelect(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getNodesToSelect(e,t).filter((e=>e.selectable)).length>0}getNodesToSelect(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.validateSelectAllType();const i=[];if(t)return this.forEachNodeOnPage((e=>{if(e.group)if(e.expanded)this.groupSelectsChildren||i.push(e);else{const t=e=>{var r;i.push(e),null!==(r=e.childrenAfterFilter)&&void 0!==r&&r.length&&e.childrenAfterFilter.forEach(t)};t(e)}else i.push(e)})),i;const r=this.rowModel;return e?(r.forEachNodeAfterFilter((e=>{i.push(e)})),i):(r.forEachNode((e=>{i.push(e)})),i)}forEachNodeOnPage(e){const t=this.pageBoundsService.getFirstRow(),i=this.pageBoundsService.getLastRow();for(let r=t;r<=i;r++){const t=this.rowModel.getRow(r);t&&e(t)}}selectAllRowNodes(e){var t,i;if("string"!==typeof this.gos.get("rowSelection")&&!Ce(this.gos))return v("cannot multi select unless selection mode is 'multiRow'");this.validateSelectAllType();const{source:r,justFiltered:n,justCurrentPage:o}=e,s=this.getNodesToSelect(n,o);s.forEach((e=>e.selectThisNode(!0,void 0,r))),this.selectionCtx.setRoot(null!==(t=s[0])&&void 0!==t?t:null),this.selectionCtx.setEndRange(null!==(i=ye(s))&&void 0!==i?i:null),G(this.gos)&&this.groupSelectsChildren&&this.updateGroupsFromChildrenSelections(r),this.dispatchSelectionChanged(r)}getSelectionState(){const e=[];return this.selectedNodes.forEach((t=>{null!==t&&void 0!==t&&t.id&&e.push(t.id)})),e.length?e:null}setSelectionState(e,t){if(!Array.isArray(e))return C("Invalid selection state. When using client-side row model, the state must conform to `string[]`.");const i=new Set(e),r=[];this.rowModel.forEachNode((e=>{i.has(e.id)&&r.push(e)})),this.setNodesSelected({newValue:!0,nodes:r,source:t})}dispatchSelectionChanged(e){this.eventService.dispatchEvent({type:"selectionChanged",source:e})}validateSelectAllType(){if(!G(this.gos))throw new Error("selectAll only available when rowModelType='clientSide', ie not ".concat(this.rowModel.getType()))}},xc=class extends He{constructor(){super(...arguments),this.beanName="selectableService"}wireBeans(e){this.rowModel=e.rowModel,this.selectionService=e.selectionService}postConstruct(){this.addManagedPropertyListeners(["isRowSelectable","rowSelection"],(()=>this.updateSelectable()))}updateSelectableAfterGrouping(){this.updateSelectable(!0)}updateSelectable(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{gos:t}=this,i=V(t),r=me(t);if(!i||!r)return;const n=be(t),o=G(t)&&n,s=[],a=t=>{var i;if(e&&!t.group)return;if(o&&t.group){const e=t.childrenAfterGroup.some((e=>!0===e.selectable));return void t.setRowSelectable(e,!0)}const n=null===(i=null===r||void 0===r?void 0:r(t))||void 0===i||i;t.setRowSelectable(n,!0),!n&&t.isSelected()&&s.push(t)};if(o){const e=this.rowModel;new Rc(!1,e.getRootNode()).forEachChangedNodeDepthFirst(a,!0,!0)}else this.rowModel.forEachNode(a);s.length&&this.selectionService.setNodesSelected({nodes:s,newValue:!1,source:"selectableChanged"}),o&&this.selectionService instanceof Ec&&this.selectionService.updateGroupsFromChildrenSelections("selectableChanged")}},Tc=["asc","desc",null],Fc=class extends He{constructor(){super(...arguments),this.beanName="sortController"}wireBeans(e){this.columnModel=e.columnModel,this.funcColsService=e.funcColsService,this.showRowGroupColsService=e.showRowGroupColsService}progressSort(e,t,i){const r=this.getNextSortDirection(e);this.setSortForColumn(e,r,t,i)}setSortForColumn(e,t,i,r){"asc"!==t&&"desc"!==t&&(t=null);let n=[e];if(re(this.gos)&&e.getColDef().showRowGroup){const t=this.funcColsService.getSourceColumnsForGroupColumn(e),i=null===t||void 0===t?void 0:t.filter((e=>e.isSortable()));i&&(n=[e,...i])}n.forEach((e=>e.setSort(t,r)));const o=[];if(!((i||this.gos.get("alwaysMultiSort"))&&!this.gos.get("suppressMultiSort"))){const e=this.clearSortBarTheseColumns(n,r);o.push(...e)}this.updateSortIndex(e),o.push(...n),this.dispatchSortChangedEvents(r,o)}updateSortIndex(e){var t;const i=re(this.gos),r=null===(t=this.showRowGroupColsService)||void 0===t?void 0:t.getShowRowGroupCol(e.getId()),n=i&&r||e,o=this.getColumnsWithSortingOrdered();this.columnModel.getAllCols().forEach((e=>e.setSortIndex(null)));const s=o.filter((e=>(!i||!e.getColDef().showRowGroup)&&e!==n));(n.getSort()?[...s,n]:s).forEach(((e,t)=>{e.setSortIndex(t)}))}onSortChanged(e,t){this.dispatchSortChangedEvents(e,t)}isSortActive(){const e=this.columnModel.getAllCols().filter((e=>!!e.getSort()));return e&&e.length>0}dispatchSortChangedEvents(e,t){const i={type:"sortChanged",source:e};t&&(i.columns=t),this.eventService.dispatchEvent(i)}clearSortBarTheseColumns(e,t){const i=[];return this.columnModel.getAllCols().forEach((r=>{e.includes(r)||(r.getSort()&&i.push(r),r.setSort(void 0,t))})),i}getNextSortDirection(e){let t;if(t=e.getColDef().sortingOrder?e.getColDef().sortingOrder:this.gos.get("sortingOrder")?this.gos.get("sortingOrder"):Tc,!Array.isArray(t)||t.length<=0)return v("sortingOrder must be an array with at least one element, currently it's ".concat(t)),null;const i=t.indexOf(e.getSort()),r=i<0,n=i==t.length-1;let o;return o=r||n?t[0]:t[i+1],Tc.indexOf(o)<0?(v("invalid sort type ",o),null):o}getIndexedSortMap(){let e=this.columnModel.getAllCols().filter((e=>!!e.getSort()));if(this.columnModel.isPivotMode()){const t=re(this.gos);e=e.filter((e=>{var i;const r=!!e.getAggFunc(),n=!e.isPrimary(),o=t?null===(i=this.showRowGroupColsService)||void 0===i?void 0:i.getShowRowGroupCol(e.getId()):e.getColDef().showRowGroup;return r||n||o}))}const t=this.funcColsService.getRowGroupColumns().filter((e=>!!e.getSort())),i={};e.forEach(((e,t)=>i[e.getId()]=t)),e.sort(((e,t)=>{const r=e.getSortIndex(),n=t.getSortIndex();if(null!=r&&null!=n)return r-n;if(null==r&&null==n){return i[e.getId()]>i[t.getId()]?1:-1}return null==n?-1:1}));const r=re(this.gos)&&!!t.length;r&&(e=[...new Set(e.map((e=>{var t,i;return null!==(t=null===(i=this.showRowGroupColsService)||void 0===i?void 0:i.getShowRowGroupCol(e.getId()))&&void 0!==t?t:e})))]);const n=new Map;return e.forEach(((e,t)=>n.set(e,t))),r&&t.forEach((e=>{const t=this.showRowGroupColsService.getShowRowGroupCol(e.getId());n.set(e,n.get(t))})),n}getColumnsWithSortingOrdered(){return[...this.getIndexedSortMap().entries()].sort(((e,t)=>{let[i,r]=e,[n,o]=t;return r-o})).map((e=>{let[t]=e;return t}))}getSortModel(){return this.getColumnsWithSortingOrdered().filter((e=>e.getSort())).map((e=>({sort:e.getSort(),colId:e.getId()})))}getSortOptions(){return this.getColumnsWithSortingOrdered().filter((e=>e.getSort())).map((e=>({sort:e.getSort(),column:e})))}canColumnDisplayMixedSort(e){const t=re(this.gos),i=!!e.getColDef().showRowGroup;return t&&i}getDisplaySortForColumn(e){const t=this.funcColsService.getSourceColumnsForGroupColumn(e);if(!this.canColumnDisplayMixedSort(e)||null===t||void 0===t||!t.length)return e.getSort();const i=null!=e.getColDef().field||!!e.getColDef().valueGetter?[e,...t]:t,r=i[0].getSort();return i.every((e=>e.getSort()==r))?r:"mixed"}getDisplaySortIndexForColumn(e){return this.getIndexedSortMap().get(e)}},Pc=class extends He{constructor(){super(...arguments),this.beanName="syncService",this.waitingForColumns=!1}wireBeans(e){this.ctrlsService=e.ctrlsService,this.columnModel=e.columnModel,this.rowModel=e.rowModel}postConstruct(){this.addManagedPropertyListener("columnDefs",(e=>this.setColumnDefs(e)))}start(){this.ctrlsService.whenReady(this,(()=>{const e=this.gos.get("columnDefs");e?this.setColumnsAndData(e):this.waitingForColumns=!0,this.gridReady()}))}setColumnsAndData(e){this.columnModel.setColumnDefs(null!==e&&void 0!==e?e:[],"gridInitializing"),this.rowModel.start()}gridReady(){this.eventService.dispatchEvent({type:"gridReady"});const e=this.gos.isModuleRegistered("@ag-grid-enterprise/core");this.gos.get("debug")&&m("initialised successfully, enterprise = ".concat(e))}setColumnDefs(e){const t=this.gos.get("columnDefs");if(t)return this.waitingForColumns?(this.waitingForColumns=!1,void this.setColumnsAndData(t)):void this.columnModel.setColumnDefs(t,mt(e.source))}},Dc=class extends He{constructor(){super(...arguments),this.beanName="changeDetectionService"}wireBeans(e){this.rowModel=e.rowModel,this.rowRenderer=e.rowRenderer}postConstruct(){G(this.gos)&&(this.clientSideRowModel=this.rowModel),this.addManagedEventListeners({cellValueChanged:this.onCellValueChanged.bind(this)})}onCellValueChanged(e){"paste"!==e.source&&this.doChangeDetection(e.node,e.column)}doChangeDetection(e,t){if(this.gos.get("suppressChangeDetection"))return;const i=[e];if(this.clientSideRowModel&&!e.isRowPinned()){const r=this.gos.get("aggregateOnlyChangedColumns"),n=new Rc(r,this.clientSideRowModel.getRootNode());n.addParentNode(e.parent,[t]),this.clientSideRowModel.doAggregate(n),n.forEachChangedNodeDepthFirst((e=>{i.push(e)}))}this.rowRenderer.refreshCells({rowNodes:i})}},kc=class extends He{constructor(){super(...arguments),this.beanName="expressionService",this.expressionToFunctionCache={}}evaluate(e,t){if("string"===typeof e)return this.evaluateExpression(e,t);C("value should be either a string or a function",e)}evaluateExpression(e,t){try{const i=this.createExpressionFunction(e);return i(t.value,t.context,t.oldValue,t.newValue,t.value,t.node,t.data,t.colDef,t.rowIndex,t.api,t.getValue,t.column,t.columnGroup)}catch(i){return m("Processing of the expression failed"),m("Expression = ",e),m("Params = ",t),m("Exception = ",i),null}}createExpressionFunction(e){if(this.expressionToFunctionCache[e])return this.expressionToFunctionCache[e];const t=this.createFunctionBody(e),i=new Function("x, ctx, oldValue, newValue, value, node, data, colDef, rowIndex, api, getValue, column, columnGroup",t);return this.expressionToFunctionCache[e]=i,i}createFunctionBody(e){return e.indexOf("return")>=0?e:"return "+e+";"}},Ac=class extends He{constructor(){super(...arguments),this.beanName="valueCache",this.cacheVersion=0}postConstruct(){this.active=this.gos.get("valueCache"),this.neverExpires=this.gos.get("valueCacheNeverExpires")}onDataChanged(){this.neverExpires||this.expire()}expire(){this.cacheVersion++}setValue(e,t,i){this.active&&(e.__cacheVersion!==this.cacheVersion&&(e.__cacheVersion=this.cacheVersion,e.__cacheData={}),e.__cacheData[t]=i)}getValue(e,t){if(this.active&&e.__cacheVersion===this.cacheVersion)return e.__cacheData[t]}},Mc=class extends He{constructor(){super(...arguments),this.beanName="valueService",this.initialised=!1,this.isSsrm=!1}wireBeans(e){this.expressionService=e.expressionService,this.columnModel=e.columnModel,this.valueCache=e.valueCache,this.dataTypeService=e.dataTypeService}postConstruct(){this.initialised||this.init()}init(){this.isSsrm=H(this.gos),this.cellExpressions=this.gos.get("enableCellExpressions"),this.isTreeData=this.gos.get("treeData"),this.initialised=!0;const e=e=>this.callColumnCellValueChangedHandler(e),t=_(this.gos);this.eventService.addEventListener("cellValueChanged",e,t),this.addDestroyFunc((()=>this.eventService.removeEventListener("cellValueChanged",e,t))),this.addManagedPropertyListener("treeData",(e=>this.isTreeData=e.currentValue))}getValueForDisplay(e,t){var i;const r=t.leafGroup&&this.columnModel.isPivotMode(),n=t.group&&t.expanded&&!t.footer&&!r,o=this.gos.get("groupSuppressBlankHeader");if(!n||o)return this.getValue(e,t);let s=!1;const a=null!==(i=this.gos.get("groupTotalRow"))&&void 0!==i?i:this.gos.get("groupIncludeFooter");if("function"!==typeof a)s=!!a;else{var l;s=!!(null!==(l=this.gos.getCallback("groupTotalRow"))&&void 0!==l?l:this.gos.getCallback("groupIncludeFooter"))({node:this})}const c=n&&s;return this.getValue(e,t,!1,c)}getValue(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.initialised||this.init(),!t)return;const n=e.getColDef(),o=n.field,s=e.getColId(),a=t.data;let l;const c=t.groupData&&void 0!==t.groupData[s],u=!r&&t.aggData&&void 0!==t.aggData[s],d=this.isSsrm&&r&&!!e.getColDef().aggFunc,h=this.isSsrm&&t.footer&&t.field&&(!0===e.getColDef().showRowGroup||e.getColDef().showRowGroup===t.field);if(i&&n.filterValueGetter?l=this.executeFilterValueGetter(n.filterValueGetter,a,e,t):this.isTreeData&&u?l=t.aggData[s]:this.isTreeData&&n.valueGetter?l=this.executeValueGetter(n.valueGetter,a,e,t):this.isTreeData&&o&&a?l=nt(a,o,e.isFieldContainsDots()):c?l=t.groupData[s]:u?l=t.aggData[s]:n.valueGetter?l=this.executeValueGetter(n.valueGetter,a,e,t):h?l=nt(a,t.field,e.isFieldContainsDots()):o&&a&&!d&&(l=nt(a,o,e.isFieldContainsDots())),this.cellExpressions&&"string"===typeof l&&0===l.indexOf("=")){const i=l.substring(1);l=this.executeValueGetter(i,a,e,t)}if(null==l){const i=this.getOpenedGroup(t,e);if(null!=i)return i}return l}parseValue(e,t,i,r){const n=e.getColDef(),o=n.valueParser;if(F(o)){const s=this.gos.addGridCommonParams({node:t,data:null===t||void 0===t?void 0:t.data,oldValue:r,newValue:i,colDef:n,column:e});return"function"===typeof o?o(s):this.expressionService.evaluate(o,s)}return i}getDeleteValue(e,t){var i;return F(e.getColDef().valueParser)&&null!==(i=this.parseValue(e,t,"",this.getValueForDisplay(e,t)))&&void 0!==i?i:null}formatValue(e,t,i,r){let n,o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=null;const a=e.getColDef();if(r?n=r:o&&(n=a.valueFormatter),n){const r=this.gos.addGridCommonParams({value:i,node:t,data:t?t.data:null,colDef:a,column:e});s="function"===typeof n?n(r):this.expressionService.evaluate(n,r)}else if(a.refData)return a.refData[i]||"";return null==s&&Array.isArray(i)&&(s=i.join(", ")),s}getOpenedGroup(e,t){if(!this.gos.get("showOpenedGroup"))return;if(!t.getColDef().showRowGroup)return;const i=t.getColDef().showRowGroup;let r=e.parent;for(;null!=r;){if(r.rowGroupColumn&&(!0===i||i===r.rowGroupColumn.getColId()))return r.key;r=r.parent}}setValue(e,t,i,r){const n=this.columnModel.getColDefCol(t);if(!e||!n)return!1;P(e.data)&&(e.data={});const{field:o,valueSetter:s}=n.getColDef();if(P(o)&&P(s))return v("you need either field or valueSetter set on colDef for editing to work"),!1;if(this.dataTypeService&&!this.dataTypeService.checkType(n,i))return v("Data type of the new value does not match the cell data type of the column"),!1;const a=this.gos.addGridCommonParams({node:e,data:e.data,oldValue:this.getValue(n,e),newValue:i,colDef:n.getColDef(),column:n});let l;if(a.newValue=i,l=F(s)?"function"===typeof s?s(a):this.expressionService.evaluate(s,a):this.setValueUsingField(e.data,o,i,n.isFieldContainsDots()),void 0===l&&(l=!0),!l)return!1;e.resetQuickFilterAggregateText(),this.valueCache.onDataChanged();const c=this.getValue(n,e);return this.eventService.dispatchEvent({type:"cellValueChanged",event:null,rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:a.column,colDef:a.colDef,data:e.data,node:e,oldValue:a.oldValue,newValue:c,value:c,source:r}),!0}callColumnCellValueChangedHandler(e){const t=e.colDef.onCellValueChanged;"function"===typeof t&&this.getFrameworkOverrides().wrapOutgoing((()=>{t({node:e.node,data:e.data,oldValue:e.oldValue,newValue:e.newValue,colDef:e.colDef,column:e.column,api:e.api,context:e.context})}))}setValueUsingField(e,t,i,r){if(!t)return!1;let n=!1;if(r){const r=t.split(".");let o=e;for(;r.length>0&&o;){const e=r.shift();0===r.length?(n=o[e]===i,n||(o[e]=i)):o=o[e]}}else n=e[t]===i,n||(e[t]=i);return!n}executeFilterValueGetter(e,t,i,r){const n=this.gos.addGridCommonParams({data:t,node:r,column:i,colDef:i.getColDef(),getValue:this.getValueCallback.bind(this,r)});return"function"===typeof e?e(n):this.expressionService.evaluate(e,n)}executeValueGetter(e,t,i,r){const n=i.getColId(),o=this.valueCache.getValue(r,n);if(void 0!==o)return o;const s=this.gos.addGridCommonParams({data:t,node:r,column:i,colDef:i.getColDef(),getValue:this.getValueCallback.bind(this,r)});let a;return a="function"===typeof e?e(s):this.expressionService.evaluate(e,s),this.valueCache.setValue(r,n,a),a}getValueCallback(e,t){const i=this.columnModel.getColDefCol(t);return i?this.getValue(i,e):null}getKeyForNode(e,t){const i=this.getValue(e,t),r=e.getColDef().keyCreator;let n=i;if(r){n=r(this.gos.addGridCommonParams({value:i,colDef:e.getColDef(),column:e,node:t,data:t.data}))}return"string"===typeof n||null==n||(n=String(n),"[object Object]"===n&&v("a column you are grouping or pivoting by has objects as values. If you want to group by complex objects then either a) use a colDef.keyCreator (se AG Grid docs) or b) to toString() on the object to return a key")),n}},Ic=class e{static applyGlobalGridOptions(t){if(!e.gridOptions)return t;let i={};return rt(i,e.gridOptions,!0,!0),"deep"===e.mergeStrategy?rt(i,t,!0,!0):i=c(c({},i),t),e.gridOptions.context&&(i.context=e.gridOptions.context),t.context&&("deep"===e.mergeStrategy&&i.context&&rt(t.context,i.context,!0,!0),i.context=t.context),i}};Ic.gridOptions=void 0,Ic.mergeStrategy="shallow";var Lc=Ic;function Oc(e){var t;return null===(t=Lc.gridOptions)||void 0===t?void 0:t[e]}var Nc=1,Bc=class{create(e,t,i,r,n){var o;const s=function(e){const t={};return Object.entries(e).forEach((e=>{let[i,r]=e;const n=lc(i,r);t[i]=n})),t}(Lc.applyGlobalGridOptions(t)),a=null!==(o=s.gridId)&&void 0!==o?o:String(Nc++),l=this.getRegisteredModules(n,a),c=this.createBeansList(s.rowModelType,l,a),u=this.createProvidedBeans(e,s,n);if(!c)return void C("Failed to create grid.");const d=new vn({providedBeanInstances:u,beanClasses:c,gridId:a,beanInitComparator:gl,beanDestroyComparator:pl,derivedBeans:[nl]});return this.registerModuleUserComponents(d,l),this.registerControllers(d,l),this.registerModuleApiFunctions(d,l),i(d),d.getBean("syncService").start(),r&&r(d),d.getBean("gridApi")}registerControllers(e,t){const i=e.getBean("ctrlsFactory");t.forEach((e=>{e.controllers&&e.controllers.forEach((e=>i.register(e)))}))}getRegisteredModules(e,t){const i=e?e.modules:null,r=fn.__getRegisteredModules(t),n=[],o={},s=(e,t,i)=>{var r;o[(r=t).moduleName]||(o[r.moduleName]=!0,n.push(r),fn.__register(r,e,i)),t.dependantModules&&t.dependantModules.forEach((t=>s(e,t,i)))};return s(!(null===i||void 0===i||!i.length)||!fn.__isPackageBased(),nc,void 0),i&&i.forEach((e=>s(!0,e,t))),r&&r.forEach((e=>s(!fn.__isPackageBased(),e,void 0))),n}registerModuleUserComponents(e,t){const i=this.extractModuleEntity(t,(e=>e.userComponents?e.userComponents:[])),r=e.getBean("userComponentRegistry");i.forEach((e=>{let{name:t,classImp:i,params:n}=e;r.registerDefaultComponent(t,i,n)}))}registerModuleApiFunctions(e,t){const i=e.getBean("apiFunctionService");t.forEach((e=>{const t=e.apiFunctions;if(t){Object.keys(t).forEach((e=>{null===i||void 0===i||i.addFunction(e,t[e])}))}}))}createProvidedBeans(e,t,i){let r=i?i.frameworkOverrides:null;P(r)&&(r=new $a);const n={gridOptions:t,eGridDiv:e,globalEventListener:i?i.globalEventListener:null,globalSyncEventListener:i?i.globalSyncEventListener:null,frameworkOverrides:r};return i&&i.providedBeanInstances&&Object.assign(n,i.providedBeanInstances),n}createBeansList(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"clientSide",t=arguments.length>2?arguments[2]:void 0;const i=(arguments.length>1?arguments[1]:void 0).filter((t=>!t.rowModel||t.rowModel===e)),r={clientSide:"@ag-grid-community/client-side-row-model",infinite:"@ag-grid-community/infinite-row-model",serverSide:"@ag-grid-enterprise/server-side-row-model",viewport:"@ag-grid-enterprise/viewport-row-model"};if(!r[e])return void C("Could not find row model for rowModelType = ",e);if(!fn.__assertRegistered(r[e],"rowModelType = '".concat(e,"'"),t))return;const n=[wl,vl,dc,oc,rl,_r,ul,dl,da,hn,Sc,ca,hc,Ba,yn,Nt,Tl,uc,qa,Ec,ft,Ko,fc,pc,Oa,kc,gt,la,Ac,Mc,Ia,ua,wn,Pl,aa,Rl,Xa,_a,na,Fc,Cc,vc,xc,Dc,ha,ol,bc,yc,ml,Dl,Cl,fl,Pc,wc,ga,gc,mc,pa,yt,sl,Et,bt,al,ll,At,St,Dt,cl,kt,We],o=this.extractModuleEntity(i,(e=>e.beans?e.beans:[]));n.push(...o);const s=[];return n.forEach((e=>{s.indexOf(e)<0&&s.push(e)})),s}extractModuleEntity(e,t){return[].concat(...e.map(t))}},Gc=class extends He{constructor(){super(...arguments),this.beanName="rowModelHelperService"}wireBeans(e){this.rowModel=e.rowModel}postConstruct(){const e=this.rowModel;switch(e.getType()){case"clientSide":this.clientSideRowModel=e;break;case"infinite":this.infiniteRowModel=e;break;case"serverSide":this.serverSideRowModel=e}}getClientSideRowModel(){return this.clientSideRowModel}getInfiniteRowModel(){return this.infiniteRowModel}getServerSideRowModel(){return this.serverSideRowModel}};var Hc={version:Do,moduleName:"@ag-grid-community/csrm-ssrm-shared-api",apiFunctions:{expandAll:function(e){e.expansionService.expandAll(!0)},collapseAll:function(e){e.expansionService.expandAll(!1)},onRowHeightChanged:function(e){var t,i;const r=null===(t=e.rowModelHelperService)||void 0===t?void 0:t.getClientSideRowModel(),n=null===(i=e.rowModelHelperService)||void 0===i?void 0:i.getServerSideRowModel();r?r.onRowHeightChanged():n&&n.onRowHeightChanged()}}},zc={version:Do,moduleName:"@ag-grid-community/ssrm-infinite-shared-api",apiFunctions:{setRowCount:function(e,t,i){var r,n;const o=null===(r=e.rowModelHelperService)||void 0===r?void 0:r.getServerSideRowModel();if(o)return e.funcColsService.isRowGroupEmpty()?void o.setRowCount(t,i):void C("setRowCount cannot be used while using row grouping.");const s=null===(n=e.rowModelHelperService)||void 0===n?void 0:n.getInfiniteRowModel();s&&s.setRowCount(t,i)},getCacheBlockState:function(e){var t,i;return null!==(t=null===(i=e.rowNodeBlockLoader)||void 0===i?void 0:i.getBlockState())&&void 0!==t?t:{}},isLastRowIndexKnown:function(e){return e.rowModel.isLastRowIndexKnown()}}},Vc=class{wrap(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3?arguments[3]:void 0;const n=this.createWrapper(e,r);return t.forEach((e=>{this.createMethod(n,e,!0)})),i.forEach((e=>{this.createMethod(n,e,!1)})),n}createMethod(e,t,i){e.addMethod(t,this.createMethodProxy(e,t,i))}createMethodProxy(e,t,i){return function(){return e.hasMethod(t)?e.callMethod(t,arguments):(i&&v("Framework component is missing the method "+t+"()"),null)}}},_c=class{};_c.CHART_TYPE_TO_SERIES_TYPE={column:"bar",groupedColumn:"bar",stackedColumn:"bar",normalizedColumn:"bar",bar:"bar",groupedBar:"bar",stackedBar:"bar",normalizedBar:"bar",line:"line",scatter:"scatter",bubble:"bubble",pie:"pie",donut:"donut",doughnut:"donut",area:"area",stackedArea:"area",normalizedArea:"area",histogram:"histogram",radarLine:"radar-line",radarArea:"radar-area",nightingale:"nightingale",radialColumn:"radial-column",radialBar:"radial-bar",sunburst:"sunburst",rangeBar:"range-bar",rangeArea:"range-area",boxPlot:"box-plot",treemap:"treemap",heatmap:"heatmap",waterfall:"waterfall"},_c.COMBO_CHART_TYPES=["columnLineCombo","areaColumnCombo","customCombo"],_c.SERIES_GROUP_TYPES=["grouped","stacked","normalized"];var Wc="undefined"===typeof global?{}:global;Wc.HTMLElement="undefined"===typeof HTMLElement?{}:HTMLElement,Wc.HTMLButtonElement="undefined"===typeof HTMLButtonElement?{}:HTMLButtonElement,Wc.HTMLSelectElement="undefined"===typeof HTMLSelectElement?{}:HTMLSelectElement,Wc.HTMLInputElement="undefined"===typeof HTMLInputElement?{}:HTMLInputElement,Wc.Node="undefined"===typeof Node?{}:Node,Wc.MouseEvent="undefined"===typeof MouseEvent?{}:MouseEvent;var Uc=class{constructor(e,t,i,r,n,o){this.nextId=0,this.rowCountReady=!1,this.allNodesMap={},this.rootNode=e,this.gos=t,this.eventService=i,this.funcColsService=r,this.beans=o,this.selectionService=n,this.rootNode.group=!0,this.rootNode.level=-1,this.rootNode.id="ROOT_NODE_ID",this.rootNode.allLeafChildren=[],this.rootNode.childrenAfterGroup=[],this.rootNode.childrenAfterSort=[],this.rootNode.childrenAfterAggFilter=[],this.rootNode.childrenAfterFilter=[]}getCopyOfNodesMap(){return et(this.allNodesMap)}getRowNode(e){return this.allNodesMap[e]}setRowData(e){if("string"===typeof e)return void v("rowData must be an array.");this.rowCountReady=!0,this.dispatchRowDataUpdateStartedEvent(e);const t=this.rootNode,i=this.rootNode.sibling;t.childrenAfterFilter=null,t.childrenAfterGroup=null,t.childrenAfterAggFilter=null,t.childrenAfterSort=null,t.childrenMapped=null,t.updateHasChildren(),this.nextId=0,this.allNodesMap={},e?t.allLeafChildren=e.map(((e,t)=>this.createNode(e,this.rootNode,0,t))):(t.allLeafChildren=[],t.childrenAfterGroup=[]),i&&(i.childrenAfterFilter=t.childrenAfterFilter,i.childrenAfterGroup=t.childrenAfterGroup,i.childrenAfterAggFilter=t.childrenAfterAggFilter,i.childrenAfterSort=t.childrenAfterSort,i.childrenMapped=t.childrenMapped,i.allLeafChildren=t.allLeafChildren)}updateRowData(e){this.rowCountReady=!0,this.dispatchRowDataUpdateStartedEvent(e.add);const t={rowNodeTransaction:{remove:[],update:[],add:[]},rowsInserted:!1},i=[];return this.executeRemove(e,t,i),this.executeUpdate(e,t,i),this.executeAdd(e,t),this.updateSelection(i,"rowDataChanged"),t}updateRowOrderFromRowData(e){var t;const i=this.rootNode.allLeafChildren,r=null!==(t=null===i||void 0===i?void 0:i.length)&&void 0!==t?t:0,n=new Map;let o=-1,s=-1;for(let a=0;a<r;++a){const t=i[a],r=t.data;r!==e[a]&&(s<0&&(o=a),s=a,n.set(r,t))}if(o<0)return!1;for(let a=o;a<=s;++a){const t=n.get(e[a]);void 0!==t&&(i[a]=t,t.sourceRowIndex=a)}return!0}isRowCountReady(){return this.rowCountReady}dispatchRowDataUpdateStartedEvent(e){this.eventService.dispatchEvent({type:"rowDataUpdateStarted",firstRowData:null!==e&&void 0!==e&&e.length?e[0]:null})}updateSelection(e,t){const i=e.length>0;i&&this.selectionService.setNodesSelected({newValue:!1,nodes:e,suppressFinishActions:!0,source:t}),this.selectionService.updateGroupsFromChildrenSelections(t),i&&this.eventService.dispatchEvent({type:"selectionChanged",source:t})}executeAdd(e,t){const i=e.add;if(D(i))return;const r=this.rootNode.allLeafChildren;let n=r.length;if("number"===typeof e.addIndex&&(n=this.sanitizeAddIndex(e.addIndex),n>0)){if(this.gos.get("treeData"))for(let e=0;e<r.length;e++){const t=r[e];if((null===t||void 0===t?void 0:t.rowIndex)==n-1){n=e+1;break}}}const o=i.map(((e,t)=>this.createNode(e,this.rootNode,0,n+t)));if(n<r.length){const e=r.slice(0,n),i=r.slice(n,r.length),s=e.length+o.length;for(let t=0,r=i.length;t<r;++t)i[t].sourceRowIndex=s+t;this.rootNode.allLeafChildren=[...e,...o,...i],t.rowsInserted=!0}else this.rootNode.allLeafChildren=r.concat(o);const s=this.rootNode.sibling;s&&(s.allLeafChildren=r),t.rowNodeTransaction.add=o}sanitizeAddIndex(e){var t,i;const r=null!==(t=null===(i=this.rootNode.allLeafChildren)||void 0===i?void 0:i.length)&&void 0!==t?t:0;return e<0||e>=r||Number.isNaN(e)?r:Math.ceil(e)}executeRemove(e,t,i){var r,n,o;let{rowNodeTransaction:s}=t;const{remove:a}=e;if(D(a))return;const l={};a.forEach((e=>{const t=this.lookupRowNode(e);t&&(t.isSelected()&&i.push(t),t.clearRowTopAndRowIndex(),l[t.id]=!0,delete this.allNodesMap[t.id],s.remove.push(t))})),this.rootNode.allLeafChildren=null!==(r=null===(n=this.rootNode.allLeafChildren)||void 0===n?void 0:n.filter((e=>!l[e.id])))&&void 0!==r?r:null,null===(o=this.rootNode.allLeafChildren)||void 0===o||o.forEach(((e,t)=>{e.sourceRowIndex=t}));const c=this.rootNode.sibling;c&&(c.allLeafChildren=this.rootNode.allLeafChildren)}executeUpdate(e,t,i){let{rowNodeTransaction:r}=t;const{update:n}=e;D(n)||n.forEach((e=>{const t=this.lookupRowNode(e);t&&(t.updateData(e),!t.selectable&&t.isSelected()&&i.push(t),this.setMasterForRow(t,e,0,!1),r.update.push(t))}))}lookupRowNode(e){const t=ce(this.gos);let i;if(t){const r=t({data:e,level:0});if(i=this.allNodesMap[r],!i)return C("could not find row id=".concat(r,", data item was not found for this id")),null}else{var r;if(i=null===(r=this.rootNode.allLeafChildren)||void 0===r?void 0:r.find((t=>t.data===e)),!i)return C("could not find data item as object was not found",e),C("Consider using getRowId to help the Grid find matching row data"),null}return i||null}createNode(e,t,i,r){const n=new Dn(this.beans);return n.sourceRowIndex=r,n.group=!1,this.setMasterForRow(n,e,i,!0),t&&(n.parent=t),n.level=i,n.setDataAndId(e,this.nextId.toString()),this.allNodesMap[n.id]&&v("duplicate node id '".concat(n.id,"' detected from getRowId callback, this could cause issues in your grid.")),this.allNodesMap[n.id]=n,this.nextId++,n}setMasterForRow(e,t,i,r){if(this.gos.get("treeData"))e.setMaster(!1),r&&(e.expanded=!1);else{if(this.gos.get("masterDetail")){const i=this.gos.get("isRowMaster");i?e.setMaster(i(t)):e.setMaster(!0)}else e.setMaster(!1);if(r){const t=this.funcColsService.getRowGroupColumns(),r=i+(t?t.length:0);e.expanded=!!e.master&&this.isExpanded(r)}}}isExpanded(e){const t=this.gos.get("groupDefaultExpanded");return-1===t||e<t}};var jc="32.3.3",Kc={version:jc,moduleName:"@ag-grid-community/client-side-row-model".concat("-core"),rowModel:"clientSide",beans:[class extends He{constructor(){super(...arguments),this.beanName="rowModel",this.onRowHeightChanged_debounced=E(this.onRowHeightChanged.bind(this),100),this.rowsToDisplay=[],this.hasStarted=!1,this.shouldSkipSettingDataOnStart=!1,this.isRefreshingModel=!1,this.rowCountReady=!1}wireBeans(e){this.beans=e,this.columnModel=e.columnModel,this.funcColsService=e.funcColsService,this.selectionService=e.selectionService,this.valueCache=e.valueCache,this.environment=e.environment,this.filterStage=e.filterStage,this.sortStage=e.sortStage,this.flattenStage=e.flattenStage,this.groupStage=e.groupStage,this.aggregationStage=e.aggregationStage,this.pivotStage=e.pivotStage,this.filterAggregatesStage=e.filterAggregatesStage}postConstruct(){const e=this.refreshModel.bind(this,{step:"group"}),t=!this.gos.get("suppressAnimationFrame"),i=this.refreshModel.bind(this,{step:"group",afterColumnsChanged:!0,keepRenderedRows:!0,animate:t});this.addManagedEventListeners({newColumnsLoaded:i,columnRowGroupChanged:e,columnValueChanged:this.onValueChanged.bind(this),columnPivotChanged:this.refreshModel.bind(this,{step:"pivot"}),filterChanged:this.onFilterChanged.bind(this),sortChanged:this.onSortChanged.bind(this),columnPivotModeChanged:e,gridStylesChanged:this.onGridStylesChanges.bind(this),gridReady:this.onGridReady.bind(this)}),this.addPropertyListeners(),this.rootNode=new Dn(this.beans),this.nodeManager=new Uc(this.rootNode,this.gos,this.eventService,this.funcColsService,this.selectionService,this.beans)}addPropertyListeners(){const e=new Set(["treeData","masterDetail"]),t=new Set(["groupDefaultExpanded","groupAllowUnbalanced","initialGroupOrderComparator","groupHideOpenParents","groupDisplayType"]),i=new Set(["excludeChildrenWhenTreeDataFiltering"]),r=new Set(["removePivotHeaderRowWhenSingleValueColumn","pivotRowTotals","pivotColumnGroupTotals","suppressExpandablePivotGroups"]),n=new Set(["getGroupRowAgg","alwaysAggregateAtRootLevel","groupIncludeTotalFooter","suppressAggFilteredOnly","grandTotalRow"]),o=new Set(["postSortRows","groupDisplayType","accentedSort"]),s=new Set([]),a=new Set(["groupRemoveSingleChildren","groupRemoveLowestSingleChildren","groupIncludeFooter","groupTotalRow"]),l=[...e,...t,...i,...r,...r,...n,...o,...s,...a];this.addManagedPropertyListeners(l,(l=>{var c;const u=null===(c=l.changeSet)||void 0===c?void 0:c.properties;if(!u)return;const d=e=>u.some((t=>e.has(t)));d(e)?this.setRowData(this.rootNode.allLeafChildren.map((e=>e.data))):d(t)?this.refreshModel({step:"group"}):d(i)?this.refreshModel({step:"filter"}):d(r)?this.refreshModel({step:"pivot"}):d(n)?this.refreshModel({step:"aggregate"}):d(o)?this.refreshModel({step:"sort"}):d(s)?this.refreshModel({step:"filter_aggregates"}):d(a)&&this.refreshModel({step:"map"})})),this.addManagedPropertyListener("rowHeight",(()=>this.resetRowHeights()))}start(){this.hasStarted=!0,this.shouldSkipSettingDataOnStart?this.dispatchUpdateEventsAndRefresh():this.setInitialData()}setInitialData(){const e=this.gos.get("rowData");e&&(this.shouldSkipSettingDataOnStart=!0,this.setRowData(e))}ensureRowHeightsValid(e,t,i,r){let n,o=!1;do{n=!1;const s=this.getRowIndexAtPixel(e),a=this.getRowIndexAtPixel(t),l=Math.max(s,i),c=Math.min(a,r);for(let e=l;e<=c;e++){const t=this.getRow(e);if(t.rowHeightEstimated){const e=U(this.gos,t);t.setRowHeight(e.height),n=!0,o=!0}}n&&this.setRowTopAndRowIndex()}while(n);return o}setRowTopAndRowIndex(){const e=this.environment.getDefaultRowHeight();let t=0;const i=new Set,r=z(this.gos,"normal");for(let n=0;n<this.rowsToDisplay.length;n++){const o=this.rowsToDisplay[n];if(null!=o.id&&i.add(o.id),null==o.rowHeight){const t=U(this.gos,o,r,e);o.setRowHeight(t.height,t.estimated)}o.setRowTop(t),o.setRowIndex(n),t+=o.rowHeight}return i}clearRowTopAndRowIndex(e,t){const i=e.isActive(),r=e=>{e&&null!=e.id&&!t.has(e.id)&&e.clearRowTopAndRowIndex()},n=e=>{if(r(e),r(e.detailNode),r(e.sibling),e.hasChildren()&&e.childrenAfterGroup){const t=-1==e.level;i&&!t&&!e.expanded||e.childrenAfterGroup.forEach(n)}};n(this.rootNode)}ensureRowsAtPixel(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=this.getRowIndexAtPixel(t),n=this.getRow(r),o=!this.gos.get("suppressAnimationFrame");if(n===e[0])return!1;const s=this.rootNode.allLeafChildren;return e.forEach((e=>{xe(s,e)})),e.forEach(((e,t)=>{Te(s,e,Math.max(r+i,0)+t)})),e.forEach(((e,t)=>{e.sourceRowIndex=t})),this.refreshModel({step:"group",keepRenderedRows:!0,keepEditingRows:!0,animate:o,rowNodesOrderChanged:!0}),!0}highlightRowAtPixel(e,t){const i=null!=t?this.getRowIndexAtPixel(t):null,r=null!=i?this.getRow(i):null;if(!r||!e||null==t)return void this.clearHighlightedRow();const n=this.getHighlightPosition(t,r),o=this.isHighlightingCurrentPosition(e,r,n),s=null!=this.lastHighlightedRow&&this.lastHighlightedRow!==r;(o||s)&&(this.clearHighlightedRow(),o)||(r.setHighlighted(n),this.lastHighlightedRow=r)}getHighlightPosition(e,t){if(!t){const i=this.getRowIndexAtPixel(e);if(!(t=this.getRow(i||0)))return 1}const{rowTop:i,rowHeight:r}=t;return e-i<r/2?0:1}getLastHighlightedRowNode(){return this.lastHighlightedRow}isHighlightingCurrentPosition(e,t,i){if(e===t)return!0;const r=0===i?-1:1;return this.getRow(t.rowIndex+r)===e}clearHighlightedRow(){this.lastHighlightedRow&&(this.lastHighlightedRow.setHighlighted(null),this.lastHighlightedRow=null)}isLastRowIndexKnown(){return!0}getRowCount(){return this.rowsToDisplay?this.rowsToDisplay.length:0}getTopLevelRowCount(){if(0===this.rowsToDisplay.length)return 0;if(this.rowsToDisplay&&this.rowsToDisplay[0]===this.rootNode)return 1;const e=this.rootNode.childrenAfterAggFilter,t=this.rootNode.sibling?1:0;return(e?e.length:0)+t}getTopLevelRowDisplayedIndex(e){if(this.rowsToDisplay&&this.rowsToDisplay[0]===this.rootNode)return e;let t=e;if(this.rowsToDisplay[0].footer){if(0===e)return 0;t-=1}const i=this.rowsToDisplay[this.rowsToDisplay.length-1],r=t>=this.rootNode.childrenAfterSort.length;if(i.footer&&r)return i.rowIndex;let n=this.rootNode.childrenAfterSort[t];if(this.gos.get("groupHideOpenParents"))for(;n.expanded&&n.childrenAfterSort&&n.childrenAfterSort.length>0;)n=n.childrenAfterSort[0];return n.rowIndex}getRowBounds(e){if(P(this.rowsToDisplay))return null;const t=this.rowsToDisplay[e];return t?{rowTop:t.rowTop,rowHeight:t.rowHeight}:null}onRowGroupOpened(){const e=te(this.gos);this.refreshModel({step:"map",keepRenderedRows:!0,animate:e})}onFilterChanged(e){if(e.afterDataChange)return;const t=te(this.gos),i=0===e.columns.length||e.columns.some((e=>e.isPrimary()))?"filter":"filter_aggregates";this.refreshModel({step:i,keepRenderedRows:!0,animate:t})}onSortChanged(){const e=te(this.gos);this.refreshModel({step:"sort",keepRenderedRows:!0,animate:e,keepEditingRows:!0})}getType(){return"clientSide"}onValueChanged(){this.columnModel.isPivotActive()?this.refreshModel({step:"pivot"}):this.refreshModel({step:"aggregate"})}createChangePath(e){const t=D(e),i=new Rc(!1,this.rootNode);return t&&i.setInactive(),i}isSuppressModelUpdateAfterUpdateTransaction(e){if(!this.gos.get("suppressModelUpdateAfterUpdateTransaction"))return!1;if(null==e.rowNodeTransactions)return!1;const t=e.rowNodeTransactions.filter((e=>null!=e.add&&e.add.length>0||null!=e.remove&&e.remove.length>0));return null==t||0==t.length}buildRefreshModelParams(e){let t="group";const i={everything:"group",group:"group",filter:"filter",map:"map",aggregate:"aggregate",filter_aggregates:"filter_aggregates",sort:"sort",pivot:"pivot",nothing:"nothing"};if(F(e)&&(t=i[e]),P(t))return void C("invalid step ".concat(e,", available steps are ").concat(Object.keys(i).join(", ")));return{step:t,keepRenderedRows:!0,keepEditingRows:!0,animate:!this.gos.get("suppressAnimationFrame")}}refreshModel(e){if(!this.hasStarted||this.isRefreshingModel||this.columnModel.isChangeEventsDispatching())return;const t="object"===typeof e&&"step"in e?e:this.buildRefreshModelParams(e);if(!t)return;if(this.isSuppressModelUpdateAfterUpdateTransaction(t))return;const i=this.createChangePath(t.rowNodeTransactions);switch(this.isRefreshingModel=!0,t.step){case"group":this.doRowGrouping(t.rowNodeTransactions,i,!!t.rowNodesOrderChanged,!!t.afterColumnsChanged);case"filter":this.doFilter(i);case"pivot":this.doPivot(i);case"aggregate":this.doAggregate(i);case"filter_aggregates":this.doFilterAggregates(i);case"sort":this.doSort(t.rowNodeTransactions,i);case"map":this.doRowsToDisplay()}const r=this.setRowTopAndRowIndex();this.clearRowTopAndRowIndex(i,r),this.isRefreshingModel=!1,this.eventService.dispatchEvent({type:"modelUpdated",animate:t.animate,keepRenderedRows:t.keepRenderedRows,newData:t.newData,newPage:!1,keepUndoRedoStack:t.keepUndoRedoStack})}isEmpty(){const e=P(this.rootNode.allLeafChildren)||0===this.rootNode.allLeafChildren.length;return P(this.rootNode)||e||!this.columnModel.isReady()}isRowsToRender(){return F(this.rowsToDisplay)&&this.rowsToDisplay.length>0}getNodesInRangeForSelection(e,t){let i=!1,r=!1;const n=[],o=be(this.gos);return this.forEachNodeAfterFilterAndSort((s=>{if(r)return;if(i&&(s===t||s===e)&&(r=!0,s.group&&o))return void n.push(...s.allLeafChildren);if(!i){if(s!==t&&s!==e)return;i=!0}(!s.group||!o)&&n.push(s)})),n}setDatasource(e){C("should never call setDatasource on clientSideRowController")}getTopLevelNodes(){return this.rootNode?this.rootNode.childrenAfterGroup:null}getRootNode(){return this.rootNode}getRow(e){return this.rowsToDisplay[e]}isRowPresent(e){return this.rowsToDisplay.indexOf(e)>=0}getRowIndexAtPixel(e){if(this.isEmpty()||0===this.rowsToDisplay.length)return-1;let t=0,i=this.rowsToDisplay.length-1;if(e<=0)return 0;if(ye(this.rowsToDisplay).rowTop<=e)return this.rowsToDisplay.length-1;let r=-1,n=-1;for(;;){const o=Math.floor((t+i)/2),s=this.rowsToDisplay[o];if(this.isRowInPixel(s,e))return o;s.rowTop<e?t=o+1:s.rowTop>e&&(i=o-1);if(r===t&&n===i)return o;r=t,n=i}}isRowInPixel(e,t){const i=e.rowTop,r=e.rowTop+e.rowHeight;return i<=t&&r>t}forEachLeafNode(e){this.rootNode.allLeafChildren&&this.rootNode.allLeafChildren.forEach(((t,i)=>e(t,i)))}forEachNode(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.recursivelyWalkNodesAndCallback({nodes:[...this.rootNode.childrenAfterGroup||[]],callback:e,recursionType:0,index:0,includeFooterNodes:t})}forEachNodeAfterFilter(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.recursivelyWalkNodesAndCallback({nodes:[...this.rootNode.childrenAfterAggFilter||[]],callback:e,recursionType:1,index:0,includeFooterNodes:t})}forEachNodeAfterFilterAndSort(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.recursivelyWalkNodesAndCallback({nodes:[...this.rootNode.childrenAfterSort||[]],callback:e,recursionType:2,index:0,includeFooterNodes:t})}forEachPivotNode(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.recursivelyWalkNodesAndCallback({nodes:[this.rootNode],callback:e,recursionType:3,index:0,includeFooterNodes:t})}recursivelyWalkNodesAndCallback(e){const{nodes:t,callback:i,recursionType:r,includeFooterNodes:n}=e;let{index:o}=e;const s=e=>{var r;const s=null===(r=t[0])||void 0===r?void 0:r.parent;if(!s)return;const a=n&&oe(this.gos),l=se(this.gos),c=n&&l({node:s});s===this.rootNode?a===e&&(s.createFooter(),i(s.sibling,o++)):c===e&&(s.createFooter(),i(s.sibling,o++))};s("top");for(let a=0;a<t.length;a++){const e=t[a];if(i(e,o++),e.hasChildren()&&!e.footer){let t=null;switch(r){case 0:t=e.childrenAfterGroup;break;case 1:t=e.childrenAfterAggFilter;break;case 2:t=e.childrenAfterSort;break;case 3:t=e.leafGroup?null:e.childrenAfterSort}t&&(o=this.recursivelyWalkNodesAndCallback({nodes:[...t],callback:i,recursionType:r,index:o,includeFooterNodes:n}))}}return s("bottom"),o}doAggregate(e){var t;null===(t=this.aggregationStage)||void 0===t||t.execute({rowNode:this.rootNode,changedPath:e})}doFilterAggregates(e){this.filterAggregatesStage?this.filterAggregatesStage.execute({rowNode:this.rootNode,changedPath:e}):this.rootNode.childrenAfterAggFilter=this.rootNode.childrenAfterFilter}expandOrCollapseAll(e){const t=this.gos.get("treeData"),i=this.columnModel.isPivotActive(),r=n=>{n&&n.forEach((n=>{const o=()=>{n.expanded=e,r(n.childrenAfterGroup)};if(t){return void(F(n.childrenAfterGroup)&&o())}if(i){return void(!n.leafGroup&&o())}n.group&&o()}))};this.rootNode&&r(this.rootNode.childrenAfterGroup),this.refreshModel({step:"map"}),this.eventService.dispatchEvent({type:"expandOrCollapseAll",source:e?"expandAll":"collapseAll"})}doSort(e,t){this.sortStage.execute({rowNode:this.rootNode,rowNodeTransactions:e,changedPath:t})}doRowGrouping(e,t,i,r){if(this.groupStage){if(e?this.groupStage.execute({rowNode:this.rootNode,rowNodeTransactions:e,rowNodesOrderChanged:i,changedPath:t}):this.groupStage.execute({rowNode:this.rootNode,changedPath:t,afterColumnsChanged:r}),be(this.gos)){this.selectionService.updateGroupsFromChildrenSelections("rowGroupChanged",t)&&this.eventService.dispatchEvent({type:"selectionChanged",source:"rowGroupChanged"})}}else{const e=this.rootNode,t=e.sibling;e.childrenAfterGroup=e.allLeafChildren,t&&(t.childrenAfterGroup=e.childrenAfterGroup),this.rootNode.updateHasChildren()}this.nodeManager.isRowCountReady()&&(this.rowCountReady=!0,this.eventService.dispatchEventOnce({type:"rowCountReady"}))}doFilter(e){this.filterStage.execute({rowNode:this.rootNode,changedPath:e})}doPivot(e){var t;null===(t=this.pivotStage)||void 0===t||t.execute({rowNode:this.rootNode,changedPath:e})}getNodeManager(){return this.nodeManager}getRowNode(e){if("string"==typeof e&&0==e.indexOf(Dn.ID_PREFIX_ROW_GROUP)){let t;return this.forEachNode((i=>{i.id===e&&(t=i)})),t}return this.nodeManager.getRowNode(e)}setRowData(e){this.selectionService.reset("rowDataChanged"),this.nodeManager.setRowData(e),this.hasStarted&&this.dispatchUpdateEventsAndRefresh()}dispatchUpdateEventsAndRefresh(){this.eventService.dispatchEvent({type:"rowDataUpdated"}),this.refreshModel({step:"group",newData:!0})}batchUpdateRowData(e,t){if(null==this.applyAsyncTransactionsTimeout){this.rowDataTransactionBatch=[];const e=this.gos.get("asyncTransactionWaitMillis");this.applyAsyncTransactionsTimeout=window.setTimeout((()=>{this.isAlive()&&this.executeBatchUpdateRowData()}),e)}this.rowDataTransactionBatch.push({rowDataTransaction:e,callback:t})}flushAsyncTransactions(){null!=this.applyAsyncTransactionsTimeout&&(clearTimeout(this.applyAsyncTransactionsTimeout),this.executeBatchUpdateRowData())}executeBatchUpdateRowData(){var e;this.valueCache.onDataChanged();const t=[],i=[];let r=!1;null===(e=this.rowDataTransactionBatch)||void 0===e||e.forEach((e=>{const{rowNodeTransaction:n,rowsInserted:o}=this.nodeManager.updateRowData(e.rowDataTransaction);o&&(r=!0),i.push(n),e.callback&&t.push(e.callback.bind(null,n))})),this.commonUpdateRowData(i,r),t.length>0&&window.setTimeout((()=>{t.forEach((e=>e()))}),0),i.length>0&&this.eventService.dispatchEvent({type:"asyncTransactionsFlushed",results:i}),this.rowDataTransactionBatch=null,this.applyAsyncTransactionsTimeout=void 0}updateRowData(e){this.valueCache.onDataChanged();const{rowNodeTransaction:t,rowsInserted:i}=this.nodeManager.updateRowData(e);return this.commonUpdateRowData([t],i),t}afterImmutableDataChange(e,t){this.commonUpdateRowData([e],t)}commonUpdateRowData(e,t){if(!this.hasStarted)return;const i=!this.gos.get("suppressAnimationFrame");this.eventService.dispatchEvent({type:"rowDataUpdated"}),this.refreshModel({step:"group",rowNodeTransactions:e,rowNodesOrderChanged:t,keepRenderedRows:!0,keepEditingRows:!0,animate:i})}doRowsToDisplay(){this.rowsToDisplay=this.flattenStage.execute({rowNode:this.rootNode})}onRowHeightChanged(){this.refreshModel({step:"map",keepRenderedRows:!0,keepEditingRows:!0,keepUndoRedoStack:!0})}onRowHeightChangedDebounced(){this.onRowHeightChanged_debounced()}resetRowHeights(){const e=this.resetRowHeightsForAllRowNodes();this.rootNode.setRowHeight(this.rootNode.rowHeight,!0),this.rootNode.sibling&&this.rootNode.sibling.setRowHeight(this.rootNode.sibling.rowHeight,!0),e&&this.onRowHeightChanged()}resetRowHeightsForAllRowNodes(){let e=!1;return this.forEachNode((t=>{t.setRowHeight(t.rowHeight,!0);const i=t.detailNode;i&&i.setRowHeight(i.rowHeight,!0),t.sibling&&t.sibling.setRowHeight(t.sibling.rowHeight,!0),e=!0})),e}onGridStylesChanges(e){if(e.rowHeightChanged){if(this.columnModel.isAutoRowHeightActive())return;this.resetRowHeights()}}onGridReady(){this.hasStarted||this.setInitialData()}isRowDataLoaded(){return this.rowCountReady}destroy(){super.destroy(),this.clearHighlightedRow()}},class extends He{constructor(){super(...arguments),this.beanName="filterStage"}wireBeans(e){this.filterManager=e.filterManager}execute(e){const{changedPath:t}=e;this.filter(t)}filter(e){var t;const i=!(null===(t=this.filterManager)||void 0===t||!t.isChildFilterPresent());this.filterNodes(i,e)}filterNodes(e,t){const i=(t,i)=>{t.hasChildren()?t.childrenAfterFilter=e&&!i?t.childrenAfterGroup.filter((e=>{const t=e.childrenAfterFilter&&e.childrenAfterFilter.length>0,i=e.data&&this.filterManager.doesRowPassFilter({rowNode:e});return t||i})):t.childrenAfterGroup:t.childrenAfterFilter=t.childrenAfterGroup,t.sibling&&(t.sibling.childrenAfterFilter=t.childrenAfterFilter)};if(this.doingTreeDataFiltering()){const e=(t,r)=>{if(t.childrenAfterGroup)for(let n=0;n<t.childrenAfterGroup.length;n++){const o=t.childrenAfterGroup[n],s=r||this.filterManager.doesRowPassFilter({rowNode:o});o.childrenAfterGroup?e(t.childrenAfterGroup[n],s):i(o,s)}i(t,r)},r=t=>e(t,!1);t.executeFromRootNode(r)}else{const e=e=>i(e,!1);t.forEachChangedNodeDepthFirst(e,!0)}}doingTreeDataFiltering(){return this.gos.get("treeData")&&!this.gos.get("excludeChildrenWhenTreeDataFiltering")}},class extends He{constructor(){super(...arguments),this.beanName="sortStage"}wireBeans(e){this.sortService=e.sortService,this.sortController=e.sortController}execute(e){const t=this.sortController.getSortOptions(),i=F(t)&&t.length>0,r=i&&F(e.rowNodeTransactions)&&this.gos.get("deltaSort"),n=t.some((e=>re(this.gos)?e.column.isPrimary()&&e.column.isRowGroupActive():!!e.column.getColDef().showRowGroup));this.sortService.sort(t,i,r,e.rowNodeTransactions,e.changedPath,n)}},class extends He{constructor(){super(...arguments),this.beanName="flattenStage"}wireBeans(e){this.beans=e,this.columnModel=e.columnModel}execute(e){const t=e.rowNode,i=[],r=this.columnModel.isPivotMode(),n=r&&t.leafGroup,o=n?[t]:t.childrenAfterSort,s=this.getFlattenDetails();this.recursivelyAddToRowsToDisplay(s,o,i,r,0);if(!n&&i.length>0&&s.grandTotalRow){t.createFooter();const e="top"===s.grandTotalRow;this.addRowNodeToRowsToDisplay(s,t.sibling,i,0,e)}return i}getFlattenDetails(){const e=this.gos.get("groupRemoveSingleChildren");return{groupRemoveLowestSingleChildren:!e&&this.gos.get("groupRemoveLowestSingleChildren"),groupRemoveSingleChildren:e,isGroupMultiAutoColumn:ae(this.gos),hideOpenParents:this.gos.get("groupHideOpenParents"),grandTotalRow:oe(this.gos),groupTotalRow:se(this.gos)}}recursivelyAddToRowsToDisplay(e,t,i,r,n){if(!D(t))for(let o=0;o<t.length;o++){const s=t[o],a=s.hasChildren(),l=r&&!a,c=e.groupRemoveSingleChildren&&a&&1===s.childrenAfterGroup.length,u=e.groupRemoveLowestSingleChildren&&a&&s.leafGroup&&1===s.childrenAfterGroup.length,d=r&&s.leafGroup,h=e.hideOpenParents&&s.expanded&&!s.master&&!d;if(!l&&!h&&!c&&!u&&this.addRowNodeToRowsToDisplay(e,s,i,n),!r||!s.leafGroup)if(a){const t=c||u;if(s.expanded||t){const o=e.groupTotalRow({node:s});o||s.destroyFooter();const a=t?n:n+1;"top"===o&&(s.createFooter(),this.addRowNodeToRowsToDisplay(e,s.sibling,i,a)),this.recursivelyAddToRowsToDisplay(e,s.childrenAfterSort,i,r,a),"bottom"===o&&(s.createFooter(),this.addRowNodeToRowsToDisplay(e,s.sibling,i,a))}}else if(s.master&&s.expanded){const t=this.createDetailNode(s);this.addRowNodeToRowsToDisplay(e,t,i,n)}}}addRowNodeToRowsToDisplay(e,t,i,r,n){n?i.unshift(t):i.push(t),t.setUiLevel(e.isGroupMultiAutoColumn?0:r)}createDetailNode(e){if(F(e.detailNode))return e.detailNode;const t=new Dn(this.beans);return t.detail=!0,t.selectable=!1,t.parent=e,F(e.id)&&(t.id="detail_"+e.id),t.data=e.data,t.level=e.level+1,e.detailNode=t,t}},class extends He{constructor(){super(...arguments),this.beanName="sortService"}wireBeans(e){this.columnModel=e.columnModel,this.funcColsService=e.funcColsService,this.rowNodeSorter=e.rowNodeSorter,this.showRowGroupColsService=e.showRowGroupColsService}sort(e,t,i,r,n,o){const s=this.gos.get("groupMaintainOrder"),a=this.columnModel.getCols().some((e=>e.isRowGroupActive()));let l={};i&&r&&(l=this.calculateDirtyNodes(r));const c=this.columnModel.isPivotMode(),u=this.gos.getCallback("postSortRows"),d=r=>{this.pullDownGroupDataForHideOpenParents(r.childrenAfterAggFilter,!0);const d=c&&r.leafGroup;if(s&&a&&!r.leafGroup&&!o){var h;const e=null===(h=this.funcColsService.getRowGroupColumns())||void 0===h?void 0:h[r.level+1],t=null===(null===e||void 0===e?void 0:e.getSort()),i=r.childrenAfterAggFilter.slice(0);if(r.childrenAfterSort&&!t){const e={};r.childrenAfterSort.forEach(((t,i)=>{e[t.id]=i})),i.sort(((t,i)=>{var r,n;return(null!==(r=e[t.id])&&void 0!==r?r:0)-(null!==(n=e[i.id])&&void 0!==n?n:0)}))}r.childrenAfterSort=i}else r.childrenAfterSort=!t||d?r.childrenAfterAggFilter.slice(0):i?this.doDeltaSort(r,l,n,e):this.rowNodeSorter.doFullSort(r.childrenAfterAggFilter,e);if(r.sibling&&(r.sibling.childrenAfterSort=r.childrenAfterSort),this.updateChildIndexes(r),u){const e={nodes:r.childrenAfterSort};u(e)}};n&&n.forEachChangedNodeDepthFirst(d),this.updateGroupDataForHideOpenParents(n)}calculateDirtyNodes(e){const t={},i=e=>{e&&e.forEach((e=>t[e.id]=!0))};return e&&e.forEach((e=>{i(e.add),i(e.update),i(e.remove)})),t}doDeltaSort(e,t,i,r){const n=e.childrenAfterAggFilter,o=e.childrenAfterSort;if(!o)return this.rowNodeSorter.doFullSort(n,r);const s={},a=[];n.forEach((e=>{t[e.id]||!i.canSkip(e)?a.push(e):s[e.id]=!0}));const l=o.filter((e=>s[e.id])),c=(e,t)=>({currentPos:t,rowNode:e}),u=a.map(c).sort(((e,t)=>this.rowNodeSorter.compareRowNodes(r,e,t)));return this.mergeSortedArrays(r,u,l.map(c)).map((e=>{let{rowNode:t}=e;return t}))}mergeSortedArrays(e,t,i){const r=[];let n=0,o=0;for(;n<t.length&&o<i.length;){this.rowNodeSorter.compareRowNodes(e,t[n],i[o])<0?r.push(t[n++]):r.push(i[o++])}for(;n<t.length;)r.push(t[n++]);for(;o<i.length;)r.push(i[o++]);return r}updateChildIndexes(e){if(P(e.childrenAfterSort))return;const t=e.childrenAfterSort;for(let i=0;i<t.length;i++){const r=t[i],n=0===i,o=i===e.childrenAfterSort.length-1;r.setFirstChild(n),r.setLastChild(o),r.setChildIndex(i)}}updateGroupDataForHideOpenParents(e){if(!this.gos.get("groupHideOpenParents"))return;if(this.gos.get("treeData"))return v("The property hideOpenParents dose not work with Tree Data. This is because Tree Data has values at the group level, it doesn't make sense to hide them."),!1;const t=e=>{this.pullDownGroupDataForHideOpenParents(e.childrenAfterSort,!1),e.childrenAfterSort.forEach((e=>{e.hasChildren()&&t(e)}))};e&&e.executeFromRootNode((e=>t(e)))}pullDownGroupDataForHideOpenParents(e,t){this.gos.get("groupHideOpenParents")&&!P(e)&&e.forEach((e=>{var i,r;(null!==(i=null===(r=this.showRowGroupColsService)||void 0===r?void 0:r.getShowRowGroupCols())&&void 0!==i?i:[]).forEach((i=>{const r=i.getColDef().showRowGroup;if("string"!==typeof r)return void C("groupHideOpenParents only works when specifying specific columns for colDef.showRowGroup");const n=r,o=this.columnModel.getColDefCol(n);if(!(o===e.rowGroupColumn))if(t)e.setGroupValue(i.getId(),void 0);else{const t=this.getFirstChildOfFirstChild(e,o);t&&e.setGroupValue(i.getId(),t.key)}}))}))}getFirstChildOfFirstChild(e,t){let i=e;for(;i;){const e=i.parent;if(!e||!i.firstChild)return null;if(e.rowGroupColumn===t)return e;i=e}return null}},class extends He{constructor(){super(...arguments),this.beanName="immutableService"}wireBeans(e){this.rowModel=e.rowModel,this.selectionService=e.selectionService}postConstruct(){G(this.gos)&&(this.clientSideRowModel=this.rowModel,this.addManagedPropertyListener("rowData",(()=>this.onRowDataUpdated())))}isActive(){const e=this.gos.exists("getRowId");return!this.gos.get("resetRowDataOnUpdate")&&e}setRowData(e){const t=this.createTransactionForRowData(e);if(!t)return;const i=this.clientSideRowModel.getNodeManager(),{rowNodeTransaction:r,rowsInserted:n}=i.updateRowData(t);let o=!1;this.gos.get("suppressMaintainUnsortedOrder")||(o=i.updateRowOrderFromRowData(e)),this.clientSideRowModel.afterImmutableDataChange(r,o||n)}createTransactionForRowData(e){if(!G(this.gos))return C("ImmutableService only works with ClientSideRowModel"),null;const t=ce(this.gos);if(null==t)return C("ImmutableService requires getRowId() callback to be implemented, your row data needs IDs!"),null;const i=this.clientSideRowModel.getNodeManager().getCopyOfNodesMap(),r=[],n=[],o=[];return F(e)&&e.forEach((e=>{const r=t({data:e,level:0}),s=i[r];if(s){s.data!==e&&n.push(e),i[r]=void 0}else o.push(e)})),Ze(i,((e,t)=>{t&&r.push(t.data)})),{remove:r,update:n,add:o}}onRowDataUpdated(){const e=this.gos.get("rowData");e&&(this.isActive()?this.setRowData(e):(this.selectionService.reset("rowDataChanged"),this.clientSideRowModel.setRowData(e)))}}]},Yc={version:jc,moduleName:"@ag-grid-community/client-side-row-model",dependantModules:[Kc,{version:jc,moduleName:"@ag-grid-community/client-side-row-model".concat("-api"),beans:[Gc],apiFunctions:{onGroupExpandedOrCollapsed:function(e){e.expansionService.onGroupExpandedOrCollapsed()},refreshClientSideRowModel:function(e,t){var i;null===(i=e.rowModelHelperService)||void 0===i||null===(i=i.getClientSideRowModel())||void 0===i||i.refreshModel(t)},isRowDataEmpty:function(e){var t,i;return null===(t=null===(i=e.rowModelHelperService)||void 0===i||null===(i=i.getClientSideRowModel())||void 0===i?void 0:i.isEmpty())||void 0===t||t},forEachLeafNode:function(e,t){var i;null===(i=e.rowModelHelperService)||void 0===i||null===(i=i.getClientSideRowModel())||void 0===i||i.forEachLeafNode(t)},forEachNodeAfterFilter:function(e,t){var i;null===(i=e.rowModelHelperService)||void 0===i||null===(i=i.getClientSideRowModel())||void 0===i||i.forEachNodeAfterFilter(t)},forEachNodeAfterFilterAndSort:function(e,t){var i;null===(i=e.rowModelHelperService)||void 0===i||null===(i=i.getClientSideRowModel())||void 0===i||i.forEachNodeAfterFilterAndSort(t)},resetRowHeights:function(e){var t;e.columnModel.isAutoRowHeightActive()?v("calling gridApi.resetRowHeights() makes no sense when using Auto Row Height."):null===(t=e.rowModelHelperService)||void 0===t||null===(t=t.getClientSideRowModel())||void 0===t||t.resetRowHeights()},applyTransaction:function(e,t){return e.frameworkOverrides.wrapIncoming((()=>{var i;return null===(i=e.rowModelHelperService)||void 0===i||null===(i=i.getClientSideRowModel())||void 0===i?void 0:i.updateRowData(t)}))},applyTransactionAsync:function(e,t,i){e.frameworkOverrides.wrapIncoming((()=>{var r;return null===(r=e.rowModelHelperService)||void 0===r||null===(r=r.getClientSideRowModel())||void 0===r?void 0:r.batchUpdateRowData(t,i)}))},flushAsyncTransactions:function(e){e.frameworkOverrides.wrapIncoming((()=>{var t;return null===(t=e.rowModelHelperService)||void 0===t||null===(t=t.getClientSideRowModel())||void 0===t?void 0:t.flushAsyncTransactions()}))},getBestCostNodeSelection:function(e){return e.selectionService.getBestCostNodeSelection()}},dependantModules:[Kc,Hc]}]},qc=class extends He{setBeans(e){this.beans=e}getFileName(e){const t=this.getDefaultFileExtension();return null!=e&&e.length||(e=this.getDefaultFileName()),-1===e.indexOf(".")?"".concat(e,".").concat(t):e}getData(e){const t=this.createSerializingSession(e);return this.beans.gridSerializer.serialize(t,e)}getDefaultFileName(){return"export.".concat(this.getDefaultFileExtension())}},Qc=class{constructor(e){this.groupColumns=[];const{columnModel:t,funcColsService:i,columnNameService:r,valueService:n,gos:o,processCellCallback:s,processHeaderCallback:a,processGroupHeaderCallback:l,processRowGroupCallback:c}=e;this.columnModel=t,this.funcColsService=i,this.columnNameService=r,this.valueService=n,this.gos=o,this.processCellCallback=s,this.processHeaderCallback=a,this.processGroupHeaderCallback=l,this.processRowGroupCallback=c}prepare(e){this.groupColumns=e.filter((e=>!!e.getColDef().showRowGroup))}extractHeaderValue(e){const t=this.getHeaderName(this.processHeaderCallback,e);return null!==t&&void 0!==t?t:""}extractRowCellValue(e,t,i,r,n){const o=this.gos.get("groupHideOpenParents")&&!n.footer||!this.shouldRenderGroupSummaryCell(n,e,t)?this.valueService.getValue(e,n):this.createValueForGroupNode(e,n);return this.processCell({accumulatedRowIndex:i,rowNode:n,column:e,value:o,processCellCallback:this.processCellCallback,type:r})}shouldRenderGroupSummaryCell(e,t,i){if(!(e&&e.group))return!1;if(-1!==this.groupColumns.indexOf(t)){var r;const i=null===(r=e.groupData)||void 0===r?void 0:r[t.getId()],n=this.gos.get("suppressGroupMaintainValueType");if(n&&null!=i||!n&&void 0!==i)return!0;if(H(this.gos)&&e.group)return!0;if(e.footer&&-1===e.level){const e=t.getColDef();return null==e||!0===e.showRowGroup||e.showRowGroup===this.funcColsService.getRowGroupColumns()[0].getId()}}const n=le(this.gos,this.columnModel.isPivotMode());return 0===i&&n}getHeaderName(e,t){return e?e(this.gos.addGridCommonParams({column:t})):this.columnNameService.getDisplayNameForColumn(t,"csv",!0)}createValueForGroupNode(e,t){if(this.processRowGroupCallback)return this.processRowGroupCallback(this.gos.addGridCommonParams({column:e,node:t}));const i=this.gos.get("treeData"),r=this.gos.get("suppressGroupMaintainValueType"),n=t=>{var n,o;if(i||r)return t.key;const s=null===(n=t.groupData)||void 0===n?void 0:n[e.getId()];return s&&t.rowGroupColumn&&!1!==t.rowGroupColumn.getColDef().useValueFormatterForExport&&null!==(o=this.valueService.formatValue(t.rowGroupColumn,t,s))&&void 0!==o?o:s},o=t.footer,s=[n(t)];if(!ae(this.gos))for(;t.parent;)t=t.parent,s.push(n(t));const a=s.reverse().join(" -> ");return o?"Total ".concat(a):a}processCell(e){const{accumulatedRowIndex:t,rowNode:i,column:r,value:n,processCellCallback:o,type:s}=e;var a;return o?{value:null!==(a=o(this.gos.addGridCommonParams({accumulatedRowIndex:t,column:r,node:i,value:n,type:s,parseValue:e=>this.valueService.parseValue(r,i,e,this.valueService.getValue(r,i)),formatValue:e=>{var t;return null!==(t=this.valueService.formatValue(r,i,e))&&void 0!==t?t:e}})))&&void 0!==a?a:""}:!1!==r.getColDef().useValueFormatterForExport?{value:null!==n&&void 0!==n?n:"",valueFormatted:this.valueService.formatValue(r,i,n)}:{value:null!==n&&void 0!==n?n:""}}},$c=class{static download(e,t){const i=document.defaultView||window;if(!i)return void v("There is no `window` associated with the current `document`");const r=document.createElement("a"),n=i.URL.createObjectURL(t);r.setAttribute("href",n),r.setAttribute("download",e),r.style.display="none",document.body.appendChild(r),r.dispatchEvent(new MouseEvent("click",{bubbles:!1,cancelable:!0,view:i})),document.body.removeChild(r),i.setTimeout((()=>{i.URL.revokeObjectURL(n)}),0)}},Xc=class extends Qc{constructor(e){super(e),this.isFirstLine=!0,this.result="";const{suppressQuotes:t,columnSeparator:i}=e;this.suppressQuotes=t,this.columnSeparator=i}addCustomContent(e){e&&("string"===typeof e?(/^\s*\n/.test(e)||this.beginNewLine(),e=e.replace(/\r?\n/g,"\r\n"),this.result+=e):e.forEach((e=>{this.beginNewLine(),e.forEach(((e,t)=>{0!==t&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(e.data.value||""),e.mergeAcross&&this.appendEmptyCells(e.mergeAcross)}))})))}onNewHeaderGroupingRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderGroupingRowColumn.bind(this)}}onNewHeaderGroupingRowColumn(e,t,i,r){0!=i&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(t),this.appendEmptyCells(r)}appendEmptyCells(e){for(let t=1;t<=e;t++)this.result+=this.columnSeparator+this.putInQuotes("")}onNewHeaderRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderRowColumn.bind(this)}}onNewHeaderRowColumn(e,t){0!=t&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(this.extractHeaderValue(e))}onNewBodyRow(){return this.beginNewLine(),{onColumn:this.onNewBodyRowColumn.bind(this)}}onNewBodyRowColumn(e,t,i){var r;0!=t&&(this.result+=this.columnSeparator);const n=this.extractRowCellValue(e,t,t,"csv",i);this.result+=this.putInQuotes(null!==(r=n.valueFormatted)&&void 0!==r?r:n.value)}putInQuotes(e){if(this.suppressQuotes)return e;if(null===e||void 0===e)return'""';let t;"string"===typeof e?t=e:"function"===typeof e.toString?t=e.toString():(v("unknown value type during csv conversion"),t="");return'"'+t.replace(/"/g,'""')+'"'}parse(){return this.result}beginNewLine(){this.isFirstLine||(this.result+="\r\n"),this.isFirstLine=!1}};var Jc="32.3.3",Zc={version:Jc,moduleName:"@ag-grid-community/csv-export".concat("-core"),beans:[class extends qc{constructor(){super(...arguments),this.beanName="csvCreator"}wireBeans(e){this.columnModel=e.columnModel,this.columnNameService=e.columnNameService,this.funcColsService=e.funcColsService,this.valueService=e.valueService,this.gridSerializer=e.gridSerializer}postConstruct(){this.setBeans({gridSerializer:this.gridSerializer,gos:this.gos})}getMergedParams(e){const t=this.gos.get("defaultCsvExportParams");return Object.assign({},t,e)}export(e){if(this.isExportSuppressed())return void v("Export cancelled. Export is not allowed as per your configuration.");const t=this.getMergedParams(e),i=this.getData(t),r=new Blob(["\ufeff",i],{type:"text/plain"}),n="function"===typeof t.fileName?t.fileName(this.gos.getGridCommonParams()):t.fileName;$c.download(this.getFileName(n),r)}exportDataAsCsv(e){this.export(e)}getDataAsCsv(e){const t=arguments.length>1&&void 0!==arguments[1]&&arguments[1]?Object.assign({},e):this.getMergedParams(e);return this.getData(t)}getDefaultFileExtension(){return"csv"}createSerializingSession(e){const{columnModel:t,columnNameService:i,funcColsService:r,valueService:n,gos:o}=this,{processCellCallback:s,processHeaderCallback:a,processGroupHeaderCallback:l,processRowGroupCallback:c,suppressQuotes:u,columnSeparator:d}=e;return new Xc({columnModel:t,columnNameService:i,funcColsService:r,valueService:n,gos:o,processCellCallback:s||void 0,processHeaderCallback:a||void 0,processGroupHeaderCallback:l||void 0,processRowGroupCallback:c||void 0,suppressQuotes:u||!1,columnSeparator:d||","})}isExportSuppressed(){return this.gos.get("suppressCsvExport")}},class extends He{constructor(){super(...arguments),this.beanName="gridSerializer"}wireBeans(e){this.visibleColsService=e.visibleColsService,this.columnModel=e.columnModel,this.columnNameService=e.columnNameService,this.rowModel=e.rowModel,this.pinnedRowModel=e.pinnedRowModel,this.selectionService=e.selectionService,this.rowNodeSorter=e.rowNodeSorter,this.sortController=e.sortController}serialize(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{allColumns:i,columnKeys:r,skipRowGroups:n}=t,o=this.getColumnsToExport(i,n,r),s=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return e=>t.reduce(((e,t)=>t(e)),e)}(this.prepareSession(o),this.prependContent(t),this.exportColumnGroups(t,o),this.exportHeaders(t,o),this.processPinnedTopRows(t,o),this.processRows(t,o),this.processPinnedBottomRows(t,o),this.appendContent(t));return s(e).parse()}processRow(e,t,i,r){var n;const o=t.shouldRowBeSkipped||(()=>!1),s=this.gos.get("groupRemoveSingleChildren"),a=this.gos.get("groupRemoveLowestSingleChildren"),l=null!=t.rowPositions||!!t.onlySelected,c=this.gos.get("groupHideOpenParents")&&!l,u=this.columnModel.isPivotMode()?r.leafGroup:!r.group,d=!!r.footer,h=a&&r.leafGroup,g=1===r.allChildrenCount&&1===(null===(n=r.childrenAfterGroup)||void 0===n?void 0:n.length)&&(s||h);if(!u&&!d&&(t.skipRowGroups||g||c)||t.onlySelected&&!r.isSelected()||t.skipPinnedTop&&"top"===r.rowPinned||t.skipPinnedBottom&&"bottom"===r.rowPinned)return;if(-1===r.level&&!u&&!d)return;if(o(this.gos.addGridCommonParams({node:r})))return;const p=e.onNewBodyRow(r);if(i.forEach(((e,t)=>{p.onColumn(e,t,r)})),t.getCustomContentBelowRow){const i=t.getCustomContentBelowRow(this.gos.addGridCommonParams({node:r}));i&&e.addCustomContent(i)}}appendContent(e){return t=>{const i=e.appendContent;return i&&t.addCustomContent(i),t}}prependContent(e){return t=>{const i=e.prependContent;return i&&t.addCustomContent(i),t}}prepareSession(e){return t=>(t.prepare(e),t)}exportColumnGroups(e,t){return i=>{if(!e.skipColumnGroupHeaders){const r=new Ot,n=this.visibleColsService.createGroups({columns:t,idCreator:r,pinned:null,isStandaloneStructure:!0});this.recursivelyAddHeaderGroups(n,i,e.processGroupHeaderCallback)}return i}}exportHeaders(e,t){return i=>{if(!e.skipColumnHeaders){const e=i.onNewHeaderRow();t.forEach(((t,i)=>{e.onColumn(t,i,void 0)}))}return i}}processPinnedTopRows(e,t){return i=>{const r=this.processRow.bind(this,i,e,t);return e.rowPositions?e.rowPositions.filter((e=>"top"===e.rowPinned)).sort(((e,t)=>e.rowIndex-t.rowIndex)).map((e=>this.pinnedRowModel.getPinnedTopRow(e.rowIndex))).forEach(r):this.pinnedRowModel.forEachPinnedRow("top",r),i}}processRows(e,t){return i=>{const r=this.rowModel,n=G(this.gos),o=H(this.gos),s=!n&&e.onlySelected,a=this.processRow.bind(this,i,e,t),{exportedRows:l="filteredAndSorted"}=e;if(e.rowPositions)e.rowPositions.filter((e=>null==e.rowPinned)).sort(((e,t)=>e.rowIndex-t.rowIndex)).map((e=>r.getRow(e.rowIndex))).forEach(a);else if(this.columnModel.isPivotMode())n?r.forEachPivotNode(a,!0):o?r.forEachNodeAfterFilterAndSort(a,!0):r.forEachNode(a);else if(e.onlySelectedAllPages||s){const e=this.selectionService.getSelectedNodes();this.replicateSortedOrder(e),e.forEach(a)}else"all"===l?r.forEachNode(a):n||o?r.forEachNodeAfterFilterAndSort(a,!0):r.forEachNode(a);return i}}replicateSortedOrder(e){const t=this.sortController.getSortOptions(),i=(e,r)=>{return null!=e.rowIndex&&null!=r.rowIndex?e.rowIndex-r.rowIndex:e.level===r.level?(null===(n=e.parent)||void 0===n?void 0:n.id)===(null===(o=r.parent)||void 0===o?void 0:o.id)?this.rowNodeSorter.compareRowNodes(t,{rowNode:e,currentPos:null!==(s=e.rowIndex)&&void 0!==s?s:-1},{rowNode:r,currentPos:null!==(a=r.rowIndex)&&void 0!==a?a:-1}):i(e.parent,r.parent):e.level>r.level?i(e.parent,r):i(e,r.parent);var n,o,s,a};e.sort(i)}processPinnedBottomRows(e,t){return i=>{const r=this.processRow.bind(this,i,e,t);return e.rowPositions?e.rowPositions.filter((e=>"bottom"===e.rowPinned)).sort(((e,t)=>e.rowIndex-t.rowIndex)).map((e=>this.pinnedRowModel.getPinnedBottomRow(e.rowIndex))).forEach(r):this.pinnedRowModel.forEachPinnedRow("bottom",r),i}}getColumnsToExport(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0;const r=this.columnModel.isPivotMode();if(i&&i.length)return this.columnModel.getColsForKeys(i);const n=this.gos.get("treeData");let o=[];return o=e&&!r?this.columnModel.getCols():this.visibleColsService.getAllCols(),t&&!n&&(o=o.filter((e=>qe(e)||Qe(e)))),o}recursivelyAddHeaderGroups(e,t,i){const r=[];e.forEach((e=>{const t=e;t.getChildren&&t.getChildren().forEach((e=>r.push(e)))})),e.length>0&&It(e[0])&&this.doAddHeaderHeader(t,e,i),r&&r.length>0&&this.recursivelyAddHeaderGroups(r,t,i)}doAddHeaderHeader(e,t,i){const r=e.onNewHeaderGroupingRow();let n=0;t.forEach((e=>{const t=e;let o;o=i?i(this.gos.addGridCommonParams({columnGroup:t})):this.columnNameService.getDisplayNameForColumnGroup(t,"header");const s=t.getLeafColumns().reduce(((e,t,i,r)=>{let n=ye(e);return"open"===t.getColumnGroupShow()?n&&null==n[1]||(n=[i],e.push(n)):n&&null==n[1]&&(n[1]=i-1),i===r.length-1&&n&&null==n[1]&&(n[1]=i),e}),[]);r.onColumn(t,o||"",n++,t.getLeafColumns().length-1,s)}))}}]},eu={version:Jc,moduleName:"@ag-grid-community/csv-export",dependantModules:[Zc,{version:Jc,moduleName:"@ag-grid-community/csv-export".concat("-api"),apiFunctions:{getDataAsCsv:function(e,t){var i;return null===(i=e.csvCreator)||void 0===i?void 0:i.getDataAsCsv(t)},exportDataAsCsv:function(e,t){var i;null===(i=e.csvCreator)||void 0===i||i.exportDataAsCsv(t)}},dependantModules:[Zc]}]};var tu=async e=>{const t=new Blob([e]),{size:i,content:r}=await(async e=>{let t=0;const i=[],r=new WritableStream({write:e=>{i.push(e),t+=e.length}}),n=new ReadableStream({start:t=>{const i=new FileReader;i.onload=e=>{var i;null!==(i=e.target)&&void 0!==i&&i.result&&t.enqueue(e.target.result),t.close()},i.readAsArrayBuffer(e)}}),o=new window.CompressionStream("deflate-raw");return await n.pipeThrough(o).pipeTo(r),{size:t,content:new Blob(i)}})(t);return{size:i,content:new Uint8Array(await r.arrayBuffer())}};function iu(e,t){let i="";for(let r=0;r<t;r++)i+=String.fromCharCode(255&e),e>>>=8;return i}var ru=e=>{if(!e.length)return 0;let t=~0,i=0,r=0,n=0;for(let o=0;o<e.length;o++)i=e[o],r=255&(t^i),n=ou[r],t=t>>>8^n;return~t},nu=e=>e.length?ru("string"===typeof e?(new TextEncoder).encode(e):e):0,ou=new Uint32Array([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]),su=(e,t,i,r,n,o)=>{const{content:s,path:a,created:l}=e,c=(e=>{let t=e.getHours();return t<<=6,t|=e.getMinutes(),t<<=5,t|=e.getSeconds()/2,t})(l),u=(e=>{let t=e.getFullYear()-1980;return t<<=4,t|=e.getMonth()+1,t<<=5,t|=e.getDate(),t})(l),d=nu(n),h=void 0!==o?o:r,g=Ft(a),p=g!==a;let f="";if(p){const e=iu(1,1)+iu(nu(g),4)+g;f="up"+iu(e.length,2)+e}const m="\x14\0"+(p?"\0\b":"\0\0")+iu(t?8:0,2)+iu(c,2)+iu(u,2)+iu(h?d:0,4)+iu(null!==o&&void 0!==o?o:r,4)+iu(r,4)+iu(g.length,2)+iu(f.length,2),v="PK\x03\x04"+m+g+f,C="PK\x01\x02\x14\0"+m+"\0\0\0\0\0\0"+(s?"\0\0\0\0":"\x10\0\0\0")+iu(i,4)+g+f;return{localFileHeader:Uint8Array.from(v,(e=>e.charCodeAt(0))),centralDirectoryHeader:Uint8Array.from(C,(e=>e.charCodeAt(0)))}},au=e=>{let t;if("string"===typeof e){const i=atob(e.split(";base64,")[1]);t=Uint8Array.from(i,(e=>e.charCodeAt(0)))}else t=e;return{size:t.length,content:t}},lu=async(e,t)=>{const{content:i}=e,{size:r,content:n}=i?au(i):{size:0,content:Uint8Array.from([])};let o,s,a=!1;if("file"===e.type&&n&&r>0){const e=await tu(n);o=e.content,s=e.size,a=!0}return c(c({},su(e,a,t,r,n,s)),{},{content:o||n,isCompressed:a})},cu=(e,t)=>{const{content:i}=e,{content:r}=i?au(i):{content:Uint8Array.from([])};return c(c({},su(e,!1,t,r.length,r,void 0)),{},{content:r,isCompressed:!1})},uu=class{static addFolders(e){e.forEach(this.addFolder.bind(this))}static addFolder(e){this.folders.push({path:e,created:new Date,isBase64:!1,type:"folder"})}static addFile(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.files.push({path:e,created:new Date,content:i?t:(new TextEncoder).encode(t),isBase64:i,type:"file"})}static async getZipFile(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"application/zip";const t=await this.buildCompressedFileStream();return this.clearStream(),new Blob([t],{type:e})}static getUncompressedZipFile(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"application/zip";const t=this.buildFileStream();return this.clearStream(),new Blob([t],{type:e})}static clearStream(){this.folders=[],this.files=[]}static packageFiles(e){let t=0,i=0;for(const c of e){const{localFileHeader:e,centralDirectoryHeader:r,content:n}=c;t+=e.length+n.length,i+=r.length}const r=new Uint8Array(t),n=new Uint8Array(i);let o=0,s=0;for(const c of e){const{localFileHeader:e,centralDirectoryHeader:t,content:i}=c;r.set(e,o),o+=e.length,r.set(i,o),o+=i.length,n.set(t,s),s+=t.length}const a=((e,t,i)=>{const r="PK\x05\x06\0\0\0\0"+iu(e,2)+iu(e,2)+iu(t,4)+iu(i,4)+"\0\0";return Uint8Array.from(r,(e=>e.charCodeAt(0)))})(e.length,i,t),l=new Uint8Array(r.length+n.length+a.length);return l.set(r),l.set(n,r.length),l.set(a,r.length+n.length),l}static async buildCompressedFileStream(){const e=[...this.folders,...this.files],t=[];let i=0;for(const r of e){const e=await lu(r,i),{localFileHeader:n,content:o}=e;t.push(e),i+=n.length+o.length}return this.packageFiles(t)}static buildFileStream(){const e=[...this.folders,...this.files],t=[];let i=0;for(const r of e){const e=cu(r,i),{localFileHeader:n,content:o}=e;t.push(e),i+=n.length+o.length}return this.packageFiles(t)}};uu.folders=[],uu.files=[];var du=class extends Ha{wireBeans(e){this.beans=e}constructor(e,t,i){super(e),this.parentCache=t,this.params=i,this.startRow=e*i.blockSize,this.endRow=this.startRow+i.blockSize}postConstruct(){this.createRowNodes()}getBlockStateJson(){return{id:""+this.getId(),state:{blockNumber:this.getId(),startRow:this.getStartRow(),endRow:this.getEndRow(),pageStatus:this.getState()}}}setDataAndId(e,t,i){F(t)?e.setDataAndId(t,i.toString()):e.setDataAndId(void 0,void 0)}loadFromDatasource(){const e=this.createLoadParams();P(this.params.datasource.getRows)?v("datasource is missing getRows method"):window.setTimeout((()=>{this.params.datasource.getRows(e)}),0)}processServerFail(){}createLoadParams(){return{startRow:this.getStartRow(),endRow:this.getEndRow(),successCallback:this.pageLoaded.bind(this,this.getVersion()),failCallback:this.pageLoadFailed.bind(this,this.getVersion()),sortModel:this.params.sortModel,filterModel:this.params.filterModel,context:this.gos.getGridCommonParams().context}}forEachNode(e,t,i){this.rowNodes.forEach(((r,n)=>{this.startRow+n<i&&e(r,t.next())}))}getLastAccessed(){return this.lastAccessed}getRow(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]||(this.lastAccessed=this.params.lastAccessedSequence.next());const t=e-this.startRow;return this.rowNodes[t]}getStartRow(){return this.startRow}getEndRow(){return this.endRow}createRowNodes(){this.rowNodes=[];for(let e=0;e<this.params.blockSize;e++){const t=this.startRow+e,i=new Dn(this.beans);i.setRowHeight(this.params.rowHeight),i.uiLevel=0,i.setRowIndex(t),i.setRowTop(this.params.rowHeight*t),this.rowNodes.push(i)}}processServerResult(e){this.rowNodes.forEach(((t,i)=>{const r=e.rowData?e.rowData[i]:void 0;!t.id&&t.alreadyRendered&&r&&(this.rowNodes[i]=new Dn(this.beans),this.rowNodes[i].setRowIndex(t.rowIndex),this.rowNodes[i].setRowTop(t.rowTop),this.rowNodes[i].setRowHeight(t.rowHeight),t.clearRowTopAndRowIndex()),this.setDataAndId(this.rowNodes[i],r,this.startRow+i)}));const t=null!=e.rowCount&&e.rowCount>=0?e.rowCount:void 0;this.parentCache.pageLoaded(this,t)}destroy(){this.rowNodes.forEach((e=>{e.clearRowTopAndRowIndex()})),super.destroy()}},hu=class extends He{constructor(e){super(),this.lastRowIndexKnown=!1,this.blocks={},this.blockCount=0,this.rowCount=e.initialRowCount,this.params=e}wireBeans(e){this.rowRenderer=e.rowRenderer,this.focusService=e.focusService}getRow(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i=Math.floor(e/this.params.blockSize);let r=this.blocks[i];if(!r){if(t)return;r=this.createBlock(i)}return r.getRow(e)}createBlock(e){const t=this.createBean(new du(e,this,this.params));return this.blocks[t.getId()]=t,this.blockCount++,this.purgeBlocksIfNeeded(t),this.params.rowNodeBlockLoader.addBlock(t),t}refreshCache(){0==this.blockCount?this.purgeCache():(this.getBlocksInOrder().forEach((e=>e.setStateWaitingToLoad())),this.params.rowNodeBlockLoader.checkBlockToLoad())}destroy(){this.getBlocksInOrder().forEach((e=>this.destroyBlock(e))),super.destroy()}getRowCount(){return this.rowCount}isLastRowIndexKnown(){return this.lastRowIndexKnown}pageLoaded(e,t){this.isAlive()&&(this.gos.get("debug")&&m("InfiniteCache - onPageLoaded: page = ".concat(e.getId(),", lastRow = ").concat(t)),this.checkRowCount(e,t),this.onCacheUpdated())}purgeBlocksIfNeeded(e){const t=this.getBlocksInOrder().filter((t=>t!=e));t.sort(((e,t)=>t.getLastAccessed()-e.getLastAccessed()));const i=this.params.maxBlocksInCache>0,r=i?this.params.maxBlocksInCache-1:null;t.forEach(((e,t)=>{if("needsLoading"===e.getState()&&t>=1||!!i&&t>=r){if(this.isBlockCurrentlyDisplayed(e))return;if(this.isBlockFocused(e))return;this.removeBlockFromCache(e)}}))}isBlockFocused(e){const t=this.focusService.getFocusCellToUseAfterRefresh();if(!t)return!1;if(null!=t.rowPinned)return!1;const i=e.getStartRow(),r=e.getEndRow();return t.rowIndex>=i&&t.rowIndex<r}isBlockCurrentlyDisplayed(e){const t=e.getStartRow(),i=e.getEndRow()-1;return this.rowRenderer.isRangeInRenderedViewport(t,i)}removeBlockFromCache(e){e&&this.destroyBlock(e)}checkRowCount(e,t){if("number"===typeof t&&t>=0)this.rowCount=t,this.lastRowIndexKnown=!0;else if(!this.lastRowIndexKnown){const t=(e.getId()+1)*this.params.blockSize+this.params.overflowSize;this.rowCount<t&&(this.rowCount=t)}}setRowCount(e,t){this.rowCount=e,F(t)&&(this.lastRowIndexKnown=t),this.lastRowIndexKnown||this.rowCount%this.params.blockSize===0&&this.rowCount++,this.onCacheUpdated()}forEachNodeDeep(e){const t=new or;this.getBlocksInOrder().forEach((i=>i.forEachNode(e,t,this.rowCount)))}getBlocksInOrder(){return it(this.blocks).sort(((e,t)=>e.getId()-t.getId()))}destroyBlock(e){delete this.blocks[e.getId()],this.destroyBean(e),this.blockCount--,this.params.rowNodeBlockLoader.removeBlock(e)}onCacheUpdated(){this.isAlive()&&(this.destroyAllBlocksPastVirtualRowCount(),this.eventService.dispatchEvent({type:"storeUpdated"}))}destroyAllBlocksPastVirtualRowCount(){const e=[];this.getBlocksInOrder().forEach((t=>{t.getId()*this.params.blockSize>=this.rowCount&&e.push(t)})),e.length>0&&e.forEach((e=>this.destroyBlock(e)))}purgeCache(){this.getBlocksInOrder().forEach((e=>this.removeBlockFromCache(e))),this.lastRowIndexKnown=!1,0===this.rowCount&&(this.rowCount=this.params.initialRowCount),this.onCacheUpdated()}getRowNodesInRange(e,t){const i=[];let r=-1,n=!1;const o=new or;let s=!1;this.getBlocksInOrder().forEach((a=>{s||(n&&r+1!==a.getId()?s=!0:(r=a.getId(),a.forEachNode((r=>{const o=r===e||r===t;(n||o)&&i.push(r),o&&(n=!n)}),o,this.rowCount)))}));return s||n?[]:i}};var gu="32.3.3",pu={version:gu,moduleName:"@ag-grid-community/infinite-row-model".concat("-core"),rowModel:"infinite",beans:[class extends He{constructor(){super(...arguments),this.beanName="rowModel"}wireBeans(e){this.filterManager=e.filterManager,this.sortController=e.sortController,this.selectionService=e.selectionService,this.rowRenderer=e.rowRenderer,this.rowNodeBlockLoader=e.rowNodeBlockLoader}getRowBounds(e){return{rowHeight:this.rowHeight,rowTop:this.rowHeight*e}}ensureRowHeightsValid(){return!1}postConstruct(){"infinite"===this.gos.get("rowModelType")&&(this.rowHeight=j(this.gos),this.addEventListeners(),this.addDestroyFunc((()=>this.destroyCache())),this.verifyProps())}verifyProps(){this.gos.exists("initialGroupOrderComparator")&&v("initialGroupOrderComparator cannot be used with Infinite Row Model as sorting is done on the server side")}start(){this.setDatasource(this.gos.get("datasource"))}destroy(){this.destroyDatasource(),super.destroy()}destroyDatasource(){this.datasource&&(this.destroyBean(this.datasource),this.rowRenderer.datasourceChanged(),this.datasource=null)}addEventListeners(){this.addManagedEventListeners({filterChanged:this.onFilterChanged.bind(this),sortChanged:this.onSortChanged.bind(this),newColumnsLoaded:this.onColumnEverything.bind(this),storeUpdated:this.onCacheUpdated.bind(this)}),this.addManagedPropertyListener("datasource",(()=>this.setDatasource(this.gos.get("datasource")))),this.addManagedPropertyListener("cacheBlockSize",(()=>this.resetCache())),this.addManagedPropertyListener("rowHeight",(()=>{this.rowHeight=j(this.gos),this.cacheParams.rowHeight=this.rowHeight,this.updateRowHeights()}))}onFilterChanged(){this.reset()}onSortChanged(){this.reset()}onColumnEverything(){let e;e=!this.cacheParams||this.isSortModelDifferent(),e&&this.reset()}isSortModelDifferent(){return!L(this.cacheParams.sortModel,this.sortController.getSortModel())}getType(){return"infinite"}setDatasource(e){this.destroyDatasource(),this.datasource=e,e&&this.reset()}isEmpty(){return!this.infiniteCache}isRowsToRender(){return!!this.infiniteCache}getNodesInRangeForSelection(e,t){return this.infiniteCache?this.infiniteCache.getRowNodesInRange(e,t):[]}reset(){if(!this.datasource)return;null!=ce(this.gos)||this.selectionService.reset("rowDataChanged"),this.resetCache()}dispatchModelUpdatedEvent(){this.eventService.dispatchEvent({type:"modelUpdated",newPage:!1,newPageSize:!1,newData:!1,keepRenderedRows:!0,animate:!1})}resetCache(){var e,t;this.destroyCache(),this.cacheParams={datasource:this.datasource,filterModel:null!==(e=null===(t=this.filterManager)||void 0===t?void 0:t.getFilterModel())&&void 0!==e?e:{},sortModel:this.sortController.getSortModel(),rowNodeBlockLoader:this.rowNodeBlockLoader,initialRowCount:this.gos.get("infiniteInitialRowCount"),maxBlocksInCache:this.gos.get("maxBlocksInCache"),rowHeight:j(this.gos),overflowSize:this.gos.get("cacheOverflowSize"),blockSize:this.gos.get("cacheBlockSize"),lastAccessedSequence:new or},this.infiniteCache=this.createBean(new hu(this.cacheParams)),this.eventService.dispatchEventOnce({type:"rowCountReady"}),this.dispatchModelUpdatedEvent()}updateRowHeights(){this.forEachNode((e=>{e.setRowHeight(this.rowHeight),e.setRowTop(this.rowHeight*e.rowIndex)})),this.dispatchModelUpdatedEvent()}destroyCache(){this.infiniteCache&&(this.infiniteCache=this.destroyBean(this.infiniteCache))}onCacheUpdated(){this.dispatchModelUpdatedEvent()}getRow(e){if(this.infiniteCache&&!(e>=this.infiniteCache.getRowCount()))return this.infiniteCache.getRow(e)}getRowNode(e){let t;return this.forEachNode((i=>{i.id===e&&(t=i)})),t}forEachNode(e){this.infiniteCache&&this.infiniteCache.forEachNodeDeep(e)}getTopLevelRowCount(){return this.getRowCount()}getTopLevelRowDisplayedIndex(e){return e}getRowIndexAtPixel(e){if(0!==this.rowHeight){const t=Math.floor(e/this.rowHeight),i=this.getRowCount()-1;return t>i?i:t}return 0}getRowCount(){return this.infiniteCache?this.infiniteCache.getRowCount():0}isRowPresent(e){return!!this.getRowNode(e.id)}refreshCache(){this.infiniteCache&&this.infiniteCache.refreshCache()}purgeCache(){this.infiniteCache&&this.infiniteCache.purgeCache()}isLastRowIndexKnown(){return!!this.infiniteCache&&this.infiniteCache.isLastRowIndexKnown()}setRowCount(e,t){this.infiniteCache&&this.infiniteCache.setRowCount(e,t)}}],dependantModules:[za]},fu={version:gu,moduleName:"@ag-grid-community/infinite-row-model",dependantModules:[pu,{version:gu,moduleName:"@ag-grid-community/infinite-row-model".concat("-api"),beans:[Gc],apiFunctions:{refreshInfiniteCache:function(e){var t;null===(t=e.rowModelHelperService)||void 0===t||null===(t=t.getInfiniteRowModel())||void 0===t||t.refreshCache()},purgeInfiniteCache:function(e){var t;null===(t=e.rowModelHelperService)||void 0===t||null===(t=t.getInfiniteRowModel())||void 0===t||t.purgeCache()},getInfiniteRowCount:function(e){var t;return null===(t=e.rowModelHelperService)||void 0===t||null===(t=t.getInfiniteRowModel())||void 0===t?void 0:t.getRowCount()}},dependantModules:[pu,zc]}]},mu=(e,t)=>new wu(e.feature,t,e.defaults,e.css),vu=0,Cu=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"customPart".concat(++vu);return new wu(e,t)},wu=class e{constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];this.feature=e,this.variant=t,this.defaults=i,this.css=r}get id(){return this.feature?"".concat(this.feature,"/").concat(this.variant):this.variant}withParams(t){const i=c({},this.defaults);for(const[e,r]of Object.entries(t))null!=r&&(i[e]=r);return new e(this.feature,this.variant,i,this.css)}withAdditionalParams(e){return this.withParams(e)}withCSS(t){return new e(this.feature,this.variant,this.defaults,this.css.concat(t))}},bu=':where([class^=ag-]){box-sizing:border-box;outline:none;&:after,&:before,&:focus,&:focus-within{box-sizing:border-box;outline:none}&:where(button){background:none;border:none;color:inherit;cursor:pointer;font-family:inherit;font-size:inherit;line-height:inherit;margin:0;padding:0}&:where(button){font-weight:inherit}&::-ms-clear{display:none}}.ag-aria-description-container{border:0;z-index:9999;clip:rect(1px,1px,1px,1px);height:1px;overflow:hidden;padding:0;position:absolute;white-space:nowrap;width:1px}.ag-hidden{display:none!important}.ag-invisible{visibility:hidden!important}.ag-unselectable{-webkit-user-select:none;-moz-user-select:none;user-select:none}.ag-selectable{-webkit-user-select:text;-moz-user-select:text;user-select:text}.ag-tab-guard{display:block;height:0;position:absolute;width:0}.ag-virtual-list-viewport .ag-tab-guard{position:sticky}.ag-tab-guard-top{top:1px}.ag-tab-guard-bottom{bottom:1px}.ag-shake-left-to-right{animation-direction:alternate;animation-duration:.2s;animation-iteration-count:infinite;animation-name:ag-shake-left-to-right}@keyframes ag-shake-left-to-right{0%{padding-left:6px;padding-right:2px}to{padding-left:2px;padding-right:6px}}.ag-watermark{bottom:20px;color:#9b9b9b;opacity:.7;position:absolute;right:25px;transition:opacity 1s ease-out 3s;&:before{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMDkiIGhlaWdodD0iMzYiIGZpbGw9Im5vbmUiIHZpZXdCb3g9IjAgMCAyMDkgMzYiPjxwYXRoIGZpbGw9IiM5QjlCOUIiIGQ9Ik0xOTIuOTkzIDIzLjY1OHYtNy45NDZoLTEzLjU0MWwtNy45NDcgNy45NDZ6TTIwOC4yNSAzLjk1aC0xNi45NzRsLTguMDEgNy45NDdoMjQuOTg0ek0xNjMuNjIyIDMxLjYwNWw0LjA2OS00LjA2OWgxMy43MzJ2Ny45NDdoLTE3LjgwMXoiLz48cGF0aCBmaWxsPSIjOUI5QjlCIiBkPSJNMTY2LjYxIDE5Ljc4aDguNzczbDguMDEtNy45NDZIMTY2LjYxek0xNTcuMDExIDMxLjYwNWg2LjYxMWw3Ljg4My03Ljk0N2gtMTQuNDk0ek0xOTEuMjc2IDMuOTVsLTQuMDY4IDQuMDdIMTYxLjI3Vi4wNzJoMzAuMDA2ek0yMC44NCAzMC4yMDZIOC4zNzhsLTIuMTYyIDUuMzRILjc1TDEyLjI1NyA4LjU5Mmg0Ljc2OEwyOC41MyAzNS41NDZoLTUuNTN6bS0xLjcxNy00LjI2TDE0LjYwOSAxNC45NWwtNC41MTQgMTAuOTk4ek0xMDQuNDM3IDE4LjUwOWMxLjU4OS0yLjM1MiA1LjU5NC0yLjYwNyA3LjI0Ny0yLjYwN3Y0LjU3OGMtMi4wMzQgMC00LjA2OS4wNjMtNS4yNzcuOTUzLTEuMjA3Ljg5LTEuODQzIDIuMDk4LTEuODQzIDMuNTZ2MTAuNTUzaC00Ljk1OVYxNS45MDJoNC43Njh6TTExOS4zNzYgMTUuOTAyaC00Ljk1OHYxOS42NDRoNC45NTh6TTExOS4zNzYgNy4xM2gtNC45NTh2NS44NDhoNC45NTh6TTE0My45NzkgNy4xM3YyOC40MTZoLTQuNzY4bC0uMTI3LTIuOTg4YTguMyA4LjMgMCAwIDEtMi42NyAyLjQ4Yy0xLjA4MS41NzItMi40MTYuODktMy45NDIuODktMS4zMzUgMC0yLjYwNi0uMjU1LTMuNjg3LS43LTEuMTQ0LS41MDgtMi4xNjItMS4xNDQtMi45ODgtMi4wMzRhOS42IDkuNiAwIDAgMS0xLjk3MS0zLjE3OWMtLjUwOC0xLjIwNy0uNjk5LTIuNjA2LS42OTktNC4xMzJzLjI1NC0yLjkyNC42OTktNC4xOTZjLjUwOS0xLjI3MSAxLjE0NS0yLjM1MiAxLjk3MS0zLjI0MnMxLjg0NC0xLjU4OSAyLjk4OC0yLjA5OCAyLjM1Mi0uNzYzIDMuNjg3LS43NjNjMS41MjYgMCAyLjc5Ny4yNTUgMy44NzguODI3czEuOTcxIDEuMzM1IDIuNjcgMi40MTZWNy4xOTNoNC45NTl6bS0xMC40MjYgMjQuNTM4YzEuNjUzIDAgMi45MjQtLjU3MiAzLjk0MS0xLjY1M3MxLjUyNi0yLjU0MyAxLjUyNi00LjMyMy0uNTA5LTMuMTc4LTEuNTI2LTQuMzIyYy0xLjAxNy0xLjA4MS0yLjI4OC0xLjY1My0zLjk0MS0xLjY1My0xLjU5IDAtMi45MjUuNTcyLTMuODc4IDEuNjUzLTEuMDE3IDEuMDgtMS41MjYgMi41NDMtMS41MjYgNC4zMjIgMCAxLjc4LjUwOSAzLjE4IDEuNTI2IDQuMjYgMS4wMTcgMS4xNDQgMi4yODggMS43MTYgMy44NzggMS43MTZNNTcuMjAyIDIwLjM1M0g0NC45MzN2NC4yNTloNi45OTNjLS4xOSAyLjE2MS0xLjAxNyAzLjgxNC0yLjQxNiA1LjE1LTEuMzk4IDEuMjctMy4xNzggMS45MDYtNS40NjcgMS45MDYtMS4yNzEgMC0yLjQ4LS4yNTQtMy40OTYtLjY5OWE3IDcgMCAwIDEtMi43MzQtMS45N2MtLjc2My0uODI3LTEuMzM1LTEuODQ0LTEuNzgtMy4wNTJzLS42MzYtMi40OC0uNjM2LTMuOTQyLjE5LTIuNzMzLjYzNi0zLjk0MWMuMzgxLTEuMjA4IDEuMDE3LTIuMTYyIDEuNzgtMy4wNTIuNzYzLS44MjYgMS42NTMtMS40NjIgMi43MzMtMS45N2E5LjEgOS4xIDAgMCAxIDMuNTYtLjdxNC4wMDUgMCA2LjEwMyAxLjkwN2wzLjMwNi0zLjMwNWMtMi40OC0xLjkwNy01LjY1OC0yLjkyNS05LjQwOS0yLjkyNS0yLjA5NyAwLTQuMDA0LjMxOC01LjcyMSAxLjAxOC0xLjcxNi42OTktMy4xNzkgMS41ODktNC4zODYgMi43OTdBMTIuMSAxMi4xIDAgMCAwIDMxLjIgMTYuMjJjLS42MzUgMS43MTctLjk1MyAzLjYyNC0uOTUzIDUuNjU4cy4zMTggMy45NDIgMS4wMTcgNS42NThjLjcgMS43MTcgMS41OSAzLjE3OSAyLjc5NyA0LjM4N2ExMi4xIDEyLjEgMCAwIDAgNC4zODcgMi43OTdjMS43MTYuNyAzLjYyMyAxLjAxNyA1LjY1NyAxLjAxNyAyLjAzNSAwIDMuODc4LS4zMTggNS41MzEtMS4wMTcgMS42NTMtLjcgMy4wNTItMS41OSA0LjE5Ni0yLjc5N3ExLjcxNi0xLjgxMiAyLjY3LTQuMzg3Yy42MzYtMS43MTYuOTU0LTMuNjIzLjk1NC01LjY1OHYtLjgyNmMtLjE5MS0uMTI3LS4yNTUtLjQ0NS0uMjU1LS43TTk1Ljk4MiAyMC4zNTNoLTEyLjI3djQuMjU5aDYuOTkzYy0uMTkgMi4xNjEtMS4wMTcgMy44MTQtMi40MTYgNS4xNS0xLjM5OCAxLjI3LTMuMTc4IDEuOTA2LTUuNDY3IDEuOTA2LTEuMjcxIDAtMi40OC0uMjU0LTMuNDk2LS42OTlhNyA3IDAgMCAxLTIuNzM0LTEuOTdjLS43NjMtLjgyNy0xLjMzNS0xLjg0NC0xLjc4LTMuMDUycy0uNjM2LTIuNDgtLjYzNi0zLjk0Mi4xOS0yLjczMy42MzYtMy45NDFjLjM4MS0xLjIwOCAxLjAxNy0yLjE2MiAxLjc4LTMuMDUyLjc2My0uODI2IDEuNjUzLTEuNDYyIDIuNzM0LTEuOTdhOS4xIDkuMSAwIDAgMSAzLjU2LS43cTQuMDA1IDAgNi4xMDMgMS45MDdsMy4zMDUtMy4zMDVjLTIuNDc5LTEuOTA3LTUuNjU4LTIuOTI1LTkuNDA4LTIuOTI1LTIuMDk4IDAtNC4wMDUuMzE4LTUuNzIyIDEuMDE4LTEuNzE2LjY5OS0zLjE3OCAxLjU4OS00LjM4NiAyLjc5N2ExMi4xIDEyLjEgMCAwIDAtMi43OTcgNC4zODZjLS42MzYgMS43MTctLjk1NCAzLjYyNC0uOTU0IDUuNjU4cy4zMTggMy45NDIgMS4wMTcgNS42NThjLjcgMS43MTcgMS41OSAzLjE3OSAyLjc5NyA0LjM4N2ExMi4xIDEyLjEgMCAwIDAgNC4zODcgMi43OTdjMS43MTYuNyAzLjYyMyAxLjAxNyA1LjY1OCAxLjAxNyAyLjAzNCAwIDMuODc4LS4zMTggNS41My0xLjAxNyAxLjY1My0uNyAzLjA1Mi0xLjU5IDQuMTk2LTIuNzk3cTEuNzE4LTEuODEyIDIuNjctNC4zODdjLjYzNi0xLjcxNi45NTQtMy42MjMuOTU0LTUuNjU4di0uODI2Yy0uMTktLjEyNy0uMjU1LS40NDUtLjI1NS0uNyIvPjwvc3ZnPg==);background-repeat:no-repeat;background-size:170px 40px;content:"";display:block;height:40px;width:170px}}.ag-watermark-text{font-family:Impact,sans-serif;font-size:19px;font-weight:700;opacity:.5}.ag-ltr .ag-watermark-text{padding-left:.7rem}.ag-rtl .ag-watermark-text{padding-right:.7rem}.ag-body-horizontal-scroll-viewport,.ag-body-vertical-scroll-viewport,.ag-body-viewport,.ag-center-cols-viewport,.ag-floating-bottom-viewport,.ag-floating-top-viewport,.ag-header-viewport,.ag-sticky-bottom-viewport,.ag-sticky-top-viewport,.ag-virtual-list-viewport{flex:1 1 auto;height:100%;min-width:0;overflow:hidden;position:relative}.ag-body-viewport,.ag-center-cols-viewport,.ag-floating-bottom-viewport,.ag-floating-top-viewport,.ag-header-viewport,.ag-sticky-bottom-viewport,.ag-sticky-top-viewport{overflow-x:auto;-ms-overflow-style:none!important;scrollbar-width:none!important;&::-webkit-scrollbar{display:none!important}}.ag-body-viewport{display:flex;overflow-x:hidden;&.ag-layout-normal{overflow-y:auto;-webkit-overflow-scrolling:touch}}.ag-sticky-bottom-container,.ag-sticky-top-container{min-height:1px}.ag-center-cols-viewport{min-height:100%;width:100%}.ag-body-horizontal-scroll-viewport{overflow-x:scroll}.ag-body-vertical-scroll-viewport{overflow-y:scroll}.ag-virtual-list-viewport{overflow:auto;width:100%}.ag-body-container,.ag-body-horizontal-scroll-container,.ag-body-vertical-scroll-container,.ag-center-cols-container,.ag-floating-bottom-container,.ag-floating-bottom-full-width-container,.ag-floating-top-container,.ag-full-width-container,.ag-header-container,.ag-pinned-left-cols-container,.ag-pinned-right-cols-container,.ag-sticky-bottom-container,.ag-sticky-top-container,.ag-virtual-list-container{position:relative}.ag-floating-bottom-container,.ag-floating-top-container,.ag-header-container,.ag-sticky-bottom-container,.ag-sticky-top-container{height:100%;white-space:nowrap}.ag-center-cols-container,.ag-pinned-right-cols-container{display:block}.ag-body-horizontal-scroll-container{height:100%}.ag-body-vertical-scroll-container{width:100%}.ag-floating-bottom-full-width-container,.ag-floating-top-full-width-container,.ag-full-width-container,.ag-sticky-bottom-full-width-container,.ag-sticky-top-full-width-container{pointer-events:none;position:absolute;top:0}.ag-ltr .ag-floating-bottom-full-width-container,.ag-ltr .ag-floating-top-full-width-container,.ag-ltr .ag-full-width-container,.ag-ltr .ag-sticky-bottom-full-width-container,.ag-ltr .ag-sticky-top-full-width-container{left:0}.ag-rtl .ag-floating-bottom-full-width-container,.ag-rtl .ag-floating-top-full-width-container,.ag-rtl .ag-full-width-container,.ag-rtl .ag-sticky-bottom-full-width-container,.ag-rtl .ag-sticky-top-full-width-container{right:0}.ag-full-width-container{width:100%}.ag-floating-bottom-full-width-container,.ag-floating-top-full-width-container{display:inline-block;height:100%;overflow:hidden;width:100%}.ag-virtual-list-container{overflow:hidden}.ag-body{display:flex;flex:1 1 auto;flex-direction:row!important;min-height:0;position:relative}.ag-body-horizontal-scroll,.ag-body-vertical-scroll{display:flex;min-height:0;min-width:0;position:relative;&.ag-scrollbar-invisible{bottom:0;position:absolute;&.ag-apple-scrollbar{opacity:0;transition:opacity .4s;visibility:hidden;&.ag-scrollbar-active,&.ag-scrollbar-scrolling{opacity:1;visibility:visible}}}}.ag-body-horizontal-scroll{width:100%;&.ag-scrollbar-invisible{left:0;right:0}}.ag-body-vertical-scroll{height:100%;&.ag-scrollbar-invisible{top:0;z-index:10}}.ag-ltr .ag-body-vertical-scroll{&.ag-scrollbar-invisible{right:0}}.ag-rtl .ag-body-vertical-scroll{&.ag-scrollbar-invisible{left:0}}.ag-force-vertical-scroll{overflow-y:scroll!important}.ag-horizontal-left-spacer,.ag-horizontal-right-spacer{height:100%;min-width:0;overflow-x:scroll;&.ag-scroller-corner{overflow-x:hidden}}.ag-ltr .ag-column-moving{.ag-cell,.ag-header-cell{transition:left .2s}.ag-header-group-cell{transition:left .2s,width .2s}}.ag-rtl .ag-column-moving{.ag-cell,.ag-header-cell{transition:right .2s}.ag-header-group-cell{transition:right .2s,width .2s}}.ag-row-animation .ag-row{transition:transform .4s,top .4s,opacity .2s}.ag-row-animation .ag-row.ag-after-created{transition:transform .4s,top .4s,height .4s,opacity .2s}.ag-row-no-animation .ag-row{transition:none}.ag-row-loading{align-items:center;display:flex}.ag-row-position-absolute{position:absolute}.ag-row-position-relative{position:relative}.ag-full-width-row{overflow:hidden;pointer-events:all}.ag-row-inline-editing{z-index:1}.ag-row-dragging{z-index:2}.ag-stub-cell{align-items:center;display:flex}.ag-cell{display:inline-block;height:100%;position:absolute;white-space:nowrap}.ag-cell-value{flex:1 1 auto}.ag-cell-value,.ag-group-value{overflow:hidden;text-overflow:ellipsis}.ag-cell-wrap-text{white-space:normal;word-break:break-word}.ag-sparkline-wrapper{height:100%;left:0;position:absolute;top:0;width:100%}.ag-full-width-row .ag-cell-wrapper.ag-row-group{align-items:center;height:100%}.ag-cell .ag-icon{display:inline-block;vertical-align:middle}.ag-floating-top{border-bottom:var(--ag-pinned-row-border);display:flex;overflow:hidden;position:relative;white-space:nowrap;width:100%}.ag-pinned-left-floating-top,.ag-pinned-right-floating-top{display:inline-block;min-width:0;overflow:hidden;position:relative}.ag-floating-bottom{border-top:var(--ag-pinned-row-border);display:flex;overflow:hidden;position:relative;white-space:nowrap;width:100%}.ag-pinned-left-floating-bottom,.ag-pinned-right-floating-bottom{display:inline-block;min-width:0;overflow:hidden;position:relative}.ag-sticky-bottom,.ag-sticky-top{background-color:var(--ag-background-color);display:flex;height:0;overflow:hidden;position:absolute;width:100%}.ag-pinned-left-sticky-top,.ag-pinned-right-sticky-top{height:100%;overflow:hidden;position:relative}.ag-sticky-bottom-full-width-container,.ag-sticky-top-full-width-container{height:100%;overflow:hidden;width:100%}.ag-value-slide-out{opacity:1}.ag-ltr .ag-value-slide-out{margin-right:5px;transition:opacity 3s,margin-right 3s}.ag-rtl .ag-value-slide-out{margin-left:5px;transition:opacity 3s,margin-left 3s}:is(.ag-ltr,.ag-rtl) .ag-value-slide-out{transition-timing-function:linear}.ag-value-slide-out-end{opacity:0}.ag-ltr .ag-value-slide-out-end{margin-right:10px}.ag-rtl .ag-value-slide-out-end{margin-left:10px}.ag-opacity-zero{opacity:0!important}.ag-details-row{width:100%}.ag-details-row-fixed-height{height:100%}.ag-details-grid{width:100%}.ag-details-grid-fixed-height{height:100%}.ag-cell-label-container{align-items:center;display:flex;flex-direction:row-reverse;height:100%;justify-content:space-between;width:100%}.ag-right-aligned-header{.ag-cell-label-container{flex-direction:row}.ag-header-cell-text{text-align:end}}.ag-column-group-icons{display:block;>*{cursor:pointer}}.ag-pill-select{display:flex;flex-direction:column;.ag-column-drop-list{padding:0}.ag-select{padding-top:var(--ag-spacing)}.ag-picker-field-wrapper{background-color:transparent;border:0}.ag-picker-field-display{cursor:pointer}}.ag-ltr{direction:ltr;.ag-body,.ag-body-horizontal-scroll,.ag-body-viewport,.ag-floating-bottom,.ag-floating-top,.ag-header,.ag-sticky-bottom,.ag-sticky-top{flex-direction:row}}.ag-rtl{direction:rtl;.ag-body,.ag-body-horizontal-scroll,.ag-body-viewport,.ag-floating-bottom,.ag-floating-top,.ag-header,.ag-sticky-bottom,.ag-sticky-top{flex-direction:row-reverse}.ag-icon-contracted,.ag-icon-expanded,.ag-icon-tree-closed{display:block}}.ag-rtl{.ag-icon-contracted,.ag-icon-expanded,.ag-icon-tree-closed{transform:rotate(180deg)}}.ag-rtl{.ag-icon-contracted,.ag-icon-expanded,.ag-icon-tree-closed{transform:rotate(-180deg)}}.ag-measurement-container{overflow:hidden;visibility:hidden;width:0;& div{position:absolute}}.ag-group{position:relative;width:100%}.ag-group-title-bar{align-items:center;display:flex;padding:var(--ag-spacing)}.ag-group-title{display:inline;min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.ag-group-title-bar .ag-group-title{cursor:default}.ag-group-toolbar{align-items:center;display:flex;padding:var(--ag-spacing)}.ag-group-container{display:flex}.ag-disabled .ag-group-container{pointer-events:none}.ag-disabled-group-container,.ag-disabled-group-title-bar{opacity:.5}.ag-group-container-horizontal{flex-direction:row;flex-wrap:wrap}.ag-group-container-vertical{flex-direction:column}.ag-group-title-bar-icon{cursor:pointer;flex:none}.ag-ltr .ag-group-title-bar-icon{margin-right:var(--ag-spacing)}.ag-rtl .ag-group-title-bar-icon{margin-left:var(--ag-spacing)}.ag-group-item-alignment-stretch .ag-group-item{align-items:stretch}.ag-group-item-alignment-start .ag-group-item{align-items:flex-start}.ag-group-item-alignment-end .ag-group-item{align-items:flex-end}.ag-popup-child{top:0;z-index:5;&:where(:not(.ag-tooltip-custom)){box-shadow:var(--ag-popup-shadow)}}.ag-popup-editor{position:absolute;-webkit-user-select:none;-moz-user-select:none;user-select:none}.ag-large-text-input{display:block}.ag-rtl{text-align:right}.ag-ltr .ag-row:not(.ag-row-level-0) .ag-pivot-leaf-group{margin-left:var(--ag-row-group-indent-size)}.ag-rtl .ag-row:not(.ag-row-level-0) .ag-pivot-leaf-group{margin-right:var(--ag-row-group-indent-size)}.ag-ltr .ag-row-group-leaf-indent{margin-left:calc(var(--ag-cell-widget-spacing) + var(--ag-icon-size))}.ag-rtl .ag-row-group-leaf-indent{margin-right:calc(var(--ag-cell-widget-spacing) + var(--ag-icon-size))}.ag-value-change-delta{padding:0 2px}.ag-value-change-delta-up{color:var(--ag-value-change-delta-up-color)}.ag-value-change-delta-down{color:var(--ag-value-change-delta-down-color)}.ag-value-change-value{background-color:transparent;border-radius:1px;padding-left:1px;padding-right:1px;transition:background-color 1s}.ag-value-change-value-highlight{background-color:var(--ag-value-change-value-highlight-background-color);transition:background-color .1s}.ag-cell-data-changed{background-color:var(--ag-value-change-value-highlight-background-color)!important}.ag-cell-data-changed-animation{background-color:transparent}.ag-cell-highlight{background-color:var(--ag-range-selection-highlight-color)!important}.ag-row{background-color:var(--ag-background-color);border-bottom:var(--ag-row-border);color:var(--ag-cell-text-color);font-size:var(--ag-data-font-size);height:var(--ag-row-height);white-space:nowrap;width:100%;--ag-internal-content-line-height:min(calc(var(--ag-row-height) - 1px),var(--ag-line-height,1000px))}:where(.ag-body-vertical-content-no-gap) .ag-row-last{border-bottom-color:transparent}.ag-sticky-bottom{border-top:var(--ag-row-border);box-sizing:content-box!important;display:none}.ag-group-contracted,.ag-group-expanded{cursor:pointer}.ag-cell,.ag-full-width-row .ag-cell-wrapper.ag-row-group{border:1px solid transparent;line-height:var(--ag-internal-content-line-height)}.ag-ltr .ag-cell{border-right:var(--ag-column-border)}.ag-rtl .ag-cell{border-left:var(--ag-column-border)}.ag-ltr :where(.ag-body-horizontal-content-no-gap) .ag-column-last{border-right-color:transparent}.ag-rtl :where(.ag-body-horizontal-content-no-gap) .ag-column-last{border-left-color:transparent}.ag-cell-wrapper{align-items:center;display:flex;&.ag-row-group{align-items:flex-start}>:not(.ag-cell-value):not(.ag-group-value){align-items:center;display:flex;height:var(--ag-internal-content-line-height)}}.ag-ltr .ag-cell-wrapper{padding-left:calc(var(--ag-indentation-level)*var(--ag-row-group-indent-size))}.ag-rtl .ag-cell-wrapper{padding-right:calc(var(--ag-indentation-level)*var(--ag-row-group-indent-size))}.ag-ltr .ag-row>.ag-cell-wrapper.ag-row-group{padding-left:calc(var(--ag-cell-horizontal-padding) + var(--ag-row-group-indent-size)*var(--ag-indentation-level))}.ag-rtl .ag-row>.ag-cell-wrapper.ag-row-group{padding-right:calc(var(--ag-cell-horizontal-padding) + var(--ag-row-group-indent-size)*var(--ag-indentation-level))}.ag-ltr .ag-group-contracted,.ag-ltr .ag-group-expanded,.ag-ltr .ag-row-drag,.ag-ltr .ag-selection-checkbox{margin-right:var(--ag-cell-widget-spacing)}.ag-rtl .ag-group-contracted,.ag-rtl .ag-group-expanded,.ag-rtl .ag-row-drag,.ag-rtl .ag-selection-checkbox{margin-left:var(--ag-cell-widget-spacing)}.ag-ltr .ag-group-child-count{margin-left:3px}.ag-rtl .ag-group-child-count{margin-right:3px}.ag-row-highlight-above:after,.ag-row-highlight-below:after{background-color:var(--ag-range-selection-border-color);content:"";height:1px;position:absolute;width:calc(100% - 1px)}.ag-ltr .ag-row-highlight-above:after,.ag-ltr .ag-row-highlight-below:after{left:1px}.ag-rtl .ag-row-highlight-above:after,.ag-rtl .ag-row-highlight-below:after{right:1px}.ag-row-highlight-above:after{top:-1px}.ag-row-highlight-above.ag-row-first:after{top:0}.ag-row-highlight-below:after{bottom:0}.ag-row-odd{background-color:var(--ag-odd-row-background-color)}.ag-row-selected:before{background-color:var(--ag-selected-row-background-color);content:"";display:block;inset:0;pointer-events:none;position:absolute}.ag-row-hover.ag-full-width-row.ag-row-group:before,.ag-row-hover:not(.ag-full-width-row):before{background-color:var(--ag-row-hover-color);content:"";display:block;inset:0;pointer-events:none;position:absolute}.ag-row-hover.ag-row-selected:before{background-color:var(--ag-row-hover-color);background-image:linear-gradient(var(--ag-selected-row-background-color),var(--ag-selected-row-background-color))}.ag-row-hover.ag-full-width-row.ag-row-group>*{position:relative}.ag-column-hover{background-color:var(--ag-column-hover-color)}.ag-right-aligned-cell{font-variant-numeric:tabular-nums}.ag-ltr .ag-right-aligned-cell{text-align:right}.ag-rtl .ag-right-aligned-cell{text-align:left}.ag-right-aligned-cell .ag-cell-value,.ag-right-aligned-cell .ag-group-value{margin-left:auto}.ag-cell:not(.ag-cell-inline-editing),.ag-full-width-row .ag-cell-wrapper.ag-row-group{-webkit-font-smoothing:subpixel-antialiased}.ag-ltr .ag-cell:not(.ag-cell-inline-editing),.ag-ltr .ag-full-width-row .ag-cell-wrapper.ag-row-group{padding-left:calc(var(--ag-cell-horizontal-padding) - 1px + var(--ag-row-group-indent-size)*var(--ag-indentation-level));padding-right:calc(var(--ag-cell-horizontal-padding) - 1px)}.ag-rtl .ag-cell:not(.ag-cell-inline-editing),.ag-rtl .ag-full-width-row .ag-cell-wrapper.ag-row-group{padding-left:calc(var(--ag-cell-horizontal-padding) - 1px);padding-right:calc(var(--ag-cell-horizontal-padding) - 1px + var(--ag-row-group-indent-size)*var(--ag-indentation-level))}.ag-row>.ag-cell-wrapper{padding-left:calc(var(--ag-cell-horizontal-padding) - 1px);padding-right:calc(var(--ag-cell-horizontal-padding) - 1px)}.ag-row-dragging{cursor:move;opacity:.5}.ag-details-row{background-color:var(--ag-background-color);padding:calc(var(--ag-spacing)*3.5)}.ag-layout-auto-height,.ag-layout-print{.ag-center-cols-container,.ag-center-cols-viewport{min-height:150px}}.ag-overlay-loading-wrapper{background-color:var(--ag-modal-overlay-background-color)}.ag-skeleton-container{align-content:center;height:100%;width:100%}.ag-skeleton-effect{animation:ag-skeleton-loading 1.5s ease-in-out .5s infinite;background-color:var(--ag-row-loading-skeleton-effect-color);border-radius:.25rem;height:1em;width:100%}.ag-ltr .ag-right-aligned-cell .ag-skeleton-effect{margin-left:auto}.ag-rtl .ag-right-aligned-cell .ag-skeleton-effect{margin-right:auto}@keyframes ag-skeleton-loading{0%{opacity:1}50%{opacity:.4}to{opacity:1}}.ag-loading{align-items:center;display:flex;height:100%}.ag-ltr .ag-loading{padding-left:var(--ag-cell-horizontal-padding)}.ag-rtl .ag-loading{padding-right:var(--ag-cell-horizontal-padding)}.ag-ltr .ag-loading-icon{padding-right:var(--ag-cell-widget-spacing)}.ag-rtl .ag-loading-icon{padding-left:var(--ag-cell-widget-spacing)}.ag-icon-loading{animation-duration:1s;animation-iteration-count:infinite;animation-name:spin;animation-timing-function:linear}@keyframes spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.ag-details-row{padding:calc(var(--ag-spacing)*3.75)}.ag-pinned-left-header,.ag-pinned-right-header{display:inline-block;overflow:hidden;position:relative}.ag-body-horizontal-scroll:not(.ag-scrollbar-invisible){.ag-horizontal-left-spacer:not(.ag-scroller-corner){border-right:var(--ag-pinned-column-border)}.ag-horizontal-right-spacer:not(.ag-scroller-corner){border-left:var(--ag-pinned-column-border)}}.ag-pinned-right-header{border-left:var(--ag-pinned-column-border)}.ag-pinned-left-header{border-right:var(--ag-pinned-column-border)}.ag-cell.ag-cell-first-right-pinned:not(.ag-cell-range-left):not(.ag-cell-range-single-cell){border-left:var(--ag-pinned-column-border)}.ag-cell.ag-cell-last-left-pinned:not(.ag-cell-range-right):not(.ag-cell-range-single-cell){border-right:var(--ag-pinned-column-border)}.ag-pinned-left-header .ag-header-cell-resize:after{left:calc(50% - var(--ag-header-column-resize-handle-width))}.ag-pinned-right-header .ag-header-cell-resize:after{left:50%}.ag-pinned-left-header,.ag-pinned-right-header{height:100%}.ag-pinned-left-header .ag-header-cell-resize{right:-3px}.ag-pinned-right-header .ag-header-cell-resize{left:-3px}.ag-body-viewport:not(.ag-has-focus) .ag-cell-range-single-cell:not(.ag-cell-inline-editing),.ag-cell-range-selected:not(.ag-cell-focus){background-color:var(--ag-range-selection-background-color);&.ag-cell-range-chart{background-color:var(--ag-range-selection-chart-background-color)!important;&.ag-cell-range-chart-category{background-color:var(--ag-range-selection-chart-category-background-color)!important}}}.ag-cell-range-selected-1:not(.ag-cell-focus),.ag-root:not(.ag-context-menu-open) .ag-body-viewport:not(.ag-has-focus) .ag-cell-range-selected-1:not(.ag-cell-inline-editing){background-color:var(--ag-range-selection-background-color)}.ag-cell-range-selected-2:not(.ag-cell-focus){background-image:linear-gradient(var(--ag-range-selection-background-color),var(--ag-range-selection-background-color))}.ag-cell-range-selected-3:not(.ag-cell-focus){background-image:linear-gradient(var(--ag-range-selection-background-color),var(--ag-range-selection-background-color)),linear-gradient(var(--ag-range-selection-background-color),var(--ag-range-selection-background-color))}.ag-cell-range-selected-4:not(.ag-cell-focus){background-image:linear-gradient(var(--ag-range-selection-background-color),var(--ag-range-selection-background-color)),linear-gradient(var(--ag-range-selection-background-color),var(--ag-range-selection-background-color)),linear-gradient(var(--ag-range-selection-background-color),var(--ag-range-selection-background-color))}.ag-cell.ag-cell-range-selected:not(.ag-cell-range-single-cell){&.ag-cell-range-top{border-top-color:var(--ag-range-selection-border-color);border-top-style:var(--ag-range-selection-border-style)}&.ag-cell-range-right{border-right-color:var(--ag-range-selection-border-color);border-right-style:var(--ag-range-selection-border-style)}&.ag-cell-range-bottom{border-bottom-color:var(--ag-range-selection-border-color);border-bottom-style:var(--ag-range-selection-border-style)}&.ag-cell-range-left{border-left-color:var(--ag-range-selection-border-color);border-left-style:var(--ag-range-selection-border-style)}}.ag-ltr,.ag-rtl{.ag-cell-focus:not(.ag-cell-range-selected):focus-within,.ag-cell-range-single-cell,.ag-cell-range-single-cell.ag-cell-range-handle,.ag-context-menu-open .ag-cell-focus:not(.ag-cell-range-selected),.ag-full-width-row.ag-row-focus:focus .ag-cell-wrapper.ag-row-group{border:1px solid;border-color:var(--ag-range-selection-border-color);border-style:var(--ag-range-selection-border-style);outline:initial}}.ag-cell.ag-selection-fill-top,.ag-cell.ag-selection-fill-top.ag-cell-range-selected{border-top:1px dashed;border-top-color:var(--ag-range-selection-border-color)}.ag-ltr .ag-cell.ag-selection-fill-right,.ag-ltr .ag-cell.ag-selection-fill-right.ag-cell-range-selected{border-right:1px dashed var(--ag-range-selection-border-color)!important}.ag-rtl .ag-cell.ag-selection-fill-right,.ag-rtl .ag-cell.ag-selection-fill-right.ag-cell-range-selected{border-left:1px dashed var(--ag-range-selection-border-color)!important}.ag-cell.ag-selection-fill-bottom,.ag-cell.ag-selection-fill-bottom.ag-cell-range-selected{border-bottom:1px dashed;border-bottom-color:var(--ag-range-selection-border-color)}.ag-ltr .ag-cell.ag-selection-fill-left,.ag-ltr .ag-cell.ag-selection-fill-left.ag-cell-range-selected{border-left:1px dashed var(--ag-range-selection-border-color)!important}.ag-rtl .ag-cell.ag-selection-fill-left,.ag-rtl .ag-cell.ag-selection-fill-left.ag-cell-range-selected{border-right:1px dashed var(--ag-range-selection-border-color)!important}.ag-fill-handle,.ag-range-handle{background-color:var(--ag-range-selection-border-color);bottom:-1px;height:6px;position:absolute;width:6px}.ag-ltr .ag-fill-handle,.ag-ltr .ag-range-handle{right:-1px}.ag-rtl .ag-fill-handle,.ag-rtl .ag-range-handle{left:-1px}.ag-fill-handle{cursor:cell}.ag-ltr .ag-range-handle{cursor:nwse-resize}.ag-rtl .ag-range-handle{cursor:nesw-resize}.ag-cell-inline-editing{border:var(--ag-input-focus-border)!important}.ag-input-wrapper,.ag-picker-field-wrapper{align-items:center;display:flex;flex:1 1 auto;line-height:normal;position:relative}.ag-input-field{align-items:center;display:flex;flex-direction:row}.ag-input-field-input{flex:1 1 auto}.ag-floating-filter-input .ag-input-field-input[type=date]{width:1px}.ag-input-field-input{min-width:0;width:100%}.ag-column-select-header-filter-wrapper,.ag-filter-filter,.ag-filter-toolpanel-search,.ag-mini-filter{.ag-input-wrapper:before{background-color:currentColor;content:"";display:block;height:12px;-webkit-mask-image:url("data:image/svg+xml;charset=utf-8;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMiIgaGVpZ2h0PSIxMiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMS41Ij48cGF0aCBkPSJNNS4zIDlhMy43IDMuNyAwIDEgMCAwLTcuNSAzLjcgMy43IDAgMCAwIDAgNy41Wk0xMC41IDEwLjUgOC4zIDguMiIvPjwvc3ZnPg==");mask-image:url("data:image/svg+xml;charset=utf-8;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMiIgaGVpZ2h0PSIxMiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMS41Ij48cGF0aCBkPSJNNS4zIDlhMy43IDMuNyAwIDEgMCAwLTcuNSAzLjcgMy43IDAgMCAwIDAgNy41Wk0xMC41IDEwLjUgOC4zIDguMiIvPjwvc3ZnPg==");-webkit-mask-position:center;mask-position:center;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;opacity:50%;position:absolute;width:12px}}.ag-ltr .ag-column-select-header-filter-wrapper,.ag-ltr .ag-filter-filter,.ag-ltr .ag-filter-toolpanel-search,.ag-ltr .ag-mini-filter{.ag-input-wrapper:before{margin-left:var(--ag-spacing)}& input.ag-number-field-input,& input.ag-text-field-input{padding-left:calc(var(--ag-spacing)*1.5 + 12px)}}.ag-rtl .ag-column-select-header-filter-wrapper,.ag-rtl .ag-filter-filter,.ag-rtl .ag-filter-toolpanel-search,.ag-rtl .ag-mini-filter{.ag-input-wrapper:before{margin-right:var(--ag-spacing)}& input.ag-number-field-input,& input.ag-text-field-input{padding-right:calc(var(--ag-spacing)*1.5 + 12px)}}.ag-advanced-filter-header{align-items:center;background-color:var(--ag-header-background-color);border-bottom:var(--ag-header-row-border);display:flex;padding-left:var(--ag-cell-horizontal-padding);padding-right:var(--ag-cell-horizontal-padding);position:relative}.ag-advanced-filter{align-items:center;display:flex;width:100%}.ag-advanced-filter-apply-button,.ag-advanced-filter-builder-button{line-height:normal;white-space:nowrap}.ag-ltr .ag-advanced-filter-apply-button,.ag-ltr .ag-advanced-filter-builder-button{margin-left:calc(var(--ag-spacing)*2)}.ag-rtl .ag-advanced-filter-apply-button,.ag-rtl .ag-advanced-filter-builder-button{margin-right:calc(var(--ag-spacing)*2)}.ag-advanced-filter-builder-button{align-items:center;background-color:unset;border:0;display:flex;font-size:var(--ag-font-size);font-weight:600;padding:var(--ag-spacing);&:hover:not(:disabled){background-color:var(--ag-row-hover-color)}&:not(:disabled){cursor:pointer}}.ag-ltr .ag-advanced-filter-builder-button-label{margin-left:var(--ag-spacing)}.ag-rtl .ag-advanced-filter-builder-button-label{margin-right:var(--ag-spacing)}.ag-advanced-filter-builder{display:flex;flex-direction:column;-webkit-user-select:none;-moz-user-select:none;user-select:none;width:100%}.ag-advanced-filter-builder-list{flex:1;overflow:auto}.ag-advanced-filter-builder-button-panel{border-top:var(--ag-advanced-filter-builder-button-bar-border);display:flex;justify-content:flex-end;padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding)}.ag-ltr .ag-advanced-filter-builder .ag-advanced-filter-builder-button-panel{.ag-advanced-filter-builder-apply-button,.ag-advanced-filter-builder-cancel-button{margin-left:calc(var(--ag-spacing)*2)}}.ag-rtl .ag-advanced-filter-builder .ag-advanced-filter-builder-button-panel{.ag-advanced-filter-builder-apply-button,.ag-advanced-filter-builder-cancel-button{margin-right:calc(var(--ag-spacing)*2)}}.ag-advanced-filter-builder-item-wrapper{align-items:center;display:flex;flex:1 1 auto;justify-content:space-between;overflow:hidden}.ag-ltr .ag-advanced-filter-builder-item-wrapper{padding-left:calc(var(--ag-icon-size)/2);padding-right:var(--ag-icon-size)}.ag-rtl .ag-advanced-filter-builder-item-wrapper{padding-left:var(--ag-icon-size);padding-right:calc(var(--ag-icon-size)/2)}.ag-virtual-list-viewport .ag-advanced-filter-builder-item-wrapper .ag-tab-guard{position:absolute}.ag-advanced-filter-builder-item-tree-lines>*{width:var(--ag-advanced-filter-builder-indent-size)}.ag-advanced-filter-builder-item-tree-lines .ag-advanced-filter-builder-item-tree-line-root{width:var(--ag-icon-size);&:before{height:50%;top:50%}}.ag-advanced-filter-builder-item-tree-line-horizontal,.ag-advanced-filter-builder-item-tree-line-vertical,.ag-advanced-filter-builder-item-tree-line-vertical-bottom,.ag-advanced-filter-builder-item-tree-line-vertical-top{align-items:center;display:flex;height:100%;position:relative;&:after,&:before{content:"";height:100%;position:absolute}}.ag-advanced-filter-builder-item-tree-line-horizontal:after{border-bottom:1px solid var(--ag-border-color);height:50%;top:0;width:calc(var(--ag-advanced-filter-builder-indent-size) - var(--ag-icon-size))}.ag-ltr .ag-advanced-filter-builder-item-tree-line-horizontal:after{left:calc(var(--ag-icon-size)/2)}.ag-rtl .ag-advanced-filter-builder-item-tree-line-horizontal:after{right:calc(var(--ag-icon-size)/2)}.ag-advanced-filter-builder-item-tree-line-vertical:before{top:0;width:calc(var(--ag-advanced-filter-builder-indent-size) - var(--ag-icon-size)/2)}.ag-ltr .ag-advanced-filter-builder-item-tree-line-vertical:before{border-left:1px solid var(--ag-border-color);left:calc(var(--ag-icon-size)/2)}.ag-rtl .ag-advanced-filter-builder-item-tree-line-vertical:before{border-right:1px solid var(--ag-border-color);right:calc(var(--ag-icon-size)/2)}.ag-advanced-filter-builder-item-tree-line-vertical-top:before{height:50%;top:0;width:calc(var(--ag-advanced-filter-builder-indent-size) - var(--ag-icon-size)/2)}.ag-ltr .ag-advanced-filter-builder-item-tree-line-vertical-top:before{border-left:1px solid var(--ag-border-color);left:calc(var(--ag-icon-size)/2)}.ag-rtl .ag-advanced-filter-builder-item-tree-line-vertical-top:before{border-right:1px solid var(--ag-border-color);right:calc(var(--ag-icon-size)/2)}.ag-advanced-filter-builder-item-tree-line-vertical-bottom:before{height:calc(50% - var(--ag-icon-size)*1.5/2);top:calc(50% + var(--ag-icon-size)*1.5/2);width:calc(var(--ag-icon-size)/2)}.ag-ltr .ag-advanced-filter-builder-item-tree-line-vertical-bottom:before{border-left:1px solid var(--ag-border-color);left:calc(var(--ag-icon-size)/2)}.ag-rtl .ag-advanced-filter-builder-item-tree-line-vertical-bottom:before{border-right:1px solid var(--ag-border-color);right:calc(var(--ag-icon-size)/2)}.ag-advanced-filter-builder-item-condition{padding-bottom:var(--ag-spacing);padding-top:var(--ag-spacing)}.ag-advanced-filter-builder-item,.ag-advanced-filter-builder-item-buttons,.ag-advanced-filter-builder-item-condition,.ag-advanced-filter-builder-item-tree-lines,.ag-advanced-filter-builder-pill,.ag-advanced-filter-builder-pill-wrapper{align-items:center;display:flex;height:100%}.ag-advanced-filter-builder-pill-wrapper{margin:0 var(--ag-spacing)}.ag-advanced-filter-builder-pill{border-radius:var(--ag-border-radius);min-height:calc(100% - var(--ag-spacing)*3);min-width:calc(var(--ag-spacing)*2);padding:var(--ag-spacing) calc(var(--ag-spacing)*2);position:relative;.ag-advanced-filter-builder-value-number{font-family:monospace;font-weight:700}.ag-advanced-filter-builder-value-empty{color:var(--ag-subtle-text-color)}}.ag-ltr .ag-advanced-filter-builder-pill{.ag-picker-field-display{margin-right:var(--ag-spacing)}}.ag-rtl .ag-advanced-filter-builder-pill{.ag-picker-field-display{margin-left:var(--ag-spacing)}}.ag-advanced-filter-builder-item-button,.ag-advanced-filter-builder-pill{&:focus-visible{shadow:var(--ag-focus-shadow)}}.ag-advanced-filter-builder-pill-display{font-weight:500;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.ag-advanced-filter-builder-join-pill{background-color:var(--ag-advanced-filter-builder-join-pill-color);cursor:pointer}.ag-advanced-filter-builder-column-pill{background-color:var(--ag-advanced-filter-builder-column-pill-color);cursor:pointer}.ag-advanced-filter-builder-option-pill{background-color:var(--ag-advanced-filter-builder-option-pill-color);cursor:pointer}.ag-advanced-filter-builder-value-pill{background-color:var(--ag-advanced-filter-builder-value-pill-color);cursor:text;max-width:140px;.ag-advanced-filter-builder-pill-display{display:block}}.ag-advanced-filter-builder-item-buttons>*{margin:0 calc(var(--ag-spacing)*.5)}.ag-advanced-filter-builder-item-button{color:var(--ag-subtle-text-color);cursor:pointer;position:relative}.ag-advanced-filter-builder-item-button-disabled{cursor:default;opacity:.5}.ag-advanced-filter-builder-virtual-list-container{top:var(--ag-spacing)}.ag-advanced-filter-builder-virtual-list-item{cursor:default;display:flex;height:var(--ag-list-item-height);&:hover{background-color:var(--ag-row-hover-color);.ag-advanced-filter-builder-item-button{opacity:100%}}}.ag-advanced-filter-builder-validation .ag-advanced-filter-builder-invalid,.ag-advanced-filter-builder-virtual-list-item-highlight .ag-advanced-filter-builder-item-button:focus-visible{opacity:100%}.ag-advanced-filter-builder-invalid{color:var(--ag-invalid-color);cursor:default;margin:0 var(--ag-spacing)}.ag-cell-inline-editing{border-radius:var(--ag-border-radius);padding:0;z-index:1;.ag-cell-edit-wrapper,.ag-cell-editor,.ag-cell-editor .ag-wrapper,.ag-cell-editor input,.ag-cell-wrapper{height:100%;line-height:normal;width:100%}}.ag-autocomplete-list-popup,.ag-popup-editor .ag-large-text{background-color:var(--ag-background-color);border-radius:var(--ag-border-radius);box-shadow:var(--ag-dropdown-shadow);padding:0}.ag-large-text-input{height:auto;padding:var(--ag-cell-horizontal-padding)}.ag-rtl .ag-large-text-input textarea{resize:none}.ag-checkbox-edit{padding-left:var(--ag-cell-horizontal-padding);padding-right:var(--ag-cell-horizontal-padding)}.ag-chart{display:flex;height:100%;position:relative;width:100%}.ag-chart-components-wrapper{display:flex}.ag-chart-canvas-wrapper,.ag-chart-components-wrapper{flex:1 1 auto;position:relative}.ag-chart-menu{display:flex;flex-direction:column;position:absolute;top:16px}.ag-ltr .ag-chart-menu{right:20px}.ag-rtl .ag-chart-menu{left:20px}.ag-chart-docked-container{min-width:var(--ag-chart-menu-panel-width);position:relative}.ag-chart-menu-hidden~.ag-chart-docked-container{display:none}.ag-chart-tabbed-menu{display:flex;flex-direction:column;height:100%;overflow:hidden;width:100%}.ag-chart-tabbed-menu-header{cursor:default;flex:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.ag-chart-tabbed-menu-body{align-items:stretch;display:flex;flex:1 1 auto;overflow:hidden}.ag-chart-tab{overflow:hidden;overflow-y:auto;width:100%}.ag-chart-settings{overflow-x:hidden}.ag-chart-settings-wrapper{display:flex;flex-direction:column;height:100%;overflow:hidden;position:relative;width:100%}.ag-chart-settings-nav-bar{align-items:center;display:flex;height:30px;padding:0 10px;-webkit-user-select:none;-moz-user-select:none;user-select:none;width:100%}.ag-chart-settings-card-selector{align-items:center;display:flex;flex:1 1 auto;height:100%;justify-content:space-around;padding:0 10px}.ag-chart-settings-card-item{background-color:var(--ag-foreground-color);border-radius:4px;cursor:pointer;height:10px;height:8px;position:relative;width:10px;width:8px;&.ag-not-selected{opacity:.2}&:before{background-color:transparent;content:" ";display:block;height:20px;left:50%;margin-left:-10px;margin-top:-10px;position:absolute;top:50%;width:20px}&.ag-selected{background-color:var(--ag-accent-color)}}.ag-chart-settings-next,.ag-chart-settings-prev{flex:none;position:relative;&:focus-within{border-radius:1px;box-shadow:var(--ag-focus-shadow)}}.ag-chart-settings-next-button,.ag-chart-settings-prev-button{cursor:pointer;height:100%;left:0;opacity:0;position:absolute;top:0;width:100%}.ag-chart-settings-mini-charts-container{flex:1 1 auto;overflow-x:hidden;overflow-y:auto;position:relative}.ag-chart-settings-mini-wrapper{display:flex;flex-direction:column;left:0;min-height:100%;overflow:hidden;position:absolute;top:0;width:100%;&.ag-animating{transition:left .3s;transition-timing-function:ease-in-out}}.ag-chart-mini-thumbnail{cursor:pointer}.ag-chart-mini-thumbnail-canvas{display:block}.ag-chart-advanced-settings-wrapper,.ag-chart-data-wrapper,.ag-chart-format-wrapper{display:flex;flex-direction:column;padding-bottom:16px;position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none}.ag-chart-advanced-settings-wrapper,.ag-chart-data-wrapper{height:100%;overflow-y:auto}.ag-chart-advanced-settings{background-color:var(--ag-chrome-background-color)}.ag-chart-advanced-settings,.ag-chart-advanced-settings-wrapper{width:100%}.ag-chart-advanced-settings-wrapper{padding-bottom:0}.ag-chart-advanced-settings-section,.ag-chart-data-section,.ag-chart-format-section{display:flex;margin:0}.ag-chart-advanced-settings-section{border-bottom:1px solid var(--ag-border-color)}.ag-chart-empty-text{align-items:center;background-color:var(--ag-background-color);display:flex;height:100%;justify-content:center;top:0;width:100%}.ag-chart .ag-chart-menu{display:none}.ag-chart-menu-hidden:hover .ag-chart-menu{display:block}.ag-chart{.ag-chart-menu-wrapper{.ag-chart-menu{display:flex;flex-direction:row;gap:20px;top:8px;width:auto}}}.ag-ltr .ag-chart{.ag-chart-menu-wrapper{.ag-chart-menu{justify-content:right;right:calc(var(--ag-cell-horizontal-padding) + var(--ag-spacing) - 4px)}}}.ag-rtl .ag-chart{.ag-chart-menu-wrapper{.ag-chart-menu{justify-content:left;left:calc(var(--ag-cell-horizontal-padding) + var(--ag-spacing) - 4px)}}}.ag-charts-font-size-color{align-self:stretch;display:flex;justify-content:space-between}.ag-charts-data-group-item{position:relative}.ag-charts-data-group-item:not(:last-child){margin-bottom:var(--ag-spacing)}.ag-chart-menu{background:var(--ag-background-color);border-radius:var(--ag-border-radius)}.ag-chart-menu-icon{border-radius:var(--ag-border-radius);cursor:pointer;margin:2px 0;opacity:.5;opacity:.8;&:hover{opacity:1}}.ag-chart-menu-toolbar-button{background-color:unset;border:0;border-radius:1px;padding:0 2px}.ag-chart-mini-thumbnail{border:1px solid var(--ag-border-color);border-radius:5px;&.ag-selected{border-color:var(--ag-accent-color);border-width:2px}&:focus-visible{border-color:var(--ag-accent-color);box-shadow:var(--ag-focus-shadow)}}.ag-chart-data-column-drag-handle{margin-left:var(--ag-spacing)}.ag-charts-data-group-title-bar,.ag-charts-format-top-level-group-title-bar,.ag-charts-settings-group-title-bar{position:relative}.ag-charts-advanced-settings-top-level-group-title-bar{background-color:unset;position:relative}.ag-charts-advanced-settings-top-level-group-title-bar:focus-visible,.ag-charts-data-group-title-bar:focus-visible,.ag-charts-format-top-level-group-title-bar:focus-visible,.ag-charts-settings-group-title-bar:focus-visible{box-shadow:inset var(--ag-focus-shadow)}.ag-charts-data-group-container{padding:calc(var(--ag-widget-container-vertical-padding)*.5) var(--ag-widget-container-horizontal-padding);.ag-charts-data-group-item:not(.ag-charts-format-sub-level-group):not(.ag-pill-select):not(.ag-select){height:var(--ag-list-item-height)}.ag-charts-data-group-item.ag-picker-field{margin-top:var(--ag-spacing)}}.ag-charts-advanced-settings-top-level-group-container,.ag-charts-format-top-level-group-container{margin-left:calc(var(--ag-spacing)*2);padding:var(--ag-spacing)}.ag-charts-advanced-settings-top-level-group-item,.ag-charts-format-top-level-group-item{margin:var(--ag-spacing) 0}.ag-charts-format-sub-level-group-container{display:flex;flex-direction:column;gap:var(--ag-widget-vertical-spacing);padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding)}.ag-charts-settings-group-container{display:grid;grid-template-columns:60px 1fr 60px 1fr 60px;padding:var(--ag-spacing);row-gap:8px;.ag-chart-mini-thumbnail:nth-child(3n+1){grid-column:1}.ag-chart-mini-thumbnail:nth-child(3n+2){grid-column:3}.ag-chart-mini-thumbnail:nth-child(3n+3){grid-column:5}}.ag-chart-data-section,.ag-chart-format-section{display:flex;margin:0}.ag-chart-menu-panel{background-color:var(--ag-chrome-background-color)}.ag-ltr .ag-chart-menu-panel{border-left:1px solid var(--ag-border-color)}.ag-rtl .ag-chart-menu-panel{border-right:1px solid var(--ag-border-color)}.ag-chart-tabbed-menu-body{position:relative;&:after{background:linear-gradient(var(--ag-background-color),transparent);content:"";display:block;height:16px;left:0;position:absolute;right:0;top:0}}.ag-charts-data-group-title-bar,.ag-charts-format-top-level-group-title-bar,.ag-charts-settings-group-container,.ag-charts-settings-group-title-bar{border-top:none;font-weight:500;padding:0 calc(var(--ag-spacing)*1.5)}.ag-chart-settings-nav-bar{border-top:1px solid var(--ag-border-color)}.ag-charts-format-sub-level-group-title-bar{background:none;font-weight:500}.ag-chart-data-section,.ag-chart-format-section{.ag-label:not(.ag-group-title-bar){color:var(--ag-chart-menu-label-color)}.ag-label-align-top .ag-label{margin-bottom:var(--ag-widget-vertical-spacing);margin-top:calc(var(--ag-widget-vertical-spacing)*.5)}.ag-slider.ag-label-align-top .ag-label{margin-bottom:0}& label{display:inline-block}}.ag-chart-data-wrapper,.ag-chart-format-wrapper,.ag-charts-data-group-container,.ag-charts-data-group-title-bar,.ag-charts-format-sub-level-group,.ag-charts-format-sub-level-group-container,.ag-charts-format-sub-level-group-container>*,.ag-charts-format-sub-level-group-item:last-child,.ag-charts-format-sub-level-group-title-bar,.ag-charts-format-top-level-group,.ag-charts-format-top-level-group .ag-charts-format-top-level-group-container,.ag-charts-format-top-level-group-item,.ag-charts-format-top-level-group-title-bar,.ag-charts-settings-group-container,.ag-charts-settings-group-title-bar{margin:0;padding:0}.ag-charts-data-group,.ag-charts-format-top-level-group{border-top:1px solid var(--ag-border-color)}.ag-charts-data-group-title-bar,.ag-charts-format-top-level-group-title-bar,.ag-charts-settings-group-title-bar{padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding)}.ag-charts-data-group .ag-charts-data-group-container,.ag-charts-format-top-level-group .ag-charts-format-top-level-group-container,.ag-charts-settings-group .ag-charts-settings-group-container{padding:0 var(--ag-widget-container-horizontal-padding)}.ag-charts-format-sub-level-group-title-bar{padding:var(--ag-widget-vertical-spacing) 0}.ag-charts-format-sub-level-group-container{padding-bottom:var(--ag-widget-container-vertical-padding);padding-top:var(--ag-widget-vertical-spacing)}.ag-charts-format-sub-level-group-container>*,.ag-charts-format-sub-level-no-header-group-container>*,.ag-charts-format-top-level-group-container>*{margin-bottom:var(--ag-widget-vertical-spacing)}.ag-chart-advanced-settings-section,.ag-chart-settings-mini-wrapper,.ag-charts-data-group-item{padding-bottom:var(--ag-widget-container-vertical-padding)}.ag-chart-advanced-settings-section{padding-top:var(--ag-widget-container-vertical-padding)}.ag-charts-advanced-settings-top-level-group{.ag-charts-advanced-settings-top-level-group-container,.ag-charts-advanced-settings-top-level-group-title-bar{padding:0 var(--ag-widget-container-horizontal-padding)}}.ag-charts-advanced-settings-top-level-group-container{margin:0}.ag-charts-advanced-settings-top-level-group-item{margin-bottom:0;margin-top:calc(var(--ag-widget-vertical-spacing)*2)}.ag-chart-menu{--ag-icon-size:20px;background-color:color-mix(in srgb,transparent,var(--ag-background-color) 30%);padding:4px 2px}.ag-chart-settings-card-item.ag-not-selected:hover{opacity:.35}.ag-column-drop{align-items:center;display:inline-flex;overflow:auto;position:relative;width:100%}.ag-column-drop-cell,.ag-column-drop-list{align-items:center;display:flex}.ag-column-drop-cell{gap:var(--ag-spacing);position:relative}.ag-column-drop-cell-text{flex:1 1 auto;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.ag-column-drop-vertical{align-items:stretch;display:flex;flex-direction:column;overflow:hidden}.ag-column-drop-vertical-title-bar{align-items:center;display:flex;flex:none}.ag-column-drop-vertical-list{align-items:stretch;flex-direction:column;flex-grow:1;overflow-x:auto;position:relative;>*{flex:none}}.ag-column-drop-empty .ag-column-drop-vertical-list{overflow:hidden}.ag-column-drop-vertical-empty-message{display:block}.ag-column-drop.ag-column-drop-horizontal{overflow:hidden;white-space:nowrap}.ag-column-drop-cell-button{cursor:pointer}.ag-column-drop-wrapper{display:flex}.ag-column-drop-horizontal-half-width{width:50%!important}.ag-column-drop-cell{background:var(--ag-column-drop-cell-background-color);border:var(--ag-column-drop-cell-border);border-radius:500px;padding:calc(var(--ag-spacing)*.5);&:focus-visible{box-shadow:var(--ag-focus-shadow)}}.ag-ltr .ag-column-drop-cell{padding-left:calc(var(--ag-spacing)*.75)}.ag-rtl .ag-column-drop-cell{padding-right:calc(var(--ag-spacing)*.75)}.ag-column-drop-cell-button{min-width:calc(var(--ag-spacing)*4)}.ag-column-drop-cell-ghost{opacity:.5}.ag-column-drop-horizontal{gap:var(--ag-cell-widget-spacing);height:var(--ag-header-height)}.ag-ltr .ag-column-drop-horizontal{padding-left:var(--ag-cell-horizontal-padding)}.ag-rtl .ag-column-drop-horizontal{padding-right:var(--ag-cell-horizontal-padding)}.ag-column-drop-horizontal-list{gap:var(--ag-cell-widget-spacing)}.ag-column-drop-vertical-list{padding-bottom:var(--ag-spacing);padding-left:var(--ag-spacing);padding-right:var(--ag-spacing)}.ag-column-drop-vertical-cell{margin-top:var(--ag-spacing)}.ag-ltr .ag-column-drop-vertical-icon{margin-right:var(--ag-widget-horizontal-spacing)}.ag-rtl .ag-column-drop-vertical-icon{margin-left:var(--ag-widget-horizontal-spacing)}.ag-column-drop-vertical-empty-message{bottom:0;left:0;margin-top:var(--ag-spacing);overflow:hidden;position:absolute;right:0;top:0}.ag-select-agg-func-popup{background:var(--ag-background-color);border:1px solid var(--ag-border-color);border-radius:var(--ag-border-radius);box-shadow:var(--ag-dropdown-shadow);height:calc(var(--ag-spacing)*5*3.5);padding:0;position:absolute}.ag-select-agg-func-virtual-list-item{cursor:default;&:hover{background-color:var(--ag-selected-row-background-color)}&:focus-visible{shadow:var(--ag-focus-shadow)}}.ag-ltr .ag-select-agg-func-virtual-list-item{padding-left:calc(var(--ag-spacing)*2)}.ag-rtl .ag-select-agg-func-virtual-list-item{padding-right:calc(var(--ag-spacing)*2)}.ag-sort-indicator-container{display:contents}.ag-ltr .ag-sort-indicator-icon{padding-left:var(--ag-spacing)}.ag-rtl .ag-sort-indicator-icon{padding-right:var(--ag-spacing)}.ag-column-drop-horizontal{background-color:var(--ag-header-background-color);border-bottom:var(--ag-header-row-border)}.ag-ltr .ag-column-drop-horizontal-half-width:not(:last-child){border-right:var(--ag-column-border)}.ag-rtl .ag-column-drop-horizontal-half-width:not(:last-child){border-left:var(--ag-column-border)}.ag-column-drop-cell-button{min-width:0;opacity:.75;&:hover{opacity:1}}.ag-column-drop-vertical{min-height:75px}.ag-column-drop-vertical-title-bar{padding:var(--ag-widget-container-vertical-padding) calc(var(--ag-spacing)*2) 0}.ag-column-drop-vertical-empty-message{align-items:center;border:1px dashed;border-color:var(--ag-border-color);display:flex;justify-content:center;margin:calc(var(--ag-spacing)*1.5) calc(var(--ag-spacing)*2);padding:calc(var(--ag-spacing)*2)}.ag-column-select{display:flex;flex:3 1 0px;flex-direction:column;overflow:hidden;position:relative}.ag-column-select-header{flex:none;height:var(--ag-header-height);padding-left:var(--ag-widget-container-horizontal-padding);padding-right:var(--ag-widget-container-horizontal-padding)}.ag-column-select-column,.ag-column-select-column-group,.ag-column-select-header{align-items:center;display:flex;gap:var(--ag-widget-horizontal-spacing);position:relative}.ag-column-select-column,.ag-column-select-column-group{height:100%}.ag-column-select-virtual-list-item:focus-visible{box-shadow:inset var(--ag-focus-shadow)}.ag-column-select-header-icon{border-radius:var(--ag-border-radius);cursor:pointer;height:var(--ag-icon-size);position:relative;width:var(--ag-icon-size);&:focus-visible{box-shadow:var(--ag-focus-shadow)}}.ag-column-select-header-filter-wrapper{flex:1 1 auto}.ag-column-select-header-filter{width:100%}.ag-column-select-list{flex:1 1 0px;overflow:hidden}.ag-ltr .ag-column-select-column,.ag-ltr .ag-column-select-column-group{padding-left:calc(var(--ag-indentation-level)*var(--ag-column-select-indent-size))}.ag-rtl .ag-column-select-column,.ag-rtl .ag-column-select-column-group{padding-right:calc(var(--ag-indentation-level)*var(--ag-column-select-indent-size))}.ag-ltr .ag-column-select-add-group-indent{margin-left:calc(var(--ag-icon-size) + var(--ag-spacing)*1.5)}.ag-rtl .ag-column-select-add-group-indent{margin-right:calc(var(--ag-icon-size) + var(--ag-spacing)*1.5)}.ag-column-select-column,.ag-column-select-column-group{&:not(:last-child){margin-bottom:var(--ag-widget-vertical-spacing)}}.ag-column-select-column-group-readonly,.ag-column-select-column-readonly{opacity:.5;pointer-events:none}.ag-column-select-virtual-list-viewport{padding:calc(var(--ag-widget-container-vertical-padding)*.5) 0}.ag-column-select-virtual-list-item{padding:0 var(--ag-widget-container-horizontal-padding)}.ag-column-select-column-label{flex:1 1 auto;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.ag-column-select-checkbox{display:flex}.ag-set-filter{--ag-indentation-level:0}.ag-set-filter-item{align-items:center;display:flex;height:100%}.ag-set-filter-item-checkbox{display:flex;height:100%;width:100%}.ag-set-filter-group-icons{display:block;>*{cursor:pointer}}.ag-filter-body-wrapper{display:flex;flex-direction:column}.ag-filter-filter{flex:1 1 0px}.ag-filter-condition{display:flex;justify-content:center}.ag-floating-filter-body{display:flex;flex:1 1 auto;height:100%;position:relative}.ag-floating-filter-full-body{align-items:center;display:flex;flex:1 1 auto;height:100%;overflow:hidden;width:100%}.ag-floating-filter-full-body>div{flex:1 1 auto}.ag-floating-filter-input{align-items:center;display:flex;width:100%;>*{flex:1 1 auto}}.ag-floating-filter-button{display:flex;flex:none}.ag-set-floating-filter-input input[disabled]{pointer-events:none}.ag-floating-filter-button-button{-webkit-appearance:none;-moz-appearance:none;appearance:none;background:transparent;border:none;height:var(--ag-icon-size);width:var(--ag-icon-size)}.ag-filter-loading{height:100%;padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding);position:absolute;width:100%;z-index:1}.ag-column-panel{display:flex;flex:1 1 auto;flex-direction:column;overflow:hidden}.ag-pivot-mode-panel{display:flex;height:var(--ag-header-height)}.ag-pivot-mode-select{align-items:center;display:flex}.ag-ltr .ag-pivot-mode-select{margin-left:var(--ag-widget-container-horizontal-padding)}.ag-rtl .ag-pivot-mode-select{margin-right:var(--ag-widget-container-horizontal-padding)}.ag-column-panel-column-select{border-bottom:var(--ag-tool-panel-separator-border);border-top:var(--ag-tool-panel-separator-border)}:where(.ag-column-panel) .ag-column-drop-vertical{flex:1 1 0px;min-height:50px;&:where(:not(.ag-last-column-drop)){border-bottom:var(--ag-tool-panel-separator-border)}}.ag-dnd-ghost{align-items:center;background-color:var(--ag-drag-and-drop-image-background-color);border:var(--ag-drag-and-drop-image-border);border-radius:var(--ag-border-radius);box-shadow:var(--ag-drag-and-drop-image-shadow);color:var(--ag-text-color);cursor:move;font-weight:500;gap:var(--ag-cell-widget-spacing);height:var(--ag-header-height);max-width:200px;padding-left:var(--ag-cell-horizontal-padding);padding-right:var(--ag-cell-horizontal-padding);text-overflow:ellipsis;transform:translateY(calc(var(--ag-spacing)*2))}.ag-dnd-ghost,.ag-header{display:flex;overflow:hidden;white-space:nowrap}.ag-header{background-color:var(--ag-header-background-color);border-bottom:var(--ag-header-row-border);color:var(--ag-header-text-color);font-family:var(--ag-header-font-family);font-size:var(--ag-header-font-size);font-weight:var(--ag-header-font-weight);width:100%}.ag-header-row{height:var(--ag-header-height);position:absolute}.ag-header-row:not(:first-child){.ag-header-cell:not(.ag-header-span-height.ag-header-span-total),.ag-header-group-cell.ag-header-group-cell-with-group{border-top:var(--ag-header-row-border)}}.ag-header-row:not(.ag-header-row-column-group){overflow:hidden}.ag-header.ag-header-allow-overflow .ag-header-row{overflow:visible}.ag-header-cell,.ag-header-group-cell{align-items:center;display:inline-flex;gap:var(--ag-cell-widget-spacing);height:100%;overflow:hidden;padding:0 var(--ag-cell-horizontal-padding);position:absolute}@property --ag-internal-moving-color{syntax:"<color>";inherits:false;initial-value:transparent}@property --ag-internal-hover-color{syntax:"<color>";inherits:false;initial-value:transparent}.ag-header-cell:not(.ag-floating-filter),.ag-header-group-cell{&:before{background-image:linear-gradient(var(--ag-internal-hover-color),var(--ag-internal-hover-color)),linear-gradient(var(--ag-internal-moving-color),var(--ag-internal-moving-color));content:"";inset:0;position:absolute;--ag-internal-moving-color:transparent;--ag-internal-hover-color:transparent;transition:--ag-internal-moving-color var(--ag-header-cell-background-transition-duration),--ag-internal-hover-color var(--ag-header-cell-background-transition-duration)}&:hover:before{--ag-internal-hover-color:var(--ag-header-cell-hover-background-color)}&.ag-header-cell-moving:before{--ag-internal-moving-color:var(--ag-header-cell-moving-background-color);--ag-internal-hover-color:var(--ag-header-cell-hover-background-color)}}:where(.ag-header-cell:not(.ag-floating-filter) *,.ag-header-group-cell *){position:relative;z-index:1}.ag-header-cell-filter-button,.ag-header-cell.ag-header-active .ag-header-cell-menu-button{opacity:1}.ag-header-cell-menu-button:not(.ag-header-menu-always-show){opacity:0;transition:opacity .2s}.ag-header-cell-label,.ag-header-group-cell-label{align-items:center;align-self:stretch;display:flex;flex:1 1 auto;gap:var(--ag-spacing);padding:5px 0}.ag-header-cell-label{overflow:hidden;text-overflow:ellipsis}.ag-header-group-cell-label.ag-sticky-label{flex:none;max-width:100%;position:sticky}.ag-ltr .ag-header-group-cell-label.ag-sticky-label{left:var(--ag-cell-horizontal-padding)}.ag-rtl .ag-header-group-cell-label.ag-sticky-label{right:var(--ag-cell-horizontal-padding)}.ag-header-cell-text,.ag-header-group-text{overflow:hidden;text-overflow:ellipsis}.ag-header-cell-text{word-break:break-word}.ag-header-group-cell .ag-header-cell-comp-wrapper{display:flex}.ag-header-cell:not(.ag-header-cell-auto-height) .ag-header-cell-comp-wrapper{align-items:center;display:flex;height:100%}.ag-header-cell-comp-wrapper{width:100%}.ag-header-cell-wrap-text .ag-header-cell-comp-wrapper{white-space:normal}.ag-right-aligned-header .ag-header-cell-label{flex-direction:row-reverse}.ag-floating-filter-button-button,.ag-header-cell-filter-button,.ag-header-cell-menu-button,.ag-header-cell-sortable .ag-header-cell-label,.ag-header-expand-icon,.ag-panel-title-bar-button{cursor:pointer}.ag-advanced-filter-header-cell,.ag-header-cell,.ag-header-group-cell{&:focus-visible{box-shadow:inset var(--ag-focus-shadow)}}.ag-ltr :where(.ag-header-cell:not(.ag-right-aligned-header)){.ag-header-label-icon,.ag-header-menu-icon{margin-left:var(--ag-spacing)}}.ag-rtl :where(.ag-header-cell:not(.ag-right-aligned-header)){.ag-header-label-icon,.ag-header-menu-icon{margin-right:var(--ag-spacing)}}.ag-ltr :where(.ag-header-cell.ag-right-aligned-header){.ag-header-label-icon,.ag-header-menu-icon{margin-right:var(--ag-spacing)}}.ag-rtl :where(.ag-header-cell.ag-right-aligned-header){.ag-header-label-icon,.ag-header-menu-icon{margin-left:var(--ag-spacing)}}.ag-header-cell:after,.ag-header-group-cell:not(.ag-header-span-height.ag-header-group-cell-no-group):after{content:"";height:var(--ag-header-column-border-height);position:absolute;top:calc(50% - var(--ag-header-column-border-height)*.5);z-index:1}.ag-ltr .ag-header-cell:after,.ag-ltr .ag-header-group-cell:not(.ag-header-span-height.ag-header-group-cell-no-group):after{border-right:var(--ag-header-column-border);right:0}.ag-rtl .ag-header-cell:after,.ag-rtl .ag-header-group-cell:not(.ag-header-span-height.ag-header-group-cell-no-group):after{border-left:var(--ag-header-column-border);left:0}.ag-header-highlight-after:after,.ag-header-highlight-before:after{background-color:var(--ag-accent-color);content:"";height:100%;position:absolute;width:1px}.ag-ltr .ag-header-highlight-before:after{left:0}.ag-ltr .ag-header-highlight-after:after,.ag-rtl .ag-header-highlight-before:after{right:0}.ag-rtl .ag-header-highlight-after:after{left:0}.ag-ltr .ag-pinned-left-header .ag-header-highlight-after:after{right:1px}.ag-rtl .ag-pinned-left-header .ag-header-highlight-after:after{left:1px}.ag-header-cell-resize{align-items:center;cursor:ew-resize;display:flex;height:100%;position:absolute;top:0;width:8px;z-index:2;&:after{background-color:var(--ag-header-column-resize-handle-color);content:"";height:var(--ag-header-column-resize-handle-height);position:absolute;top:calc(50% - var(--ag-header-column-resize-handle-height)*.5);width:var(--ag-header-column-resize-handle-width);z-index:1}}.ag-ltr .ag-header-cell-resize{right:-3px;&:after{left:calc(50% - var(--ag-header-column-resize-handle-width))}}.ag-rtl .ag-header-cell-resize{left:-3px;&:after{right:calc(50% - var(--ag-header-column-resize-handle-width))}}.ag-header-cell.ag-header-span-height .ag-header-cell-resize:after{height:calc(100% - var(--ag-spacing)*4);top:calc(var(--ag-spacing)*2)}.ag-header-group-cell-no-group.ag-header-span-height .ag-header-cell-resize{display:none}.ag-menu{background-color:var(--ag-menu-background-color);border:var(--ag-menu-border);border-radius:var(--ag-border-radius);box-shadow:var(--ag-menu-shadow);color:var(--ag-menu-text-color);max-height:100%;min-width:180px;overflow-y:auto;position:absolute;-webkit-user-select:none;-moz-user-select:none;user-select:none}.ag-menu-list{cursor:default;display:table;padding:var(--ag-spacing) 0;width:100%}.ag-menu-option,.ag-menu-separator{display:table-row}.ag-menu-option-part,.ag-menu-separator-part{display:table-cell;vertical-align:middle}.ag-menu-option-text{white-space:nowrap}.ag-menu-option-custom{display:contents}.ag-compact-menu-option{display:flex;flex-wrap:nowrap;width:100%}.ag-compact-menu-option-text{flex:1 1 auto;white-space:nowrap}.ag-menu-separator{height:calc(var(--ag-spacing)*2 + 1px)}.ag-menu-separator-part:after{border-top:1px solid var(--ag-menu-separator-color);content:"";display:block}.ag-compact-menu-option-active,.ag-menu-option-active{background-color:var(--ag-row-hover-color)}.ag-compact-menu-option-part,.ag-menu-option-part{line-height:var(--ag-icon-size);padding:calc(var(--ag-spacing) + 2px) 0}.ag-compact-menu-option-disabled,.ag-menu-option-disabled{cursor:not-allowed;opacity:.5}.ag-compact-menu-option-icon,.ag-menu-option-icon{width:var(--ag-icon-size)}.ag-ltr .ag-compact-menu-option-icon,.ag-ltr .ag-menu-option-icon{padding-left:calc(var(--ag-spacing)*2)}.ag-rtl .ag-compact-menu-option-icon,.ag-rtl .ag-menu-option-icon{padding-right:calc(var(--ag-spacing)*2)}.ag-compact-menu-option-text,.ag-menu-option-text{padding-left:calc(var(--ag-spacing)*2);padding-right:calc(var(--ag-spacing)*2)}.ag-ltr .ag-compact-menu-option-shortcut,.ag-ltr .ag-menu-option-shortcut{padding-right:var(--ag-spacing)}.ag-rtl .ag-compact-menu-option-shortcut,.ag-rtl .ag-menu-option-shortcut{padding-left:var(--ag-spacing)}.ag-ltr .ag-compact-menu-option-popup-pointer,.ag-ltr .ag-menu-option-popup-pointer{padding-right:var(--ag-spacing)}.ag-rtl .ag-compact-menu-option-popup-pointer,.ag-rtl .ag-menu-option-popup-pointer{padding-left:var(--ag-spacing)}.ag-menu-column-select-wrapper{height:265px;overflow:auto;.ag-column-select{height:100%}}.ag-menu.ag-tabs{min-width:290px}.ag-filter-separator{border-top:1px solid var(--menu-separator-color)}.ag-filter-select .ag-picker-field-wrapper{width:0}.ag-filter-condition-operator{height:17px}.ag-ltr .ag-filter-condition-operator-or{margin-left:calc(var(--ag-spacing)*2)}.ag-rtl .ag-filter-condition-operator-or{margin-right:calc(var(--ag-spacing)*2)}.ag-set-filter-select-all{padding-top:var(--ag-widget-container-vertical-padding)}.ag-filter-no-matches,.ag-set-filter-list{height:calc(var(--ag-list-item-height)*6)}.ag-filter-no-matches{padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding)}.ag-set-filter-tree-list{height:calc(var(--ag-list-item-height)*10)}.ag-set-filter-filter{margin-left:var(--ag-widget-container-horizontal-padding);margin-right:var(--ag-widget-container-horizontal-padding);margin-top:var(--ag-widget-container-vertical-padding)}.ag-filter-to{margin-top:var(--ag-widget-vertical-spacing)}.ag-mini-filter{margin:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding)}.ag-ltr .ag-set-filter-item{padding-left:calc(var(--ag-widget-container-horizontal-padding) + var(--ag-indentation-level)*var(--ag-set-filter-indent-size))}.ag-rtl .ag-set-filter-item{padding-right:calc(var(--ag-widget-container-horizontal-padding) + var(--ag-indentation-level)*var(--ag-set-filter-indent-size))}.ag-ltr .ag-set-filter-add-group-indent{margin-left:calc(var(--ag-icon-size) + var(--ag-widget-container-horizontal-padding))}.ag-rtl .ag-set-filter-add-group-indent{margin-right:calc(var(--ag-icon-size) + var(--ag-widget-container-horizontal-padding))}.ag-ltr .ag-set-filter-group-icons{margin-right:var(--ag-widget-container-horizontal-padding)}.ag-rtl .ag-set-filter-group-icons{margin-left:var(--ag-widget-container-horizontal-padding)}.ag-filter-menu .ag-set-filter-list{min-width:200px}.ag-filter-virtual-list-item:focus-visible{box-shadow:inset var(--ag-focus-shadow)}.ag-filter-apply-panel{display:flex;justify-content:flex-end;overflow:hidden;padding:var(--ag-widget-vertical-spacing) var(--ag-widget-container-horizontal-padding) var(--ag-widget-container-vertical-padding)}.ag-filter-apply-panel-button{line-height:1.5}.ag-ltr .ag-filter-apply-panel-button{margin-left:calc(var(--ag-spacing)*2)}.ag-rtl .ag-filter-apply-panel-button{margin-right:calc(var(--ag-spacing)*2)}.ag-simple-filter-body-wrapper{display:flex;flex-direction:column;min-height:calc(var(--ag-list-item-height) + var(--ag-widget-container-vertical-padding) + var(--ag-widget-vertical-spacing));overflow-y:auto;padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding);padding-bottom:calc(var(--ag-widget-container-vertical-padding) - var(--ag-widget-vertical-spacing));&>*{margin-bottom:var(--ag-widget-vertical-spacing)}.ag-resizer-wrapper{margin:0}}.ag-multi-filter-menu-item{margin:var(--ag-spacing) 0}.ag-multi-filter-group-title-bar{background-color:transparent;color:var(--ag-header-text-color);font-weight:500;padding:calc(var(--ag-spacing)*1.5) var(--ag-spacing);&:focus-visible{box-shadow:var(--ag-focus-shadow)}}.ag-group-filter-field-select-wrapper{display:flex;flex-direction:column;gap:var(--ag-widget-vertical-spacing);padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding)}.ag-menu-option{cursor:pointer;font-weight:500}.ag-ltr .ag-menu-option-popup-pointer .ag-icon{text-align:right}.ag-rtl .ag-menu-option-popup-pointer .ag-icon{text-align:left}.ag-panel{background-color:var(--ag-panel-background-color);display:flex;flex-direction:column;overflow:hidden;position:relative}.ag-dialog{border:var(--ag-dialog-border);border-radius:var(--ag-border-radius);box-shadow:var(--ag-dialog-shadow);position:absolute}.ag-panel-title-bar{align-items:center;background-color:var(--ag-panel-title-bar-background-color);border-bottom:var(--ag-panel-title-bar-border);color:var(--ag-header-text-color);cursor:default;display:flex;flex:none;height:var(--ag-header-height);padding:var(--ag-spacing) var(--ag-cell-horizontal-padding)}.ag-ltr .ag-panel-title-bar-button{margin-left:calc(var(--ag-spacing)*2);margin-right:var(--ag-spacing)}.ag-rtl .ag-panel-title-bar-button{margin-left:var(--ag-spacing);margin-right:calc(var(--ag-spacing)*2)}.ag-panel-title-bar-title{color:var(--ag-header-text-color);flex:1 1 auto;font-weight:500}.ag-panel-title-bar-buttons{display:flex}.ag-panel-title-bar-button{cursor:pointer}.ag-panel-content-wrapper{display:flex;flex:1 1 auto;overflow:hidden;position:relative}.ag-resizer{pointer-events:none;position:absolute;-webkit-user-select:none;-moz-user-select:none;user-select:none;z-index:1;&.ag-resizer-topLeft{height:5px;left:0;top:0;width:5px}&.ag-resizer-top{cursor:ns-resize;height:5px;left:5px;right:5px;top:0}&.ag-resizer-topRight{height:5px;right:0;top:0;width:5px}&.ag-resizer-right{bottom:5px;cursor:ew-resize;right:0;top:5px;width:5px}&.ag-resizer-bottomRight{bottom:0;height:5px;right:0;width:5px}&.ag-resizer-bottom{bottom:0;cursor:ns-resize;height:5px;left:5px;right:5px}&.ag-resizer-bottomLeft{bottom:0;height:5px;left:0;width:5px}&.ag-resizer-left{bottom:5px;cursor:ew-resize;left:0;top:5px;width:5px}}.ag-ltr .ag-resizer{&.ag-resizer-topLeft{cursor:nwse-resize}&.ag-resizer-topRight{cursor:nesw-resize}&.ag-resizer-bottomRight{cursor:nwse-resize}&.ag-resizer-bottomLeft{cursor:nesw-resize}}.ag-rtl .ag-resizer{&.ag-resizer-topLeft{cursor:nesw-resize}&.ag-resizer-topRight{cursor:nwse-resize}&.ag-resizer-bottomRight{cursor:nesw-resize}&.ag-resizer-bottomLeft{cursor:nwse-resize}}.ag-dragging-fill-handle .ag-dialog,.ag-dragging-range-handle .ag-dialog{opacity:.7;pointer-events:none}.ag-layout-print{&.ag-body{display:block;height:unset}&.ag-root-wrapper{display:inline-block}.ag-body-horizontal-scroll,.ag-body-vertical-scroll{display:none}&.ag-force-vertical-scroll{overflow-y:visible!important}}@media print{.ag-root-wrapper.ag-layout-print{display:table;.ag-body-horizontal-scroll-viewport,.ag-body-viewport,.ag-center-cols-container,.ag-center-cols-viewport,.ag-root,.ag-root-wrapper-body,.ag-virtual-list-viewport{display:block!important;height:auto!important;overflow:hidden!important}.ag-cell,.ag-row{-moz-column-break-inside:avoid;break-inside:avoid}}}.ag-select{align-items:center;display:flex;flex-direction:row;.ag-picker-field-wrapper{cursor:default}&.ag-disabled .ag-picker-field-wrapper:focus{box-shadow:none}&:not(.ag-cell-editor,.ag-label-align-top){min-height:var(--ag-list-item-height)}.ag-picker-field-display{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.ag-picker-field-icon{align-items:center;display:flex}&.ag-disabled{opacity:.5}}.ag-ltr .ag-select{.ag-picker-field-wrapper{padding-left:calc(var(--ag-cell-horizontal-padding)/2);padding-right:var(--ag-spacing)}}.ag-rtl .ag-select{.ag-picker-field-wrapper{padding-left:var(--ag-spacing);padding-right:calc(var(--ag-cell-horizontal-padding)/2)}}.ag-rich-select{cursor:default;height:100%}.ag-rich-select-value{align-items:center;background-color:var(--ag-input-background-color);display:flex;height:100%;padding:var(--ag-spacing);.ag-picker-field-display{overflow:hidden;text-overflow:ellipsis;&.ag-display-as-placeholder{opacity:.5}}}.ag-rich-select-list{background-color:var(--ag-input-background-color);border:var(--ag-input-border);border-radius:var(--ag-input-border-radius);box-shadow:var(--ag-dropdown-shadow);height:auto;position:relative;width:100%;.ag-loading-text{padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding)}}.ag-rich-select-row{align-items:center;display:flex;flex:1 1 auto;height:100%;overflow:hidden;padding:0 var(--ag-spacing);white-space:nowrap}.ag-rich-select-row-selected{background-color:var(--ag-selected-row-background-color)}.ag-rich-select-row-highlighted,.ag-rich-select-row:hover{background-image:linear-gradient(var(--ag-row-hover-color),var(--ag-row-hover-color))}.ag-rich-select-row-text-highlight{font-weight:700}.ag-rich-select-field-input{flex:1 1 auto;.ag-input-field-input{border:none!important;box-shadow:none!important;padding:0!important;text-overflow:ellipsis;&::-moz-placeholder{opacity:.8}&::placeholder{opacity:.8}}}.ag-ltr .ag-rich-select-field-input{left:var(--ag-spacing)}.ag-rtl .ag-rich-select-field-input{right:var(--ag-spacing)}.ag-popup-editor .ag-rich-select-value{height:var(--ag-row-height);min-width:200px}.ag-rich-select-virtual-list-item{cursor:default;height:var(--ag-list-item-height)}.ag-pill-container{display:flex;flex-wrap:nowrap;gap:.25rem}.ag-pill{align-items:center;background:var(--ag-select-cell-background-color);border:var(--ag-select-cell-border);border-radius:var(--ag-border-radius);display:flex;padding:0 .25rem;white-space:nowrap;&:focus-visible{box-shadow:var(--ag-focus-shadow)}}.ag-pill .ag-pill-button{border:none;padding:0;&:hover{color:var(--ag-accent-color);cursor:pointer}}.ag-ltr .ag-pill .ag-pill-button{margin-left:var(--ag-spacing)}.ag-rtl .ag-pill .ag-pill-button{margin-right:var(--ag-spacing)}ag-grid,ag-grid-angular{display:block}.ag-dnd-ghost,.ag-popup,.ag-root-wrapper{cursor:default;line-height:normal;white-space:normal;-webkit-font-smoothing:antialiased;background-color:var(--ag-background-color);color:var(--ag-text-color);color-scheme:var(--ag-browser-color-scheme);font-family:var(--ag-font-family);font-size:var(--ag-font-size);--ag-indentation-level:0}.ag-root-wrapper{border:var(--ag-wrapper-border);border-radius:var(--ag-wrapper-border-radius);display:flex;flex-direction:column;overflow:hidden;position:relative;&.ag-layout-normal{height:100%}}.ag-root-wrapper-body{display:flex;flex-direction:row;&.ag-layout-normal{flex:1 1 auto;height:0;min-height:0}}.ag-root{display:flex;flex-direction:column;position:relative;&.ag-layout-auto-height,&.ag-layout-normal{flex:1 1 auto;overflow:hidden;width:0}&.ag-layout-normal{height:100%}}.ag-tool-panel-wrapper{cursor:default;display:flex;overflow-x:hidden;overflow-y:auto;-webkit-user-select:none;-moz-user-select:none;user-select:none;width:var(--ag-side-bar-panel-width)}.ag-select-agg-func-item{align-items:center;display:flex;flex:1 1 auto;flex-direction:row;flex-wrap:nowrap;height:100%;overflow:hidden;position:relative;text-overflow:ellipsis;white-space:nowrap;>*{flex:none}}.ag-tool-panel-horizontal-resize{cursor:ew-resize;height:100%;position:absolute;top:0;width:5px;z-index:1}.ag-ltr .ag-side-bar-left .ag-tool-panel-horizontal-resize{right:-3px}.ag-ltr .ag-side-bar-right .ag-tool-panel-horizontal-resize,.ag-rtl .ag-side-bar-left .ag-tool-panel-horizontal-resize{left:-3px}.ag-rtl .ag-side-bar-right .ag-tool-panel-horizontal-resize{right:-3px}.ag-side-bar{background-color:var(--ag-side-bar-background-color);display:flex;flex-direction:row-reverse;position:relative}.ag-side-bar-left{flex-direction:row;order:-1}.ag-side-buttons{position:relative;width:calc(var(--ag-icon-size) + var(--ag-spacing)*2)}.ag-side-button{&.ag-selected{background-color:var(--ag-background-color);border-bottom:1px solid var(--ag-border-color);&:not(:first-of-type){border-top:1px solid var(--ag-border-color)}}}.ag-side-button-button{align-items:center;cursor:pointer;display:flex;flex-direction:column;gap:var(--ag-spacing);padding:calc(var(--ag-spacing)*3) 0;position:relative;white-space:nowrap;width:100%;&:focus{box-shadow:none}}.ag-side-button-button:focus-visible{box-shadow:inset var(--ag-focus-shadow)}.ag-side-button-label{writing-mode:vertical-lr}@media (max-resolution:1.5x){.ag-side-button-label{font-family:"Segoe UI",var(--ag-font-family)}.ag-ltr .ag-side-button-label{transform:rotate(.05deg)}.ag-rtl .ag-side-button-label{transform:rotate(-.05deg)}}.ag-ltr .ag-side-bar-left,.ag-rtl .ag-side-bar-right{border-right:var(--ag-side-panel-border);.ag-tool-panel-wrapper{border-left:var(--ag-side-panel-border)}}.ag-ltr .ag-side-bar-right,.ag-rtl .ag-side-bar-left{border-left:var(--ag-side-panel-border);.ag-tool-panel-wrapper{border-right:var(--ag-side-panel-border)}}.ag-ltr .ag-chart-menu-panel{border-left:var(--ag-side-panel-border)}.ag-rtl .ag-chart-menu-panel{border-right:var(--ag-side-panel-border)}.ag-button{border-radius:0}.ag-standard-button{-moz-appearance:none;appearance:none;-webkit-appearance:none;background-color:var(--ag-background-color);border:var(--ag-input-border);border-radius:var(--ag-border-radius);cursor:pointer;font-family:inherit;padding:var(--ag-spacing) calc(var(--ag-spacing)*2);&:hover{background-color:var(--ag-row-hover-color)}&:active{border-color:var(--ag-accent-color)}&:disabled{background-color:var(--ag-input-disabled-background-color);border:var(--ag-input-disabled-border);color:var(--ag-input-disabled-text-color)}}:where(input[class^=ag-][type=button],button[class^=ag-]):focus-visible{box-shadow:var(--ag-focus-shadow)}.ag-drag-handle{color:var(--ag-drag-handle-color);cursor:grab}.ag-list-item,.ag-virtual-list-item{height:var(--ag-list-item-height)}.ag-virtual-list-item{position:absolute;width:100%}.ag-select-list{background-color:var(--ag-background-color);border:var(--ag-input-border);border-radius:var(--ag-border-radius);box-shadow:var(--ag-dropdown-shadow);overflow-x:hidden;overflow-y:auto}.ag-list-item{align-items:center;display:flex;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;&.ag-active-item{background-color:var(--ag-row-hover-color)}}.ag-select-list-item{cursor:default;-webkit-user-select:none;-moz-user-select:none;user-select:none;& span{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}}.ag-ltr .ag-select-list-item{padding-left:calc(var(--ag-cell-horizontal-padding)/2)}.ag-rtl .ag-select-list-item{padding-right:calc(var(--ag-cell-horizontal-padding)/2)}.ag-list-item-hovered:after{background-color:var(--ag-accent-color);content:"";height:1px;left:0;position:absolute;right:0}.ag-item-highlight-top:after{top:0}.ag-item-highlight-bottom:after{bottom:0}.ag-range-field{align-items:center;display:flex;.ag-input-wrapper{height:100%}}& input[class^=ag-][type=range]{-webkit-appearance:none;background:none;height:100%;overflow:visible;padding:0;width:100%;&::-webkit-slider-runnable-track{background-color:var(--ag-border-color);border-radius:1.5px;height:3px;margin:0;padding:0;width:100%}&::-moz-range-track{background-color:var(--ag-border-color);border-radius:1.5px;height:3px;margin:0;padding:0;width:100%}&::-webkit-slider-thumb{-webkit-appearance:none;background-color:var(--ag-background-color);border:1px solid var(--ag-border-color);border-radius:100%;height:var(--ag-icon-size);margin:0;padding:0;transform:translateY(calc(var(--ag-icon-size)*-.5 + 1.5px));width:var(--ag-icon-size)}&::-moz-ag-range-thumb{-webkit-appearance:none;background-color:var(--ag-background-color);border:1px solid var(--ag-border-color);border-radius:100%;height:var(--ag-icon-size);margin:0;padding:0;transform:translateY(calc(var(--ag-icon-size)*-.5 + 1.5px));width:var(--ag-icon-size)}&:focus{&::-webkit-slider-thumb{border-color:var(--ag-accent-color);box-shadow:var(--ag-focus-shadow)}&::-moz-ag-range-thumb{border-color:var(--ag-accent-color);box-shadow:var(--ag-focus-shadow)}}&:active{&::-webkit-slider-runnable-track{background-color:var(--ag-accent-color)}&::-moz-ag-range-track{background-color:var(--ag-accent-color)}}&:disabled{opacity:.5}}.ag-toggle-button{flex:none;min-width:unset;width:unset}.ag-toggle-button-input-wrapper{background-color:var(--ag-toggle-button-off-background-color);border:solid var(--ag-toggle-button-border-width) var(--ag-toggle-button-off-border-color);border-radius:calc(var(--ag-toggle-button-height)*.5);flex:none;height:var(--ag-toggle-button-height);max-width:var(--ag-toggle-button-width);min-width:var(--ag-toggle-button-width);position:relative;& input{-webkit-appearance:none;-moz-appearance:none;appearance:none;height:100%;opacity:0;width:100%}&:before{background-color:var(--ag-toggle-button-switch-background-color);border:var(--ag-toggle-button-border-width) solid var(--ag-toggle-button-switch-border-color);border-radius:100%;content:"";display:block;height:var(--ag-toggle-button-height);pointer-events:none;position:absolute;top:calc(0px - var(--ag-toggle-button-border-width));width:var(--ag-toggle-button-height)}&.ag-checked{background-color:var(--ag-toggle-button-on-background-color);border-color:var(--ag-toggle-button-on-border-color);&:before{border-color:var(--ag-toggle-button-on-border-color)}}&:focus-within{box-shadow:var(--ag-focus-shadow)}&.ag-disabled{opacity:.5}}.ag-ltr .ag-toggle-button-input-wrapper{&:before{left:calc(0px - var(--ag-toggle-button-border-width));transition:left .1s}&.ag-checked{&:before{left:calc(100% - var(--ag-toggle-button-height) + var(--ag-toggle-button-border-width))}}}.ag-rtl .ag-toggle-button-input-wrapper{&:before{right:calc(0px - var(--ag-toggle-button-border-width));transition:right .1s}&.ag-checked{&:before{right:calc(100% - var(--ag-toggle-button-height) + var(--ag-toggle-button-border-width))}}}.ag-autocomplete{align-items:center;display:flex;width:100%;>*{flex:1 1 auto}}.ag-autocomplete-list-popup{position:absolute;-webkit-user-select:none;-moz-user-select:none;user-select:none}.ag-autocomplete-list{height:calc(var(--ag-row-height)*6.5);min-width:200px;position:relative;width:100%}.ag-autocomplete-virtual-list-item{cursor:default;display:flex;height:var(--ag-list-item-height);&:focus-visible:after{content:none}&:hover{background-color:var(--ag-row-hover-color)}}.ag-autocomplete-row{align-items:center;display:flex;flex:1 1 auto;overflow:hidden}.ag-autocomplete-row-label{margin:0 var(--ag-widget-container-horizontal-padding);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.ag-autocomplete-row-selected{background-color:var(--ag-selected-row-background-color)}.ag-tooltip{background-color:var(--ag-tooltip-background-color);border:var(--ag-tooltip-border);border-radius:var(--ag-border-radius);color:var(--ag-tooltip-text-color);padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding);white-space:normal}.ag-tooltip,.ag-tooltip-custom{position:absolute;z-index:99999}.ag-tooltip-custom:not(.ag-tooltip-interactive),.ag-tooltip:not(.ag-tooltip-interactive){pointer-events:none}.ag-tooltip-custom.ag-tooltip-animate,.ag-tooltip.ag-tooltip-animate{transition:opacity 1s;&.ag-tooltip-hiding{opacity:0}}.ag-angle-select{align-items:center;display:flex}.ag-angle-select-wrapper{display:flex}.ag-angle-select-parent-circle{display:block;position:relative}.ag-angle-select-child-circle{position:absolute}.ag-slider-wrapper{display:flex;.ag-input-field{flex:1 1 auto}}.ag-picker-field-display{flex:1 1 auto}.ag-picker-field{align-items:center;display:flex}.ag-picker-field-icon{border:0;cursor:pointer;display:flex;margin:0;padding:0}.ag-color-panel{display:flex;flex-direction:column;text-align:center;width:100%}.ag-spectrum-color{cursor:default;flex:1 1 auto;overflow:visible;position:relative}.ag-spectrum-fill{inset:0;position:absolute}.ag-spectrum-val{cursor:pointer}.ag-spectrum-dragger{cursor:pointer;pointer-events:none;position:absolute}.ag-spectrum-alpha,.ag-spectrum-hue{cursor:default}.ag-spectrum-hue-background{background:linear-gradient(270deg,red 3%,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red);height:100%;width:100%}.ag-spectrum-alpha-background{background:linear-gradient(to right,var(--ag-internal-spectrum-alpha-color-from),var(--ag-internal-spectrum-alpha-color-to)),url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="4" height="4"><rect x="0" y="0" width="4" height="4" fill="%23fff"/><path d="M0 0H2V4H4V2H0Z" fill="%23b2b2b2"/></svg>\') 0 0 /4px 4px;height:100%;width:100%}.ag-spectrum-tool{cursor:pointer;position:relative}.ag-spectrum-slider{pointer-events:none;position:absolute}.ag-spectrum-alpha .ag-spectrum-slider{background:linear-gradient(to bottom,var(--ag-internal-spectrum-alpha-color),var(--ag-internal-spectrum-alpha-color)) var(--ag-background-color)}.ag-recent-colors{display:flex;gap:6px;margin-top:10px}.ag-recent-color{cursor:pointer}.ag-angle-select[disabled]{opacity:.5;pointer-events:none}.ag-ltr .ag-angle-select-field,.ag-ltr .ag-slider-field{margin-right:calc(var(--ag-spacing)*2)}.ag-rtl .ag-angle-select-field,.ag-rtl .ag-slider-field{margin-left:calc(var(--ag-spacing)*2)}.ag-angle-select-parent-circle{background-color:var(--ag-background-color);border:1px solid;border-color:var(--ag-border-color);border-radius:12px;height:24px;width:24px}.ag-angle-select-child-circle{background-color:var(--ag-foreground-color);border-radius:3px;height:6px;left:12px;margin-left:-3px;margin-top:-4px;top:4px;width:6px}.ag-picker-field-wrapper{background-color:var(--ag-background-color);border:var(--ag-input-border);border-radius:5px;min-height:max(var(--ag-list-item-height),calc(var(--ag-spacing)*4));overflow:hidden;&:disabled{opacity:.5}&.ag-picker-has-focus,&:focus-within{border:var(--ag-input-focus-border);box-shadow:var(--ag-focus-shadow)}}.ag-picker-field-button{background-color:var(--ag-background-color)}.ag-dialog.ag-color-dialog{border-radius:5px}.ag-color-picker{.ag-picker-field-wrapper{padding-left:var(--ag-spacing);padding-right:var(--ag-spacing)}.ag-picker-field-display{align-items:center;display:flex;flex-direction:row;min-height:var(--ag-list-item-height)}}.ag-ltr .ag-color-picker-color,.ag-ltr .ag-color-picker-value{margin-right:var(--ag-spacing)}.ag-rtl .ag-color-picker-color,.ag-rtl .ag-color-picker-value{margin-left:var(--ag-spacing)}.ag-color-panel{padding:var(--ag-spacing)}.ag-spectrum-tools{padding-bottom:0;padding-left:0;padding-right:0}.ag-spectrum-tool{height:12px}.ag-spectrum-alpha-background,.ag-spectrum-hue-background{border-radius:12px}.ag-spectrum-slider{border:3px solid #f8f8f8;border-radius:18px;height:18px;margin-top:-15px;width:18px}.ag-recent-colors{margin-bottom:2px;margin-left:var(--ag-spacing);margin-right:var(--ag-spacing)}.ag-color-input-color,.ag-color-picker-color,.ag-recent-color{border-radius:4px}.ag-recent-color{border:1px solid var(--ag-border-color)}.ag-spectrum-sat{background-image:linear-gradient(90deg,#fff,hsla(20,42%,65%,0))}.ag-spectrum-val{background-image:linear-gradient(0deg,#000,hsla(20,42%,65%,0))}.ag-spectrum-dragger{background:#000;border:3px solid #fff;border-radius:18px;box-shadow:0 0 2px 0 rgba(0,0,0,.24);height:18px;width:18px}.ag-spectrum-alpha-background,.ag-spectrum-hue-background{border-radius:2px}.ag-spectrum-tool{border-radius:2px;height:11px;margin-bottom:10px}.ag-spectrum-slider{border:2px solid #fff;border-radius:13px;box-shadow:0 1px 4px 0 rgba(0,0,0,.37);height:13px;margin-top:-12px;width:13px}.ag-recent-color,.ag-spectrum-color,.ag-spectrum-slider{&:focus-visible:not(:disabled):not([readonly]){box-shadow:var(--ag-focus-shadow)}}.ag-color-input{.ag-color-input-color{position:absolute}}.ag-ltr .ag-color-input{& input[class^=ag-][type=text].ag-input-field-input{padding-left:calc(var(--ag-icon-size) + var(--ag-spacing)*2)}.ag-color-input-color{margin-left:var(--ag-spacing)}}.ag-rtl .ag-color-input{& input[class^=ag-][type=text].ag-input-field-input{padding-right:calc(var(--ag-icon-size) + var(--ag-spacing)*2)}.ag-color-input-color{margin-right:var(--ag-spacing)}}.ag-color-input-color,.ag-color-picker-color{border:1px solid var(--ag-border-color);border-radius:2px;height:var(--ag-icon-size);width:var(--ag-icon-size)}.ag-pill-select{.ag-picker-field-display{font-weight:500}.ag-picker-field-display,.ag-picker-field-icon .ag-icon{color:var(--ag-chart-menu-label-color)}}.ag-filter-toolpanel{flex:1 1 0px;min-width:0}.ag-filter-toolpanel-header{position:relative}.ag-filter-toolpanel-header,.ag-filter-toolpanel-search{align-items:center;display:flex;>*{align-items:center;display:flex}}.ag-filter-toolpanel-header{height:calc(var(--ag-spacing)*6);&:focus-visible{border-radius:var(--ag-border-radius);box-shadow:inset var(--ag-focus-shadow)}}.ag-filter-toolpanel-header,.ag-filter-toolpanel-search{padding:0 var(--ag-spacing)}.ag-filter-toolpanel-group:not(.ag-has-filter)>.ag-group-title-bar .ag-filter-toolpanel-group-instance-header-icon{display:none}.ag-filter-toolpanel-group-level-0-header{height:calc(var(--ag-spacing)*8)}.ag-filter-toolpanel-group-item{margin-bottom:calc(var(--ag-spacing)*.5);margin-top:calc(var(--ag-spacing)*.5)}.ag-filter-toolpanel-search{margin-bottom:var(--ag-spacing);margin-top:var(--ag-widget-container-vertical-padding)}.ag-filter-toolpanel-search-input{flex-grow:1;height:calc(var(--ag-spacing)*4)}.ag-ltr .ag-filter-toolpanel-group-title-bar-icon{margin-right:var(--ag-spacing)}.ag-rtl .ag-filter-toolpanel-group-title-bar-icon{margin-left:var(--ag-spacing)}.ag-filter-toolpanel-expand{cursor:pointer}.ag-ltr .ag-filter-toolpanel-expand{margin-right:var(--ag-spacing)}.ag-rtl .ag-filter-toolpanel-expand{margin-left:var(--ag-spacing)}.ag-ltr .ag-filter-toolpanel-group-title-bar,.ag-ltr .ag-filter-toolpanel-instance-header{padding-left:calc(var(--ag-spacing) + var(--ag-filter-tool-panel-group-indent)*var(--ag-indentation-level))}.ag-rtl .ag-filter-toolpanel-group-title-bar,.ag-rtl .ag-filter-toolpanel-instance-header{padding-right:calc(var(--ag-spacing) + var(--ag-filter-tool-panel-group-indent)*var(--ag-indentation-level))}.ag-ltr .ag-filter-toolpanel-instance-body{margin-left:var(--ag-filter-tool-panel-group-indent)}.ag-rtl .ag-filter-toolpanel-instance-body{margin-right:var(--ag-filter-tool-panel-group-indent)}.ag-ltr .ag-filter-toolpanel-group-instance-header-icon,.ag-ltr .ag-filter-toolpanel-instance-header-icon{margin-left:var(--ag-spacing)}.ag-rtl .ag-filter-toolpanel-group-instance-header-icon,.ag-rtl .ag-filter-toolpanel-instance-header-icon{margin-right:var(--ag-spacing)}.ag-filter-toolpanel-instance-filter{background-color:var(--ag-chrome-background-color)}.ag-filter-toolpanel-group-level-0{border-top:none}.ag-filter-toolpanel-header{height:auto;padding-bottom:var(--ag-spacing);padding-top:var(--ag-spacing)}.ag-filter-toolpanel-group-item{margin:0}.ag-filter-toolpanel-header,.ag-filter-toolpanel-search{color:var(--ag-header-text-color);font-weight:500}.ag-paging-panel{align-items:center;border-top:var(--ag-footer-row-border);display:flex;gap:calc(var(--ag-spacing)*4);height:max(var(--ag-row-height),22px);justify-content:flex-end;padding:0 var(--ag-cell-horizontal-padding)}.ag-paging-page-size .ag-wrapper{min-width:50px}.ag-paging-page-summary-panel{align-items:center;display:flex;gap:var(--ag-cell-widget-spacing);.ag-disabled &{pointer-events:none}}.ag-paging-button{cursor:pointer;position:relative;&:focus-visible{box-shadow:var(--ag-focus-shadow)}&.ag-disabled{cursor:default;opacity:.5}}.ag-paging-number,.ag-paging-row-summary-panel-number{font-weight:500}.ag-status-bar{border-top:var(--ag-footer-row-border);display:flex;justify-content:space-between;line-height:1.5;overflow:hidden;padding-left:calc(var(--ag-spacing)*4);padding-right:calc(var(--ag-spacing)*4)}.ag-status-panel{display:inline-flex}.ag-status-name-value{white-space:nowrap}.ag-status-bar-center,.ag-status-bar-left,.ag-status-bar-right{display:inline-flex}.ag-status-bar-center{text-align:center}.ag-status-name-value{margin-left:var(--ag-spacing);margin-right:var(--ag-spacing);padding-bottom:var(--ag-widget-container-vertical-padding);padding-top:var(--ag-widget-container-vertical-padding)}.ag-status-name-value-value{font-weight:500}.ag-overlay{inset:0;pointer-events:none;position:absolute;z-index:2}.ag-overlay-panel,.ag-overlay-wrapper{display:flex;height:100%;width:100%}.ag-overlay-wrapper{align-items:center;flex:none;justify-content:center;text-align:center}.ag-overlay-loading-wrapper{pointer-events:all}.ag-overlay-loading-center{background:var(--ag-background-color);border:1px solid var(--ag-border-color);border-radius:var(--ag-border-radius);box-shadow:var(--ag-popup-shadow);padding:var(--ag-spacing)}.ag-icon{display:block;height:var(--ag-icon-size);position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none;width:var(--ag-icon-size)}.ag-column-select-column-group-readonly,.ag-disabled,[disabled]{.ag-icon{opacity:.5}}.ag-column-select-column-readonly .ag-icon-grip,.ag-column-select-column-readonly.ag-icon-grip{opacity:.35}.ag-chart-menu-icon,.ag-chart-settings-next,.ag-chart-settings-prev,.ag-column-group-icons,.ag-column-select-header-icon,.ag-filter-toolpanel-expand,.ag-floating-filter-button-button,.ag-group-contracted .ag-icon,.ag-group-expanded .ag-icon,.ag-group-title-bar-icon,.ag-header-cell-filter-button,.ag-header-cell-menu-button,.ag-header-expand-icon,.ag-panel-title-bar-button,.ag-panel-title-bar-button-icon,.ag-set-filter-group-icons{&:hover{background-color:var(--ag-icon-button-hover-color);border-radius:1px;box-shadow:0 0 0 4px var(--ag-icon-button-hover-color)}}.ag-filter-active{--ag-icon-button-hover-color:color-mix(in srgb,transparent,var(--ag-accent-color) 28%);background-color:color-mix(in srgb,transparent,var(--ag-accent-color) 14%);border-radius:1px;box-shadow:0 0 0 4px color-mix(in srgb,transparent,var(--ag-accent-color) 14%);position:relative;&:after{background-color:var(--ag-accent-color);border-radius:50%;content:"";height:6px;position:absolute;top:-1px;width:6px}.ag-icon-filter{clip-path:path("M8,0C8,4.415 11.585,8 16,8L16,16L0,16L0,0L8,0Z")}}.ag-ltr .ag-filter-active{&:after{right:-1px}}.ag-rtl .ag-filter-active{&:after{left:-1px}}.ag-label-align-right{.ag-label{order:1}>*{flex:none}}.ag-label-align-top{align-items:flex-start;flex-direction:column;>*{align-self:stretch}}.ag-label-ellipsis{flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.ag-label{white-space:nowrap}.ag-ltr .ag-label{margin-right:var(--ag-spacing)}.ag-rtl .ag-label{margin-left:var(--ag-spacing)}.ag-label-align-top .ag-label{margin-bottom:calc(var(--ag-spacing)*.5)}.ag-ltr .ag-label-align-right .ag-label{margin-left:var(--ag-spacing)}.ag-rtl .ag-label-align-right .ag-label{margin-right:var(--ag-spacing)}',Su={backgroundColor:"#FFF",foregroundColor:"#181d1f",textColor:{ref:"foregroundColor"},accentColor:"#2196f3",invalidColor:"#e02525",borderColor:{ref:"foregroundColor",mix:.15},wrapperBorder:!0,rowBorder:!0,browserColorScheme:"light",headerRowBorder:{ref:"rowBorder"},footerRowBorder:{ref:"rowBorder"},columnBorder:{style:"solid",width:1,color:"transparent"},headerColumnBorder:!1,headerColumnBorderHeight:"100%",pinnedColumnBorder:!0,pinnedRowBorder:!0,sidePanelBorder:!0,fontFamily:["-apple-system","BlinkMacSystemFont","Segoe UI","Roboto","Oxygen-Sans","Ubuntu","Cantarell","Helvetica Neue","sans-serif"],chromeBackgroundColor:{ref:"foregroundColor",mix:.02,onto:"backgroundColor"},headerBackgroundColor:{ref:"chromeBackgroundColor"},headerFontFamily:{ref:"fontFamily"},headerFontWeight:500,headerFontSize:{ref:"fontSize"},dataFontSize:{ref:"fontSize"},headerTextColor:{ref:"textColor"},headerCellHoverBackgroundColor:"transparent",headerCellMovingBackgroundColor:{ref:"backgroundColor"},headerCellBackgroundTransitionDuration:"0.2s",cellTextColor:{ref:"textColor"},subtleTextColor:{ref:"textColor",mix:.5},rangeSelectionBorderStyle:"solid",rangeSelectionBorderColor:{ref:"accentColor"},rangeSelectionBackgroundColor:{ref:"accentColor",mix:.2},rangeSelectionChartBackgroundColor:"#0058FF1A",rangeSelectionChartCategoryBackgroundColor:"#00FF841A",rangeSelectionHighlightColor:{ref:"accentColor",mix:.5},rowHoverColor:{ref:"accentColor",mix:.08},columnHoverColor:{ref:"accentColor",mix:.05},selectedRowBackgroundColor:{ref:"accentColor",mix:.12},modalOverlayBackgroundColor:{ref:"backgroundColor",mix:.66},oddRowBackgroundColor:{ref:"backgroundColor"},borderRadius:4,wrapperBorderRadius:8,cellHorizontalPadding:{calc:"spacing * 2 * cellHorizontalPaddingScale"},cellWidgetSpacing:{calc:"spacing * 1.5"},cellHorizontalPaddingScale:1,rowGroupIndentSize:{calc:"cellWidgetSpacing + iconSize"},valueChangeDeltaUpColor:"#43a047",valueChangeDeltaDownColor:"#e53935",valueChangeValueHighlightBackgroundColor:"#16a08580",spacing:8,fontSize:14,rowHeight:{calc:"max(iconSize, dataFontSize) + spacing * 3.25 * rowVerticalPaddingScale"},rowVerticalPaddingScale:1,headerHeight:{calc:"max(iconSize, dataFontSize) + spacing * 4 * headerVerticalPaddingScale"},headerVerticalPaddingScale:1,popupShadow:{radius:16,color:"#00000026"},dropdownShadow:{radius:4,spread:1,offsetY:1,color:"#babfc766"},dragAndDropImageBackgroundColor:{ref:"backgroundColor"},dragAndDropImageBorder:!0,dragAndDropImageShadow:{ref:"popupShadow"},dragHandleColor:{ref:"foregroundColor",mix:.7},focusShadow:{spread:3,color:{ref:"accentColor",mix:.5}},sideBarPanelWidth:250,sideBarBackgroundColor:{ref:"chromeBackgroundColor"},headerColumnResizeHandleHeight:"30%",headerColumnResizeHandleWidth:2,headerColumnResizeHandleColor:{ref:"borderColor"},widgetContainerHorizontalPadding:{calc:"spacing * 1.5"},widgetContainerVerticalPadding:{calc:"spacing * 1.5"},widgetHorizontalSpacing:{calc:"spacing * 1.5"},widgetVerticalSpacing:{ref:"spacing"},listItemHeight:{calc:"iconSize + widgetVerticalSpacing"},iconSize:16,toggleButtonWidth:28,toggleButtonHeight:18,toggleButtonBorderWidth:2,toggleButtonOnBorderColor:{ref:"accentColor"},toggleButtonOnBackgroundColor:{ref:"accentColor"},toggleButtonOffBorderColor:{ref:"foregroundColor",mix:.3,onto:"backgroundColor"},toggleButtonOffBackgroundColor:{ref:"foregroundColor",mix:.3,onto:"backgroundColor"},toggleButtonSwitchBorderColor:{ref:"toggleButtonOffBorderColor"},toggleButtonSwitchBackgroundColor:{ref:"backgroundColor"},menuBorder:{color:{ref:"foregroundColor",mix:.2}},menuBackgroundColor:{ref:"foregroundColor",mix:.03,onto:"backgroundColor"},menuTextColor:{ref:"foregroundColor",mix:.95,onto:"backgroundColor"},menuShadow:{ref:"popupShadow"},menuSeparatorColor:{ref:"borderColor"},setFilterIndentSize:{ref:"iconSize"},chartMenuPanelWidth:260,chartMenuLabelColor:{ref:"foregroundColor",mix:.8},iconButtonHoverColor:{ref:"foregroundColor",mix:.1},dialogShadow:{ref:"popupShadow"},dialogBorder:{color:{ref:"foregroundColor",mix:.2}},panelBackgroundColor:{ref:"backgroundColor"},panelTitleBarBackgroundColor:{ref:"headerBackgroundColor"},panelTitleBarBorder:!0,columnSelectIndentSize:{ref:"iconSize"},toolPanelSeparatorBorder:!0,tooltipBackgroundColor:{ref:"chromeBackgroundColor"},tooltipTextColor:{ref:"textColor"},tooltipBorder:!0,columnDropCellBackgroundColor:{ref:"foregroundColor",mix:.07},columnDropCellBorder:{color:{ref:"foregroundColor",mix:.13}},selectCellBackgroundColor:{ref:"foregroundColor",mix:.07},selectCellBorder:{color:{ref:"foregroundColor",mix:.13}},advancedFilterBuilderButtonBarBorder:!0,advancedFilterBuilderIndentSize:{calc:"spacing * 2 + iconSize"},advancedFilterBuilderJoinPillColor:"#f08e8d",advancedFilterBuilderColumnPillColor:"#a6e194",advancedFilterBuilderOptionPillColor:"#f3c08b",advancedFilterBuilderValuePillColor:"#85c0e4",filterToolPanelGroupIndent:{ref:"spacing"},iconButtonHoverBackgroundColor:{ref:"foregroundColor",mix:.1},rowLoadingSkeletonEffectColor:"rgba(66, 66, 66, 0.2)"},yu=e=>"--ag-".concat(e.replace(/[A-Z]/g,(e=>"-".concat(e))).toLowerCase()),Ru=e=>"var(".concat(yu(e),")"),Eu=(e=>{const t=new Map;return i=>{const r=i;return t.has(r)||t.set(r,e(i)),t.get(r)}})((e=>{if(/Color$/.test(e))return"color";if(/Scale?$/.test(e))return"scale";if("spacing"===e||/(Padding|Spacing|Size|Width|Height|Radius|Indent|Start|End|Top|Bottom|Horizontal|Vertical)$/.test(e))return"length";if(/Border$/.test(e))return"border";if(/BorderStyle$/.test(e))return"borderStyle";if(/Shadow$/.test(e))return"shadow";if(/Image$/.test(e))return"image";if(/Family$/.test(e))return"fontFamily";if(/Weight$/.test(e))return"fontWeight";if(/Duration$/.test(e))return"duration";if(/ColorScheme$/.test(e))return"colorScheme";throw new Error('"'.concat(e,'" is not a valid theme parameter.'))})),xu=e=>"string"===typeof e?e:"number"===typeof e&&String(e),Tu=e=>{if("string"===typeof e)return e;if("ref"in e){const t=Ru(e.ref);if(null==e.mix)return t;const i=e.onto?"var(--ag-background-color)":"transparent";return"color-mix(in srgb, ".concat(i,", ").concat(t," ").concat(((e,t,i)=>Math.max(t,Math.min(i,e)))(100*e.mix,0,100),"%)")}return!1},Fu=e=>{if("string"===typeof e)return e;if("number"===typeof e)return"".concat(e,"px");if("calc"in e){const t=e.calc.replace(/ ?[*/+] ?/g," $& ");return"calc(".concat(t.replace(/-?[a-z][a-z0-9]*\b(?![-(])/gi,(e=>"-"===e[0]?e:" ".concat(Ru(e)," "))),")")}return"ref"in e&&Ru(e.ref)},Pu=xu,Du=e=>"string"===typeof e?e:"googleFont"in e?Du(e.googleFont):"ref"in e?Ru(e.ref):!!Array.isArray(e)&&e.map((e=>("object"===typeof e&&"googleFont"in e&&(e=e.googleFont),/^[\w-]+$/.test(e)?e:JSON.stringify(e)))).join(", "),ku=e=>"string"===typeof e?e:"url"in e?"url(".concat(JSON.stringify(e.url),")"):"svg"in e?ku({url:"data:image/svg+xml,".concat(encodeURIComponent(e.svg))}):"ref"in e&&Ru(e.ref),Au={color:Tu,colorScheme:xu,length:Fu,scale:xu,border:(e,t)=>{var i,r,n;return"string"===typeof e?e:!0===e?"solid 1px var(--ag-border-color)":!1===e?"columnBorder"===t?"solid 1px transparent":"none":"ref"in e?Ru(e.ref):Pu(null!==(i=e.style)&&void 0!==i?i:"solid")+" "+Fu(null!==(r=e.width)&&void 0!==r?r:1)+" "+Tu(null!==(n=e.color)&&void 0!==n?n:{ref:"borderColor"})},borderStyle:Pu,shadow:e=>{var t,i,r,n,o;return"string"===typeof e?e:!1===e?"none":"ref"in e?Ru(e.ref):[Fu(null!==(t=e.offsetX)&&void 0!==t?t:0),Fu(null!==(i=e.offsetY)&&void 0!==i?i:0),Fu(null!==(r=e.radius)&&void 0!==r?r:0),Fu(null!==(n=e.spread)&&void 0!==n?n:0),Tu(null!==(o=e.color)&&void 0!==o?o:{ref:"foregroundColor"})].join(" ")},image:ku,fontFamily:Du,fontWeight:xu,duration:(e,t)=>"string"===typeof e?e:"number"===typeof e?(e>50&&C("Numeric value ".concat(e," passed to ").concat(t," param will be interpreted as ").concat(e,' seconds. If this is intentional use "').concat(e,'s" to silence this warning.')),"".concat(e,"s")):"ref"in e&&Ru(e.ref)},Mu=(e,t)=>{const i=Eu(e);return Au[i](t,e)},Iu=0,Lu="object"!==typeof window||!window||"object"!==typeof document||window.document!==document,Ou=0,Nu=!1,Bu=class e{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.id=e,this.dependencies=t,this.defaults=i,this.useCount=0}withPart(t){return"function"===typeof t&&(t=t()),new e(this.id,this.dependencies.concat(t),this.defaults)}withParams(t){const i=c({},this.defaults);for(const[e,r]of Object.entries(t))null!=r&&(i[e]=r);return new e(this.id,this.dependencies,i)}getCSS(){return[bu,...this._getCSSChunks().map((e=>e.css))].join("\n\n")}startUse(e){++this.useCount,1===this.useCount&&this._install(e)}stopUse(){--this.useCount,0===this.useCount&&setTimeout((()=>{0===this.useCount&&Vu(this.getCssClass(),this._installRoot)}),1e3)}getCssClass(){return null==this._cssClass&&(this._cssClass="ag-theme-".concat(++Ou)),this._cssClass}getParams(){if(this._getParamsCache)return this._getParamsCache;const e=c({},Su);for(const t of this._getFlatUnits())for(const[i,r]of Object.entries(t.defaults)){const t=null!=r?r:Su[i];null!=t&&(e[i]=t)}return this._getParamsCache=e}async _install(e){let{container:t,loadThemeGoogleFonts:i}=e;if(Lu)return;if(!Nu){Nu=!0,Vu("legacy",document.head);getComputedStyle(document.body).getPropertyValue("--ag-legacy-styles-loaded")&&C("both Theming API and the ag-grid.css are used on the same page, styling will be incorrect")}let r=t.getRootNode();r instanceof ShadowRoot||(r=document.head),this._installRoot=r;const n=[];n.push(zu({css:bu,part:"core",root:r}));for(const o of Hu(this))i?Wu(o):null==i&&v("theme uses google font ".concat(o," but no value for loadThemeGoogleFonts was provided. Pass true to load fonts from ").concat(Uu," or false to silence this warning."));for(const o of this._getCSSChunks())zu({css:o.css,part:o.id,scope:this.getCssClass(),root:r});return Promise.all(n)}_getFlatUnits(){if(this._getFlatUnitsCache)return this._getFlatUnitsCache;const e={};for(const i of this.dependencies)delete e[i.feature],e[i.feature]=i;const t=[...Object.values(e),this];return this._getFlatUnitsCache=t}_getCSSChunks(){if(this._getCssChunksCache)return this._getCssChunksCache;const e=[];e.push(Gu(this));for(const t of this._getFlatUnits())if(t.css&&t.css.length>0){let i="/* Part ".concat(t.id," */");i+=t.css.map((e=>"function"===typeof e?e():e)).join("\n")+"\n",i=".".concat(this.getCssClass()," {\n\t").concat(i,"\n}"),e.push({css:i,id:t.id})}return this._getCssChunksCache=e}},Gu=e=>{let t="",i="";for(const[o,s]of Object.entries(e.getParams())){const e=Mu(o,s);if(!1===e)C("Invalid value for param ".concat(o," - ").concat(Ku(s)));else{const r=yu(o),n=r.replace("--ag-","--ag-inherited-");t+="\t".concat(r,": var(").concat(n,", ").concat(e,");\n"),i+="\t".concat(n,": var(").concat(r,");\n")}}const r=":where(.".concat(e.getCssClass(),")");let n="".concat(r," {\n").concat(t,"}\n");return n+=":has(> ".concat(r,"):not(").concat(r,") {\n").concat(i,"}\n"),{css:n,id:"variables"}},Hu=e=>Array.from(new Set(Object.values(e.getParams()).flat().map((e=>null===e||void 0===e?void 0:e.googleFont)).filter((e=>"string"===typeof e)))).sort(),zu=async e=>{let{root:t,part:i,scope:r,css:n}=e,o=':scope > style[data-ag-part="'.concat(i,'"]');r&&(o+='[data-ag-scope="'.concat(r,'"]'));let s=t.querySelector(o);if(!s){s=document.createElement("style"),s.dataset.agPart=i,r&&(s.dataset.agScope=r);const e=t.querySelectorAll(":scope > style[data-ag-part]"),n=e[e.length-1];n?n.insertAdjacentElement("afterend",s):t.firstElementChild?t.firstElementChild.insertAdjacentElement("beforebegin",s):t.appendChild(s)}if(s._agTextContent!==n)return s.textContent=n,s._agTextContent=n,ju(s)},Vu=(e,t)=>{for(const i of Array.from(t.querySelectorAll(':scope > style[data-ag-scope="'.concat(e,'"]'))))i.remove()},_u=new Set,Wu=async e=>{if(_u.has(e))return;_u.add(e);const t="@import url('https://".concat(Uu,"/css2?family=").concat(encodeURIComponent(e),":wght@100;200;300;400;500;600;700;800;900&display=swap');\n");return zu({css:t,part:"googleFont:".concat(e),root:document.head})},Uu="fonts.googleapis.com",ju=e=>new Promise((t=>{const i=()=>{e.removeEventListener("load",i),t()};e.addEventListener("load",i)})),Ku=e=>null==e?String(e):"".concat(typeof e," ").concat(e),Yu=Cu("checkboxStyle","default").withAdditionalParams({checkboxBorderWidth:1,checkboxBorderRadius:{ref:"borderRadius"},checkboxUncheckedBackgroundColor:{ref:"backgroundColor"},checkboxUncheckedBorderColor:{ref:"foregroundColor",mix:.3,onto:"backgroundColor"},checkboxCheckedBackgroundColor:{ref:"accentColor"},checkboxCheckedBorderColor:{ref:"accentColor"},checkboxCheckedShapeImage:{svg:'<svg xmlns="http://www.w3.org/2000/svg" width="10" height="7" fill="none"><path stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.75" d="M1 3.5 3.5 6l5-5"/></svg>'},checkboxCheckedShapeColor:{ref:"backgroundColor"},checkboxIndeterminateBackgroundColor:{ref:"foregroundColor",mix:.3,onto:"backgroundColor"},checkboxIndeterminateBorderColor:{ref:"foregroundColor",mix:.3,onto:"backgroundColor"},checkboxIndeterminateShapeImage:{svg:'<svg xmlns="http://www.w3.org/2000/svg" width="10" height="2" fill="none"><rect width="10" height="2" fill="#000" rx="1"/></svg>'},checkboxIndeterminateShapeColor:{ref:"backgroundColor"},radioCheckedShapeImage:{svg:'<svg xmlns="http://www.w3.org/2000/svg" width="6" height="6" fill="none"><circle cx="3" cy="3" r="3" fill="#000"/></svg>'}}).withCSS('.ag-checkbox-input-wrapper,.ag-radio-button-input-wrapper{background-color:var(--ag-checkbox-unchecked-background-color);border:solid var(--ag-checkbox-border-width) var(--ag-checkbox-unchecked-border-color);flex:none;height:var(--ag-icon-size);position:relative;width:var(--ag-icon-size);& input{-webkit-appearance:none;-moz-appearance:none;appearance:none;height:100%;opacity:0;width:100%}&:after{content:"";display:block;inset:0;-webkit-mask-position:center;mask-position:center;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;pointer-events:none;position:absolute}&.ag-checked{background-color:var(--ag-checkbox-checked-background-color);border-color:var(--ag-checkbox-checked-border-color);&:after{background-color:var(--ag-checkbox-checked-shape-color)}}&:active,&:focus-within{box-shadow:var(--ag-focus-shadow)}&.ag-disabled{filter:grayscale();opacity:.5}}.ag-checkbox-input-wrapper{border-radius:var(--ag-checkbox-border-radius);&.ag-checked:after{-webkit-mask-image:var(--ag-checkbox-checked-shape-image);mask-image:var(--ag-checkbox-checked-shape-image)}&.ag-indeterminate{background-color:var(--ag-checkbox-indeterminate-background-color);border-color:var(--ag-checkbox-indeterminate-border-color);&:after{background-color:var(--ag-checkbox-indeterminate-shape-color);-webkit-mask-image:var(--ag-checkbox-indeterminate-shape-image);mask-image:var(--ag-checkbox-indeterminate-shape-image)}}}.ag-radio-button-input-wrapper{border-radius:100%;&.ag-checked:after{-webkit-mask-image:var(--ag-radio-checked-shape-image);mask-image:var(--ag-radio-checked-shape-image)}}'),qu=Cu("colorScheme","light"),Qu={aggregation:'<path d="M18 7V4H6l6 8-6 8h12v-3"/>',arrows:'<polyline points="5 9 2 12 5 15"/><polyline points="9 5 12 2 15 5"/><polyline points="15 19 12 22 9 19"/><polyline points="19 9 22 12 19 15"/><line x1="2" x2="22" y1="12" y2="12"/><line x1="12" x2="12" y1="2" y2="22"/>',asc:'<path d="m5 12 7-7 7 7"/><path d="M12 19V5"/>',cancel:'<circle cx="12" cy="12" r="10"/><path d="m15 9-6 6"/><path d="m9 9 6 6"/>',chart:'<line x1="18" x2="18" y1="20" y2="10"/><line x1="12" x2="12" y1="20" y2="4"/><line x1="6" x2="6" y1="20" y2="14"/>',"color-picker":'<path d="m19 11-8-8-8.6 8.6a2 2 0 0 0 0 2.8l5.2 5.2c.8.8 2 .8 2.8 0L19 11Z"/><path d="m5 2 5 5"/><path d="M2 13h15"/><path d="M22 20a2 2 0 1 1-4 0c0-1.6 1.7-2.4 2-4 .3 1.6 2 2.4 2 4Z"/>',columns:'<path d="M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18"/>',contracted:'<path d="m9 18 6-6-6-6"/>',copy:'<rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/>',cross:'<path d="M18 6 6 18"/><path d="m6 6 12 12"/>',csv:'<path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><path d="M8 13h2"/><path d="M8 17h2"/><path d="M14 13h2"/><path d="M14 17h2"/>',cut:'<circle cx="6" cy="6" r="3"/><path d="M8.12 8.12 12 12"/><path d="M20 4 8.12 15.88"/><circle cx="6" cy="18" r="3"/><path d="M14.8 14.8 20 20"/>',desc:'<path d="M12 5v14"/><path d="m19 12-7 7-7-7"/>',down:'<path d="M12 5v14"/><path d="m19 12-7 7-7-7"/>',excel:'<path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><path d="M8 13h2"/><path d="M8 17h2"/><path d="M14 13h2"/><path d="M14 17h2"/>',expanded:'<path d="m15 18-6-6 6-6"/>',"eye-slash":'<path d="M9.88 9.88a3 3 0 1 0 4.24 4.24"/><path d="M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68"/><path d="M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61"/><line x1="2" x2="22" y1="2" y2="22"/>',eye:'<path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/>',filter:'<path d="M3 6h18"/><path d="M7 12h10"/><path d="M10 18h4"/>',first:'<path d="m17 18-6-6 6-6"/><path d="M7 6v12"/>',group:'<path d="M16 12H3"/><path d="M16 18H3"/><path d="M10 6H3"/><path d="M21 18V8a2 2 0 0 0-2-2h-5"/><path d="m16 8-2-2 2-2"/>',last:'<path d="m7 18 6-6-6-6"/><path d="M17 6v12"/>',left:'<path d="m12 19-7-7 7-7"/><path d="M19 12H5"/>',linked:'<path d="M9 17H7A5 5 0 0 1 7 7h2"/><path d="M15 7h2a5 5 0 1 1 0 10h-2"/><line x1="8" x2="16" y1="12" y2="12"/>',loading:'<line x1="12" x2="12" y1="2" y2="6"/><line x1="12" x2="12" y1="18" y2="22"/><line x1="4.93" x2="7.76" y1="4.93" y2="7.76"/><line x1="16.24" x2="19.07" y1="16.24" y2="19.07"/><line x1="2" x2="6" y1="12" y2="12"/><line x1="18" x2="22" y1="12" y2="12"/><line x1="4.93" x2="7.76" y1="19.07" y2="16.24"/><line x1="16.24" x2="19.07" y1="7.76" y2="4.93"/>',maximize:'<polyline points="15 3 21 3 21 9"/><polyline points="9 21 3 21 3 15"/><line x1="21" x2="14" y1="3" y2="10"/><line x1="3" x2="10" y1="21" y2="14"/>',menu:'<line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/>',"menu-alt":'<circle cx="12" cy="5" r="0.75" fill="#D9D9D9"/><circle cx="12" cy="12" r="0.75" fill="#D9D9D9"/><circle cx="12" cy="19" r="0.75" fill="#D9D9D9"/>',minimize:'<polyline points="4 14 10 14 10 20"/><polyline points="20 10 14 10 14 4"/><line x1="14" x2="21" y1="10" y2="3"/><line x1="3" x2="10" y1="21" y2="14"/>',minus:'<circle cx="12" cy="12" r="10"/><path d="M8 12h8"/>',next:'<path d="m9 18 6-6-6-6"/>',none:'<path d="m7 15 5 5 5-5"/><path d="m7 9 5-5 5 5"/>',"not-allowed":'<circle cx="12" cy="12" r="10"/><path d="m4.9 4.9 14.2 14.2"/>',paste:'<path d="M15 2H9a1 1 0 0 0-1 1v2c0 .6.4 1 1 1h6c.6 0 1-.4 1-1V3c0-.6-.4-1-1-1Z"/><path d="M8 4H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2M16 4h2a2 2 0 0 1 2 2v2M11 14h10"/><path d="m17 10 4 4-4 4"/>',pin:'<line x1="12" x2="12" y1="17" y2="22"/><path d="M5 17h14v-1.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V6h1a2 2 0 0 0 0-4H8a2 2 0 0 0 0 4h1v4.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24Z"/>',pivot:'<path d="M15 3v18"/><rect width="18" height="18" x="3" y="3" rx="2"/><path d="M21 9H3"/><path d="M21 15H3"/>',plus:'<circle cx="12" cy="12" r="10"/><path d="M8 12h8"/><path d="M12 8v8"/>',previous:'<path d="m15 18-6-6 6-6"/>',right:'<path d="M5 12h14"/><path d="m12 5 7 7-7 7"/>',save:'<path d="M12 17V3"/><path d="m6 11 6 6 6-6"/><path d="M19 21H5"/>',"small-down":'<path d="m6 9 6 6 6-6"/>',"small-left":'<path d="m15 18-6-6 6-6"/>',"small-right":'<path d="m9 18 6-6-6-6"/>',"small-up":'<path d="m18 15-6-6-6 6"/>',tick:'<path d="M20 6 9 17l-5-5"/>',"tree-closed":'<path d="m9 18 6-6-6-6"/>',"tree-indeterminate":'<path d="M5 12h14"/>',"tree-open":'<path d="m6 9 6 6 6-6"/>',unlinked:'<path d="M9 17H7A5 5 0 0 1 7 7"/><path d="M15 7h2a5 5 0 0 1 4 8"/><line x1="8" x2="12" y1="12" y2="12"/><line x1="2" x2="22" y1="2" y2="22"/>',up:'<path d="m5 12 7-7 7 7"/><path d="M12 19V5"/>',grip:'<circle cx="5" cy="8" r="0.5"/><circle cx="12" cy="8" r="0.5"/><circle cx="19" cy="8" r="0.5"/><circle cx="5" cy="16" r="0.5"/><circle cx="12" cy="16" r="0.5"/><circle cx="19" cy="16" r="0.5"/><g stroke="none" fill="currentColor"><circle cx="5" cy="8" r="1"/><circle cx="12" cy="8" r="1"/><circle cx="19" cy="8" r="1"/><circle cx="5" cy="16" r="1"/><circle cx="12" cy="16" r="1"/><circle cx="19" cy="16" r="1"/></g>',settings:'<path d="M20 7h-9"/><path d="M14 17H5"/><circle cx="17" cy="17" r="3"/><circle cx="7" cy="7" r="3"/>'},$u=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t='.ag-icon:before{background-color:currentColor;content:"";display:block;height:var(--ag-icon-size);-webkit-mask-image:linear-gradient(#0000,#0000);mask-image:linear-gradient(#0000,#0000);-webkit-mask-size:contain;mask-size:contain;width:var(--ag-icon-size)}';for(const i of Object.keys(Qu)){const r=Xu(i,e.strokeWidth||1.5);t+=".ag-icon-".concat(i,"::before { mask-image: url('data:image/svg+xml,").concat(encodeURIComponent(r),"'); }\n")}return t},Xu=(e,t)=>{const i=Qu[e];if(!i)throw new Error("Missing icon data for ".concat(e));return'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon ag-icon-'.concat(e,'" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke="black" stroke-width="').concat(t,'" viewBox="0 0 24 24"><style>* { vector-effect: non-scaling-stroke; }</style>')+i+"</svg>"},Ju=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Cu("iconSet","quartz").withCSS((()=>$u(e)))},Zu=Cu("inputStyle","base").withAdditionalParams({inputBackgroundColor:"transparent",inputBorder:!1,inputBorderRadius:0,inputTextColor:{ref:"textColor"},inputPaddingStart:0,inputHeight:{calc:"max(iconSize, fontSize) + spacing * 2"},inputFocusBackgroundColor:{ref:"inputBackgroundColor"},inputFocusBorder:{ref:"inputBorder"},inputFocusShadow:"none",inputFocusTextColor:{ref:"inputTextColor"},inputDisabledBackgroundColor:{ref:"inputBackgroundColor"},inputDisabledBorder:{ref:"inputBorder"},inputDisabledTextColor:{ref:"inputTextColor"},inputInvalidBackgroundColor:{ref:"inputBackgroundColor"},inputInvalidBorder:{ref:"inputBorder"},inputInvalidTextColor:{ref:"inputTextColor"}}).withCSS(":where(input[class^=ag-][type=number]:not(.ag-number-field-input-stepper)){-moz-appearance:textfield;&::-webkit-inner-spin-button,&::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}}:where(input[class^=ag-]:not([type]),input[class^=ag-][type=text],input[class^=ag-][type=number],input[class^=ag-][type=tel],input[class^=ag-][type=date],input[class^=ag-][type=datetime-local],textarea[class^=ag-]){background-color:var(--ag-input-background-color);border:var(--ag-input-border);border-radius:var(--ag-input-border-radius);color:var(--ag-input-text-color);cursor:pointer;font-family:inherit;font-size:inherit;line-height:inherit;margin:0;min-height:var(--ag-input-height);padding:0;&:where(:disabled){background-color:var(--ag-input-disabled-background-color);border:var(--ag-input-disabled-border);color:var(--ag-input-disabled-text-color)}&:where(:focus){background-color:var(--ag-input-focus-background-color);border:var(--ag-input-focus-border);box-shadow:var(--ag-input-focus-shadow);color:var(--ag-input-focus-text-color)}&:where(:invalid){background-color:var(--ag-input-invalid-background-color);border:var(--ag-input-invalid-border);color:var(--ag-input-invalid-text-color)}&:where(.invalid){background-color:var(--ag-input-invalid-background-color);border:var(--ag-input-invalid-border);color:var(--ag-input-invalid-text-color)}}&.ag-ltr :where(input[class^=ag-]:not([type]),input[class^=ag-][type=text],input[class^=ag-][type=number],input[class^=ag-][type=tel],input[class^=ag-][type=date],input[class^=ag-][type=datetime-local],textarea[class^=ag-]){padding-left:var(--ag-input-padding-start)}&.ag-rtl :where(input[class^=ag-]:not([type]),input[class^=ag-][type=text],input[class^=ag-][type=number],input[class^=ag-][type=tel],input[class^=ag-][type=date],input[class^=ag-][type=datetime-local],textarea[class^=ag-]){padding-right:var(--ag-input-padding-start)}"),ed=mu(Zu,"bordered").withParams({inputBackgroundColor:{ref:"backgroundColor"},inputBorder:!0,inputBorderRadius:{ref:"borderRadius"},inputPaddingStart:{ref:"spacing"},inputFocusBorder:{color:{ref:"accentColor"}},inputFocusShadow:{ref:"focusShadow"},inputDisabledBackgroundColor:{ref:"foregroundColor",mix:.06,onto:"backgroundColor"},inputDisabledTextColor:{ref:"textColor",mix:.5},inputInvalidBorder:{color:{ref:"invalidColor"}}}),td=Cu("tabStyle","base").withAdditionalParams({tabBarBackgroundColor:"transparent",tabBarHorizontalPadding:0,tabBarTopPadding:0,tabBackgroundColor:"transparent",tabTextColor:{ref:"textColor"},tabHorizontalPadding:{ref:"spacing"},tabTopPadding:{ref:"spacing"},tabBottomPadding:{ref:"spacing"},tabSpacing:"0",tabHoverBackgroundColor:{ref:"tabBackgroundColor"},tabHoverTextColor:{ref:"tabTextColor"},tabSelectedBackgroundColor:{ref:"tabBackgroundColor"},tabSelectedTextColor:{ref:"tabTextColor"},tabSelectedBorderWidth:1,tabSelectedBorderColor:"transparent",tabSelectedUnderlineColor:"transparent",tabSelectedUnderlineWidth:"0",tabSelectedUnderlineTransitionDuration:"0",tabBarBorder:!1}).withCSS('.ag-tabs-header{background-color:var(--ag-tab-bar-background-color);border-bottom:var(--ag-tab-bar-border);display:flex;gap:var(--ag-tab-spacing);padding:var(--ag-tab-bar-top-padding) var(--ag-tab-bar-horizontal-padding) 0}.ag-tabs-header-wrapper{display:flex;.ag-tabs-header{flex:1}}.ag-tabs-close-button-wrapper{border:0;padding:var(--ag-spacing)}&.ag-ltr .ag-tabs-close-button-wrapper{border-right:1px solid var(--ag-border-color)}&.ag-rtl .ag-tabs-close-button-wrapper{border-left:1px solid var(--ag-border-color)}.ag-tabs-close-button{background-color:unset;border:0;cursor:pointer;padding:0}.ag-tab{align-items:center;background-color:var(--ag-tab-background-color);border-left:var(--ag-tab-selected-border-width) solid transparent;border-right:var(--ag-tab-selected-border-width) solid transparent;color:var(--ag-tab-text-color);cursor:pointer;display:flex;flex:1;justify-content:center;padding:var(--ag-tab-top-padding) var(--ag-tab-horizontal-padding) var(--ag-tab-bottom-padding);position:relative;&:hover{background-color:var(--ag-tab-hover-background-color);color:var(--ag-tab-hover-text-color)}&.ag-tab-selected{background-color:var(--ag-tab-selected-background-color);color:var(--ag-tab-selected-text-color)}&:after{background-color:var(--ag-tab-selected-underline-color);bottom:0;content:"";display:block;height:var(--ag-tab-selected-underline-width);left:0;opacity:0;position:absolute;right:0;transition:opacity var(--ag-tab-selected-underline-transition-duration)}&.ag-tab-selected:after{opacity:1}&:focus-visible{box-shadow:inset var(--ag-focus-shadow)}}&.ag-ltr .ag-tab{&.ag-tab-selected{&:not(:first-of-type){border-left-color:var(--ag-tab-selected-border-color)}&:not(:last-of-type){border-right-color:var(--ag-tab-selected-border-color)}}}&.ag-rtl .ag-tab{&.ag-tab-selected{&:not(:first-of-type){border-right-color:var(--ag-tab-selected-border-color)}&:not(:last-of-type){border-left-color:var(--ag-tab-selected-border-color)}}}'),id=mu(td,"quartz").withParams({tabBarBorder:!0,tabBarBackgroundColor:{ref:"foregroundColor",mix:.05},tabTextColor:{ref:"textColor",mix:.7},tabSelectedTextColor:{ref:"textColor"},tabHoverTextColor:{ref:"textColor"},tabSelectedBorderColor:{ref:"borderColor"},tabSelectedBackgroundColor:{ref:"backgroundColor"}}),rd=e=>function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"customTheme".concat(++Iu);return new Bu(e,[],{})}(e).withPart(Yu),nd=rd("quartz").withPart(qu).withPart(Ju).withPart(id).withPart((()=>ed)).withParams({fontFamily:[{googleFont:"IBM Plex Sans"},"-apple-system","BlinkMacSystemFont","Segoe UI","Roboto","Oxygen-Sans","Ubuntu"]});fn.__registerModules([nc,Yc,fu,eu],!1,void 0);var od=i(950);const sd=["key"];var ad,ld=r.createContext({}),cd=(e,t,i,r)=>{if(!e||e.componentFromFramework||t.isDestroyed())return;const n=e.newAgStackInstance();if(null==n)return;let o,s,a=!1;return n.then((e=>{a?t.destroyBean(e):(o=e,s=o.getGui(),i.appendChild(s),ud(r,o))})),()=>{var e;a=!0,o&&(null===(e=s)||void 0===e||null===(e=e.parentElement)||void 0===e||e.removeChild(s),t.destroyBean(o),r&&ud(r,void 0))}},ud=(e,t)=>{if(e)if(e instanceof Function){e(t)}else{e.current=t}},dd=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return t.filter((e=>null!=e&&""!==e)).join(" ")},hd=class e{constructor(){this.classesMap={};for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];t.forEach((e=>{this.classesMap[e]=!0}))}setClass(t,i){if(!!this.classesMap[t]==i)return this;const r=new e;return r.classesMap=c({},this.classesMap),r.classesMap[t]=i,r}toString(){return Object.keys(this.classesMap).filter((e=>this.classesMap[e])).join(" ")}},gd=e=>"function"===typeof e&&!(e.prototype&&e.prototype.isReactComponent)||"object"===typeof e&&e.$$typeof===("function"===typeof Symbol&&Symbol.for?Symbol.for("react.memo"):60115),pd=null===(ad=r.version)||void 0===ad?void 0:ad.split(".")[0],fd="16"===pd||"17"===pd;var md=!1;var vd=(e,t)=>{fd||!e||md?t():od.flushSync(t)};function Cd(e,t,i){if(null==t||null==e)return t;if(e===t||0===t.length&&0===e.length)return e;if(i||0===e.length&&t.length>0||e.length>0&&0===t.length)return t;const r=[],n=[],o=new Map,s=new Map;for(let a=0;a<t.length;a++){const e=t[a];s.set(e.instanceId,e)}for(let a=0;a<e.length;a++){const t=e[a];o.set(t.instanceId,t),s.has(t.instanceId)&&r.push(t)}for(let a=0;a<t.length;a++){const e=t[a],i=e.instanceId;o.has(i)||n.push(e)}return r.length===e.length&&0===n.length?e:0===r.length&&n.length===t.length?t:0===r.length?n:0===n.length?r:[...r,...n]}var wd=(0,r.forwardRef)(((e,t)=>{var i;const{ctrlsFactory:n,context:o}=(0,r.useContext)(ld),s=(0,r.useRef)(null),a=(0,r.useRef)(null),l=(0,r.useRef)(null),u=(0,r.useRef)(null),d=(0,r.useRef)(null),h=(0,r.useRef)(),[g,p]=(0,r.useState)(),[f,m]=(0,r.useState)(),[v,C]=(0,r.useState)(),[w,b]=(0,r.useState)((()=>new hd)),[S,y]=(0,r.useState)((()=>new hd("ag-hidden"))),[R,E]=(0,r.useState)((()=>new hd("ag-hidden"))),[x,T]=(0,r.useState)((()=>new hd("ag-invisible")));(0,r.useImperativeHandle)(t,(()=>({refresh:()=>!1}))),(0,r.useLayoutEffect)((()=>cd(g,o,a.current)),[g]);const F=(0,r.useCallback)((t=>{if(s.current=t,!t)return void(h.current=o.destroyBean(h.current));const i={setInnerRenderer:(e,t)=>{p(e),C(t)},setChildCount:e=>m(e),addOrRemoveCssClass:(e,t)=>b((i=>i.setClass(e,t))),setContractedDisplayed:e=>E((t=>t.setClass("ag-hidden",!e))),setExpandedDisplayed:e=>y((t=>t.setClass("ag-hidden",!e))),setCheckboxVisible:e=>T((t=>t.setClass("ag-invisible",!e)))},r=n.getInstance("groupCellRendererCtrl");r&&(h.current=o.createBean(r),h.current.init(i,t,l.current,u.current,d.current,wd,e))}),[]),P=(0,r.useMemo)((()=>"ag-cell-wrapper ".concat(w.toString())),[w]),D=(0,r.useMemo)((()=>"ag-group-expanded ".concat(S.toString())),[S]),k=(0,r.useMemo)((()=>"ag-group-contracted ".concat(R.toString())),[R]),A=(0,r.useMemo)((()=>"ag-group-checkbox ".concat(x.toString())),[x]),M=g&&g.componentFromFramework,I=M?g.componentClass:void 0,L=null==g&&null!=v,O=Pt(v,!0);return r.createElement("span",c({className:P,ref:F},e.colDef?{}:{role:null===(i=h.current)||void 0===i?void 0:i.getCellAriaRole()}),r.createElement("span",{className:D,ref:u}),r.createElement("span",{className:k,ref:d}),r.createElement("span",{className:A,ref:l}),r.createElement("span",{className:"ag-group-value",ref:a},L&&r.createElement(r.Fragment,null,O),M&&r.createElement(I,c({},g.params))),r.createElement("span",{className:"ag-group-child-count"},f))})),bd=wd,Sd=(0,r.createContext)({setMethods:()=>{}}),yd=(0,r.memo)((e=>{const{initialProps:t,addUpdateCallback:i,CustomComponentClass:n,setMethods:o}=e,[s,a]=(0,r.useState)(t),{key:l}=s,d=u(s,sd);return(0,r.useEffect)((()=>{i((e=>a(e)))}),[]),r.createElement(Sd.Provider,{value:{setMethods:o}},r.createElement(n,c({key:l},d)))})),Rd=0;function Ed(){return"agPortalKey_".concat(++Rd)}var xd=class{constructor(e,t,i,r){this.portal=null,this.oldPortal=null,this.reactComponent=e,this.portalManager=t,this.componentType=i,this.suppressFallbackMethods=!!r,this.statelessComponent=this.isStateless(this.reactComponent),this.key=Ed(),this.portalKey=Ed(),this.instanceCreated=this.isStatelessComponent()?Wr.resolve(!1):new Wr((e=>{this.resolveInstanceCreated=e}))}getGui(){return this.eParentElement}getRootElement(){return this.eParentElement.firstChild}destroy(){this.componentInstance&&"function"==typeof this.componentInstance.destroy&&this.componentInstance.destroy();const e=this.portal;e&&this.portalManager.destroyPortal(e)}createParentElement(e){const t=this.portalManager.getComponentWrappingElement(),i=document.createElement(t||"div");return i.classList.add("ag-react-container"),e.reactContainer=i,i}addParentContainerStyleAndClasses(){if(this.componentInstance&&(this.componentInstance.getReactContainerStyle&&this.componentInstance.getReactContainerStyle()&&(v('Since v31.1 "getReactContainerStyle" is deprecated. Apply styling directly to ".ag-react-container" if needed.'),Object.assign(this.eParentElement.style,this.componentInstance.getReactContainerStyle())),this.componentInstance.getReactContainerClasses&&this.componentInstance.getReactContainerClasses())){v('Since v31.1 "getReactContainerClasses" is deprecated. Apply styling directly to ".ag-react-container" if needed.');this.componentInstance.getReactContainerClasses().forEach((e=>this.eParentElement.classList.add(e)))}}statelessComponentRendered(){return this.eParentElement.childElementCount>0||this.eParentElement.childNodes.length>0}getFrameworkComponentInstance(){return this.componentInstance}isStatelessComponent(){return this.statelessComponent}getReactComponentName(){return this.reactComponent.name}getMemoType(){return this.hasSymbol()?Symbol.for("react.memo"):60115}hasSymbol(){return"function"===typeof Symbol&&Symbol.for}isStateless(e){return"function"===typeof e&&!(e.prototype&&e.prototype.isReactComponent)||"object"===typeof e&&e.$$typeof===this.getMemoType()}hasMethod(e){const t=this.getFrameworkComponentInstance();return!!t&&null!=t[e]||this.fallbackMethodAvailable(e)}callMethod(e,t){const i=this.getFrameworkComponentInstance();if(this.isStatelessComponent())return this.fallbackMethod(e,t&&t[0]?t[0]:{});if(!i)return void setTimeout((()=>this.callMethod(e,t)));const r=i[e];return r?r.apply(i,t):this.fallbackMethodAvailable(e)?this.fallbackMethod(e,t&&t[0]?t[0]:{}):void 0}addMethod(e,t){this[e]=t}init(e){return this.eParentElement=this.createParentElement(e),this.createOrUpdatePortal(e),new Wr((e=>this.createReactComponent(e)))}createOrUpdatePortal(e){this.isStatelessComponent()||(this.ref=e=>{var t;this.componentInstance=e,this.addParentContainerStyleAndClasses(),null===(t=this.resolveInstanceCreated)||void 0===t||t.call(this,!0),this.resolveInstanceCreated=void 0},e.ref=this.ref),this.reactElement=this.createElement(this.reactComponent,c(c({},e),{},{key:this.key})),this.portal=(0,od.createPortal)(this.reactElement,this.eParentElement,this.portalKey)}createElement(e,t){return(0,r.createElement)(e,t)}createReactComponent(e){this.portalManager.mountReactPortal(this.portal,this,e)}rendered(){return this.isStatelessComponent()&&this.statelessComponentRendered()||!(this.isStatelessComponent()||!this.getFrameworkComponentInstance())}refreshComponent(e){this.oldPortal=this.portal,this.createOrUpdatePortal(e),this.portalManager.updateReactPortal(this.oldPortal,this.portal)}fallbackMethod(e,t){const i=this["".concat(e,"Component")];if(!this.suppressFallbackMethods&&i)return i.bind(this)(t)}fallbackMethodAvailable(e){if(this.suppressFallbackMethods)return!1;return!!this["".concat(e,"Component")]}};function Td(e,t,i){e.forEach((e=>{const r=t[e];r&&(i[e]=r)}))}var Fd=class extends xd{constructor(){super(...arguments),this.awaitUpdateCallback=new Wr((e=>{this.resolveUpdateCallback=e})),this.wrapperComponent=yd}init(e){return this.sourceParams=e,super.init(this.getProps())}addMethod(){}getInstance(){return this.instanceCreated.then((()=>this.componentInstance))}getFrameworkComponentInstance(){return this}createElement(e,t){return super.createElement(this.wrapperComponent,{initialProps:t,CustomComponentClass:e,setMethods:e=>this.setMethods(e),addUpdateCallback:e=>{this.updateCallback=()=>(e(this.getProps()),new Wr((e=>{setTimeout((()=>{e()}))}))),this.resolveUpdateCallback()}})}setMethods(e){this.providedMethods=e,Td(this.getOptionalMethods(),this.providedMethods,this)}getOptionalMethods(){return[]}getProps(){return c(c({},this.sourceParams),{},{key:this.key,ref:this.ref})}refreshProps(){return this.updateCallback?this.updateCallback():new Wr((e=>this.awaitUpdateCallback.then((()=>{this.updateCallback().then((()=>e()))}))))}},Pd=class extends Fd{refresh(e){return this.sourceParams=e,this.refreshProps(),!0}},Dd=class extends Fd{constructor(){super(...arguments),this.date=null,this.onDateChange=e=>this.updateDate(e)}getDate(){return this.date}setDate(e){this.date=e,this.refreshProps()}refresh(e){this.sourceParams=e,this.refreshProps()}getOptionalMethods(){return["afterGuiAttached","setInputPlaceholder","setInputAriaLabel","setDisabled"]}updateDate(e){this.setDate(e),this.sourceParams.onDateChanged()}getProps(){const e=super.getProps();return e.date=this.date,e.onDateChange=this.onDateChange,delete e.onDateChanged,e}},kd=class extends Fd{constructor(){super(...arguments),this.label="",this.icon=null,this.shake=!1}setIcon(e,t){this.icon=e,this.shake=t,this.refreshProps()}setLabel(e){this.label=e,this.refreshProps()}getProps(){const e=super.getProps(),{label:t,icon:i,shake:r}=this;return e.label=t,e.icon=i,e.shake=r,e}},Ad=class extends Fd{constructor(){super(...arguments),this.model=null,this.onModelChange=e=>this.updateModel(e),this.onUiChange=()=>this.sourceParams.filterChangedCallback(),this.expectingNewMethods=!0,this.hasBeenActive=!1}isFilterActive(){return null!=this.model}doesFilterPass(e){return this.providedMethods.doesFilterPass(e)}getModel(){return this.model}setModel(e){return this.expectingNewMethods=!0,this.model=e,this.hasBeenActive||(this.hasBeenActive=this.isFilterActive()),this.refreshProps()}refresh(e){return this.sourceParams=e,this.refreshProps(),!0}getOptionalMethods(){return["afterGuiAttached","afterGuiDetached","onNewRowsLoaded","getModelAsString","onAnyFilterChanged"]}setMethods(e){var t;!1===this.expectingNewMethods&&this.hasBeenActive&&(null===(t=this.providedMethods)||void 0===t?void 0:t.doesFilterPass)!==(null===e||void 0===e?void 0:e.doesFilterPass)&&setTimeout((()=>{this.sourceParams.filterChangedCallback()})),this.expectingNewMethods=!1,super.setMethods(e)}updateModel(e){this.setModel(e).then((()=>this.sourceParams.filterChangedCallback()))}getProps(){const e=super.getProps();return e.model=this.model,e.onModelChange=this.onModelChange,e.onUiChange=this.onUiChange,delete e.filterChangedCallback,delete e.filterModifiedCallback,delete e.valueGetter,e}};function Md(e,t){e.parentFilterInstance((i=>{(i.setModel(t)||Wr.resolve()).then((()=>{e.filterParams.filterChangedCallback()}))}))}var Id=class{constructor(e,t){this.floatingFilterParams=e,this.refreshProps=t,this.model=null,this.onModelChange=e=>this.updateModel(e)}getProps(){return c(c({},this.floatingFilterParams),{},{model:this.model,onModelChange:this.onModelChange})}onParentModelChanged(e){this.model=e,this.refreshProps()}refresh(e){this.floatingFilterParams=e,this.refreshProps()}setMethods(e){Td(this.getOptionalMethods(),e,this)}getOptionalMethods(){return["afterGuiAttached"]}updateModel(e){this.model=e,this.refreshProps(),Md(this.floatingFilterParams,e)}},Ld=class extends Fd{constructor(){super(...arguments),this.model=null,this.onModelChange=e=>this.updateModel(e)}onParentModelChanged(e){this.model=e,this.refreshProps()}refresh(e){this.sourceParams=e,this.refreshProps()}getOptionalMethods(){return["afterGuiAttached"]}updateModel(e){this.model=e,this.refreshProps(),Md(this.sourceParams,e)}getProps(){const e=super.getProps();return e.model=this.model,e.onModelChange=this.onModelChange,e}},Od=class extends Fd{refresh(e){this.sourceParams=e,this.refreshProps()}},Nd=class extends Fd{constructor(){super(...arguments),this.active=!1,this.expanded=!1,this.onActiveChange=e=>this.updateActive(e)}setActive(e){this.awaitSetActive(e)}setExpanded(e){this.expanded=e,this.refreshProps()}getOptionalMethods(){return["select","configureDefaults"]}awaitSetActive(e){return this.active=e,this.refreshProps()}updateActive(e){const t=this.awaitSetActive(e);e&&t.then((()=>this.sourceParams.onItemActivated()))}getProps(){const e=super.getProps();return e.active=this.active,e.expanded=this.expanded,e.onActiveChange=this.onActiveChange,delete e.onItemActivated,e}},Bd=class extends Fd{refresh(e){this.sourceParams=e,this.refreshProps()}},Gd=class extends Fd{refresh(e){return this.sourceParams=e,this.refreshProps(),!0}},Hd=class extends Fd{constructor(){super(...arguments),this.onStateChange=e=>this.updateState(e)}refresh(e){return this.sourceParams=e,this.refreshProps(),!0}getState(){return this.state}updateState(e){this.state=e,this.refreshProps(),this.sourceParams.onStateUpdated()}getProps(){const e=super.getProps();return e.state=this.state,e.onStateChange=this.onStateChange,e}};function zd(){v("As of v32, using custom components with `reactiveCustomComponents = false` is deprecated.")}var Vd=class{constructor(e,t,i){this.destroyed=!1,this.portals=[],this.hasPendingPortalUpdate=!1,this.wrappingElement=t||"div",this.refresher=e,this.maxComponentCreationTimeMs=i||1e3}getPortals(){return this.portals}destroy(){this.destroyed=!0}destroyPortal(e){this.portals=this.portals.filter((t=>t!==e)),this.batchUpdate()}getComponentWrappingElement(){return this.wrappingElement}mountReactPortal(e,t,i){this.portals=[...this.portals,e],this.waitForInstance(t,i),this.batchUpdate()}updateReactPortal(e,t){this.portals[this.portals.indexOf(e)]=t,this.batchUpdate()}batchUpdate(){this.hasPendingPortalUpdate||(setTimeout((()=>{this.destroyed||(this.refresher(),this.hasPendingPortalUpdate=!1)})),this.hasPendingPortalUpdate=!0)}waitForInstance(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Date.now();if(this.destroyed)t(null);else if(e.rendered())t(e);else{if(Date.now()-i>=this.maxComponentCreationTimeMs&&!this.hasPendingPortalUpdate)return;window.setTimeout((()=>{this.waitForInstance(e,t,i)}))}}},_d=(0,r.memo)((e=>{let{ctrl:t}=e;const i=t.isAlive(),{context:n}=(0,r.useContext)(ld),o=i?t.getColId():void 0,[s,a]=(0,r.useState)(),l=(0,r.useRef)(),u=(0,r.useRef)(null),d=(0,r.useRef)(null),h=(0,r.useRef)(null),g=(0,r.useRef)(),p=(0,r.useRef)();i&&!p.current&&(p.current=new ni((()=>u.current)));const f=(0,r.useCallback)((e=>{var r;if(u.current=e,l.current=e?n.createBean(new Kt):n.destroyBean(l.current),!e||!i)return;const o={setWidth:e=>{u.current&&(u.current.style.width=e)},addOrRemoveCssClass:(e,t)=>p.current.addOrRemoveCssClass(e,t),setAriaSort:e=>{u.current&&(e?wi(u.current,e):bi(u.current))},setUserCompDetails:e=>a(e),getUserCompInstance:()=>g.current||void 0};t.setComp(o,e,d.current,h.current,l.current);const s=t.getSelectAllGui();null===(r=d.current)||void 0===r||r.insertAdjacentElement("afterend",s),l.current.addDestroyFunc((()=>s.remove()))}),[]);(0,r.useLayoutEffect)((()=>cd(s,n,h.current,g)),[s]),(0,r.useEffect)((()=>{t.setDragSource(u.current)}),[s]);const m=(0,r.useMemo)((()=>!!((null===s||void 0===s?void 0:s.componentFromFramework)&&gd(s.componentClass))),[s]),v=s&&s.componentFromFramework,C=s&&s.componentClass;return r.createElement("div",{ref:f,className:"ag-header-cell","col-id":o,role:"columnheader"},r.createElement("div",{ref:d,className:"ag-header-cell-resize",role:"presentation"}),r.createElement("div",{ref:h,className:"ag-header-cell-comp-wrapper",role:"presentation"},v&&m&&r.createElement(C,c({},s.params)),v&&!m&&r.createElement(C,c(c({},s.params),{},{ref:g}))))})),Wd=(0,r.memo)((e=>{let{ctrl:t}=e;const{context:i,gos:n}=(0,r.useContext)(ld),[o,s]=(0,r.useState)((()=>new hd("ag-header-cell","ag-floating-filter"))),[a,l]=(0,r.useState)((()=>new hd)),[u,d]=(0,r.useState)((()=>new hd("ag-floating-filter-button","ag-hidden"))),[h,g]=(0,r.useState)("false"),[p,f]=(0,r.useState)(),[,m]=(0,r.useState)(1),v=(0,r.useRef)(),C=(0,r.useRef)(null),w=(0,r.useRef)(null),b=(0,r.useRef)(null),S=(0,r.useRef)(null),y=(0,r.useRef)(),R=(0,r.useRef)(),E=e=>{null!=e&&y.current&&y.current(e)},x=(0,r.useCallback)((e=>{if(C.current=e,v.current=e?i.createBean(new Kt):i.destroyBean(v.current),!e)return;R.current=new Wr((e=>{y.current=e}));const r={addOrRemoveCssClass:(e,t)=>s((i=>i.setClass(e,t))),addOrRemoveBodyCssClass:(e,t)=>l((i=>i.setClass(e,t))),setButtonWrapperDisplayed:e=>{d((t=>t.setClass("ag-hidden",!e))),g(e?"false":"true")},setWidth:e=>{C.current&&(C.current.style.width=e)},setCompDetails:e=>f(e),getFloatingFilterComp:()=>R.current?R.current:null,setMenuIcon:e=>{var t;return null===(t=S.current)||void 0===t?void 0:t.appendChild(e)}};t.setComp(r,e,S.current,w.current,v.current)}),[]);(0,r.useLayoutEffect)((()=>cd(p,i,w.current,E)),[p]);const T=(0,r.useMemo)((()=>o.toString()),[o]),F=(0,r.useMemo)((()=>a.toString()),[a]),P=(0,r.useMemo)((()=>u.toString()),[u]),D=(0,r.useMemo)((()=>!!(p&&p.componentFromFramework&&gd(p.componentClass))),[p]),k=(0,r.useMemo)((()=>n.get("reactiveCustomComponents")),[]),A=(0,r.useMemo)((()=>{if(p){if(k){const e=new Id(p.params,(()=>m((e=>e+1))));return E(e),e}p.componentFromFramework&&zd()}}),[p]),M=null===A||void 0===A?void 0:A.getProps(),I=p&&p.componentFromFramework,L=p&&p.componentClass;return r.createElement("div",{ref:x,className:T,role:"gridcell"},r.createElement("div",{ref:w,className:F,role:"presentation"},I&&!k&&r.createElement(L,c(c({},p.params),{},{ref:D?()=>{}:E})),I&&k&&r.createElement(Sd.Provider,{value:{setMethods:e=>A.setMethods(e)}},r.createElement(L,c({},M)))),r.createElement("div",{ref:b,"aria-hidden":h,className:P,role:"presentation"},r.createElement("button",{ref:S,type:"button",className:"ag-button ag-floating-filter-button-button",tabIndex:-1})))})),Ud=(0,r.memo)((e=>{let{ctrl:t}=e;const{context:i}=(0,r.useContext)(ld),[n,o]=(0,r.useState)((()=>new hd)),[s,a]=(0,r.useState)((()=>new hd)),[l,u]=(0,r.useState)("false"),[d,h]=(0,r.useState)(),[g,p]=(0,r.useState)(),f=(0,r.useMemo)((()=>t.getColId()),[]),m=(0,r.useRef)(),v=(0,r.useRef)(null),C=(0,r.useRef)(null),w=(0,r.useRef)(null),b=(0,r.useRef)(),S=(0,r.useCallback)((e=>{if(v.current=e,m.current=e?i.createBean(new Kt):i.destroyBean(m.current),!e)return;const r={setWidth:e=>{v.current&&(v.current.style.width=e)},addOrRemoveCssClass:(e,t)=>o((i=>i.setClass(e,t))),setHeaderWrapperHidden:e=>{const t=w.current;t&&(e?t.style.setProperty("display","none"):t.style.removeProperty("display"))},setHeaderWrapperMaxHeight:e=>{const t=w.current;t&&(null!=e?t.style.setProperty("max-height","".concat(e,"px")):t.style.removeProperty("max-height"),t.classList.toggle("ag-header-cell-comp-wrapper-limited-height",null!=e))},setUserCompDetails:e=>p(e),setResizableDisplayed:e=>{a((t=>t.setClass("ag-hidden",!e))),u(e?"false":"true")},setAriaExpanded:e=>h(e),getUserCompInstance:()=>b.current||void 0};t.setComp(r,e,C.current,w.current,m.current)}),[]);(0,r.useLayoutEffect)((()=>cd(g,i,w.current)),[g]),(0,r.useEffect)((()=>{v.current&&t.setDragSource(v.current)}),[g]);const y=(0,r.useMemo)((()=>!!((null===g||void 0===g?void 0:g.componentFromFramework)&&gd(g.componentClass))),[g]),R=(0,r.useMemo)((()=>"ag-header-group-cell "+n.toString()),[n]),E=(0,r.useMemo)((()=>"ag-header-cell-resize "+s.toString()),[s]),x=g&&g.componentFromFramework,T=g&&g.componentClass;return r.createElement("div",{ref:S,className:R,"col-id":f,role:"columnheader","aria-expanded":d},r.createElement("div",{ref:w,className:"ag-header-cell-comp-wrapper",role:"presentation"},x&&y&&r.createElement(T,c({},g.params)),x&&!y&&r.createElement(T,c(c({},g.params),{},{ref:b}))),r.createElement("div",{ref:C,"aria-hidden":l,className:E}))})),jd=(0,r.memo)((e=>{let{ctrl:t}=e;const{context:i}=(0,r.useContext)(ld),{topOffset:n,rowHeight:o}=(0,r.useMemo)((()=>t.getTopAndHeight()),[]),s=t.getAriaRowIndex(),a=t.getHeaderRowClass(),[l,c]=(0,r.useState)((()=>o+"px")),[u,d]=(0,r.useState)((()=>n+"px")),h=(0,r.useRef)(null),g=(0,r.useRef)(null),[p,f]=(0,r.useState)((()=>t.getHeaderCtrls())),m=(0,r.useRef)(),v=(0,r.useRef)(null),C=(0,r.useCallback)((e=>{if(v.current=e,m.current=e?i.createBean(new Kt):i.destroyBean(m.current),!e)return;const r={setHeight:e=>c(e),setTop:e=>d(e),setHeaderCtrls:(e,t,i)=>{g.current=h.current,h.current=e;const r=Cd(g.current,e,t);r!==g.current&&vd(i,(()=>f(r)))},setWidth:e=>{v.current&&(v.current.style.width=e)}};t.setComp(r,m.current,!1)}),[]),w=(0,r.useMemo)((()=>({height:l,top:u})),[l,u]),b=(0,r.useCallback)((e=>{switch(t.getType()){case jo.COLUMN_GROUP:return r.createElement(Ud,{ctrl:e,key:e.instanceId});case jo.FLOATING_FILTER:return r.createElement(Wd,{ctrl:e,key:e.instanceId});default:return r.createElement(_d,{ctrl:e,key:e.instanceId})}}),[]);return r.createElement("div",{ref:C,className:a,role:"row",style:w,"aria-rowindex":s},p.map(b))})),Kd=(0,r.memo)((e=>{let{pinned:t}=e;const[i,n]=(0,r.useState)(!0),[o,s]=(0,r.useState)([]),{context:a}=(0,r.useContext)(ld),l=(0,r.useRef)(null),c=(0,r.useRef)(null),u=(0,r.useRef)(),d="left"===t,h="right"===t,g=!d&&!h,p=(0,r.useCallback)((e=>{if(l.current=e,u.current=e?a.createBean(new ds(t)):a.destroyBean(u.current),!e)return;const i={setDisplayed:n,setCtrls:e=>s(e),setCenterWidth:e=>{c.current&&(c.current.style.width=e)},setViewportScrollLeft:e=>{l.current&&(l.current.scrollLeft=e)},setPinnedContainerWidth:e=>{l.current&&(l.current.style.width=e,l.current.style.minWidth=e,l.current.style.maxWidth=e)}};u.current.setComp(i,l.current)}),[]),f=i?"":"ag-hidden",m=()=>o.map((e=>r.createElement(jd,{ctrl:e,key:e.instanceId})));return r.createElement(r.Fragment,null,d&&r.createElement("div",{ref:p,className:"ag-pinned-left-header "+f,"aria-hidden":!i,role:"rowgroup"},m()),h&&r.createElement("div",{ref:p,className:"ag-pinned-right-header "+f,"aria-hidden":!i,role:"rowgroup"},m()),g&&r.createElement("div",{ref:p,className:"ag-header-viewport "+f,role:"presentation"},r.createElement("div",{ref:c,className:"ag-header-container",role:"rowgroup"},m())))})),Yd=(0,r.memo)((()=>{const[e,t]=(0,r.useState)((()=>new hd)),[i,n]=(0,r.useState)(),{context:o}=(0,r.useContext)(ld),s=(0,r.useRef)(null),a=(0,r.useRef)(),l=(0,r.useCallback)((e=>{if(s.current=e,a.current=e?o.createBean(new Yo):o.destroyBean(a.current),!e)return;const i={addOrRemoveCssClass:(e,i)=>t((t=>t.setClass(e,i))),setHeightAndMinHeight:e=>n(e)};a.current.setComp(i,e,e)}),[]),c=(0,r.useMemo)((()=>"ag-header "+e.toString()),[e]),u=(0,r.useMemo)((()=>({height:i,minHeight:i})),[i]);return r.createElement("div",{ref:l,className:c,style:u,role:"presentation"},r.createElement(Kd,{pinned:"left"}),r.createElement(Kd,{pinned:null}),r.createElement(Kd,{pinned:"right"}))})),qd=(e,t)=>{(0,r.useEffect)((()=>{const i=t.current;if(i){const t=i.parentElement;if(t){const r=document.createComment(e);return t.insertBefore(r,i),()=>{t.removeChild(r)}}}}),[e])},Qd=class{constructor(e,t){this.cellEditorParams=e,this.refreshProps=t,this.instanceCreated=new Wr((e=>{this.resolveInstanceCreated=e})),this.onValueChange=e=>this.updateValue(e),this.value=e.value}getProps(){return c(c({},this.cellEditorParams),{},{initialValue:this.cellEditorParams.value,value:this.value,onValueChange:this.onValueChange})}getValue(){return this.value}refresh(e){this.cellEditorParams=e,this.refreshProps()}setMethods(e){Td(this.getOptionalMethods(),e,this)}getInstance(){return this.instanceCreated.then((()=>this.componentInstance))}setRef(e){var t;this.componentInstance=e,null===(t=this.resolveInstanceCreated)||void 0===t||t.call(this),this.resolveInstanceCreated=void 0}getOptionalMethods(){return["isCancelBeforeStart","isCancelAfterEnd","focusIn","focusOut","afterGuiAttached"]}updateValue(e){this.value=e,this.refreshProps()}},$d=(0,r.memo)((e=>{const[t,i]=(0,r.useState)(),{context:n,popupService:o,localeService:s,gos:a,editService:l}=(0,r.useContext)(ld);return(e=>{const t=(0,r.useRef)(e),i=(0,r.useRef)(),n=(0,r.useRef)(!1),o=(0,r.useRef)(!1),[,s]=(0,r.useState)(0);n.current&&(o.current=!0),(0,r.useEffect)((()=>(n.current||(i.current=t.current(),n.current=!0),s((e=>e+1)),()=>{var e;o.current&&(null===(e=i.current)||void 0===e||e.call(i))})),[])})((()=>{var t,r;const{editDetails:c,cellCtrl:u,eParentCell:d}=e,{compDetails:h}=c,g=a.get("stopEditingWhenCellsLoseFocus"),p=n.createBean(l.createPopupEditorWrapper(h.params)),f=p.getGui();if(e.jsChildComp){const t=e.jsChildComp.getGui();t&&f.appendChild(t)}const m={column:u.getColumn(),rowNode:u.getRowNode(),type:"popupCellEditor",eventSource:d,ePopup:f,position:c.popupPosition,keepWithinBounds:!0},v=o.positionPopupByComponent.bind(o,m),C=s.getLocaleTextFunc(),w=o.addPopup({modal:g,eChild:f,closeOnEsc:!0,closedCallback:()=>{u.onPopupEditorClosed()},anchorToElement:d,positionCallback:v,ariaLabel:C("ariaLabelCellEditor","Cell Editor")}),b=w?w.hideFunc:void 0;return i(p),null===(t=e.jsChildComp)||void 0===t||null===(r=t.afterGuiAttached)||void 0===r||r.call(t),()=>{null===b||void 0===b||b(),n.destroyBean(p)}})),r.createElement(r.Fragment,null,t&&e.wrappedContent&&(0,od.createPortal)(e.wrappedContent,t.getGui()))})),Xd=(e,t,i,n,o,s)=>{const{context:a}=(0,r.useContext)(ld),l=(0,r.useCallback)((()=>{const e=o.current;if(!e)return;const t=e.getGui();t&&t.parentElement&&t.parentElement.removeChild(t),a.destroyBean(e),o.current=void 0}),[]);(0,r.useEffect)((()=>{const r=null!=e,n=(null===e||void 0===e?void 0:e.compDetails)&&!e.compDetails.componentFromFramework;if(!(r&&n&&!(t&&null==i)))return void l();const a=e.compDetails;if(o.current){const t=o.current,i=!!(null!=t.refresh&&0==e.force)&&t.refresh(a.params);if(!0===i||void 0===i)return;l()}const c=a.newAgStackInstance();null!=c&&c.then((e=>{if(!e)return;const r=e.getGui();if(!r)return;(t?i:s.current).appendChild(r),o.current=e}))}),[e,t,n]),(0,r.useEffect)((()=>l),[])},Jd=(e,t,i)=>{const n=e.compProxy;return r.createElement(r.Fragment,null,n?((e,t,i)=>{const{compProxy:n}=e;i(n);const o=n.getProps(),s=gd(t);return r.createElement(Sd.Provider,{value:{setMethods:e=>n.setMethods(e)}},s?r.createElement(t,c({},o)):r.createElement(t,c(c({},o),{},{ref:e=>n.setRef(e)})))})(e,t,i):r.createElement(t,c(c({},e.compDetails.params),{},{ref:i})))},Zd=(0,r.memo)((e=>{let{cellCtrl:t,printLayout:i,editingRow:n}=e;const{context:o}=(0,r.useContext)(ld),{colIdSanitised:s,instanceId:a}=t,l=(0,r.useRef)(),[u,d]=(0,r.useState)((()=>t.isCellRenderer()?void 0:{compDetails:void 0,value:t.getValueToDisplay(),force:!1})),[h,g]=(0,r.useState)(),[p,f]=(0,r.useState)(1),[m,v]=(0,r.useState)(),[C,w]=(0,r.useState)(!1),[b,S]=(0,r.useState)(!1),[y,R]=(0,r.useState)(!1),[E,x]=(0,r.useState)(),T=(0,r.useMemo)((()=>t.isForceWrapper()),[t]),F=(0,r.useMemo)((()=>t.getCellAriaRole()),[t]),P=(0,r.useRef)(null),D=(0,r.useRef)(null),k=(0,r.useRef)(),A=(0,r.useRef)(),M=(0,r.useRef)(),I=(0,r.useRef)([]),L=(0,r.useRef)(),[O,N]=(0,r.useState)(0),B=(0,r.useCallback)((e=>{L.current=e,N((e=>e+1))}),[]),G=T||null!=u&&(C||y||b),H=(0,r.useCallback)((e=>{if(A.current=e,e){const i=e.isCancelBeforeStart&&e.isCancelBeforeStart();setTimeout((()=>{i?(t.stopEditing(!0),t.focusCell(!0)):t.cellEditorAttached()}))}}),[t]),z=(0,r.useRef)();z.current||(z.current=new ni((()=>P.current))),Xd(u,G,L.current,O,k,P);const V=(0,r.useRef)();(0,r.useLayoutEffect)((()=>{var e;const t=V.current,i=u;if(V.current=u,null==t||null==t.compDetails||null==i||null==i.compDetails)return;const r=t.compDetails,n=i.compDetails;if(r.componentClass!=n.componentClass)return;if(null==(null===(e=D.current)||void 0===e?void 0:e.refresh))return;1!=D.current.refresh(n.params)&&f((e=>e+1))}),[u]),(0,r.useLayoutEffect)((()=>{if(!(h&&!h.compDetails.componentFromFramework))return;const e=h.compDetails,t=!0===h.popup,i=e.newAgStackInstance();return i.then((e=>{if(!e)return;const i=e.getGui();if(H(e),!t){const t=(T?M:P).current;null===t||void 0===t||t.appendChild(i),e.afterGuiAttached&&e.afterGuiAttached()}x(e)})),()=>{i.then((e=>{var t;const i=e.getGui();o.destroyBean(e),H(void 0),x(void 0),null===i||void 0===i||null===(t=i.parentElement)||void 0===t||t.removeChild(i)}))}}),[h]);const _=(0,r.useCallback)((e=>{if(M.current=e,!e)return I.current.forEach((e=>e())),void(I.current=[]);const i=t=>{if(t){const i=t.getGui();e.insertAdjacentElement("afterbegin",i),I.current.push((()=>{o.destroyBean(t),qi(i)}))}return t};if(C){i(t.createSelectionCheckbox())}y&&i(t.createDndSource()),b&&i(t.createRowDragComp())}),[t,o,y,b,C]),W=(0,r.useCallback)((e=>{if(P.current=e,l.current=e?o.createBean(new Kt):o.destroyBean(l.current),!e||!t)return;const r={addOrRemoveCssClass:(e,t)=>z.current.addOrRemoveCssClass(e,t),setUserStyles:e=>v(e),getFocusableElement:()=>P.current,setIncludeSelection:e=>w(e),setIncludeRowDrag:e=>S(e),setIncludeDndSource:e=>R(e),getCellEditor:()=>A.current||null,getCellRenderer:()=>{var e;return null!==(e=D.current)&&void 0!==e?e:k.current},getParentOfValue:()=>{var e,t;return null!==(e=null!==(t=L.current)&&void 0!==t?t:M.current)&&void 0!==e?e:P.current},setRenderDetails:(e,t,i)=>{d((r=>(null===r||void 0===r?void 0:r.compDetails)!==e||(null===r||void 0===r?void 0:r.value)!==t||(null===r||void 0===r?void 0:r.force)!==i?{value:t,compDetails:e,force:i}:r))},setEditDetails:(e,t,i,r)=>{if(e){let n;r?n=new Qd(e.params,(()=>f((e=>e+1)))):e.componentFromFramework&&zd(),g({compDetails:e,popup:t,popupPosition:i,compProxy:n}),t||d(void 0)}else g((e=>{null!==e&&void 0!==e&&e.compProxy&&(A.current=void 0)}))}},s=M.current||void 0;t.setComp(r,e,s,i,n,l.current)}),[]),U=(0,r.useMemo)((()=>{var e;return!!((null===u||void 0===u||null===(e=u.compDetails)||void 0===e?void 0:e.componentFromFramework)&&gd(u.compDetails.componentClass))}),[u]);(0,r.useLayoutEffect)((()=>{var e;P.current&&(z.current.addOrRemoveCssClass("ag-cell-value",!G),z.current.addOrRemoveCssClass("ag-cell-inline-editing",!!h&&!h.popup),z.current.addOrRemoveCssClass("ag-cell-popup-editing",!!h&&!!h.popup),z.current.addOrRemoveCssClass("ag-cell-not-inline-editing",!h||!!h.popup),null===(e=t.getRowCtrl())||void 0===e||e.setInlineEditingCss(),t.shouldRestoreFocus()&&!t.isEditing()&&P.current.focus({preventScroll:!0}))}));const j=()=>r.createElement(r.Fragment,null,null!=u&&((e,t,i,n,o,s,a)=>{const{compDetails:l,value:u}=e,d=!l,h=l&&l.componentFromFramework,g=l&&l.componentClass,p=null!==u&&void 0!==u&&u.toString?u.toString():u,f=()=>r.createElement(r.Fragment,null,d&&r.createElement(r.Fragment,null,p),h&&!s&&r.createElement(g,c(c({},l.params),{},{key:t,ref:n})),h&&s&&r.createElement(g,c(c({},l.params),{},{key:t})));return r.createElement(r.Fragment,null,o?r.createElement("span",{role:"presentation",id:"cell-".concat(i),className:"ag-cell-value",ref:a},f()):f())})(u,p,a,D,G,U,B),null!=h&&((e,t,i,n,o)=>{const s=e.compDetails,a=s.componentClass,l=s.componentFromFramework&&!e.popup,c=s.componentFromFramework&&e.popup,u=!s.componentFromFramework&&e.popup;return r.createElement(r.Fragment,null,l&&Jd(e,a,t),c&&r.createElement($d,{editDetails:e,cellCtrl:n,eParentCell:i,wrappedContent:Jd(e,a,t)}),u&&o&&r.createElement($d,{editDetails:e,cellCtrl:n,eParentCell:i,jsChildComp:o}))})(h,H,P.current,t,E)),K=(0,r.useCallback)((()=>t.onFocusOut()),[]);return r.createElement("div",{ref:W,style:m,role:F,"col-id":s,onBlur:K},G?r.createElement("div",{className:"ag-cell-wrapper",role:"presentation",ref:_},j()):j())})),eh=(0,r.memo)((e=>{let{rowCtrl:t,containerType:i}=e;const{context:n,gos:o}=(0,r.useContext)(ld),s=(0,r.useRef)(),a=(0,r.useRef)(t.getDomOrder()),l=t.isFullWidth(),u=t.getRowNode().displayed,[d,h]=(0,r.useState)((()=>u?t.getRowIndex():null)),[g,p]=(0,r.useState)((()=>t.getRowId())),[f,m]=(0,r.useState)((()=>t.getBusinessKey())),[v,C]=(0,r.useState)((()=>t.getRowStyles())),w=(0,r.useRef)(null),b=(0,r.useRef)(null),[S,y]=(0,r.useState)((()=>null)),[R,E]=(0,r.useState)(),[x,T]=(0,r.useState)((()=>u?t.getInitialRowTop(i):void 0)),[F,P]=(0,r.useState)((()=>u?t.getInitialTransform(i):void 0)),D=(0,r.useRef)(null),k=(0,r.useRef)(),A=(0,r.useRef)(!1),[M,I]=(0,r.useState)(0);(0,r.useEffect)((()=>{var e;if(A.current||!R||M>10)return;const i=null===(e=D.current)||void 0===e?void 0:e.firstChild;i?(t.setupDetailRowAutoHeight(i),A.current=!0):I((e=>e+1))}),[R,M]);const L=(0,r.useRef)();L.current||(L.current=new ni((()=>D.current)));const O=(0,r.useCallback)((e=>{if(D.current=e,s.current=e?n.createBean(new Kt):n.destroyBean(s.current),!e)return void t.unsetComp(i);if(!t.isAlive())return;const r={setTop:T,setTransform:P,addOrRemoveCssClass:(e,t)=>L.current.addOrRemoveCssClass(e,t),setDomOrder:e=>a.current=e,setRowIndex:h,setRowId:p,setRowBusinessKey:m,setUserStyles:C,setCellCtrls:(e,t)=>{b.current=w.current,w.current=e;const i=Cd(b.current,e,a.current);i!==b.current&&vd(t,(()=>y(i)))},showFullWidth:e=>E(e),getFullWidthCellRenderer:()=>k.current,refreshFullWidth:e=>z.current?(E((t=>c(c({},t),{},{params:e()}))),!0):!(!k.current||!k.current.refresh)&&k.current.refresh(e())};t.setComp(r,e,i,s.current)}),[]);(0,r.useLayoutEffect)((()=>cd(R,n,D.current,k)),[R]);const N=(0,r.useMemo)((()=>{const e={top:x,transform:F};return Object.assign(e,v),e}),[x,F,v]),B=l&&(null===R||void 0===R?void 0:R.componentFromFramework),G=!l&&null!=S,H=(0,r.useMemo)((()=>!!((null===R||void 0===R?void 0:R.componentFromFramework)&&gd(R.componentClass))),[R]),z=(0,r.useRef)(!1);(0,r.useEffect)((()=>{z.current=H&&!!R&&!!o.get("reactiveCustomComponents")}),[H,R]);return r.createElement("div",{ref:O,role:"row",style:N,"row-index":d,"row-id":g,"row-business-key":f},G&&(null===S||void 0===S?void 0:S.map((e=>r.createElement(Zd,{cellCtrl:e,editingRow:t.isEditing(),printLayout:t.isPrintLayout(),key:e.instanceId})))),B&&(()=>{const e=R.componentClass;return r.createElement(r.Fragment,null,H?r.createElement(e,c({},R.params)):r.createElement(e,c(c({},R.params),{},{ref:k})))})())})),th=(0,r.memo)((e=>{let{name:t}=e;const{context:i}=(0,r.useContext)(ld),n=(0,r.useMemo)((()=>js(t)),[t]),o=(0,r.useRef)(null),s=(0,r.useRef)(null),a=(0,r.useRef)([]),l=(0,r.useRef)([]),[c,u]=(0,r.useState)((()=>[])),d=(0,r.useRef)(!1),h=(0,r.useRef)(),g=(0,r.useMemo)((()=>dd(n.viewport)),[n]),p=(0,r.useMemo)((()=>dd(n.container)),[n]),f="center"===n.type;qd(" AG Row Container "+t+" ",f?o:s);const m=(0,r.useCallback)((()=>f?null!=o.current&&null!=s.current:null!=s.current),[]),v=(0,r.useCallback)((()=>f?null==o.current&&null==s.current:null==s.current),[]),C=(0,r.useCallback)((()=>{if(v()&&(h.current=i.destroyBean(h.current)),m()){const e=e=>{const t=Cd(l.current,a.current,d.current);t!==l.current&&(l.current=t,vd(e,(()=>u(t))))},r={setHorizontalScroll:e=>{o.current&&(o.current.scrollLeft=e)},setViewportHeight:e=>{o.current&&(o.current.style.height=e)},setRowCtrls:t=>{let{rowCtrls:i,useFlushSync:r}=t;const n=!!r&&a.current.length>0&&i.length>0;a.current=i,e(n)},setDomOrder:t=>{d.current!=t&&(d.current=t,e(!1))},setContainerWidth:e=>{s.current&&(s.current.style.width=e)},setOffsetTop:e=>{s.current&&(s.current.style.transform="translateY(".concat(e,")"))}};h.current=i.createBean(new ea(t)),h.current.setComp(r,s.current,o.current)}}),[m,v]),w=(0,r.useCallback)((e=>{s.current=e,C()}),[C]),b=(0,r.useCallback)((e=>{o.current=e,C()}),[C]),S=()=>r.createElement("div",{className:p,ref:w,role:"rowgroup"},c.map((e=>r.createElement(eh,{rowCtrl:e,containerType:n.type,key:e.instanceId}))));return r.createElement(r.Fragment,null,f?r.createElement("div",{className:g,ref:b,role:"presentation"},S()):S())})),ih=(0,r.memo)((()=>{const{context:e,resizeObserverService:t}=(0,r.useContext)(ld),[i,n]=(0,r.useState)(""),[o,s]=(0,r.useState)(0),[a,l]=(0,r.useState)(0),[c,u]=(0,r.useState)("0px"),[d,h]=(0,r.useState)("0px"),[g,p]=(0,r.useState)("100%"),[f,m]=(0,r.useState)("0px"),[v,C]=(0,r.useState)("0px"),[w,b]=(0,r.useState)("100%"),[S,y]=(0,r.useState)(""),[R,E]=(0,r.useState)(""),[x,T]=(0,r.useState)(null),[F,P]=(0,r.useState)(""),[D,k]=(0,r.useState)(null),[A,M]=(0,r.useState)("ag-layout-normal"),I=(0,r.useRef)();I.current||(I.current=new ni((()=>L.current)));const L=(0,r.useRef)(null),O=(0,r.useRef)(null),N=(0,r.useRef)(null),B=(0,r.useRef)(null),G=(0,r.useRef)(null),H=(0,r.useRef)(null),z=(0,r.useRef)(null),V=(0,r.useRef)([]),_=(0,r.useRef)([]);qd(" AG Grid Body ",L),qd(" AG Pinned Top ",O),qd(" AG Sticky Top ",N),qd(" AG Middle ",H),qd(" AG Pinned Bottom ",z);const W=(0,r.useCallback)((i=>{if(L.current=i,!i)return V.current=e.destroyBeans(V.current),_.current.forEach((e=>e())),void(_.current=[]);if(!e)return;const r=(e,t)=>{e.appendChild(t),_.current.push((()=>e.removeChild(t)))},o=(t,i,n)=>{r(t,document.createComment(n)),r(t,(t=>{const i=e.createBean(new t);return V.current.push(i),i})(i).getGui())};o(i,fs," AG Fake Horizontal Scroll "),o(i,gs," AG Overlay Wrapper "),G.current&&o(G.current,vs," AG Fake Vertical Scroll ");const a={setRowAnimationCssOnBodyViewport:n,setColumnCount:e=>{L.current&&vi(L.current,e)},setRowCount:e=>{L.current&&fi(L.current,e)},setTopHeight:s,setBottomHeight:l,setStickyTopHeight:u,setStickyTopTop:h,setStickyTopWidth:p,setTopDisplay:y,setBottomDisplay:E,setColumnMovingCss:(e,t)=>I.current.addOrRemoveCssClass(e,t),updateLayoutClasses:M,setAlwaysVerticalScrollClass:T,setPinnedTopBottomOverflowY:P,setCellSelectableCss:(e,t)=>k(t?e:null),setBodyViewportWidth:e=>{H.current&&(H.current.style.width=e)},registerBodyViewportResizeListener:e=>{if(H.current){const i=t.observeResize(H.current,e);_.current.push((()=>i()))}},setStickyBottomHeight:m,setStickyBottomBottom:C,setStickyBottomWidth:b},c=e.createBean(new ia);V.current.push(c),c.setComp(a,i,H.current,O.current,z.current,N.current,B.current)}),[]),U=(0,r.useMemo)((()=>dd("ag-root","ag-unselectable",A)),[A]),j=(0,r.useMemo)((()=>dd("ag-body-viewport",i,A,x,D)),[i,A,x,D]),K=(0,r.useMemo)((()=>dd("ag-body",A)),[A]),Y=(0,r.useMemo)((()=>dd("ag-floating-top",D)),[D]),q=(0,r.useMemo)((()=>dd("ag-sticky-top",D)),[D]),Q=(0,r.useMemo)((()=>dd("ag-sticky-bottom","0px"===f?"ag-hidden":null,D)),[D,f]),$=(0,r.useMemo)((()=>dd("ag-floating-bottom",D)),[D]),X=(0,r.useMemo)((()=>({height:o,minHeight:o,display:S,overflowY:F})),[o,S,F]),J=(0,r.useMemo)((()=>({height:c,top:d,width:g})),[c,d,g]),Z=(0,r.useMemo)((()=>({height:f,bottom:v,width:w})),[f,v,w]),ee=(0,r.useMemo)((()=>({height:a,minHeight:a,display:R,overflowY:F})),[a,R,F]),te=e=>r.createElement(th,{name:e,key:"".concat(e,"-container")}),ie=e=>{let{section:t,children:i,className:n,style:o}=e;return r.createElement("div",{ref:t,className:n,role:"presentation",style:o},i.map(te))};return r.createElement("div",{ref:W,className:U,role:"treegrid"},r.createElement(Yd,null),ie({section:O,className:Y,style:X,children:["topLeft","topCenter","topRight","topFullWidth"]}),r.createElement("div",{className:K,ref:G,role:"presentation"},ie({section:H,className:j,children:["left","center","right","fullWidth"]})),ie({section:N,className:q,style:J,children:["stickyTopLeft","stickyTopCenter","stickyTopRight","stickyTopFullWidth"]}),ie({section:B,className:Q,style:Z,children:["stickyBottomLeft","stickyBottomCenter","stickyBottomRight","stickyBottomFullWidth"]}),ie({section:z,className:$,style:ee,children:["bottomLeft","bottomCenter","bottomRight","bottomFullWidth"]}))})),rh=(0,r.forwardRef)(((e,t)=>{const{children:i,eFocusableElement:n,onTabKeyDown:o,gridCtrl:s,forceFocusOutWhenTabGuardsAreEmpty:a}=e,{context:l}=(0,r.useContext)(ld),c=(0,r.useRef)(null),u=(0,r.useRef)(null),d=(0,r.useRef)(),h=e=>{const t=null==e?void 0:parseInt(e,10).toString();[c,u].forEach((e=>{var i,r;void 0===t?null===(i=e.current)||void 0===i||i.removeAttribute("tabindex"):null===(r=e.current)||void 0===r||r.setAttribute("tabindex",t)}))};(0,r.useImperativeHandle)(t,(()=>({forceFocusOutOfContainer(e){var t;null===(t=d.current)||void 0===t||t.forceFocusOutOfContainer(e)}})));const g=(0,r.useCallback)((()=>{const e=c.current,t=u.current;if(e||t){if(e&&t){const i={setTabIndex:h};d.current=l.createBean(new Ua({comp:i,eTopGuard:e,eBottomGuard:t,eFocusableElement:n,onTabKeyDown:o,forceFocusOutWhenTabGuardsAreEmpty:a,focusInnerElement:e=>s.focusInnerElement(e)}))}}else d.current=l.destroyBean(d.current)}),[]),p=(0,r.useCallback)((e=>{c.current=e,g()}),[g]),f=(0,r.useCallback)((e=>{u.current=e,g()}),[g]),m=e=>{const t="top"===e?Wa.TAB_GUARD_TOP:Wa.TAB_GUARD_BOTTOM;return r.createElement("div",{className:"".concat(Wa.TAB_GUARD," ").concat(t),role:"presentation",ref:"top"===e?p:f})};return r.createElement(r.Fragment,null,m("top"),i,m("bottom"))})),nh=(0,r.memo)(rh),oh=(0,r.memo)((e=>{let{context:t}=e;const[i,n]=(0,r.useState)(""),[o,s]=(0,r.useState)(""),[a,l]=(0,r.useState)(""),[c,u]=(0,r.useState)(null),[d,h]=(0,r.useState)(null),[g,p]=(0,r.useState)(!1),[f,m]=(0,r.useState)(),v=(0,r.useRef)(),C=(0,r.useRef)(null),w=(0,r.useRef)(),[b,S]=(0,r.useState)(null),y=(0,r.useRef)((()=>{})),R=(0,r.useRef)(),E=(0,r.useRef)([]),x=(0,r.useCallback)((()=>{}),[]),T=(0,r.useMemo)((()=>t.isDestroyed()?null:t.getBeans()),[t]);qd(" AG Grid ",C);const F=(0,r.useCallback)((e=>{if(C.current=e,v.current=e?t.createBean(new kl):t.destroyBean(v.current),!e||t.isDestroyed())return;const i=v.current;y.current=i.focusInnerElement.bind(i);const r={destroyGridUi:()=>{},setRtlClass:n,setGridThemeClass:s,forceFocusOutOfContainer:e=>{var t,i;e||null===(t=R.current)||void 0===t||!t.isDisplayed()?null===(i=w.current)||void 0===i||i.forceFocusOutOfContainer(e):R.current.forceFocusOutOfContainer(e)},updateLayoutClasses:l,getFocusableContainers:()=>{var e;const t=[],i=null===(e=C.current)||void 0===e?void 0:e.querySelector(".ag-root");return i&&t.push({getGui:()=>i}),E.current.forEach((e=>{e.isDisplayed()&&t.push(e)})),t},setCursor:u,setUserSelect:h};i.setComp(r,e,e),p(!0)}),[]);(0,r.useEffect)((()=>{const e=v.current,i=C.current;if(!f||!T||!e||!b||!i)return;const r=[],{watermarkSelector:n,paginationSelector:o,sideBarSelector:s,statusBarSelector:a,gridHeaderDropZonesSelector:l}=e.getOptionalSelectors(),c=[];if(l){const e=t.createBean(new l.component),n=e.getGui();i.insertAdjacentElement("afterbegin",n),c.push(n),r.push(e)}if(s){const e=t.createBean(new s.component),i=e.getGui(),n=b.querySelector(".ag-tab-guard-bottom");n&&(n.insertAdjacentElement("beforebegin",i),c.push(i)),r.push(e),E.current.push(e)}const u=e=>{const n=t.createBean(new e),o=n.getGui();return i.insertAdjacentElement("beforeend",o),c.push(o),r.push(n),n};if(a&&u(a.component),o){const e=u(o.component);R.current=e,E.current.push(e)}return n&&u(n.component),()=>{t.destroyBeans(r),c.forEach((e=>{var t;null===(t=e.parentElement)||void 0===t||t.removeChild(e)}))}}),[f,b,T]);const P=(0,r.useMemo)((()=>dd("ag-root-wrapper",i,o,a)),[i,o,a]),D=(0,r.useMemo)((()=>dd("ag-root-wrapper-body","ag-focus-managed",a)),[a]),k=(0,r.useMemo)((()=>({userSelect:null!=d?d:"",WebkitUserSelect:null!=d?d:"",cursor:null!=c?c:""})),[d,c]),A=(0,r.useCallback)((e=>{w.current=e,m(null!==e)}),[]);return r.createElement("div",{ref:F,className:P,style:k,role:"presentation"},r.createElement("div",{className:D,ref:S,role:"presentation"},g&&b&&T&&r.createElement(ld.Provider,{value:T},r.createElement(nh,{ref:A,eFocusableElement:b,onTabKeyDown:x,gridCtrl:v.current,forceFocusOutWhenTabGuardsAreEmpty:!0},r.createElement(ih,null)))))})),sh=class extends He{wireBeans(e){this.ctrlsService=e.ctrlsService}areHeaderCellsRendered(){return this.ctrlsService.getHeaderRowContainerCtrls().every((e=>e.getAllCtrls().every((e=>e.areCellsRendered()))))}},ah=e=>{var t,i;const n=(0,r.useRef)(),o=(0,r.useRef)(null),s=(0,r.useRef)(null),a=(0,r.useRef)([]),l=(0,r.useRef)([]),u=(0,r.useRef)(e),d=(0,r.useRef)(),h=(0,r.useRef)(),g=(0,r.useRef)(!1),[p,f]=(0,r.useState)(void 0),[,m]=(0,r.useState)(0),v=(0,r.useCallback)((t=>{var i,r,u;if(o.current=t,!t)return a.current.forEach((e=>e())),void(a.current.length=0);const p=e.modules||[];s.current||(s.current=new Vd((()=>m((e=>e+1))),e.componentWrappingElement,e.maxComponentCreationTimeMs),a.current.push((()=>{var e;null===(e=s.current)||void 0===e||e.destroy(),s.current=null})));const v=function(e,t){"object"!==typeof e&&(e={});const i=c({},e);return jt.ALL_PROPERTIES_AND_CALLBACKS.forEach((e=>{const r=t[e];"undefined"!==typeof r&&r!==jt.VUE_OMITTED_PROPERTY&&(i[e]=r)})),i}(e.gridOptions,e),C=new uh((()=>{if(g.current){const e=()=>{var e;return null!==(e=d.current)&&void 0!==e&&e.shouldQueueUpdates()?void 0:l.current.shift()};let t=e();for(;t;)t(),t=e()}}));d.current=C;const w=new sh,b={providedBeanInstances:{frameworkComponentWrapper:new lh(s.current,null===(i=null!==(r=v.reactiveCustomComponents)&&void 0!==r?r:Oc("reactiveCustomComponents"))||void 0===i||i),renderStatusService:w},modules:p,frameworkOverrides:C},S=new Bc;null!==(u=v.gridId)&&void 0!==u||(v.gridId=h.current),n.current=S.create(t,v,(t=>{f(t),t.createBean(w),a.current.push((()=>{t.destroy()})),t.getBean("ctrlsService").whenReady({addDestroyFunc:e=>{a.current.push(e)}},(()=>{if(t.isDestroyed())return;const i=n.current;var r;i&&(null===(r=e.setGridApi)||void 0===r||r.call(e,i))}))}),(e=>{e.getBean("ctrlsService").whenReady({addDestroyFunc:e=>{a.current.push(e)}},(()=>{l.current.forEach((e=>e())),l.current.length=0,g.current=!0}))}),b),a.current.push((()=>{n.current=void 0})),n.current&&(h.current=n.current.getGridId())}),[]),C=(0,r.useMemo)((()=>c({height:"100%"},e.containerStyle||{})),[e.containerStyle]),w=(0,r.useCallback)((e=>{var t;!g.current||null!==(t=d.current)&&void 0!==t&&t.shouldQueueUpdates()?l.current.push(e):e()}),[]);return(0,r.useEffect)((()=>{const t=function(e,t){const i={};return Object.keys(t).forEach((r=>{const n=t[r];e[r]!==n&&(i[r]=n)})),i}(u.current,e);u.current=e,w((()=>{n.current&&function(e,t){if(!e)return;const i={};let r=!1;if(Object.keys(e).filter((e=>jt.ALL_PROPERTIES_AND_CALLBACKS_SET.has(e))).forEach((t=>{i[t]=e[t],r=!0})),!r)return;const n={type:"gridOptionsChanged",options:i};t.dispatchEvent(n);const o={type:"componentStateChanged"};Ze(i,((e,t)=>{o[e]=t})),t.dispatchEvent(o)}(t,n.current)}))}),[e]),r.createElement("div",{style:C,className:e.className,ref:v},p&&!p.isDestroyed()?r.createElement(oh,{context:p}):null,null!==(t=null===(i=s.current)||void 0===i?void 0:i.getPortals())&&void 0!==t?t:null)};var lh=class extends Vc{constructor(e,t){super(),this.parent=e,this.reactiveCustomComponents=t}createWrapper(e,t){if(this.reactiveCustomComponents){const i=(e=>{switch(e){case"filter":return Ad;case"floatingFilterComponent":return Ld;case"dateComponent":return Dd;case"dragAndDropImageComponent":return kd;case"loadingOverlayComponent":return Od;case"noRowsOverlayComponent":return Bd;case"statusPanel":return Gd;case"toolPanel":return Hd;case"menuItem":return Nd;case"cellRenderer":return Pd}})(t.propertyName);if(i)return new i(e,this.parent,t)}else switch(t.propertyName){case"filter":case"floatingFilterComponent":case"dateComponent":case"dragAndDropImageComponent":case"loadingOverlayComponent":case"noRowsOverlayComponent":case"statusPanel":case"toolPanel":case"menuItem":case"cellRenderer":zd()}const i=!t.cellRenderer&&"toolPanel"!==t.propertyName;return new xd(e,this.parent,t,i)}},ch=(0,r.forwardRef)(((e,t)=>{const{ctrlsFactory:i,context:n,gos:o,resizeObserverService:s,rowModel:a}=(0,r.useContext)(ld),[l,u]=(0,r.useState)((()=>new hd)),[d,h]=(0,r.useState)((()=>new hd)),[g,p]=(0,r.useState)(),[f,m]=(0,r.useState)(),C=(0,r.useRef)(),w=(0,r.useRef)(null),b=(0,r.useRef)(),S=(0,r.useMemo)((()=>fn.__getGridRegisteredModules(e.api.getGridId())),[e]),y=(0,r.useMemo)((()=>l.toString()+" ag-details-row"),[l]),R=(0,r.useMemo)((()=>d.toString()+" ag-details-grid"),[d]);t&&(0,r.useImperativeHandle)(t,(()=>({refresh(){var e,t;return null!==(e=null===(t=C.current)||void 0===t?void 0:t.refresh())&&void 0!==e&&e}}))),e.template&&v("detailCellRendererParams.template is not supported by AG Grid React. To change the template, provide a Custom Detail Cell Renderer. See https://ag-grid.com/react-data-grid/master-detail-custom-detail/");const E=(0,r.useCallback)((t=>{var r;if(w.current=t,!t)return C.current=n.destroyBean(C.current),void(null===(r=b.current)||void 0===r||r.call(b));const l={addOrRemoveCssClass:(e,t)=>u((i=>i.setClass(e,t))),addOrRemoveDetailGridCssClass:(e,t)=>h((i=>i.setClass(e,t))),setDetailGrid:e=>p(e),setRowData:e=>m(e),getGui:()=>w.current},c=i.getInstance("detailCellRenderer");if(c&&(n.createBean(c),c.init(l,e),C.current=c,o.get("detailRowAutoHeight"))){const i=()=>{if(null==w.current)return;const t=w.current.clientHeight;if(null!=t&&t>0){setTimeout((()=>{e.node.setRowHeight(t),(G(o)||H(o))&&a.onRowHeightChanged()}),0)}};b.current=s.observeResize(t,i),i()}}),[]),x=(0,r.useCallback)((e=>{var t;null===(t=C.current)||void 0===t||t.registerDetailWithMaster(e)}),[]);return r.createElement("div",{className:y,ref:E},g&&r.createElement(ah,c(c({className:R},g),{},{modules:S,rowData:f,setGridApi:x})))})),uh=class extends $a{constructor(e){super("react"),this.processQueuedUpdates=e,this.queueUpdates=!1,this.frameworkComponents={agGroupCellRenderer:bd,agGroupRowRenderer:bd,agDetailCellRenderer:ch},this.wrapIncoming=(e,t)=>{return"ensureVisible"===t?(i=e,md||setTimeout((()=>md=!1),0),md=!0,i()):e();var i},this.renderingEngine="react"}frameworkComponent(e){return this.frameworkComponents[e]}isFrameworkComponent(e){if(!e)return!1;const t=e.prototype;return!(t&&"getGui"in t)}getLockOnRefresh(){this.queueUpdates=!0}releaseLockOnRefresh(){this.queueUpdates=!1,this.processQueuedUpdates()}shouldQueueUpdates(){return this.queueUpdates}runWhenReadyAsync(){return"19"===pd}},dh=class extends r.Component{constructor(){super(...arguments),this.apiListeners=[],this.setGridApi=e=>{this.api=e,this.apiListeners.forEach((t=>t(e)))}}registerApiListener(e){this.apiListeners.push(e)}componentWillUnmount(){this.apiListeners.length=0}render(){return r.createElement(ah,c(c({},this.props),{},{setGridApi:this.setGridApi}))}};var hh=i(579);const gh=e=>{let{setIsOpen:t,setIsAdd:i}=e;return(0,hh.jsx)("div",{className:"add-container",children:(0,hh.jsx)("button",{className:"add",onClick:()=>{t((e=>!e)),i(!0)},children:"Add"})})};var ph={version:"0.18.5"},fh=1200,mh=1252,vh=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Ch={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},wh=function(e){-1!=vh.indexOf(e)&&(mh=Ch[0]=e)};var bh=function(e){fh=e,wh(e)};function Sh(){bh(1200),wh(1252)}function yh(e){for(var t=[],i=0;i<e.length>>1;++i)t[i]=String.fromCharCode(e.charCodeAt(2*i+1)+(e.charCodeAt(2*i)<<8));return t.join("")}var Rh,Eh=function(e){return String.fromCharCode(e)},xh=function(e){return String.fromCharCode(e)};var Th="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Fh(e){for(var t="",i=0,r=0,n=0,o=0,s=0,a=0,l=0,c=0;c<e.length;)o=(i=e.charCodeAt(c++))>>2,s=(3&i)<<4|(r=e.charCodeAt(c++))>>4,a=(15&r)<<2|(n=e.charCodeAt(c++))>>6,l=63&n,isNaN(r)?a=l=64:isNaN(n)&&(l=64),t+=Th.charAt(o)+Th.charAt(s)+Th.charAt(a)+Th.charAt(l);return t}function Ph(e){var t="",i=0,r=0,n=0,o=0,s=0,a=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)i=Th.indexOf(e.charAt(l++))<<2|(o=Th.indexOf(e.charAt(l++)))>>4,t+=String.fromCharCode(i),r=(15&o)<<4|(s=Th.indexOf(e.charAt(l++)))>>2,64!==s&&(t+=String.fromCharCode(r)),n=(3&s)<<6|(a=Th.indexOf(e.charAt(l++))),64!==a&&(t+=String.fromCharCode(n));return t}var Dh=function(){return"undefined"!==typeof Buffer&&"undefined"!==typeof process&&"undefined"!==typeof process.versions&&!!process.versions.node}(),kh=function(){if("undefined"!==typeof Buffer){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch(t){e=!0}return e?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Ah(e){return Dh?Buffer.alloc?Buffer.alloc(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}function Mh(e){return Dh?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}var Ih=function(e){return Dh?kh(e,"binary"):e.split("").map((function(e){return 255&e.charCodeAt(0)}))};function Lh(e){if("undefined"===typeof ArrayBuffer)return Ih(e);for(var t=new ArrayBuffer(e.length),i=new Uint8Array(t),r=0;r!=e.length;++r)i[r]=255&e.charCodeAt(r);return t}function Oh(e){if(Array.isArray(e))return e.map((function(e){return String.fromCharCode(e)})).join("");for(var t=[],i=0;i<e.length;++i)t[i]=String.fromCharCode(e[i]);return t.join("")}var Nh=Dh?function(e){return Buffer.concat(e.map((function(e){return Buffer.isBuffer(e)?e:kh(e)})))}:function(e){if("undefined"!==typeof Uint8Array){var t=0,i=0;for(t=0;t<e.length;++t)i+=e[t].length;var r=new Uint8Array(i),n=0;for(t=0,i=0;t<e.length;i+=n,++t)if(n=e[t].length,e[t]instanceof Uint8Array)r.set(e[t],i);else{if("string"==typeof e[t])throw"wtf";r.set(new Uint8Array(e[t]),i)}return r}return[].concat.apply([],e.map((function(e){return Array.isArray(e)?e:[].slice.call(e)})))};var Bh=/\u0000/g,Gh=/[\u0001-\u0006]/g;function Hh(e){for(var t="",i=e.length-1;i>=0;)t+=e.charAt(i--);return t}function zh(e,t){var i=""+e;return i.length>=t?i:Jg("0",t-i.length)+i}function Vh(e,t){var i=""+e;return i.length>=t?i:Jg(" ",t-i.length)+i}function _h(e,t){var i=""+e;return i.length>=t?i:i+Jg(" ",t-i.length)}var Wh=Math.pow(2,32);function Uh(e,t){return e>Wh||e<-Wh?function(e,t){var i=""+Math.round(e);return i.length>=t?i:Jg("0",t-i.length)+i}(e,t):function(e,t){var i=""+e;return i.length>=t?i:Jg("0",t-i.length)+i}(Math.round(e),t)}function jh(e,t){return t=t||0,e.length>=7+t&&103===(32|e.charCodeAt(t))&&101===(32|e.charCodeAt(t+1))&&110===(32|e.charCodeAt(t+2))&&101===(32|e.charCodeAt(t+3))&&114===(32|e.charCodeAt(t+4))&&97===(32|e.charCodeAt(t+5))&&108===(32|e.charCodeAt(t+6))}var Kh=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Yh=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];var qh={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "'},Qh={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},$h={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Xh(e,t,i){for(var r=e<0?-1:1,n=e*r,o=0,s=1,a=0,l=1,c=0,u=0,d=Math.floor(n);c<t&&(a=(d=Math.floor(n))*s+o,u=d*c+l,!(n-d<5e-8));)n=1/(n-d),o=s,s=a,l=c,c=u;if(u>t&&(c>t?(u=l,a=o):(u=c,a=s)),!i)return[0,r*a,u];var h=Math.floor(r*a/u);return[h,r*a-h*u,u]}function Jh(e,t,i){if(e>2958465||e<0)return null;var r=0|e,n=Math.floor(86400*(e-r)),o=0,s=[],a={D:r,T:n,u:86400*(e-r)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(a.u)<1e-6&&(a.u=0),t&&t.date1904&&(r+=1462),a.u>.9999&&(a.u=0,86400==++n&&(a.T=n=0,++r,++a.D)),60===r)s=i?[1317,10,29]:[1900,2,29],o=3;else if(0===r)s=i?[1317,8,29]:[1900,1,0],o=6;else{r>60&&--r;var l=new Date(1900,0,1);l.setDate(l.getDate()+r-1),s=[l.getFullYear(),l.getMonth()+1,l.getDate()],o=l.getDay(),r<60&&(o=(o+6)%7),i&&(o=function(e,t){t[0]-=581;var i=e.getDay();e<60&&(i=(i+6)%7);return i}(l,s))}return a.y=s[0],a.m=s[1],a.d=s[2],a.S=n%60,n=Math.floor(n/60),a.M=n%60,n=Math.floor(n/60),a.H=n,a.q=o,a}var Zh=new Date(1899,11,31,0,0,0),eg=Zh.getTime(),tg=new Date(1900,2,1,0,0,0);function ig(e,t){var i=e.getTime();return t?i-=1262304e5:e>=tg&&(i+=864e5),(i-(eg+6e4*(e.getTimezoneOffset()-Zh.getTimezoneOffset())))/864e5}function rg(e){return-1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function ng(e){var t,i=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return t=i>=-4&&i<=-1?e.toPrecision(10+i):Math.abs(i)<=9?function(e){var t=e<0?12:11,i=rg(e.toFixed(12));return i.length<=t||(i=e.toPrecision(10)).length<=t?i:e.toExponential(5)}(e):10===i?e.toFixed(10).substr(0,12):function(e){var t=rg(e.toFixed(11));return t.length>(e<0?12:11)||"0"===t||"-0"===t?e.toPrecision(6):t}(e),rg(function(e){return-1==e.indexOf("E")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(t.toUpperCase()))}function og(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):ng(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return Tg(14,ig(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function sg(e,t,i,r){var n,o="",s=0,a=0,l=i.y,c=0;switch(e){case 98:l=i.y+543;case 121:switch(t.length){case 1:case 2:n=l%100,c=2;break;default:n=l%1e4,c=4}break;case 109:switch(t.length){case 1:case 2:n=i.m,c=t.length;break;case 3:return Yh[i.m-1][1];case 5:return Yh[i.m-1][0];default:return Yh[i.m-1][2]}break;case 100:switch(t.length){case 1:case 2:n=i.d,c=t.length;break;case 3:return Kh[i.q][0];default:return Kh[i.q][1]}break;case 104:switch(t.length){case 1:case 2:n=1+(i.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:n=i.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:n=i.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==i.u||"s"!=t&&"ss"!=t?(a=r>=2?3===r?1e3:100:1===r?10:1,(s=Math.round(a*(i.S+i.u)))>=60*a&&(s=0),"s"===t?0===s?"0":""+s/a:(o=zh(s,2+r),"ss"===t?o.substr(0,2):"."+o.substr(2,t.length-1))):zh(i.S,t.length);case 90:switch(t){case"[h]":case"[hh]":n=24*i.D+i.H;break;case"[m]":case"[mm]":n=60*(24*i.D+i.H)+i.M;break;case"[s]":case"[ss]":n=60*(60*(24*i.D+i.H)+i.M)+Math.round(i.S+i.u);break;default:throw"bad abstime format: "+t}c=3===t.length?1:2;break;case 101:n=l,c=1}return c>0?zh(n,c):""}function ag(e){if(e.length<=3)return e;for(var t=e.length%3,i=e.substr(0,t);t!=e.length;t+=3)i+=(i.length>0?",":"")+e.substr(t,3);return i}var lg=/%/g;function cg(e,t){var i,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+cg(e,-t);var n=e.indexOf(".");-1===n&&(n=e.indexOf("E"));var o=Math.floor(Math.log(t)*Math.LOG10E)%n;if(o<0&&(o+=n),-1===(i=(t/Math.pow(10,o)).toPrecision(r+1+(n+o)%n)).indexOf("e")){var s=Math.floor(Math.log(t)*Math.LOG10E);for(-1===i.indexOf(".")?i=i.charAt(0)+"."+i.substr(1)+"E+"+(s-i.length+o):i+="E+"+(s-o);"0."===i.substr(0,2);)i=(i=i.charAt(0)+i.substr(2,n)+"."+i.substr(2+n)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");i=i.replace(/\+-/,"-")}i=i.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,i,r){return t+i+r.substr(0,(n+o)%n)+"."+r.substr(o)+"E"}))}else i=t.toExponential(r);return e.match(/E\+00$/)&&i.match(/e[+-]\d$/)&&(i=i.substr(0,i.length-1)+"0"+i.charAt(i.length-1)),e.match(/E\-/)&&i.match(/e\+/)&&(i=i.replace(/e\+/,"e")),i.replace("e","E")}var ug=/# (\?+)( ?)\/( ?)(\d+)/;var dg=/^#*0*\.([0#]+)/,hg=/\).*[0#]/,gg=/\(###\) ###\\?-####/;function pg(e){for(var t,i="",r=0;r!=e.length;++r)switch(t=e.charCodeAt(r)){case 35:break;case 63:i+=" ";break;case 48:i+="0";break;default:i+=String.fromCharCode(t)}return i}function fg(e,t){var i=Math.pow(10,t);return""+Math.round(e*i)/i}function mg(e,t){var i=e-Math.floor(e),r=Math.pow(10,t);return t<(""+Math.round(i*r)).length?0:Math.round(i*r)}function vg(e,t,i){if(40===e.charCodeAt(0)&&!t.match(hg)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return i>=0?vg("n",r,i):"("+vg("n",r,-i)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,i){for(var r=t.length-1;44===t.charCodeAt(r-1);)--r;return bg(e,t.substr(0,r),i/Math.pow(10,3*(t.length-r)))}(e,t,i);if(-1!==t.indexOf("%"))return function(e,t,i){var r=t.replace(lg,""),n=t.length-r.length;return bg(e,r,i*Math.pow(10,2*n))+Jg("%",n)}(e,t,i);if(-1!==t.indexOf("E"))return cg(t,i);if(36===t.charCodeAt(0))return"$"+vg(e,t.substr(" "==t.charAt(1)?2:1),i);var n,o,s,a,l=Math.abs(i),c=i<0?"-":"";if(t.match(/^00+$/))return c+Uh(l,t.length);if(t.match(/^[#?]+$/))return"0"===(n=Uh(i,0))&&(n=""),n.length>t.length?n:pg(t.substr(0,t.length-n.length))+n;if(o=t.match(ug))return function(e,t,i){var r=parseInt(e[4],10),n=Math.round(t*r),o=Math.floor(n/r),s=n-o*r,a=r;return i+(0===o?"":""+o)+" "+(0===s?Jg(" ",e[1].length+1+e[4].length):Vh(s,e[1].length)+e[2]+"/"+e[3]+zh(a,e[4].length))}(o,l,c);if(t.match(/^#+0+$/))return c+Uh(l,t.length-t.indexOf("0"));if(o=t.match(dg))return n=fg(i,o[1].length).replace(/^([^\.]+)$/,"$1."+pg(o[1])).replace(/\.$/,"."+pg(o[1])).replace(/\.(\d*)$/,(function(e,t){return"."+t+Jg("0",pg(o[1]).length-t.length)})),-1!==t.indexOf("0.")?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),o=t.match(/^(0*)\.(#*)$/))return c+fg(l,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=t.match(/^#{1,3},##0(\.?)$/))return c+ag(Uh(l,0));if(o=t.match(/^#,##0\.([#0]*0)$/))return i<0?"-"+vg(e,t,-i):ag(""+(Math.floor(i)+function(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}(i,o[1].length)))+"."+zh(mg(i,o[1].length),o[1].length);if(o=t.match(/^#,#*,#0/))return vg(e,t.replace(/^#,#*,/,""),i);if(o=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Hh(vg(e,t.replace(/[\\-]/g,""),i)),s=0,Hh(Hh(t.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return s<n.length?n.charAt(s++):"0"===e?"0":""})));if(t.match(gg))return"("+(n=vg(e,"##########",i)).substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var u="";if(o=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(o[4].length,7),a=Xh(l,Math.pow(10,s)-1,!1),n=""+c," "==(u=bg("n",o[1],a[1])).charAt(u.length-1)&&(u=u.substr(0,u.length-1)+"0"),n+=u+o[2]+"/"+o[3],(u=_h(a[2],s)).length<o[4].length&&(u=pg(o[4].substr(o[4].length-u.length))+u),n+=u;if(o=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(o[1].length,o[4].length),7),c+((a=Xh(l,Math.pow(10,s)-1,!0))[0]||(a[1]?"":"0"))+" "+(a[1]?Vh(a[1],s)+o[2]+"/"+o[3]+_h(a[2],s):Jg(" ",2*s+1+o[2].length+o[3].length));if(o=t.match(/^[#0?]+$/))return n=Uh(i,0),t.length<=n.length?n:pg(t.substr(0,t.length-n.length))+n;if(o=t.match(/^([#0?]+)\.([#0]+)$/)){n=""+i.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),s=n.indexOf(".");var d=t.indexOf(".")-s,h=t.length-n.length-d;return pg(t.substr(0,d)+n+t.substr(t.length-h))}if(o=t.match(/^00,000\.([#0]*0)$/))return s=mg(i,o[1].length),i<0?"-"+vg(e,t,-i):ag(function(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(i)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?zh(0,3-e.length):"")+e}))+"."+zh(s,o[1].length);switch(t){case"###,##0.00":return vg(e,"#,##0.00",i);case"###,###":case"##,###":case"#,###":var g=ag(Uh(l,0));return"0"!==g?c+g:"";case"###,###.00":return vg(e,"###,##0.00",i).replace(/^0\./,".");case"#,###.00":return vg(e,"#,##0.00",i).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Cg(e,t){var i,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+Cg(e,-t);var n=e.indexOf(".");-1===n&&(n=e.indexOf("E"));var o=Math.floor(Math.log(t)*Math.LOG10E)%n;if(o<0&&(o+=n),!(i=(t/Math.pow(10,o)).toPrecision(r+1+(n+o)%n)).match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);-1===i.indexOf(".")?i=i.charAt(0)+"."+i.substr(1)+"E+"+(s-i.length+o):i+="E+"+(s-o),i=i.replace(/\+-/,"-")}i=i.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,i,r){return t+i+r.substr(0,(n+o)%n)+"."+r.substr(o)+"E"}))}else i=t.toExponential(r);return e.match(/E\+00$/)&&i.match(/e[+-]\d$/)&&(i=i.substr(0,i.length-1)+"0"+i.charAt(i.length-1)),e.match(/E\-/)&&i.match(/e\+/)&&(i=i.replace(/e\+/,"e")),i.replace("e","E")}function wg(e,t,i){if(40===e.charCodeAt(0)&&!t.match(hg)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return i>=0?wg("n",r,i):"("+wg("n",r,-i)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,i){for(var r=t.length-1;44===t.charCodeAt(r-1);)--r;return bg(e,t.substr(0,r),i/Math.pow(10,3*(t.length-r)))}(e,t,i);if(-1!==t.indexOf("%"))return function(e,t,i){var r=t.replace(lg,""),n=t.length-r.length;return bg(e,r,i*Math.pow(10,2*n))+Jg("%",n)}(e,t,i);if(-1!==t.indexOf("E"))return Cg(t,i);if(36===t.charCodeAt(0))return"$"+wg(e,t.substr(" "==t.charAt(1)?2:1),i);var n,o,s,a,l=Math.abs(i),c=i<0?"-":"";if(t.match(/^00+$/))return c+zh(l,t.length);if(t.match(/^[#?]+$/))return n=""+i,0===i&&(n=""),n.length>t.length?n:pg(t.substr(0,t.length-n.length))+n;if(o=t.match(ug))return function(e,t,i){return i+(0===t?"":""+t)+Jg(" ",e[1].length+2+e[4].length)}(o,l,c);if(t.match(/^#+0+$/))return c+zh(l,t.length-t.indexOf("0"));if(o=t.match(dg))return n=(n=(""+i).replace(/^([^\.]+)$/,"$1."+pg(o[1])).replace(/\.$/,"."+pg(o[1]))).replace(/\.(\d*)$/,(function(e,t){return"."+t+Jg("0",pg(o[1]).length-t.length)})),-1!==t.indexOf("0.")?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),o=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=t.match(/^#{1,3},##0(\.?)$/))return c+ag(""+l);if(o=t.match(/^#,##0\.([#0]*0)$/))return i<0?"-"+wg(e,t,-i):ag(""+i)+"."+Jg("0",o[1].length);if(o=t.match(/^#,#*,#0/))return wg(e,t.replace(/^#,#*,/,""),i);if(o=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Hh(wg(e,t.replace(/[\\-]/g,""),i)),s=0,Hh(Hh(t.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return s<n.length?n.charAt(s++):"0"===e?"0":""})));if(t.match(gg))return"("+(n=wg(e,"##########",i)).substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var u="";if(o=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(o[4].length,7),a=Xh(l,Math.pow(10,s)-1,!1),n=""+c," "==(u=bg("n",o[1],a[1])).charAt(u.length-1)&&(u=u.substr(0,u.length-1)+"0"),n+=u+o[2]+"/"+o[3],(u=_h(a[2],s)).length<o[4].length&&(u=pg(o[4].substr(o[4].length-u.length))+u),n+=u;if(o=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(o[1].length,o[4].length),7),c+((a=Xh(l,Math.pow(10,s)-1,!0))[0]||(a[1]?"":"0"))+" "+(a[1]?Vh(a[1],s)+o[2]+"/"+o[3]+_h(a[2],s):Jg(" ",2*s+1+o[2].length+o[3].length));if(o=t.match(/^[#0?]+$/))return n=""+i,t.length<=n.length?n:pg(t.substr(0,t.length-n.length))+n;if(o=t.match(/^([#0]+)\.([#0]+)$/)){n=""+i.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),s=n.indexOf(".");var d=t.indexOf(".")-s,h=t.length-n.length-d;return pg(t.substr(0,d)+n+t.substr(t.length-h))}if(o=t.match(/^00,000\.([#0]*0)$/))return i<0?"-"+wg(e,t,-i):ag(""+i).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?zh(0,3-e.length):"")+e}))+"."+zh(0,o[1].length);switch(t){case"###,###":case"##,###":case"#,###":var g=ag(""+l);return"0"!==g?c+g:"";default:if(t.match(/\.[0#?]*$/))return wg(e,t.slice(0,t.lastIndexOf(".")),i)+pg(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function bg(e,t,i){return(0|i)===i?wg(e,t,i):vg(e,t,i)}var Sg=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function yg(e){for(var t=0,i="",r="";t<e.length;)switch(i=e.charAt(t)){case"G":jh(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4e0a":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;if("\u4e0a\u5348/\u4e0b\u5348"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(r=i;"]"!==e.charAt(t++)&&t<e.length;)r+=e.charAt(t);if(r.match(Sg))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(i=e.charAt(++t))>-1||"\\"==i&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===i;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;default:++t}return!1}var Rg=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Eg(e,t){if(null==t)return!1;var i=parseFloat(t[2]);switch(t[1]){case"=":if(e==i)return!0;break;case">":if(e>i)return!0;break;case"<":if(e<i)return!0;break;case"<>":if(e!=i)return!0;break;case">=":if(e>=i)return!0;break;case"<=":if(e<=i)return!0}return!1}function xg(e,t){var i=function(e){for(var t=[],i=!1,r=0,n=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:i=!i;break;case 95:case 42:case 92:++r;break;case 59:t[t.length]=e.substr(n,r-n),n=r+1}if(t[t.length]=e.substr(n),!0===i)throw new Error("Format |"+e+"| unterminated string ");return t}(e),r=i.length,n=i[r-1].indexOf("@");if(r<4&&n>-1&&--r,i.length>4)throw new Error("cannot find right format for |"+i.join("|")+"|");if("number"!==typeof t)return[4,4===i.length||n>-1?i[i.length-1]:"@"];switch(i.length){case 1:i=n>-1?["General","General","General",i[0]]:[i[0],i[0],i[0],"@"];break;case 2:i=n>-1?[i[0],i[0],i[0],i[1]]:[i[0],i[1],i[0],"@"];break;case 3:i=n>-1?[i[0],i[1],i[0],i[2]]:[i[0],i[1],i[2],"@"]}var o=t>0?i[0]:t<0?i[1]:i[2];if(-1===i[0].indexOf("[")&&-1===i[1].indexOf("["))return[r,o];if(null!=i[0].match(/\[[=<>]/)||null!=i[1].match(/\[[=<>]/)){var s=i[0].match(Rg),a=i[1].match(Rg);return Eg(t,s)?[r,i[0]]:Eg(t,a)?[r,i[1]]:[r,i[null!=s&&null!=a?2:1]]}return[r,o]}function Tg(e,t,i){null==i&&(i={});var r="";switch(typeof e){case"string":r="m/d/yy"==e&&i.dateNF?i.dateNF:e;break;case"number":null==(r=14==e&&i.dateNF?i.dateNF:(null!=i.table?i.table:qh)[e])&&(r=i.table&&i.table[Qh[e]]||qh[Qh[e]]),null==r&&(r=$h[e]||"General")}if(jh(r,0))return og(t,i);t instanceof Date&&(t=ig(t,i.date1904));var n=xg(r,t);if(jh(n[1]))return og(t,i);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return function(e,t,i,r){for(var n,o,s,a=[],l="",c=0,u="",d="t",h="H";c<e.length;)switch(u=e.charAt(c)){case"G":if(!jh(e,c))throw new Error("unrecognized character "+u+" in "+e);a[a.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";34!==(s=e.charCodeAt(++c))&&c<e.length;)l+=String.fromCharCode(s);a[a.length]={t:"t",v:l},++c;break;case"\\":var g=e.charAt(++c),p="("===g||")"===g?g:"t";a[a.length]={t:p,v:g},++c;break;case"_":a[a.length]={t:"t",v:" "},c+=2;break;case"@":a[a.length]={t:"T",v:t},++c;break;case"B":case"b":if("1"===e.charAt(c+1)||"2"===e.charAt(c+1)){if(null==n&&null==(n=Jh(t,i,"2"===e.charAt(c+1))))return"";a[a.length]={t:"X",v:e.substr(c,2)},d=u,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==n&&null==(n=Jh(t,i)))return"";for(l=u;++c<e.length&&e.charAt(c).toLowerCase()===u;)l+=u;"m"===u&&"h"===d.toLowerCase()&&(u="M"),"h"===u&&(u=h),a[a.length]={t:u,v:l},d=u;break;case"A":case"a":case"\u4e0a":var f={t:u,v:u};if(null==n&&(n=Jh(t,i)),"A/P"===e.substr(c,3).toUpperCase()?(null!=n&&(f.v=n.H>=12?"P":"A"),f.t="T",h="h",c+=3):"AM/PM"===e.substr(c,5).toUpperCase()?(null!=n&&(f.v=n.H>=12?"PM":"AM"),f.t="T",c+=5,h="h"):"\u4e0a\u5348/\u4e0b\u5348"===e.substr(c,5).toUpperCase()?(null!=n&&(f.v=n.H>=12?"\u4e0b\u5348":"\u4e0a\u5348"),f.t="T",c+=5,h="h"):(f.t="t",++c),null==n&&"T"===f.t)return"";a[a.length]=f,d=u;break;case"[":for(l=u;"]"!==e.charAt(c++)&&c<e.length;)l+=e.charAt(c);if("]"!==l.slice(-1))throw'unterminated "[" block: |'+l+"|";if(l.match(Sg)){if(null==n&&null==(n=Jh(t,i)))return"";a[a.length]={t:"Z",v:l.toLowerCase()},d=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",yg(e)||(a[a.length]={t:"t",v:l}));break;case".":if(null!=n){for(l=u;++c<e.length&&"0"===(u=e.charAt(c));)l+=u;a[a.length]={t:"s",v:l};break}case"0":case"#":for(l=u;++c<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(c))>-1;)l+=u;a[a.length]={t:"n",v:l};break;case"?":for(l=u;e.charAt(++c)===u;)l+=u;a[a.length]={t:u,v:l},d=u;break;case"*":++c," "!=e.charAt(c)&&"*"!=e.charAt(c)||++c;break;case"(":case")":a[a.length]={t:1===r?"t":u,v:u},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=u;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)l+=e.charAt(c);a[a.length]={t:"D",v:l};break;case" ":a[a.length]={t:u,v:u},++c;break;case"$":a[a.length]={t:"t",v:"$"},++c;break;default:if(-1===",$-+/():!^&'~{}<>=\u20acacfijklopqrtuvwxzP".indexOf(u))throw new Error("unrecognized character "+u+" in "+e);a[a.length]={t:"t",v:u},++c}var m,v=0,C=0;for(c=a.length-1,d="t";c>=0;--c)switch(a[c].t){case"h":case"H":a[c].t=h,d="h",v<1&&(v=1);break;case"s":(m=a[c].v.match(/\.0+$/))&&(C=Math.max(C,m[0].length-1)),v<3&&(v=3);case"d":case"y":case"M":case"e":d=a[c].t;break;case"m":"s"===d&&(a[c].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&a[c].v.match(/[Hh]/)&&(v=1),v<2&&a[c].v.match(/[Mm]/)&&(v=2),v<3&&a[c].v.match(/[Ss]/)&&(v=3)}switch(v){case 0:break;case 1:n.u>=.5&&(n.u=0,++n.S),n.S>=60&&(n.S=0,++n.M),n.M>=60&&(n.M=0,++n.H);break;case 2:n.u>=.5&&(n.u=0,++n.S),n.S>=60&&(n.S=0,++n.M)}var w,b="";for(c=0;c<a.length;++c)switch(a[c].t){case"t":case"T":case" ":case"D":break;case"X":a[c].v="",a[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[c].v=sg(a[c].t.charCodeAt(0),a[c].v,n,C),a[c].t="t";break;case"n":case"?":for(w=c+1;null!=a[w]&&("?"===(u=a[w].t)||"D"===u||(" "===u||"t"===u)&&null!=a[w+1]&&("?"===a[w+1].t||"t"===a[w+1].t&&"/"===a[w+1].v)||"("===a[c].t&&(" "===u||"n"===u||")"===u)||"t"===u&&("/"===a[w].v||" "===a[w].v&&null!=a[w+1]&&"?"==a[w+1].t));)a[c].v+=a[w].v,a[w]={v:"",t:";"},++w;b+=a[c].v,c=w-1;break;case"G":a[c].t="t",a[c].v=og(t,i)}var S,y,R="";if(b.length>0){40==b.charCodeAt(0)?(S=t<0&&45===b.charCodeAt(0)?-t:t,y=bg("n",b,S)):(y=bg("n",b,S=t<0&&r>1?-t:t),S<0&&a[0]&&"t"==a[0].t&&(y=y.substr(1),a[0].v="-"+a[0].v)),w=y.length-1;var E=a.length;for(c=0;c<a.length;++c)if(null!=a[c]&&"t"!=a[c].t&&a[c].v.indexOf(".")>-1){E=c;break}var x=a.length;if(E===a.length&&-1===y.indexOf("E")){for(c=a.length-1;c>=0;--c)null!=a[c]&&-1!=="n?".indexOf(a[c].t)&&(w>=a[c].v.length-1?(w-=a[c].v.length,a[c].v=y.substr(w+1,a[c].v.length)):w<0?a[c].v="":(a[c].v=y.substr(0,w+1),w=-1),a[c].t="t",x=c);w>=0&&x<a.length&&(a[x].v=y.substr(0,w+1)+a[x].v)}else if(E!==a.length&&-1===y.indexOf("E")){for(w=y.indexOf(".")-1,c=E;c>=0;--c)if(null!=a[c]&&-1!=="n?".indexOf(a[c].t)){for(o=a[c].v.indexOf(".")>-1&&c===E?a[c].v.indexOf(".")-1:a[c].v.length-1,R=a[c].v.substr(o+1);o>=0;--o)w>=0&&("0"===a[c].v.charAt(o)||"#"===a[c].v.charAt(o))&&(R=y.charAt(w--)+R);a[c].v=R,a[c].t="t",x=c}for(w>=0&&x<a.length&&(a[x].v=y.substr(0,w+1)+a[x].v),w=y.indexOf(".")+1,c=E;c<a.length;++c)if(null!=a[c]&&(-1!=="n?(".indexOf(a[c].t)||c===E)){for(o=a[c].v.indexOf(".")>-1&&c===E?a[c].v.indexOf(".")+1:0,R=a[c].v.substr(0,o);o<a[c].v.length;++o)w<y.length&&(R+=y.charAt(w++));a[c].v=R,a[c].t="t",x=c}}}for(c=0;c<a.length;++c)null!=a[c]&&"n?".indexOf(a[c].t)>-1&&(S=r>1&&t<0&&c>0&&"-"===a[c-1].v?-t:t,a[c].v=bg(a[c].t,a[c].v,S),a[c].t="t");var T="";for(c=0;c!==a.length;++c)null!=a[c]&&(T+=a[c].v);return T}(n[1],t,i,n[0])}function Fg(e,t){if("number"!=typeof t){t=+t||-1;for(var i=0;i<392;++i)if(void 0!=qh[i]){if(qh[i]==e){t=i;break}}else t<0&&(t=i);t<0&&(t=391)}return qh[t]=e,t}function Pg(e){for(var t=0;392!=t;++t)void 0!==e[t]&&Fg(e[t],t)}function Dg(){var e;e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "',qh=e}var kg=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;var Ag=function(){var e={};e.version="1.2.0";var t=function(){for(var e=0,t=new Array(256),i=0;256!=i;++i)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=i)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,t[i]=e;return"undefined"!==typeof Int32Array?new Int32Array(t):t}();var i=function(e){var t=0,i=0,r=0,n="undefined"!==typeof Int32Array?new Int32Array(4096):new Array(4096);for(r=0;256!=r;++r)n[r]=e[r];for(r=0;256!=r;++r)for(i=e[r],t=256+r;t<4096;t+=256)i=n[t]=i>>>8^e[255&i];var o=[];for(r=1;16!=r;++r)o[r-1]="undefined"!==typeof Int32Array?n.subarray(256*r,256*r+256):n.slice(256*r,256*r+256);return o}(t),r=i[0],n=i[1],o=i[2],s=i[3],a=i[4],l=i[5],c=i[6],u=i[7],d=i[8],h=i[9],g=i[10],p=i[11],f=i[12],m=i[13],v=i[14];return e.table=t,e.bstr=function(e,i){for(var r=~i,n=0,o=e.length;n<o;)r=r>>>8^t[255&(r^e.charCodeAt(n++))];return~r},e.buf=function(e,i){for(var C=~i,w=e.length-15,b=0;b<w;)C=v[e[b++]^255&C]^m[e[b++]^C>>8&255]^f[e[b++]^C>>16&255]^p[e[b++]^C>>>24]^g[e[b++]]^h[e[b++]]^d[e[b++]]^u[e[b++]]^c[e[b++]]^l[e[b++]]^a[e[b++]]^s[e[b++]]^o[e[b++]]^n[e[b++]]^r[e[b++]]^t[e[b++]];for(w+=15;b<w;)C=C>>>8^t[255&(C^e[b++])];return~C},e.str=function(e,i){for(var r=~i,n=0,o=e.length,s=0,a=0;n<o;)(s=e.charCodeAt(n++))<128?r=r>>>8^t[255&(r^s)]:s<2048?r=(r=r>>>8^t[255&(r^(192|s>>6&31))])>>>8^t[255&(r^(128|63&s))]:s>=55296&&s<57344?(s=64+(1023&s),a=1023&e.charCodeAt(n++),r=(r=(r=(r=r>>>8^t[255&(r^(240|s>>8&7))])>>>8^t[255&(r^(128|s>>2&63))])>>>8^t[255&(r^(128|a>>6&15|(3&s)<<4))])>>>8^t[255&(r^(128|63&a))]):r=(r=(r=r>>>8^t[255&(r^(224|s>>12&15))])>>>8^t[255&(r^(128|s>>6&63))])>>>8^t[255&(r^(128|63&s))];return~r},e}(),Mg=function(){var e,t={};function i(e){if("/"==e.charAt(e.length-1))return-1===e.slice(0,-1).indexOf("/")?e:i(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(0,t+1)}function r(e){if("/"==e.charAt(e.length-1))return r(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(t+1)}function n(e,t){"string"===typeof t&&(t=new Date(t));var i=t.getHours();i=(i=i<<6|t.getMinutes())<<5|t.getSeconds()>>>1,e.write_shift(2,i);var r=t.getFullYear()-1980;r=(r=r<<4|t.getMonth()+1)<<5|t.getDate(),e.write_shift(2,r)}function o(e){Pf(e,0);for(var t={},i=0;e.l<=e.length-4;){var r=e.read_shift(2),n=e.read_shift(2),o=e.l+n,s={};if(21589===r)1&(i=e.read_shift(1))&&(s.mtime=e.read_shift(4)),n>5&&(2&i&&(s.atime=e.read_shift(4)),4&i&&(s.ctime=e.read_shift(4))),s.mtime&&(s.mt=new Date(1e3*s.mtime));e.l=o,t[r]=s}return t}function s(){return e||(e={})}function a(e,t){if(80==e[0]&&75==e[1])return re(e,t);if(109==(32|e[0])&&105==(32|e[1]))return function(e,t){if("mime-version:"!=y(e.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var i=t&&t.root||"",r=(Dh&&Buffer.isBuffer(e)?e.toString("binary"):y(e)).split("\r\n"),n=0,o="";for(n=0;n<r.length;++n)if(o=r[n],/^Content-Location:/i.test(o)&&(o=o.slice(o.indexOf("file")),i||(i=o.slice(0,o.lastIndexOf("/")+1)),o.slice(0,i.length)!=i))for(;i.length>0&&(i=(i=i.slice(0,i.length-1)).slice(0,i.lastIndexOf("/")+1),o.slice(0,i.length)!=i););var s=(r[1]||"").match(/boundary="(.*?)"/);if(!s)throw new Error("MAD cannot find boundary");var a="--"+(s[1]||""),l=[],c=[],u={FileIndex:l,FullPaths:c};h(u);var d,g=0;for(n=0;n<r.length;++n){var p=r[n];p!==a&&p!==a+"--"||(g++&&ce(u,r.slice(d,n),i),d=n)}return u}(e,t);if(e.length<512)throw new Error("CFB file size "+e.length+" < 512");var i,r,n,o,s,a,g=512,p=[],f=e.slice(0,512);Pf(f,0);var m=function(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(C,"Header Signature: "),e.l+=16;var t=e.read_shift(2,"u");return[e.read_shift(2,"u"),t]}(f);switch(i=m[0]){case 3:g=512;break;case 4:g=4096;break;case 0:if(0==m[1])return re(e,t);default:throw new Error("Major Version: Expected 3 or 4 saw "+i)}512!==g&&Pf(f=e.slice(0,g),28);var w=e.slice(0,g);!function(e,t){var i=9;switch(e.l+=2,i=e.read_shift(2)){case 9:if(3!=t)throw new Error("Sector Shift: Expected 9 saw "+i);break;case 12:if(4!=t)throw new Error("Sector Shift: Expected 12 saw "+i);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+i)}e.chk("0600","Mini Sector Shift: "),e.chk("000000000000","Reserved: ")}(f,i);var b=f.read_shift(4,"i");if(3===i&&0!==b)throw new Error("# Directory Sectors: Expected 0 saw "+b);f.l+=4,o=f.read_shift(4,"i"),f.l+=4,f.chk("00100000","Mini Stream Cutoff Size: "),s=f.read_shift(4,"i"),r=f.read_shift(4,"i"),a=f.read_shift(4,"i"),n=f.read_shift(4,"i");for(var S=-1,R=0;R<109&&!((S=f.read_shift(4,"i"))<0);++R)p[R]=S;var E=function(e,t){for(var i=Math.ceil(e.length/t)-1,r=[],n=1;n<i;++n)r[n-1]=e.slice(n*t,(n+1)*t);return r[i-1]=e.slice(i*t),r}(e,g);c(a,n,E,g,p);var x=function(e,t,i,r){var n=e.length,o=[],s=[],a=[],l=[],c=r-1,u=0,d=0,h=0,g=0;for(u=0;u<n;++u)if(a=[],(h=u+t)>=n&&(h-=n),!s[h]){l=[];var p=[];for(d=h;d>=0;){p[d]=!0,s[d]=!0,a[a.length]=d,l.push(e[d]);var f=i[Math.floor(4*d/r)];if(r<4+(g=4*d&c))throw new Error("FAT boundary crossed: "+d+" 4 "+r);if(!e[f])break;if(p[d=bf(e[f],g)])break}o[h]={nodes:a,data:qp([l])}}return o}(E,o,p,g);x[o].name="!Directory",r>0&&s!==v&&(x[s].name="!MiniFAT"),x[p[0]].name="!FAT",x.fat_addrs=p,x.ssz=g;var T=[],F=[],P=[];!function(e,t,i,r,n,o,s,a){for(var c,h=0,g=r.length?2:0,p=t[e].data,f=0,m=0;f<p.length;f+=128){var C=p.slice(f,f+128);Pf(C,64),m=C.read_shift(2),c=$p(C,0,m-g),r.push(c);var w={name:c,type:C.read_shift(1),color:C.read_shift(1),L:C.read_shift(4,"i"),R:C.read_shift(4,"i"),C:C.read_shift(4,"i"),clsid:C.read_shift(16),state:C.read_shift(4,"i"),start:0,size:0};0!==C.read_shift(2)+C.read_shift(2)+C.read_shift(2)+C.read_shift(2)&&(w.ct=d(C,C.l-8)),0!==C.read_shift(2)+C.read_shift(2)+C.read_shift(2)+C.read_shift(2)&&(w.mt=d(C,C.l-8)),w.start=C.read_shift(4,"i"),w.size=C.read_shift(4,"i"),w.size<0&&w.start<0&&(w.size=w.type=0,w.start=v,w.name=""),5===w.type?(h=w.start,n>0&&h!==v&&(t[h].name="!StreamData")):w.size>=4096?(w.storage="fat",void 0===t[w.start]&&(t[w.start]=u(i,w.start,t.fat_addrs,t.ssz)),t[w.start].name=w.name,w.content=t[w.start].data.slice(0,w.size)):(w.storage="minifat",w.size<0?w.size=0:h!==v&&w.start!==v&&t[h]&&(w.content=l(w,t[h].data,(t[a]||{}).data))),w.content&&Pf(w.content,0),o[c]=w,s.push(w)}}(o,x,E,T,r,{},F,s),function(e,t,i){for(var r=0,n=0,o=0,s=0,a=0,l=i.length,c=[],u=[];r<l;++r)c[r]=u[r]=r,t[r]=i[r];for(;a<u.length;++a)n=e[r=u[a]].L,o=e[r].R,s=e[r].C,c[r]===r&&(-1!==n&&c[n]!==n&&(c[r]=c[n]),-1!==o&&c[o]!==o&&(c[r]=c[o])),-1!==s&&(c[s]=r),-1!==n&&r!=c[r]&&(c[n]=c[r],u.lastIndexOf(n)<a&&u.push(n)),-1!==o&&r!=c[r]&&(c[o]=c[r],u.lastIndexOf(o)<a&&u.push(o));for(r=1;r<l;++r)c[r]===r&&(-1!==o&&c[o]!==o?c[r]=c[o]:-1!==n&&c[n]!==n&&(c[r]=c[n]));for(r=1;r<l;++r)if(0!==e[r].type){if((a=r)!=c[a])do{a=c[a],t[r]=t[a]+"/"+t[r]}while(0!==a&&-1!==c[a]&&a!=c[a]);c[r]=-1}for(t[0]+="/",r=1;r<l;++r)2!==e[r].type&&(t[r]+="/")}(F,P,T),T.shift();var D={FileIndex:F,FullPaths:P};return t&&t.raw&&(D.raw={header:w,sectors:E}),D}function l(e,t,i){for(var r=e.start,n=e.size,o=[],s=r;i&&n>0&&s>=0;)o.push(t.slice(s*m,s*m+m)),n-=m,s=bf(i,4*s);return 0===o.length?kf(0):Nh(o).slice(0,e.size)}function c(e,t,i,r,n){var o=v;if(e===v){if(0!==t)throw new Error("DIFAT chain shorter than expected")}else if(-1!==e){var s=i[e],a=(r>>>2)-1;if(!s)return;for(var l=0;l<a&&(o=bf(s,4*l))!==v;++l)n.push(o);c(bf(s,r-4),t-1,i,r,n)}}function u(e,t,i,r,n){var o=[],s=[];n||(n=[]);var a=r-1,l=0,c=0;for(l=t;l>=0;){n[l]=!0,o[o.length]=l,s.push(e[l]);var u=i[Math.floor(4*l/r)];if(r<4+(c=4*l&a))throw new Error("FAT boundary crossed: "+l+" 4 "+r);if(!e[u])break;l=bf(e[u],c)}return{nodes:o,data:qp([s])}}function d(e,t){return new Date(1e3*(wf(e,t+4)/1e7*Math.pow(2,32)+wf(e,t)/1e7-11644473600))}function h(e,t){var i=t||{},r=i.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw new Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=r+"/",e.FileIndex[0]={name:r,type:5}),i.CLSID&&(e.FileIndex[0].clsid=i.CLSID),function(e){var t="\x01Sh33tJ5";if(Mg.find(e,"/"+t))return;var i=kf(4);i[0]=55,i[1]=i[3]=50,i[2]=54,e.FileIndex.push({name:t,type:2,content:i,size:4,L:69,R:69,C:69}),e.FullPaths.push(e.FullPaths[0]+t),g(e)}(e)}function g(e,t){h(e);for(var n=!1,o=!1,s=e.FullPaths.length-1;s>=0;--s){var a=e.FileIndex[s];switch(a.type){case 0:o?n=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:o=!0,isNaN(a.R*a.L*a.C)&&(n=!0),a.R>-1&&a.L>-1&&a.R==a.L&&(n=!0);break;default:n=!0}}if(n||t){var l=new Date(1987,1,19),c=0,u=Object.create?Object.create(null):{},d=[];for(s=0;s<e.FullPaths.length;++s)u[e.FullPaths[s]]=!0,0!==e.FileIndex[s].type&&d.push([e.FullPaths[s],e.FileIndex[s]]);for(s=0;s<d.length;++s){var g=i(d[s][0]);(o=u[g])||(d.push([g,{name:r(g).replace("/",""),type:1,clsid:b,ct:l,mt:l,content:null}]),u[g]=!0)}for(d.sort((function(e,t){return function(e,t){for(var i=e.split("/"),r=t.split("/"),n=0,o=0,s=Math.min(i.length,r.length);n<s;++n){if(o=i[n].length-r[n].length)return o;if(i[n]!=r[n])return i[n]<r[n]?-1:1}return i.length-r.length}(e[0],t[0])})),e.FullPaths=[],e.FileIndex=[],s=0;s<d.length;++s)e.FullPaths[s]=d[s][0],e.FileIndex[s]=d[s][1];for(s=0;s<d.length;++s){var p=e.FileIndex[s],f=e.FullPaths[s];if(p.name=r(f).replace("/",""),p.L=p.R=p.C=-(p.color=1),p.size=p.content?p.content.length:0,p.start=0,p.clsid=p.clsid||b,0===s)p.C=d.length>1?1:-1,p.size=0,p.type=5;else if("/"==f.slice(-1)){for(c=s+1;c<d.length&&i(e.FullPaths[c])!=f;++c);for(p.C=c>=d.length?-1:c,c=s+1;c<d.length&&i(e.FullPaths[c])!=i(f);++c);p.R=c>=d.length?-1:c,p.type=1}else i(e.FullPaths[s+1]||"")==i(f)&&(p.R=s+1),p.type=2}}}function p(e,t){var i=t||{};if("mad"==i.fileType)return function(e,t){for(var i=t||{},r=i.boundary||"SheetJS",n=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(r="------="+r).slice(2)+'"',"","",""],o=e.FullPaths[0],s=o,a=e.FileIndex[0],l=1;l<e.FullPaths.length;++l)if(s=e.FullPaths[l].slice(o.length),(a=e.FileIndex[l]).size&&a.content&&"\x01Sh33tJ5"!=s){s=s.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,(function(e){return"_x"+e.charCodeAt(0).toString(16)+"_"})).replace(/[\u0080-\uFFFF]/g,(function(e){return"_u"+e.charCodeAt(0).toString(16)+"_"}));for(var c=a.content,u=Dh&&Buffer.isBuffer(c)?c.toString("binary"):y(c),d=0,h=Math.min(1024,u.length),g=0,p=0;p<=h;++p)(g=u.charCodeAt(p))>=32&&g<128&&++d;var f=d>=4*h/5;n.push(r),n.push("Content-Location: "+(i.root||"file:///C:/SheetJS/")+s),n.push("Content-Transfer-Encoding: "+(f?"quoted-printable":"base64")),n.push("Content-Type: "+se(a,s)),n.push(""),n.push(f?le(u):ae(u))}return n.push(r+"--\r\n"),n.join("\r\n")}(e,i);if(g(e),"zip"===i.fileType)return function(e,t){var i=t||{},r=[],o=[],s=kf(1),a=i.compression?8:0,l=0;0;var c=0,u=0,d=0,h=0,g=e.FullPaths[0],p=g,f=e.FileIndex[0],m=[],v=0;for(c=1;c<e.FullPaths.length;++c)if(p=e.FullPaths[c].slice(g.length),(f=e.FileIndex[c]).size&&f.content&&"\x01Sh33tJ5"!=p){var C=d,w=kf(p.length);for(u=0;u<p.length;++u)w.write_shift(1,127&p.charCodeAt(u));w=w.slice(0,w.l),m[h]=Ag.buf(f.content,0);var b=f.content;8==a&&(b=R(b)),(s=kf(30)).write_shift(4,67324752),s.write_shift(2,20),s.write_shift(2,l),s.write_shift(2,a),f.mt?n(s,f.mt):s.write_shift(4,0),s.write_shift(-4,8&l?0:m[h]),s.write_shift(4,8&l?0:b.length),s.write_shift(4,8&l?0:f.content.length),s.write_shift(2,w.length),s.write_shift(2,0),d+=s.length,r.push(s),d+=w.length,r.push(w),d+=b.length,r.push(b),8&l&&((s=kf(12)).write_shift(-4,m[h]),s.write_shift(4,b.length),s.write_shift(4,f.content.length),d+=s.l,r.push(s)),(s=kf(46)).write_shift(4,33639248),s.write_shift(2,0),s.write_shift(2,20),s.write_shift(2,l),s.write_shift(2,a),s.write_shift(4,0),s.write_shift(-4,m[h]),s.write_shift(4,b.length),s.write_shift(4,f.content.length),s.write_shift(2,w.length),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(4,0),s.write_shift(4,C),v+=s.l,o.push(s),v+=w.length,o.push(w),++h}return s=kf(22),s.write_shift(4,101010256),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(2,h),s.write_shift(2,h),s.write_shift(4,v),s.write_shift(4,d),s.write_shift(2,0),Nh([Nh(r),Nh(o),s])}(e,i);var r=function(e){for(var t=0,i=0,r=0;r<e.FileIndex.length;++r){var n=e.FileIndex[r];if(n.content){var o=n.content.length;o>0&&(o<4096?t+=o+63>>6:i+=o+511>>9)}}for(var s=e.FullPaths.length+3>>2,a=t+127>>7,l=(t+7>>3)+i+s+a,c=l+127>>7,u=c<=109?0:Math.ceil((c-109)/127);l+c+u+127>>7>c;)u=++c<=109?0:Math.ceil((c-109)/127);var d=[1,u,c,a,s,i,t,0];return e.FileIndex[0].size=t<<6,d[7]=(e.FileIndex[0].start=d[0]+d[1]+d[2]+d[3]+d[4]+d[5])+(d[6]+7>>3),d}(e),o=kf(r[7]<<9),s=0,a=0;for(s=0;s<8;++s)o.write_shift(1,w[s]);for(s=0;s<8;++s)o.write_shift(2,0);for(o.write_shift(2,62),o.write_shift(2,3),o.write_shift(2,65534),o.write_shift(2,9),o.write_shift(2,6),s=0;s<3;++s)o.write_shift(2,0);for(o.write_shift(4,0),o.write_shift(4,r[2]),o.write_shift(4,r[0]+r[1]+r[2]+r[3]-1),o.write_shift(4,0),o.write_shift(4,4096),o.write_shift(4,r[3]?r[0]+r[1]+r[2]-1:v),o.write_shift(4,r[3]),o.write_shift(-4,r[1]?r[0]-1:v),o.write_shift(4,r[1]),s=0;s<109;++s)o.write_shift(-4,s<r[2]?r[1]+s:-1);if(r[1])for(a=0;a<r[1];++a){for(;s<236+127*a;++s)o.write_shift(-4,s<r[2]?r[1]+s:-1);o.write_shift(-4,a===r[1]-1?v:a+1)}var l=function(e){for(a+=e;s<a-1;++s)o.write_shift(-4,s+1);e&&(++s,o.write_shift(-4,v))};for(a=s=0,a+=r[1];s<a;++s)o.write_shift(-4,S.DIFSECT);for(a+=r[2];s<a;++s)o.write_shift(-4,S.FATSECT);l(r[3]),l(r[4]);for(var c=0,u=0,d=e.FileIndex[0];c<e.FileIndex.length;++c)(d=e.FileIndex[c]).content&&((u=d.content.length)<4096||(d.start=a,l(u+511>>9)));for(l(r[6]+7>>3);511&o.l;)o.write_shift(-4,S.ENDOFCHAIN);for(a=s=0,c=0;c<e.FileIndex.length;++c)(d=e.FileIndex[c]).content&&(!(u=d.content.length)||u>=4096||(d.start=a,l(u+63>>6)));for(;511&o.l;)o.write_shift(-4,S.ENDOFCHAIN);for(s=0;s<r[4]<<2;++s){var h=e.FullPaths[s];if(h&&0!==h.length){d=e.FileIndex[s],0===s&&(d.start=d.size?d.start-1:v);var p=0===s&&i.root||d.name;if(u=2*(p.length+1),o.write_shift(64,p,"utf16le"),o.write_shift(2,u),o.write_shift(1,d.type),o.write_shift(1,d.color),o.write_shift(-4,d.L),o.write_shift(-4,d.R),o.write_shift(-4,d.C),d.clsid)o.write_shift(16,d.clsid,"hex");else for(c=0;c<4;++c)o.write_shift(4,0);o.write_shift(4,d.state||0),o.write_shift(4,0),o.write_shift(4,0),o.write_shift(4,0),o.write_shift(4,0),o.write_shift(4,d.start),o.write_shift(4,d.size),o.write_shift(4,0)}else{for(c=0;c<17;++c)o.write_shift(4,0);for(c=0;c<3;++c)o.write_shift(4,-1);for(c=0;c<12;++c)o.write_shift(4,0)}}for(s=1;s<e.FileIndex.length;++s)if((d=e.FileIndex[s]).size>=4096)if(o.l=d.start+1<<9,Dh&&Buffer.isBuffer(d.content))d.content.copy(o,o.l,0,d.size),o.l+=d.size+511&-512;else{for(c=0;c<d.size;++c)o.write_shift(1,d.content[c]);for(;511&c;++c)o.write_shift(1,0)}for(s=1;s<e.FileIndex.length;++s)if((d=e.FileIndex[s]).size>0&&d.size<4096)if(Dh&&Buffer.isBuffer(d.content))d.content.copy(o,o.l,0,d.size),o.l+=d.size+63&-64;else{for(c=0;c<d.size;++c)o.write_shift(1,d.content[c]);for(;63&c;++c)o.write_shift(1,0)}if(Dh)o.l=o.length;else for(;o.l<o.length;)o.write_shift(1,0);return o}t.version="1.2.1";var f,m=64,v=-2,C="d0cf11e0a1b11ae1",w=[208,207,17,224,161,177,26,225],b="00000000000000000000000000000000",S={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:v,FREESECT:-1,HEADER_SIGNATURE:C,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:b,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function y(e){for(var t=new Array(e.length),i=0;i<e.length;++i)t[i]=String.fromCharCode(e[i]);return t.join("")}function R(e){return f?f.deflateRawSync(e):q(e)}var E=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],x=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],T=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function F(e){var t=139536&(e<<1|e<<11)|558144&(e<<5|e<<15);return 255&(t>>16|t>>8|t)}for(var P="undefined"!==typeof Uint8Array,D=P?new Uint8Array(256):[],k=0;k<256;++k)D[k]=F(k);function A(e,t){var i=D[255&e];return t<=8?i>>>8-t:(i=i<<8|D[e>>8&255],t<=16?i>>>16-t:(i=i<<8|D[e>>16&255])>>>24-t)}function M(e,t){var i=7&t,r=t>>>3;return(e[r]|(i<=6?0:e[r+1]<<8))>>>i&3}function I(e,t){var i=7&t,r=t>>>3;return(e[r]|(i<=5?0:e[r+1]<<8))>>>i&7}function L(e,t){var i=7&t,r=t>>>3;return(e[r]|(i<=3?0:e[r+1]<<8))>>>i&31}function O(e,t){var i=7&t,r=t>>>3;return(e[r]|(i<=1?0:e[r+1]<<8))>>>i&127}function N(e,t,i){var r=7&t,n=t>>>3,o=(1<<i)-1,s=e[n]>>>r;return i<8-r?s&o:(s|=e[n+1]<<8-r,i<16-r?s&o:(s|=e[n+2]<<16-r,i<24-r?s&o:(s|=e[n+3]<<24-r)&o))}function B(e,t,i){var r=7&t,n=t>>>3;return r<=5?e[n]|=(7&i)<<r:(e[n]|=i<<r&255,e[n+1]=(7&i)>>8-r),t+3}function G(e,t,i){return i=(1&i)<<(7&t),e[t>>>3]|=i,t+1}function H(e,t,i){var r=t>>>3;return i<<=7&t,e[r]|=255&i,i>>>=8,e[r+1]=i,t+8}function z(e,t,i){var r=t>>>3;return i<<=7&t,e[r]|=255&i,i>>>=8,e[r+1]=255&i,e[r+2]=i>>>8,t+16}function V(e,t){var i=e.length,r=2*i>t?2*i:t+5,n=0;if(i>=t)return e;if(Dh){var o=Mh(r);if(e.copy)e.copy(o);else for(;n<e.length;++n)o[n]=e[n];return o}if(P){var s=new Uint8Array(r);if(s.set)s.set(e);else for(;n<i;++n)s[n]=e[n];return s}return e.length=r,e}function _(e){for(var t=new Array(e),i=0;i<e;++i)t[i]=0;return t}function W(e,t,i){var r=1,n=0,o=0,s=0,a=0,l=e.length,c=P?new Uint16Array(32):_(32);for(o=0;o<32;++o)c[o]=0;for(o=l;o<i;++o)e[o]=0;l=e.length;var u=P?new Uint16Array(l):_(l);for(o=0;o<l;++o)c[n=e[o]]++,r<n&&(r=n),u[o]=0;for(c[0]=0,o=1;o<=r;++o)c[o+16]=a=a+c[o-1]<<1;for(o=0;o<l;++o)0!=(a=e[o])&&(u[o]=c[a+16]++);var d=0;for(o=0;o<l;++o)if(0!=(d=e[o]))for(a=A(u[o],r)>>r-d,s=(1<<r+4-d)-1;s>=0;--s)t[a|s<<d]=15&d|o<<4;return r}var U=P?new Uint16Array(512):_(512),j=P?new Uint16Array(32):_(32);if(!P){for(var K=0;K<512;++K)U[K]=0;for(K=0;K<32;++K)j[K]=0}!function(){for(var e=[],t=0;t<32;t++)e.push(5);W(e,j,32);var i=[];for(t=0;t<=143;t++)i.push(8);for(;t<=255;t++)i.push(9);for(;t<=279;t++)i.push(7);for(;t<=287;t++)i.push(8);W(i,U,288)}();var Y=function(){for(var e=P?new Uint8Array(32768):[],t=0,i=0;t<T.length-1;++t)for(;i<T[t+1];++i)e[i]=t;for(;i<32768;++i)e[i]=29;var r=P?new Uint8Array(259):[];for(t=0,i=0;t<x.length-1;++t)for(;i<x[t+1];++i)r[i]=t;return function(t,i){return t.length<8?function(e,t){for(var i=0;i<e.length;){var r=Math.min(65535,e.length-i),n=i+r==e.length;for(t.write_shift(1,+n),t.write_shift(2,r),t.write_shift(2,65535&~r);r-- >0;)t[t.l++]=e[i++]}return t.l}(t,i):function(t,i){for(var n=0,o=0,s=P?new Uint16Array(32768):[];o<t.length;){var a=Math.min(65535,t.length-o);if(a<10){for(7&(n=B(i,n,+!(o+a!=t.length)))&&(n+=8-(7&n)),i.l=n/8|0,i.write_shift(2,a),i.write_shift(2,65535&~a);a-- >0;)i[i.l++]=t[o++];n=8*i.l}else{n=B(i,n,+!(o+a!=t.length)+2);for(var l=0;a-- >0;){var c=t[o],u=-1,d=0;if((u=s[l=32767&(l<<5^c)])&&((u|=-32768&o)>o&&(u-=32768),u<o))for(;t[u+d]==t[o+d]&&d<250;)++d;if(d>2){(c=r[d])<=22?n=H(i,n,D[c+1]>>1)-1:(H(i,n,3),H(i,n+=5,D[c-23]>>5),n+=3);var h=c<8?0:c-4>>2;h>0&&(z(i,n,d-x[c]),n+=h),c=e[o-u],n=H(i,n,D[c]>>3),n-=3;var g=c<4?0:c-2>>1;g>0&&(z(i,n,o-u-T[c]),n+=g);for(var p=0;p<d;++p)s[l]=32767&o,l=32767&(l<<5^t[o]),++o;a-=d-1}else c<=143?c+=48:n=G(i,n,1),n=H(i,n,D[c]),s[l]=32767&o,++o}n=H(i,n,0)-1}}return i.l=(n+7)/8|0,i.l}(t,i)}}();function q(e){var t=kf(50+Math.floor(1.1*e.length)),i=Y(e,t);return t.slice(0,i)}var Q=P?new Uint16Array(32768):_(32768),$=P?new Uint16Array(32768):_(32768),X=P?new Uint16Array(128):_(128),J=1,Z=1;function ee(e,t){var i=L(e,t)+257,r=L(e,t+=5)+1,n=function(e,t){var i=7&t,r=t>>>3;return(e[r]|(i<=4?0:e[r+1]<<8))>>>i&15}(e,t+=5)+4;t+=4;for(var o=0,s=P?new Uint8Array(19):_(19),a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=1,c=P?new Uint8Array(8):_(8),u=P?new Uint8Array(8):_(8),d=s.length,h=0;h<n;++h)s[E[h]]=o=I(e,t),l<o&&(l=o),c[o]++,t+=3;var g=0;for(c[0]=0,h=1;h<=l;++h)u[h]=g=g+c[h-1]<<1;for(h=0;h<d;++h)0!=(g=s[h])&&(a[h]=u[g]++);var p=0;for(h=0;h<d;++h)if(0!=(p=s[h])){g=D[a[h]]>>8-p;for(var f=(1<<7-p)-1;f>=0;--f)X[g|f<<p]=7&p|h<<3}var m=[];for(l=1;m.length<i+r;)switch(t+=7&(g=X[O(e,t)]),g>>>=3){case 16:for(o=3+M(e,t),t+=2,g=m[m.length-1];o-- >0;)m.push(g);break;case 17:for(o=3+I(e,t),t+=3;o-- >0;)m.push(0);break;case 18:for(o=11+O(e,t),t+=7;o-- >0;)m.push(0);break;default:m.push(g),l<g&&(l=g)}var v=m.slice(0,i),C=m.slice(i);for(h=i;h<286;++h)v[h]=0;for(h=r;h<30;++h)C[h]=0;return J=W(v,Q,286),Z=W(C,$,30),t}function te(e,t){var i=function(e,t){if(3==e[0]&&!(3&e[1]))return[Ah(t),2];for(var i=0,r=0,n=Mh(t||1<<18),o=0,s=n.length>>>0,a=0,l=0;0==(1&r);)if(r=I(e,i),i+=3,r>>>1!=0)for(r>>1==1?(a=9,l=5):(i=ee(e,i),a=J,l=Z);;){!t&&s<o+32767&&(s=(n=V(n,o+32767)).length);var c=N(e,i,a),u=r>>>1==1?U[c]:Q[c];if(i+=15&u,0===((u>>>=4)>>>8&255))n[o++]=u;else{if(256==u)break;var d=(u-=257)<8?0:u-4>>2;d>5&&(d=0);var h=o+x[u];d>0&&(h+=N(e,i,d),i+=d),c=N(e,i,l),i+=15&(u=r>>>1==1?j[c]:$[c]);var g=(u>>>=4)<4?0:u-2>>1,p=T[u];for(g>0&&(p+=N(e,i,g),i+=g),!t&&s<h&&(s=(n=V(n,h+100)).length);o<h;)n[o]=n[o-p],++o}}else{7&i&&(i+=8-(7&i));var f=e[i>>>3]|e[1+(i>>>3)]<<8;if(i+=32,f>0)for(!t&&s<o+f&&(s=(n=V(n,o+f)).length);f-- >0;)n[o++]=e[i>>>3],i+=8}return t?[n,i+7>>>3]:[n.slice(0,o),i+7>>>3]}(e.slice(e.l||0),t);return e.l+=i[1],i[0]}function ie(e,t){if(!e)throw new Error(t);"undefined"!==typeof console&&console.error(t)}function re(e,t){var i=e;Pf(i,0);var r={FileIndex:[],FullPaths:[]};h(r,{root:t.root});for(var n=i.length-4;(80!=i[n]||75!=i[n+1]||5!=i[n+2]||6!=i[n+3])&&n>=0;)--n;i.l=n+4,i.l+=4;var s=i.read_shift(2);i.l+=6;var a=i.read_shift(4);for(i.l=a,n=0;n<s;++n){i.l+=20;var l=i.read_shift(4),c=i.read_shift(4),u=i.read_shift(2),d=i.read_shift(2),g=i.read_shift(2);i.l+=8;var p=i.read_shift(4),f=o(i.slice(i.l+u,i.l+u+d));i.l+=u+d+g;var m=i.l;i.l=p+4,ne(i,l,c,r,f),i.l=m}return r}function ne(e,t,i,r,n){e.l+=2;var s=e.read_shift(2),a=e.read_shift(2),l=function(e){var t=65535&e.read_shift(2),i=65535&e.read_shift(2),r=new Date,n=31&i,o=15&(i>>>=5);i>>>=4,r.setMilliseconds(0),r.setFullYear(i+1980),r.setMonth(o-1),r.setDate(n);var s=31&t,a=63&(t>>>=5);return t>>>=6,r.setHours(t),r.setMinutes(a),r.setSeconds(s<<1),r}(e);if(8257&s)throw new Error("Unsupported ZIP encryption");e.read_shift(4);for(var c=e.read_shift(4),u=e.read_shift(4),d=e.read_shift(2),h=e.read_shift(2),g="",p=0;p<d;++p)g+=String.fromCharCode(e[e.l++]);if(h){var m=o(e.slice(e.l,e.l+h));(m[21589]||{}).mt&&(l=m[21589].mt),((n||{})[21589]||{}).mt&&(l=n[21589].mt)}e.l+=h;var v=e.slice(e.l,e.l+c);switch(a){case 8:v=function(e,t){if(!f)return te(e,t);var i=new(0,f.InflateRaw),r=i._processChunk(e.slice(e.l),i._finishFlushFlag);return e.l+=i.bytesRead,r}(e,u);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+a)}var C=!1;8&s&&(134695760==e.read_shift(4)&&(e.read_shift(4),C=!0),c=e.read_shift(4),u=e.read_shift(4)),c!=t&&ie(C,"Bad compressed size: "+t+" != "+c),u!=i&&ie(C,"Bad uncompressed size: "+i+" != "+u),ue(r,g,v,{unsafe:!0,mt:l})}var oe={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function se(e,t){if(e.ctype)return e.ctype;var i=e.name||"",r=i.match(/\.([^\.]+)$/);return r&&oe[r[1]]||t&&(r=(i=t).match(/[\.\\]([^\.\\])+$/))&&oe[r[1]]?oe[r[1]]:"application/octet-stream"}function ae(e){for(var t=Fh(e),i=[],r=0;r<t.length;r+=76)i.push(t.slice(r,r+76));return i.join("\r\n")+"\r\n"}function le(e){var t=e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,(function(e){var t=e.charCodeAt(0).toString(16).toUpperCase();return"="+(1==t.length?"0"+t:t)}));"\n"==(t=t.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(t="=0D"+t.slice(1));for(var i=[],r=(t=t.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),n=0;n<r.length;++n){var o=r[n];if(0!=o.length)for(var s=0;s<o.length;){var a=76,l=o.slice(s,s+a);"="==l.charAt(a-1)?a--:"="==l.charAt(a-2)?a-=2:"="==l.charAt(a-3)&&(a-=3),l=o.slice(s,s+a),(s+=a)<o.length&&(l+="="),i.push(l)}else i.push("")}return i.join("\r\n")}function ce(e,t,i){for(var r,n="",o="",s="",a=0;a<10;++a){var l=t[a];if(!l||l.match(/^\s*$/))break;var c=l.match(/^(.*?):\s*([^\s].*)$/);if(c)switch(c[1].toLowerCase()){case"content-location":n=c[2].trim();break;case"content-type":s=c[2].trim();break;case"content-transfer-encoding":o=c[2].trim()}}switch(++a,o.toLowerCase()){case"base64":r=Ih(Ph(t.slice(a).join("")));break;case"quoted-printable":r=function(e){for(var t=[],i=0;i<e.length;++i){for(var r=e[i];i<=e.length&&"="==r.charAt(r.length-1);)r=r.slice(0,r.length-1)+e[++i];t.push(r)}for(var n=0;n<t.length;++n)t[n]=t[n].replace(/[=][0-9A-Fa-f]{2}/g,(function(e){return String.fromCharCode(parseInt(e.slice(1),16))}));return Ih(t.join("\r\n"))}(t.slice(a));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+o)}var u=ue(e,n.slice(i.length),r,{unsafe:!0});s&&(u.ctype=s)}function ue(e,t,i,n){var o=n&&n.unsafe;o||h(e);var s=!o&&Mg.find(e,t);if(!s){var a=e.FullPaths[0];t.slice(0,a.length)==a?a=t:("/"!=a.slice(-1)&&(a+="/"),a=(a+t).replace("//","/")),s={name:r(t),type:2},e.FileIndex.push(s),e.FullPaths.push(a),o||Mg.utils.cfb_gc(e)}return s.content=i,s.size=i?i.length:0,n&&(n.CLSID&&(s.clsid=n.CLSID),n.mt&&(s.mt=n.mt),n.ct&&(s.ct=n.ct)),s}return t.find=function(e,t){var i=e.FullPaths.map((function(e){return e.toUpperCase()})),r=i.map((function(e){var t=e.split("/");return t[t.length-("/"==e.slice(-1)?2:1)]})),n=!1;47===t.charCodeAt(0)?(n=!0,t=i[0].slice(0,-1)+t):n=-1!==t.indexOf("/");var o=t.toUpperCase(),s=!0===n?i.indexOf(o):r.indexOf(o);if(-1!==s)return e.FileIndex[s];var a=!o.match(Gh);for(o=o.replace(Bh,""),a&&(o=o.replace(Gh,"!")),s=0;s<i.length;++s){if((a?i[s].replace(Gh,"!"):i[s]).replace(Bh,"")==o)return e.FileIndex[s];if((a?r[s].replace(Gh,"!"):r[s]).replace(Bh,"")==o)return e.FileIndex[s]}return null},t.read=function(t,i){var r=i&&i.type;switch(r||Dh&&Buffer.isBuffer(t)&&(r="buffer"),r||"base64"){case"file":return function(t,i){return s(),a(e.readFileSync(t),i)}(t,i);case"base64":return a(Ih(Ph(t)),i);case"binary":return a(Ih(t),i)}return a(t,i)},t.parse=a,t.write=function(t,i){var r=p(t,i);switch(i&&i.type||"buffer"){case"file":return s(),e.writeFileSync(i.filename,r),r;case"binary":return"string"==typeof r?r:y(r);case"base64":return Fh("string"==typeof r?r:y(r));case"buffer":if(Dh)return Buffer.isBuffer(r)?r:kh(r);case"array":return"string"==typeof r?Ih(r):r}return r},t.writeFile=function(t,i,r){s();var n=p(t,r);e.writeFileSync(i,n)},t.utils={cfb_new:function(e){var t={};return h(t,e),t},cfb_add:ue,cfb_del:function(e,t){h(e);var i=Mg.find(e,t);if(i)for(var r=0;r<e.FileIndex.length;++r)if(e.FileIndex[r]==i)return e.FileIndex.splice(r,1),e.FullPaths.splice(r,1),!0;return!1},cfb_mov:function(e,t,i){h(e);var n=Mg.find(e,t);if(n)for(var o=0;o<e.FileIndex.length;++o)if(e.FileIndex[o]==n)return e.FileIndex[o].name=r(i),e.FullPaths[o]=i,!0;return!1},cfb_gc:function(e){g(e,!0)},ReadShift:yf,CheckField:Ff,prep_blob:Pf,bconcat:Nh,use_zlib:function(e){try{var t=new(0,e.InflateRaw);if(t._processChunk(new Uint8Array([3,0]),t._finishFlushFlag),!t.bytesRead)throw new Error("zlib does not expose bytesRead");f=e}catch(i){console.error("cannot use native zlib: "+(i.message||i))}},_deflateRaw:q,_inflateRaw:te,consts:S},t}();let Ig;function Lg(e){return"string"===typeof e?Lh(e):Array.isArray(e)?function(e){if("undefined"===typeof Uint8Array)throw new Error("Unsupported");return new Uint8Array(e)}(e):e}function Og(e,t,i){if("undefined"!==typeof Ig&&Ig.writeFileSync)return i?Ig.writeFileSync(e,t,i):Ig.writeFileSync(e,t);if("undefined"!==typeof Deno){if(i&&"string"==typeof t)switch(i){case"utf8":t=new TextEncoder(i).encode(t);break;case"binary":t=Lh(t);break;default:throw new Error("Unsupported encoding "+i)}return Deno.writeFileSync(e,t)}var r="utf8"==i?wp(t):t;if("undefined"!==typeof IE_SaveFile)return IE_SaveFile(r,e);if("undefined"!==typeof Blob){var n=new Blob([Lg(r)],{type:"application/octet-stream"});if("undefined"!==typeof navigator&&navigator.msSaveBlob)return navigator.msSaveBlob(n,e);if("undefined"!==typeof saveAs)return saveAs(n,e);if("undefined"!==typeof URL&&"undefined"!==typeof document&&document.createElement&&URL.createObjectURL){var o=URL.createObjectURL(n);if("object"===typeof chrome&&"function"==typeof(chrome.downloads||{}).download)return URL.revokeObjectURL&&"undefined"!==typeof setTimeout&&setTimeout((function(){URL.revokeObjectURL(o)}),6e4),chrome.downloads.download({url:o,filename:e,saveAs:!0});var s=document.createElement("a");if(null!=s.download)return s.download=e,s.href=o,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&"undefined"!==typeof setTimeout&&setTimeout((function(){URL.revokeObjectURL(o)}),6e4),o}}if("undefined"!==typeof $&&"undefined"!==typeof File&&"undefined"!==typeof Folder)try{var a=File(e);return a.open("w"),a.encoding="binary",Array.isArray(t)&&(t=Oh(t)),a.write(t),a.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function Ng(e){for(var t=Object.keys(e),i=[],r=0;r<t.length;++r)Object.prototype.hasOwnProperty.call(e,t[r])&&i.push(t[r]);return i}function Bg(e,t){for(var i=[],r=Ng(e),n=0;n!==r.length;++n)null==i[e[r[n]][t]]&&(i[e[r[n]][t]]=r[n]);return i}function Gg(e){for(var t=[],i=Ng(e),r=0;r!==i.length;++r)t[e[i[r]]]=i[r];return t}function Hg(e){for(var t=[],i=Ng(e),r=0;r!==i.length;++r)t[e[i[r]]]=parseInt(i[r],10);return t}var zg=new Date(1899,11,30,0,0,0);function Vg(e,t){var i=e.getTime();return t&&(i-=1263168e5),(i-(zg.getTime()+6e4*(e.getTimezoneOffset()-zg.getTimezoneOffset())))/864e5}var _g=new Date,Wg=zg.getTime()+6e4*(_g.getTimezoneOffset()-zg.getTimezoneOffset()),Ug=_g.getTimezoneOffset();function jg(e){var t=new Date;return t.setTime(24*e*60*60*1e3+Wg),t.getTimezoneOffset()!==Ug&&t.setTime(t.getTime()+6e4*(t.getTimezoneOffset()-Ug)),t}var Kg=new Date("2017-02-19T19:06:09.000Z"),Yg=isNaN(Kg.getFullYear())?new Date("2/19/17"):Kg,qg=2017==Yg.getFullYear();function Qg(e,t){var i=new Date(e);if(qg)return t>0?i.setTime(i.getTime()+60*i.getTimezoneOffset()*1e3):t<0&&i.setTime(i.getTime()-60*i.getTimezoneOffset()*1e3),i;if(e instanceof Date)return e;if(1917==Yg.getFullYear()&&!isNaN(i.getFullYear())){var r=i.getFullYear();return e.indexOf(""+r)>-1||i.setFullYear(i.getFullYear()+100),i}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(o=new Date(o.getTime()-60*o.getTimezoneOffset()*1e3)),o}function $g(e,t){if(Dh&&Buffer.isBuffer(e)){if(t){if(255==e[0]&&254==e[1])return wp(e.slice(2).toString("utf16le"));if(254==e[1]&&255==e[2])return wp(yh(e.slice(2).toString("binary")))}return e.toString("binary")}if("undefined"!==typeof TextDecoder)try{if(t){if(255==e[0]&&254==e[1])return wp(new TextDecoder("utf-16le").decode(e.slice(2)));if(254==e[0]&&255==e[1])return wp(new TextDecoder("utf-16be").decode(e.slice(2)))}var i={"\u20ac":"\x80","\u201a":"\x82","\u0192":"\x83","\u201e":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02c6":"\x88","\u2030":"\x89","\u0160":"\x8a","\u2039":"\x8b","\u0152":"\x8c","\u017d":"\x8e","\u2018":"\x91","\u2019":"\x92","\u201c":"\x93","\u201d":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02dc":"\x98","\u2122":"\x99","\u0161":"\x9a","\u203a":"\x9b","\u0153":"\x9c","\u017e":"\x9e","\u0178":"\x9f"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[\u20ac\u201a\u0192\u201e\u2026\u2020\u2021\u02c6\u2030\u0160\u2039\u0152\u017d\u2018\u2019\u201c\u201d\u2022\u2013\u2014\u02dc\u2122\u0161\u203a\u0153\u017e\u0178]/g,(function(e){return i[e]||e}))}catch(o){}for(var r=[],n=0;n!=e.length;++n)r.push(String.fromCharCode(e[n]));return r.join("")}function Xg(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=Xg(e[i]));return t}function Jg(e,t){for(var i="";i.length<t;)i+=e;return i}function Zg(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var i=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,(function(){return i*=100,""}));return isNaN(t=Number(r))?(r=r.replace(/[(](.*)[)]/,(function(e,t){return i=-i,t})),isNaN(t=Number(r))?t:t/i):t/i}var ep=["january","february","march","april","may","june","july","august","september","october","november","december"];function tp(e){var t=new Date(e),i=new Date(NaN),r=t.getYear(),n=t.getMonth(),o=t.getDate();if(isNaN(o))return i;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==ep.indexOf(s))return i}else if(s.match(/[a-z]/))return i;return r<0||r>8099?i:(n>0||o>1)&&101!=r?t:e.match(/[^-0-9:,\/\\]/)?i:t}function ip(e,t,i){if(e.FullPaths){var r;if("string"==typeof i)return r=Dh?kh(i):function(e){for(var t=[],i=0,r=e.length+250,n=Ah(e.length+255),o=0;o<e.length;++o){var s=e.charCodeAt(o);if(s<128)n[i++]=s;else if(s<2048)n[i++]=192|s>>6&31,n[i++]=128|63&s;else if(s>=55296&&s<57344){s=64+(1023&s);var a=1023&e.charCodeAt(++o);n[i++]=240|s>>8&7,n[i++]=128|s>>2&63,n[i++]=128|a>>6&15|(3&s)<<4,n[i++]=128|63&a}else n[i++]=224|s>>12&15,n[i++]=128|s>>6&63,n[i++]=128|63&s;i>r&&(t.push(n.slice(0,i)),i=0,n=Ah(65535),r=65530)}return t.push(n.slice(0,i)),Nh(t)}(i),Mg.utils.cfb_add(e,t,r);Mg.utils.cfb_add(e,t,i)}else e.file(t,i)}function rp(){return Mg.utils.cfb_new()}var np='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n';var op={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},sp=Gg(op),ap=/[&<>'"]/g,lp=/[\u0000-\u0008\u000b-\u001f]/g;function cp(e){return(e+"").replace(ap,(function(e){return sp[e]})).replace(lp,(function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"}))}function up(e){return cp(e).replace(/ /g,"_x0020_")}var dp=/[\u0000-\u001f]/g;function hp(e){return(e+"").replace(ap,(function(e){return sp[e]})).replace(/\n/g,"<br/>").replace(dp,(function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"}))}function gp(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function pp(e){for(var t="",i=0,r=0,n=0,o=0,s=0,a=0;i<e.length;)(r=e.charCodeAt(i++))<128?t+=String.fromCharCode(r):(n=e.charCodeAt(i++),r>191&&r<224?(s=(31&r)<<6,s|=63&n,t+=String.fromCharCode(s)):(o=e.charCodeAt(i++),r<240?t+=String.fromCharCode((15&r)<<12|(63&n)<<6|63&o):(a=((7&r)<<18|(63&n)<<12|(63&o)<<6|63&(s=e.charCodeAt(i++)))-65536,t+=String.fromCharCode(55296+(a>>>10&1023)),t+=String.fromCharCode(56320+(1023&a)))));return t}function fp(e){var t,i,r,n=Ah(2*e.length),o=1,s=0,a=0;for(i=0;i<e.length;i+=o)o=1,(r=e.charCodeAt(i))<128?t=r:r<224?(t=64*(31&r)+(63&e.charCodeAt(i+1)),o=2):r<240?(t=4096*(15&r)+64*(63&e.charCodeAt(i+1))+(63&e.charCodeAt(i+2)),o=3):(o=4,t=262144*(7&r)+4096*(63&e.charCodeAt(i+1))+64*(63&e.charCodeAt(i+2))+(63&e.charCodeAt(i+3)),a=55296+((t-=65536)>>>10&1023),t=56320+(1023&t)),0!==a&&(n[s++]=255&a,n[s++]=a>>>8,a=0),n[s++]=t%256,n[s++]=t>>>8;return n.slice(0,s).toString("ucs2")}function mp(e){return kh(e,"binary").toString("utf8")}var vp="foo bar baz\xe2\x98\x83\xf0\x9f\x8d\xa3",Cp=Dh&&(mp(vp)==pp(vp)&&mp||fp(vp)==pp(vp)&&fp)||pp,wp=Dh?function(e){return kh(e,"utf8").toString("binary")}:function(e){for(var t=[],i=0,r=0,n=0;i<e.length;)switch(r=e.charCodeAt(i++),!0){case r<128:t.push(String.fromCharCode(r));break;case r<2048:t.push(String.fromCharCode(192+(r>>6))),t.push(String.fromCharCode(128+(63&r)));break;case r>=55296&&r<57344:r-=55296,n=e.charCodeAt(i++)-56320+(r<<10),t.push(String.fromCharCode(240+(n>>18&7))),t.push(String.fromCharCode(144+(n>>12&63))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(63&n)));break;default:t.push(String.fromCharCode(224+(r>>12))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(63&r)))}return t.join("")},bp=function(){var e=[["nbsp"," "],["middot","\xb7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map((function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]}));return function(t){for(var i=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),r=0;r<e.length;++r)i=i.replace(e[r][0],e[r][1]);return i}}();var Sp=/(^\s|\s$|\n)/;function yp(e,t){return"<"+e+(t.match(Sp)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Rp(e){return Ng(e).map((function(t){return" "+t+'="'+e[t]+'"'})).join("")}function Ep(e,t,i){return"<"+e+(null!=i?Rp(i):"")+(null!=t?(t.match(Sp)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function xp(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(i){if(t)throw i}return""}var Tp="http://schemas.openxmlformats.org/package/2006/metadata/core-properties",Fp="http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",Pp="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",Dp="http://schemas.openxmlformats.org/package/2006/content-types",kp="http://schemas.openxmlformats.org/package/2006/relationships",Ap="http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",Mp="http://purl.org/dc/elements/1.1/",Ip="http://purl.org/dc/terms/",Lp="http://purl.org/dc/dcmitype/",Op="http://schemas.openxmlformats.org/officeDocument/2006/relationships",Np="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",Bp="http://www.w3.org/2001/XMLSchema-instance",Gp="http://www.w3.org/2001/XMLSchema",Hp=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],zp="urn:schemas-microsoft-com:office:office",Vp="urn:schemas-microsoft-com:office:excel",_p="urn:schemas-microsoft-com:office:spreadsheet",Wp="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",Up="http://macVmlSchemaUri",jp="urn:schemas-microsoft-com:vml",Kp="http://www.w3.org/TR/REC-html40";var Yp=function(e){for(var t=[],i=0;i<e[0].length;++i)if(e[0][i])for(var r=0,n=e[0][i].length;r<n;r+=10240)t.push.apply(t,e[0][i].slice(r,r+10240));return t},qp=Dh?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map((function(e){return Buffer.isBuffer(e)?e:kh(e)}))):Yp(e)}:Yp,Qp=function(e,t,i){for(var r=[],n=t;n<i;n+=2)r.push(String.fromCharCode(vf(e,n)));return r.join("").replace(Bh,"")},$p=Dh?function(e,t,i){return Buffer.isBuffer(e)?e.toString("utf16le",t,i).replace(Bh,""):Qp(e,t,i)}:Qp,Xp=function(e,t,i){for(var r=[],n=t;n<t+i;++n)r.push(("0"+e[n].toString(16)).slice(-2));return r.join("")},Jp=Dh?function(e,t,i){return Buffer.isBuffer(e)?e.toString("hex",t,t+i):Xp(e,t,i)}:Xp,Zp=function(e,t,i){for(var r=[],n=t;n<i;n++)r.push(String.fromCharCode(mf(e,n)));return r.join("")},ef=Dh?function(e,t,i){return Buffer.isBuffer(e)?e.toString("utf8",t,i):Zp(e,t,i)}:Zp,tf=function(e,t){var i=wf(e,t);return i>0?ef(e,t+4,t+4+i-1):""},rf=tf,nf=function(e,t){var i=wf(e,t);return i>0?ef(e,t+4,t+4+i-1):""},of=nf,sf=function(e,t){var i=2*wf(e,t);return i>0?ef(e,t+4,t+4+i-1):""},af=sf,lf=function(e,t){var i=wf(e,t);return i>0?$p(e,t+4,t+4+i):""},cf=lf,uf=function(e,t){var i=wf(e,t);return i>0?ef(e,t+4,t+4+i):""},df=uf,hf=function(e,t){return function(e,t){for(var i=1-2*(e[t+7]>>>7),r=((127&e[t+7])<<4)+(e[t+6]>>>4&15),n=15&e[t+6],o=5;o>=0;--o)n=256*n+e[t+o];return 2047==r?0==n?i*(1/0):NaN:(0==r?r=-1022:(r-=1023,n+=Math.pow(2,52)),i*Math.pow(2,r-52)*n)}(e,t)},gf=hf,pf=function(e){return Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array};function ff(){$p=function(e,t,i){return Rh.utils.decode(1200,e.slice(t,i)).replace(Bh,"")},ef=function(e,t,i){return Rh.utils.decode(65001,e.slice(t,i))},rf=function(e,t){var i=wf(e,t);return i>0?Rh.utils.decode(mh,e.slice(t+4,t+4+i-1)):""},of=function(e,t){var i=wf(e,t);return i>0?Rh.utils.decode(fh,e.slice(t+4,t+4+i-1)):""},af=function(e,t){var i=2*wf(e,t);return i>0?Rh.utils.decode(1200,e.slice(t+4,t+4+i-1)):""},cf=function(e,t){var i=wf(e,t);return i>0?Rh.utils.decode(1200,e.slice(t+4,t+4+i)):""},df=function(e,t){var i=wf(e,t);return i>0?Rh.utils.decode(65001,e.slice(t+4,t+4+i)):""}}Dh&&(rf=function(e,t){if(!Buffer.isBuffer(e))return tf(e,t);var i=e.readUInt32LE(t);return i>0?e.toString("utf8",t+4,t+4+i-1):""},of=function(e,t){if(!Buffer.isBuffer(e))return nf(e,t);var i=e.readUInt32LE(t);return i>0?e.toString("utf8",t+4,t+4+i-1):""},af=function(e,t){if(!Buffer.isBuffer(e))return sf(e,t);var i=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+i-1)},cf=function(e,t){if(!Buffer.isBuffer(e))return lf(e,t);var i=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+i)},df=function(e,t){if(!Buffer.isBuffer(e))return uf(e,t);var i=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+i)},gf=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):hf(e,t)},pf=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array}),"undefined"!==typeof Rh&&ff();var mf=function(e,t){return e[t]},vf=function(e,t){return 256*e[t+1]+e[t]},Cf=function(e,t){var i=256*e[t+1]+e[t];return i<32768?i:-1*(65535-i+1)},wf=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},bf=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Sf=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function yf(e,t){var i,r,n,o,s,a,l="",c=[];switch(t){case"dbcs":if(a=this.l,Dh&&Buffer.isBuffer(this))l=this.slice(this.l,this.l+2*e).toString("utf16le");else for(s=0;s<e;++s)l+=String.fromCharCode(vf(this,a)),a+=2;e*=2;break;case"utf8":l=ef(this,this.l,this.l+e);break;case"utf16le":e*=2,l=$p(this,this.l,this.l+e);break;case"wstr":if("undefined"===typeof Rh)return yf.call(this,e,"dbcs");l=Rh.utils.decode(fh,this.slice(this.l,this.l+2*e)),e*=2;break;case"lpstr-ansi":l=rf(this,this.l),e=4+wf(this,this.l);break;case"lpstr-cp":l=of(this,this.l),e=4+wf(this,this.l);break;case"lpwstr":l=af(this,this.l),e=4+2*wf(this,this.l);break;case"lpp4":e=4+wf(this,this.l),l=cf(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+wf(this,this.l),l=df(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,l="";0!==(n=mf(this,this.l+e++));)c.push(Eh(n));l=c.join("");break;case"_wstr":for(e=0,l="";0!==(n=vf(this,this.l+e));)c.push(Eh(n)),e+=2;e+=2,l=c.join("");break;case"dbcs-cont":for(l="",a=this.l,s=0;s<e;++s){if(this.lens&&-1!==this.lens.indexOf(a))return n=mf(this,a),this.l=a+1,o=yf.call(this,e-s,n?"dbcs-cont":"sbcs-cont"),c.join("")+o;c.push(Eh(vf(this,a))),a+=2}l=c.join(""),e*=2;break;case"cpstr":if("undefined"!==typeof Rh){l=Rh.utils.decode(fh,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(l="",a=this.l,s=0;s!=e;++s){if(this.lens&&-1!==this.lens.indexOf(a))return n=mf(this,a),this.l=a+1,o=yf.call(this,e-s,n?"dbcs-cont":"sbcs-cont"),c.join("")+o;c.push(Eh(mf(this,a))),a+=1}l=c.join("");break;default:switch(e){case 1:return i=mf(this,this.l),this.l++,i;case 2:return i=("i"===t?Cf:vf)(this,this.l),this.l+=2,i;case 4:case-4:return"i"===t||0===(128&this[this.l+3])?(i=(e>0?bf:Sf)(this,this.l),this.l+=4,i):(r=wf(this,this.l),this.l+=4,r);case 8:case-8:if("f"===t)return r=8==e?gf(this,this.l):gf([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,r;e=8;case 16:l=Jp(this,this.l,e)}}return this.l+=e,l}var Rf=function(e,t,i){e[i]=255&t,e[i+1]=t>>>8&255,e[i+2]=t>>>16&255,e[i+3]=t>>>24&255},Ef=function(e,t,i){e[i]=255&t,e[i+1]=t>>8&255,e[i+2]=t>>16&255,e[i+3]=t>>24&255},xf=function(e,t,i){e[i]=255&t,e[i+1]=t>>>8&255};function Tf(e,t,i){var r=0,n=0;if("dbcs"===i){for(n=0;n!=t.length;++n)xf(this,t.charCodeAt(n),this.l+2*n);r=2*t.length}else if("sbcs"===i){if("undefined"!==typeof Rh&&874==mh)for(n=0;n!=t.length;++n){var o=Rh.utils.encode(mh,t.charAt(n));this[this.l+n]=o[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=t.length;++n)this[this.l+n]=255&t.charCodeAt(n);r=t.length}else{if("hex"===i){for(;n<e;++n)this[this.l++]=parseInt(t.slice(2*n,2*n+2),16)||0;return this}if("utf16le"===i){var s=Math.min(this.l+e,this.length);for(n=0;n<Math.min(t.length,e);++n){var a=t.charCodeAt(n);this[this.l++]=255&a,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}switch(e){case 1:r=1,this[this.l]=255&t;break;case 2:r=2,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t;break;case 3:r=3,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t,t>>>=8,this[this.l+2]=255&t;break;case 4:r=4,Rf(this,t,this.l);break;case 8:if(r=8,"f"===i){!function(e,t,i){var r=(t<0||1/t==-1/0?1:0)<<7,n=0,o=0,s=r?-t:t;isFinite(s)?0==s?n=o=0:(n=Math.floor(Math.log(s)/Math.LN2),o=s*Math.pow(2,52-n),n<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?n=-1022:(o-=Math.pow(2,52),n+=1023)):(n=2047,o=isNaN(t)?26985:0);for(var a=0;a<=5;++a,o/=256)e[i+a]=255&o;e[i+6]=(15&n)<<4|15&o,e[i+7]=n>>4|r}(this,t,this.l);break}case 16:break;case-4:r=4,Ef(this,t,this.l)}}return this.l+=r,this}function Ff(e,t){var i=Jp(this,this.l,e.length>>1);if(i!==e)throw new Error(t+"Expected "+e+" saw "+i);this.l+=e.length>>1}function Pf(e,t){e.l=t,e.read_shift=yf,e.chk=Ff,e.write_shift=Tf}function Df(e,t){e.l+=t}function kf(e){var t=Ah(e);return Pf(t,0),t}function Af(){var e=[],t=Dh?256:2048,i=function(e){var t=kf(e);return Pf(t,0),t},r=i(t),n=function(){r&&(r.length>r.l&&((r=r.slice(0,r.l)).l=r.length),r.length>0&&e.push(r),r=null)},o=function(e){return r&&e<r.length-r.l?r:(n(),r=i(Math.max(e+1,t)))};return{next:o,push:function(e){n(),null==(r=e).l&&(r.l=r.length),o(t)},end:function(){return n(),Nh(e)},_bufs:e}}function Mf(e,t,i,r){var n,o=+t;if(!isNaN(o)){r||(r=Uw[o].p||(i||[]).length||0),n=1+(o>=128?1:0)+1,r>=128&&++n,r>=16384&&++n,r>=2097152&&++n;var s=e.next(n);o<=127?s.write_shift(1,o):(s.write_shift(1,128+(127&o)),s.write_shift(1,o>>7));for(var a=0;4!=a;++a){if(!(r>=128)){s.write_shift(1,r);break}s.write_shift(1,128+(127&r)),r>>=7}r>0&&pf(i)&&e.push(i)}}function If(e,t,i){var r=Xg(e);if(t.s?(r.cRel&&(r.c+=t.s.c),r.rRel&&(r.r+=t.s.r)):(r.cRel&&(r.c+=t.c),r.rRel&&(r.r+=t.r)),!i||i.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function Lf(e,t,i){var r=Xg(e);return r.s=If(r.s,t.s,i),r.e=If(r.e,t.s,i),r}function Of(e,t){if(e.cRel&&e.c<0)for(e=Xg(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Xg(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var i=_f(e);return e.cRel||null==e.cRel||(i=i.replace(/^([A-Z])/,"$$$1")),e.rRel||null==e.rRel||(i=function(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}(i)),i}function Nf(e,t){return 0!=e.s.r||e.s.rRel||e.e.r!=(t.biff>=12?1048575:t.biff>=8?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(t.biff>=12?16383:255)||e.e.cRel?Of(e.s,t.biff)+":"+Of(e.e,t.biff):(e.s.rRel?"":"$")+Gf(e.s.r)+":"+(e.e.rRel?"":"$")+Gf(e.e.r):(e.s.cRel?"":"$")+zf(e.s.c)+":"+(e.e.cRel?"":"$")+zf(e.e.c)}function Bf(e){return parseInt(e.replace(/\$(\d+)$/,"$1"),10)-1}function Gf(e){return""+(e+1)}function Hf(e){for(var t=e.replace(/^\$([A-Z])/,"$1"),i=0,r=0;r!==t.length;++r)i=26*i+t.charCodeAt(r)-64;return i-1}function zf(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function Vf(e){for(var t=0,i=0,r=0;r<e.length;++r){var n=e.charCodeAt(r);n>=48&&n<=57?t=10*t+(n-48):n>=65&&n<=90&&(i=26*i+(n-64))}return{c:i-1,r:t-1}}function _f(e){for(var t=e.c+1,i="";t;t=(t-1)/26|0)i=String.fromCharCode((t-1)%26+65)+i;return i+(e.r+1)}function Wf(e){var t=e.indexOf(":");return-1==t?{s:Vf(e),e:Vf(e)}:{s:Vf(e.slice(0,t)),e:Vf(e.slice(t+1))}}function Uf(e,t){return"undefined"===typeof t||"number"===typeof t?Uf(e.s,e.e):("string"!==typeof e&&(e=_f(e)),"string"!==typeof t&&(t=_f(t)),e==t?e:e+":"+t)}function jf(e){var t={s:{c:0,r:0},e:{c:0,r:0}},i=0,r=0,n=0,o=e.length;for(i=0;r<o&&!((n=e.charCodeAt(r)-64)<1||n>26);++r)i=26*i+n;for(t.s.c=--i,i=0;r<o&&!((n=e.charCodeAt(r)-48)<0||n>9);++r)i=10*i+n;if(t.s.r=--i,r===o||10!=n)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++r,i=0;r!=o&&!((n=e.charCodeAt(r)-64)<1||n>26);++r)i=26*i+n;for(t.e.c=--i,i=0;r!=o&&!((n=e.charCodeAt(r)-48)<0||n>9);++r)i=10*i+n;return t.e.r=--i,t}function Kf(e,t){var i="d"==e.t&&t instanceof Date;if(null!=e.z)try{return e.w=Tg(e.z,i?Vg(t):t)}catch(r){}try{return e.w=Tg((e.XF||{}).numFmtId||(i?14:0),i?Vg(t):t)}catch(r){return""+t}}function Yf(e,t,i){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&i&&i.dateNF&&(e.z=i.dateNF),"e"==e.t?Pm[e.v]||e.v:Kf(e,void 0==t?e.v:t))}function qf(e,t){var i=t&&t.sheet?t.sheet:"Sheet1",r={};return r[i]=e,{SheetNames:[i],Sheets:r}}function Qf(e,t,i){var r=i||{},n=e?Array.isArray(e):r.dense;var o=e||(n?[]:{}),s=0,a=0;if(o&&null!=r.origin){if("number"==typeof r.origin)s=r.origin;else{var l="string"==typeof r.origin?Vf(r.origin):r.origin;s=l.r,a=l.c}o["!ref"]||(o["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var u=jf(o["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),-1==s&&(c.e.r=s=u.e.r+1)}for(var d=0;d!=t.length;++d)if(t[d]){if(!Array.isArray(t[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[d].length;++h)if("undefined"!==typeof t[d][h]){var g={v:t[d][h]},p=s+d,f=a+h;if(c.s.r>p&&(c.s.r=p),c.s.c>f&&(c.s.c=f),c.e.r<p&&(c.e.r=p),c.e.c<f&&(c.e.c=f),!t[d][h]||"object"!==typeof t[d][h]||Array.isArray(t[d][h])||t[d][h]instanceof Date)if(Array.isArray(g.v)&&(g.f=t[d][h][1],g.v=g.v[0]),null===g.v)if(g.f)g.t="n";else if(r.nullError)g.t="e",g.v=0;else{if(!r.sheetStubs)continue;g.t="z"}else"number"===typeof g.v?g.t="n":"boolean"===typeof g.v?g.t="b":g.v instanceof Date?(g.z=r.dateNF||qh[14],r.cellDates?(g.t="d",g.w=Tg(g.z,Vg(g.v))):(g.t="n",g.v=Vg(g.v),g.w=Tg(g.z,g.v))):g.t="s";else g=t[d][h];if(n)o[p]||(o[p]=[]),o[p][f]&&o[p][f].z&&(g.z=o[p][f].z),o[p][f]=g;else{var m=_f({c:f,r:p});o[m]&&o[m].z&&(g.z=o[m].z),o[m]=g}}}return c.s.c<1e7&&(o["!ref"]=Uf(c)),o}function $f(e,t){return Qf(null,e,t)}function Xf(e,t){return t||(t=kf(4)),t.write_shift(4,e),t}function Jf(e){var t=e.read_shift(4);return 0===t?"":e.read_shift(t,"dbcs")}function Zf(e,t){var i=!1;return null==t&&(i=!0,t=kf(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),i?t.slice(0,t.l):t}function em(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function tm(e,t){var i=e.l,r=e.read_shift(1),n=Jf(e),o=[],s={t:n,h:n};if(0!==(1&r)){for(var a=e.read_shift(4),l=0;l!=a;++l)o.push(em(e));s.r=o}else s.r=[{ich:0,ifnt:0}];return e.l=i+t,s}var im=tm;function rm(e,t){var i=!1;return null==t&&(i=!0,t=kf(23+4*e.t.length)),t.write_shift(1,1),Zf(e.t,t),t.write_shift(4,1),function(e,t){t||(t=kf(4)),t.write_shift(2,e.ich||0),t.write_shift(2,e.ifnt||0)}({ich:0,ifnt:0},t),i?t.slice(0,t.l):t}function nm(e){var t=e.read_shift(4),i=e.read_shift(2);return i+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:i}}function om(e,t){return null==t&&(t=kf(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function sm(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function am(e,t){return null==t&&(t=kf(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var lm=Jf,cm=Zf;function um(e){var t=e.read_shift(4);return 0===t||4294967295===t?"":e.read_shift(t,"dbcs")}function dm(e,t){var i=!1;return null==t&&(i=!0,t=kf(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),i?t.slice(0,t.l):t}var hm=Jf,gm=um,pm=dm;function fm(e){var t=e.slice(e.l,e.l+4),i=1&t[0],r=2&t[0];e.l+=4;var n=0===r?gf([0,0,0,0,252&t[0],t[1],t[2],t[3]],0):bf(t,0)>>2;return i?n/100:n}function mm(e,t){null==t&&(t=kf(4));var i=0,r=0,n=100*e;if(e==(0|e)&&e>=-(1<<29)&&e<1<<29?r=1:n==(0|n)&&n>=-(1<<29)&&n<1<<29&&(r=1,i=1),!r)throw new Error("unsupported RkNumber "+e);t.write_shift(-4,((i?n:e)<<2)+(i+2))}function vm(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var Cm=vm,wm=function(e,t){return t||(t=kf(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t};function bm(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Sm(e,t){return(t||kf(8)).write_shift(8,e,"f")}function ym(e,t){if(t||(t=kf(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;null!=e.index?(t.write_shift(1,2),t.write_shift(1,e.index)):null!=e.theme?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var i=e.tint||0;if(i>0?i*=32767:i<0&&(i*=32768),t.write_shift(2,i),e.rgb&&null==e.theme){var r=e.rgb||"FFFFFF";"number"==typeof r&&(r=("000000"+r.toString(16)).slice(-6)),t.write_shift(1,parseInt(r.slice(0,2),16)),t.write_shift(1,parseInt(r.slice(2,4),16)),t.write_shift(1,parseInt(r.slice(4,6),16)),t.write_shift(1,255)}else t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);return t}var Rm=80,Em={1:{n:"CodePage",t:2},2:{n:"Category",t:Rm},3:{n:"PresentationFormat",t:Rm},4:{n:"ByteCount",t:3},5:{n:"LineCount",t:3},6:{n:"ParagraphCount",t:3},7:{n:"SlideCount",t:3},8:{n:"NoteCount",t:3},9:{n:"HiddenCount",t:3},10:{n:"MultimediaClipCount",t:3},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:Rm},15:{n:"Company",t:Rm},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:3},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:3,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:Rm},27:{n:"ContentStatus",t:Rm},28:{n:"Language",t:Rm},29:{n:"Version",t:Rm},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},xm={1:{n:"CodePage",t:2},2:{n:"Title",t:Rm},3:{n:"Subject",t:Rm},4:{n:"Author",t:Rm},5:{n:"Keywords",t:Rm},6:{n:"Comments",t:Rm},7:{n:"Template",t:Rm},8:{n:"LastAuthor",t:Rm},9:{n:"RevNumber",t:Rm},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:3},15:{n:"WordCount",t:3},16:{n:"CharCount",t:3},17:{n:"Thumbnail",t:71},18:{n:"Application",t:Rm},19:{n:"DocSecurity",t:3},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}};function Tm(e){return e.map((function(e){return[e>>16&255,e>>8&255,255&e]}))}var Fm=Xg(Tm([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),Pm={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Dm={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},km={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Am(e,t){var i,r=function(e){for(var t=[],i=Ng(e),r=0;r!==i.length;++r)null==t[e[i[r]]]&&(t[e[i[r]]]=[]),t[e[i[r]]].push(i[r]);return t}(Dm),n=[];n[n.length]=np,n[n.length]=Ep("Types",null,{xmlns:Dp,"xmlns:xsd":Gp,"xmlns:xsi":Bp}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map((function(e){return Ep("Default",null,{Extension:e[0],ContentType:e[1]})})));var o=function(r){e[r]&&e[r].length>0&&(i=e[r][0],n[n.length]=Ep("Override",null,{PartName:("/"==i[0]?"":"/")+i,ContentType:km[r][t.bookType]||km[r].xlsx}))},s=function(i){(e[i]||[]).forEach((function(e){n[n.length]=Ep("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:km[i][t.bookType]||km[i].xlsx})}))},a=function(t){(e[t]||[]).forEach((function(e){n[n.length]=Ep("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:r[t][0]})}))};return o("workbooks"),s("sheets"),s("charts"),a("themes"),["strs","styles"].forEach(o),["coreprops","extprops","custprops"].forEach(a),a("vba"),a("comments"),a("threadedcomments"),a("drawings"),s("metadata"),a("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Mm={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Im(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Lm(e){var t=[np,Ep("Relationships",null,{xmlns:kp})];return Ng(e["!id"]).forEach((function(i){t[t.length]=Ep("Relationship",null,e["!id"][i])})),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Om(e,t,i,r,n,o){if(n||(n={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,n.Id="rId"+t,n.Type=r,n.Target=i,o?n.TargetMode=o:[Mm.HLINK,Mm.XPATH,Mm.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),e["!id"][n.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][n.Id]=n,e[("/"+n.Target).replace("//","/")]=n,t}function Nm(e,t,i){return['  <rdf:Description rdf:about="'+e+'">\n','    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(i||"odf")+"#"+t+'"/>\n',"  </rdf:Description>\n"].join("")}function Bm(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+ph.version+"</meta:generator></office:meta></office:document-meta>"}var Gm=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Hm(e,t,i,r,n){null==n[e]&&null!=t&&""!==t&&(n[e]=t,t=cp(t),r[r.length]=i?Ep(e,t,i):yp(e,t))}function zm(e,t){var i=t||{},r=[np,Ep("cp:coreProperties",null,{"xmlns:cp":Tp,"xmlns:dc":Mp,"xmlns:dcterms":Ip,"xmlns:dcmitype":Lp,"xmlns:xsi":Bp})],n={};if(!e&&!i.Props)return r.join("");e&&(null!=e.CreatedDate&&Hm("dcterms:created","string"===typeof e.CreatedDate?e.CreatedDate:xp(e.CreatedDate,i.WTF),{"xsi:type":"dcterms:W3CDTF"},r,n),null!=e.ModifiedDate&&Hm("dcterms:modified","string"===typeof e.ModifiedDate?e.ModifiedDate:xp(e.ModifiedDate,i.WTF),{"xsi:type":"dcterms:W3CDTF"},r,n));for(var o=0;o!=Gm.length;++o){var s=Gm[o],a=i.Props&&null!=i.Props[s[1]]?i.Props[s[1]]:e?e[s[1]]:null;!0===a?a="1":!1===a?a="0":"number"==typeof a&&(a=String(a)),null!=a&&Hm(s[0],a,null,r,n)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var Vm=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],_m=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Wm(e){var t=[],i=Ep;return e||(e={}),e.Application="SheetJS",t[t.length]=np,t[t.length]=Ep("Properties",null,{xmlns:Pp,"xmlns:vt":Np}),Vm.forEach((function(r){if(void 0!==e[r[1]]){var n;switch(r[2]){case"string":n=cp(String(e[r[1]]));break;case"bool":n=e[r[1]]?"true":"false"}void 0!==n&&(t[t.length]=i(r[0],n))}})),t[t.length]=i("HeadingPairs",i("vt:vector",i("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+i("vt:variant",i("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=i("TitlesOfParts",i("vt:vector",e.SheetNames.map((function(e){return"<vt:lpstr>"+cp(e)+"</vt:lpstr>"})).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function Um(e){var t=[np,Ep("Properties",null,{xmlns:Fp,"xmlns:vt":Np})];if(!e)return t.join("");var i=1;return Ng(e).forEach((function(r){++i,t[t.length]=Ep("property",function(e,t){switch(typeof e){case"string":var i=Ep("vt:lpwstr",cp(e));return t&&(i=i.replace(/&quot;/g,"_x0022_")),i;case"number":return Ep((0|e)==e?"vt:i4":"vt:r8",cp(String(e)));case"boolean":return Ep("vt:bool",e?"true":"false")}if(e instanceof Date)return Ep("vt:filetime",xp(e));throw new Error("Unable to serialize "+e)}(e[r],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:i,name:cp(r)})})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var jm={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function Km(e,t){var i=kf(4),r=kf(4);switch(i.write_shift(4,80==e?31:e),e){case 3:r.write_shift(-4,t);break;case 5:(r=kf(8)).write_shift(8,t,"f");break;case 11:r.write_shift(4,t?1:0);break;case 64:r=function(e){var t=("string"==typeof e?new Date(Date.parse(e)):e).getTime()/1e3+11644473600,i=t%Math.pow(2,32),r=(t-i)/Math.pow(2,32);r*=1e7;var n=(i*=1e7)/Math.pow(2,32)|0;n>0&&(i%=Math.pow(2,32),r+=n);var o=kf(8);return o.write_shift(4,i),o.write_shift(4,r),o}(t);break;case 31:case 80:for((r=kf(4+2*(t.length+1)+(t.length%2?0:2))).write_shift(4,t.length+1),r.write_shift(0,t,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Nh([i,r])}var Ym=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function qm(e){switch(typeof e){case"boolean":return 11;case"number":return(0|e)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64}return-1}function Qm(e,t,i){var r=kf(8),n=[],o=[],s=8,a=0,l=kf(8),c=kf(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),o.push(l),n.push(c),s+=8+l.length,!t){(c=kf(8)).write_shift(4,0),n.unshift(c);var u=[kf(4)];for(u[0].write_shift(4,e.length),a=0;a<e.length;++a){var d=e[a][0];for((l=kf(8+2*(d.length+1)+(d.length%2?0:2))).write_shift(4,a+2),l.write_shift(4,d.length+1),l.write_shift(0,d,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=Nh(u),o.unshift(l),s+=8+l.length}for(a=0;a<e.length;++a)if((!t||t[e[a][0]])&&!(Ym.indexOf(e[a][0])>-1||_m.indexOf(e[a][0])>-1)&&null!=e[a][1]){var h=e[a][1],g=0;if(t){var p=i[g=+t[e[a][0]]];if("version"==p.p&&"string"==typeof h){var f=h.split(".");h=(+f[0]<<16)+(+f[1]||0)}l=Km(p.t,h)}else{var m=qm(h);-1==m&&(m=31,h=String(h)),l=Km(m,h)}o.push(l),(c=kf(8)).write_shift(4,t?g:2+a),n.push(c),s+=8+l.length}var v=8*(o.length+1);for(a=0;a<o.length;++a)n[a].write_shift(4,v),v+=o[a].length;return r.write_shift(4,s),r.write_shift(4,o.length),Nh([r].concat(n).concat(o))}function $m(e,t,i,r,n,o){var s=kf(n?68:48),a=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,Mg.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,n?2:1),s.write_shift(16,t,"hex"),s.write_shift(4,n?68:48);var l=Qm(e,i,r);if(a.push(l),n){var c=Qm(n,null,null);s.write_shift(16,o,"hex"),s.write_shift(4,68+l.length),a.push(c)}return Nh(a)}function Xm(e,t){return 1===e.read_shift(t)}function Jm(e,t){return t||(t=kf(2)),t.write_shift(2,+!!e),t}function Zm(e){return e.read_shift(2,"u")}function ev(e,t){return t||(t=kf(2)),t.write_shift(2,e),t}function tv(e,t,i){return i||(i=kf(2)),i.write_shift(1,"e"==t?+e:+!!e),i.write_shift(1,"e"==t?1:0),i}function iv(e,t,i){var r=e.read_shift(i&&i.biff>=12?2:1),n="sbcs-cont",o=fh;(i&&i.biff>=8&&(fh=1200),i&&8!=i.biff)?12==i.biff&&(n="wstr"):e.read_shift(1)&&(n="dbcs-cont");i.biff>=2&&i.biff<=5&&(n="cpstr");var s=r?e.read_shift(r,n):"";return fh=o,s}function rv(e){var t=e.t||"",i=kf(3);i.write_shift(2,t.length),i.write_shift(1,1);var r=kf(2*t.length);return r.write_shift(2*t.length,t,"utf16le"),Nh([i,r])}function nv(e,t,i){if(i){if(i.biff>=2&&i.biff<=5)return e.read_shift(t,"cpstr");if(i.biff>=12)return e.read_shift(t,"dbcs-cont")}return 0===e.read_shift(1)?e.read_shift(t,"sbcs-cont"):e.read_shift(t,"dbcs-cont")}function ov(e,t,i){var r=e.read_shift(i&&2==i.biff?1:2);return 0===r?(e.l++,""):nv(e,r,i)}function sv(e,t,i){if(i.biff>5)return ov(e,0,i);var r=e.read_shift(1);return 0===r?(e.l++,""):e.read_shift(r,i.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function av(e,t,i){return i||(i=kf(3+2*e.length)),i.write_shift(2,e.length),i.write_shift(1,1),i.write_shift(31,e,"utf16le"),i}function lv(e,t){t||(t=kf(6+2*e.length)),t.write_shift(4,1+e.length);for(var i=0;i<e.length;++i)t.write_shift(2,e.charCodeAt(i));return t.write_shift(2,0),t}function cv(e){var t=kf(512),i=0,r=e.Target;"file://"==r.slice(0,7)&&(r=r.slice(7));var n=r.indexOf("#"),o=n>-1?31:23;switch(r.charAt(0)){case"#":o=28;break;case".":o&=-3}t.write_shift(4,2),t.write_shift(4,o);var s=[8,6815827,6619237,4849780,83];for(i=0;i<s.length;++i)t.write_shift(4,s[i]);if(28==o)lv(r=r.slice(1),t);else if(2&o){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<s.length;++i)t.write_shift(1,parseInt(s[i],16));var a=n>-1?r.slice(0,n):r;for(t.write_shift(4,2*(a.length+1)),i=0;i<a.length;++i)t.write_shift(2,a.charCodeAt(i));t.write_shift(2,0),8&o&&lv(n>-1?r.slice(n+1):"",t)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),i=0;i<s.length;++i)t.write_shift(1,parseInt(s[i],16));for(var l=0;"../"==r.slice(3*l,3*l+3)||"..\\"==r.slice(3*l,3*l+3);)++l;for(t.write_shift(2,l),t.write_shift(4,r.length-3*l+1),i=0;i<r.length-3*l;++i)t.write_shift(1,255&r.charCodeAt(i+3*l));for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),i=0;i<6;++i)t.write_shift(4,0)}return t.slice(0,t.l)}function uv(e,t,i,r){return r||(r=kf(6)),r.write_shift(2,e),r.write_shift(2,t),r.write_shift(2,i||0),r}function dv(e,t,i){var r=i.biff>8?4:2;return[e.read_shift(r),e.read_shift(r,"i"),e.read_shift(r,"i")]}function hv(e){var t=e.read_shift(2),i=e.read_shift(2);return{s:{c:e.read_shift(2),r:t},e:{c:e.read_shift(2),r:i}}}function gv(e,t){return t||(t=kf(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function pv(e,t,i){var r=1536,n=16;switch(i.bookType){case"biff8":case"xla":break;case"biff5":r=1280,n=8;break;case"biff4":r=4,n=6;break;case"biff3":r=3,n=6;break;case"biff2":r=2,n=4;break;default:throw new Error("unsupported BIFF version")}var o=kf(n);return o.write_shift(2,r),o.write_shift(2,t),n>4&&o.write_shift(2,29282),n>6&&o.write_shift(2,1997),n>8&&(o.write_shift(2,49161),o.write_shift(2,1),o.write_shift(2,1798),o.write_shift(2,0)),o}function fv(e,t){var i=!t||t.biff>=8?2:1,r=kf(8+i*e.name.length);r.write_shift(4,e.pos),r.write_shift(1,e.hs||0),r.write_shift(1,e.dt),r.write_shift(1,e.name.length),t.biff>=8&&r.write_shift(1,1),r.write_shift(i*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var n=r.slice(0,r.l);return n.l=r.l,n}function mv(e,t,i,r){var n=i&&5==i.biff;r||(r=kf(n?3+t.length:5+2*t.length)),r.write_shift(2,e),r.write_shift(n?1:2,t.length),n||r.write_shift(1,1),r.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le");var o=r.length>r.l?r.slice(0,r.l):r;return null==o.l&&(o.l=o.length),o}function vv(e,t,i,r){var n=i&&5==i.biff;r||(r=kf(n?16:20)),r.write_shift(2,0),e.style?(r.write_shift(2,e.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,e.numFmtId||0),r.write_shift(2,t<<4));var o=0;return e.numFmtId>0&&n&&(o|=1024),r.write_shift(4,o),r.write_shift(4,0),n||r.write_shift(4,0),r.write_shift(2,0),r}function Cv(e,t,i){if(i.biff<8)return function(e,t,i){3==e[e.l+1]&&e[e.l]++;var r=iv(e,0,i);return 3==r.charCodeAt(0)?r.slice(1):r}(e,0,i);for(var r=[],n=e.l+t,o=e.read_shift(i.biff>8?4:2);0!==o--;)r.push(dv(e,i.biff,i));if(e.l!=n)throw new Error("Bad ExternSheet: "+e.l+" != "+n);return r}function wv(e){var t=kf(24),i=Vf(e[0]);t.write_shift(2,i.r),t.write_shift(2,i.r),t.write_shift(2,i.c),t.write_shift(2,i.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)t.write_shift(1,parseInt(r[n],16));return Nh([t,cv(e[1])])}function bv(e){var t=e[1].Tooltip,i=kf(10+2*(t.length+1));i.write_shift(2,2048);var r=Vf(e[0]);i.write_shift(2,r.r),i.write_shift(2,r.r),i.write_shift(2,r.c),i.write_shift(2,r.c);for(var n=0;n<t.length;++n)i.write_shift(2,t.charCodeAt(n));return i.write_shift(2,0),i}function Sv(e,t,i){if(!i.cellStyles)return Df(e,t);var r=i&&i.biff>=12?4:2,n=e.read_shift(r),o=e.read_shift(r),s=e.read_shift(r),a=e.read_shift(r),l=e.read_shift(2);2==r&&(e.l+=2);var c={s:n,e:o,w:s,ixfe:a,flags:l};return(i.biff>=5||!i.biff)&&(c.level=l>>8&7),c}var yv=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Gg({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function i(t,i){var r=i||{};r.dateNF||(r.dateNF="yyyymmdd");var n=$f(function(t,i){var r=[],n=Ah(1);switch(i.type){case"base64":n=Ih(Ph(t));break;case"binary":n=Ih(t);break;case"buffer":case"array":n=t}Pf(n,0);var o=n.read_shift(1),s=!!(136&o),a=!1,l=!1;switch(o){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:a=!0,s=!0;break;case 140:l=!0;break;default:throw new Error("DBF Unsupported Version: "+o.toString(16))}var c=0,u=521;2==o&&(c=n.read_shift(2)),n.l+=3,2!=o&&(c=n.read_shift(4)),c>1048576&&(c=1e6),2!=o&&(u=n.read_shift(2));var d=n.read_shift(2),h=i.codepage||1252;2!=o&&(n.l+=16,n.read_shift(1),0!==n[n.l]&&(h=e[n[n.l]]),n.l+=1,n.l+=2),l&&(n.l+=36);for(var g=[],p={},f=Math.min(n.length,2==o?521:u-10-(a?264:0)),m=l?32:11;n.l<f&&13!=n[n.l];)switch((p={}).name=Rh.utils.decode(h,n.slice(n.l,n.l+m)).replace(/[\u0000\r\n].*$/g,""),n.l+=m,p.type=String.fromCharCode(n.read_shift(1)),2==o||l||(p.offset=n.read_shift(4)),p.len=n.read_shift(1),2==o&&(p.offset=n.read_shift(2)),p.dec=n.read_shift(1),p.name.length&&g.push(p),2!=o&&(n.l+=l?13:14),p.type){case"B":a&&8==p.len||!i.WTF||console.log("Skipping "+p.name+":"+p.type);break;case"G":case"P":i.WTF&&console.log("Skipping "+p.name+":"+p.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+p.type)}if(13!==n[n.l]&&(n.l=u-1),13!==n.read_shift(1))throw new Error("DBF Terminator not found "+n.l+" "+n[n.l]);n.l=u;var v=0,C=0;for(r[0]=[],C=0;C!=g.length;++C)r[0][C]=g[C].name;for(;c-- >0;)if(42!==n[n.l])for(++n.l,r[++v]=[],C=0,C=0;C!=g.length;++C){var w=n.slice(n.l,n.l+g[C].len);n.l+=g[C].len,Pf(w,0);var b=Rh.utils.decode(h,w);switch(g[C].type){case"C":b.trim().length&&(r[v][C]=b.replace(/\s+$/,""));break;case"D":8===b.length?r[v][C]=new Date(+b.slice(0,4),+b.slice(4,6)-1,+b.slice(6,8)):r[v][C]=b;break;case"F":r[v][C]=parseFloat(b.trim());break;case"+":case"I":r[v][C]=l?2147483648^w.read_shift(-4,"i"):w.read_shift(4,"i");break;case"L":switch(b.trim().toUpperCase()){case"Y":case"T":r[v][C]=!0;break;case"N":case"F":r[v][C]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+b+"|")}break;case"M":if(!s)throw new Error("DBF Unexpected MEMO for type "+o.toString(16));r[v][C]="##MEMO##"+(l?parseInt(b.trim(),10):w.read_shift(4));break;case"N":(b=b.replace(/\u0000/g,"").trim())&&"."!=b&&(r[v][C]=+b||0);break;case"@":r[v][C]=new Date(w.read_shift(-8,"f")-621356832e5);break;case"T":r[v][C]=new Date(864e5*(w.read_shift(4)-2440588)+w.read_shift(4));break;case"Y":r[v][C]=w.read_shift(4,"i")/1e4+w.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":r[v][C]=-w.read_shift(-8,"f");break;case"B":if(a&&8==g[C].len){r[v][C]=w.read_shift(8,"f");break}case"G":case"P":w.l+=g[C].len;break;case"0":if("_NullFlags"===g[C].name)break;default:throw new Error("DBF Unsupported data type "+g[C].type)}}else n.l+=d;if(2!=o&&n.l<n.length&&26!=n[n.l++])throw new Error("DBF EOF Marker missing "+(n.l-1)+" of "+n.length+" "+n[n.l-1].toString(16));return i&&i.sheetRows&&(r=r.slice(0,i.sheetRows)),i.DBF=g,r}(t,r),r);return n["!cols"]=r.DBF.map((function(e){return{wch:e.len,DBF:e}})),delete r.DBF,n}var r={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function(e,t){try{return qf(i(e,t),t)}catch(r){if(t&&t.WTF)throw r}return{SheetNames:[],Sheets:{}}},to_sheet:i,from_sheet:function(e,i){var n=i||{};if(+n.codepage>=0&&bh(+n.codepage),"string"==n.type)throw new Error("Cannot write DBF to JS string");var o=Af(),s=Vb(e,{header:1,raw:!0,cellDates:!0}),a=s[0],l=s.slice(1),c=e["!cols"]||[],u=0,d=0,h=0,g=1;for(u=0;u<a.length;++u)if(((c[u]||{}).DBF||{}).name)a[u]=c[u].DBF.name,++h;else if(null!=a[u]){if(++h,"number"===typeof a[u]&&(a[u]=a[u].toString(10)),"string"!==typeof a[u])throw new Error("DBF Invalid column name "+a[u]+" |"+typeof a[u]+"|");if(a.indexOf(a[u])!==u)for(d=0;d<1024;++d)if(-1==a.indexOf(a[u]+"_"+d)){a[u]+="_"+d;break}}var p=jf(e["!ref"]),f=[],m=[],v=[];for(u=0;u<=p.e.c-p.s.c;++u){var C="",w="",b=0,S=[];for(d=0;d<l.length;++d)null!=l[d][u]&&S.push(l[d][u]);if(0!=S.length&&null!=a[u]){for(d=0;d<S.length;++d){switch(typeof S[d]){case"number":w="B";break;case"string":default:w="C";break;case"boolean":w="L";break;case"object":w=S[d]instanceof Date?"D":"C"}b=Math.max(b,String(S[d]).length),C=C&&C!=w?"C":w}b>250&&(b=250),"C"==(w=((c[u]||{}).DBF||{}).type)&&c[u].DBF.len>b&&(b=c[u].DBF.len),"B"==C&&"N"==w&&(C="N",v[u]=c[u].DBF.dec,b=c[u].DBF.len),m[u]="C"==C||"N"==w?b:r[C]||0,g+=m[u],f[u]=C}else f[u]="?"}var y=o.next(32);for(y.write_shift(4,318902576),y.write_shift(4,l.length),y.write_shift(2,296+32*h),y.write_shift(2,g),u=0;u<4;++u)y.write_shift(4,0);for(y.write_shift(4,(+t[mh]||3)<<8),u=0,d=0;u<a.length;++u)if(null!=a[u]){var R=o.next(32),E=(a[u].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);R.write_shift(1,E,"sbcs"),R.write_shift(1,"?"==f[u]?"C":f[u],"sbcs"),R.write_shift(4,d),R.write_shift(1,m[u]||r[f[u]]||0),R.write_shift(1,v[u]||0),R.write_shift(1,2),R.write_shift(4,0),R.write_shift(1,0),R.write_shift(4,0),R.write_shift(4,0),d+=m[u]||r[f[u]]||0}var x=o.next(264);for(x.write_shift(4,13),u=0;u<65;++u)x.write_shift(4,0);for(u=0;u<l.length;++u){var T=o.next(g);for(T.write_shift(1,0),d=0;d<a.length;++d)if(null!=a[d])switch(f[d]){case"L":T.write_shift(1,null==l[u][d]?63:l[u][d]?84:70);break;case"B":T.write_shift(8,l[u][d]||0,"f");break;case"N":var F="0";for("number"==typeof l[u][d]&&(F=l[u][d].toFixed(v[d]||0)),h=0;h<m[d]-F.length;++h)T.write_shift(1,32);T.write_shift(1,F,"sbcs");break;case"D":l[u][d]?(T.write_shift(4,("0000"+l[u][d].getFullYear()).slice(-4),"sbcs"),T.write_shift(2,("00"+(l[u][d].getMonth()+1)).slice(-2),"sbcs"),T.write_shift(2,("00"+l[u][d].getDate()).slice(-2),"sbcs")):T.write_shift(8,"00000000","sbcs");break;case"C":var P=String(null!=l[u][d]?l[u][d]:"").slice(0,m[d]);for(T.write_shift(1,P,"sbcs"),h=0;h<m[d]-P.length;++h)T.write_shift(1,32)}}return o.next(1).write_shift(1,26),o.end()}}}(),Rv=function(){var e={AA:"\xc0",BA:"\xc1",CA:"\xc2",DA:195,HA:"\xc4",JA:197,AE:"\xc8",BE:"\xc9",CE:"\xca",HE:"\xcb",AI:"\xcc",BI:"\xcd",CI:"\xce",HI:"\xcf",AO:"\xd2",BO:"\xd3",CO:"\xd4",DO:213,HO:"\xd6",AU:"\xd9",BU:"\xda",CU:"\xdb",HU:"\xdc",Aa:"\xe0",Ba:"\xe1",Ca:"\xe2",Da:227,Ha:"\xe4",Ja:229,Ae:"\xe8",Be:"\xe9",Ce:"\xea",He:"\xeb",Ai:"\xec",Bi:"\xed",Ci:"\xee",Hi:"\xef",Ao:"\xf2",Bo:"\xf3",Co:"\xf4",Do:245,Ho:"\xf6",Au:"\xf9",Bu:"\xfa",Cu:"\xfb",Hu:"\xfc",KC:"\xc7",Kc:"\xe7",q:"\xe6",z:"\u0153",a:"\xc6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1bN("+Ng(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),i=function(t,i){var r=e[i];return"number"==typeof r?xh(r):r},r=function(e,t,i){var r=t.charCodeAt(0)-32<<4|i.charCodeAt(0)-48;return 59==r?e:xh(r)};function n(e,n){var o,s=e.split(/[\n\r]+/),a=-1,l=-1,c=0,u=0,d=[],h=[],g=null,p={},f=[],m=[],v=[],C=0;for(+n.codepage>=0&&bh(+n.codepage);c!==s.length;++c){C=0;var w,b=s[c].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(t,i),S=b.replace(/;;/g,"\0").split(";").map((function(e){return e.replace(/\u0000/g,";")})),y=S[0];if(b.length>0)switch(y){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==S[1].charAt(0)&&h.push(b.slice(3).replace(/;;/g,";"));break;case"C":var R=!1,E=!1,x=!1,T=!1,F=-1,P=-1;for(u=1;u<S.length;++u)switch(S[u].charAt(0)){case"A":case"G":break;case"X":l=parseInt(S[u].slice(1))-1,E=!0;break;case"Y":for(a=parseInt(S[u].slice(1))-1,E||(l=0),o=d.length;o<=a;++o)d[o]=[];break;case"K":'"'===(w=S[u].slice(1)).charAt(0)?w=w.slice(1,w.length-1):"TRUE"===w?w=!0:"FALSE"===w?w=!1:isNaN(Zg(w))?isNaN(tp(w).getDate())||(w=Qg(w)):(w=Zg(w),null!==g&&yg(g)&&(w=jg(w))),"undefined"!==typeof Rh&&"string"==typeof w&&"string"!=(n||{}).type&&(n||{}).codepage&&(w=Rh.utils.decode(n.codepage,w)),R=!0;break;case"E":T=!0;var D=pC(S[u].slice(1),{r:a,c:l});d[a][l]=[d[a][l],D];break;case"S":x=!0,d[a][l]=[d[a][l],"S5S"];break;case"R":F=parseInt(S[u].slice(1))-1;break;case"C":P=parseInt(S[u].slice(1))-1;break;default:if(n&&n.WTF)throw new Error("SYLK bad record "+b)}if(R&&(d[a][l]&&2==d[a][l].length?d[a][l][0]=w:d[a][l]=w,g=null),x){if(T)throw new Error("SYLK shared formula cannot have own formula");var k=F>-1&&d[F][P];if(!k||!k[1])throw new Error("SYLK shared formula cannot find base");d[a][l][1]=vC(k[1],{r:a-F,c:l-P})}break;case"F":var A=0;for(u=1;u<S.length;++u)switch(S[u].charAt(0)){case"X":l=parseInt(S[u].slice(1))-1,++A;break;case"Y":for(a=parseInt(S[u].slice(1))-1,o=d.length;o<=a;++o)d[o]=[];break;case"M":C=parseInt(S[u].slice(1))/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":g=h[parseInt(S[u].slice(1))];break;case"W":for(v=S[u].slice(1).split(" "),o=parseInt(v[0],10);o<=parseInt(v[1],10);++o)C=parseInt(v[2],10),m[o-1]=0===C?{hidden:!0}:{wch:C},zv(m[o-1]);break;case"C":m[l=parseInt(S[u].slice(1))-1]||(m[l]={});break;case"R":f[a=parseInt(S[u].slice(1))-1]||(f[a]={}),C>0?(f[a].hpt=C,f[a].hpx=Wv(C)):0===C&&(f[a].hidden=!0);break;default:if(n&&n.WTF)throw new Error("SYLK bad record "+b)}A<1&&(g=null);break;default:if(n&&n.WTF)throw new Error("SYLK bad record "+b)}}return f.length>0&&(p["!rows"]=f),m.length>0&&(p["!cols"]=m),n&&n.sheetRows&&(d=d.slice(0,n.sheetRows)),[d,p]}function o(e,t){var i=function(e,t){switch(t.type){case"base64":return n(Ph(e),t);case"binary":return n(e,t);case"buffer":return n(Dh&&Buffer.isBuffer(e)?e.toString("binary"):Oh(e),t);case"array":return n($g(e),t)}throw new Error("Unrecognized type "+t.type)}(e,t),r=i[0],o=i[1],s=$f(r,t);return Ng(o).forEach((function(e){s[e]=o[e]})),s}function s(e,t,i,r){var n="C;Y"+(i+1)+";X"+(r+1)+";K";switch(e.t){case"n":n+=e.v||0,e.f&&!e.F&&(n+=";E"+mC(e.f,{r:i,c:r}));break;case"b":n+=e.v?"TRUE":"FALSE";break;case"e":n+=e.w||e.v;break;case"d":n+='"'+(e.w||e.v)+'"';break;case"s":n+='"'+e.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return n}return e["|"]=254,{to_workbook:function(e,t){return qf(o(e,t),t)},to_sheet:o,from_sheet:function(e,t){var i,r,n=["ID;PWXL;N;E"],o=[],a=jf(e["!ref"]),l=Array.isArray(e),c="\r\n";n.push("P;PGeneral"),n.push("F;P0;DG0G8;M255"),e["!cols"]&&(r=n,e["!cols"].forEach((function(e,t){var i="F;W"+(t+1)+" "+(t+1)+" ";e.hidden?i+="0":("number"!=typeof e.width||e.wpx||(e.wpx=Bv(e.width)),"number"!=typeof e.wpx||e.wch||(e.wch=Gv(e.wpx)),"number"==typeof e.wch&&(i+=Math.round(e.wch)))," "!=i.charAt(i.length-1)&&r.push(i)}))),e["!rows"]&&function(e,t){t.forEach((function(t,i){var r="F;";t.hidden?r+="M0;":t.hpt?r+="M"+20*t.hpt+";":t.hpx&&(r+="M"+20*_v(t.hpx)+";"),r.length>2&&e.push(r+"R"+(i+1))}))}(n,e["!rows"]),n.push("B;Y"+(a.e.r-a.s.r+1)+";X"+(a.e.c-a.s.c+1)+";D"+[a.s.c,a.s.r,a.e.c,a.e.r].join(" "));for(var u=a.s.r;u<=a.e.r;++u)for(var d=a.s.c;d<=a.e.c;++d){var h=_f({r:u,c:d});(i=l?(e[u]||[])[d]:e[h])&&(null!=i.v||i.f&&!i.F)&&o.push(s(i,0,u,d))}return n.join(c)+c+o.join(c)+c+"E"+c}}}(),Ev=function(){function e(e,t){for(var i=e.split("\n"),r=-1,n=-1,o=0,s=[];o!==i.length;++o)if("BOT"!==i[o].trim()){if(!(r<0)){for(var a=i[o].trim().split(","),l=a[0],c=a[1],u=i[++o]||"";1&(u.match(/["]/g)||[]).length&&o<i.length-1;)u+="\n"+i[++o];switch(u=u.trim(),+l){case-1:if("BOT"===u){s[++r]=[],n=0;continue}if("EOD"!==u)throw new Error("Unrecognized DIF special command "+u);break;case 0:"TRUE"===u?s[r][n]=!0:"FALSE"===u?s[r][n]=!1:isNaN(Zg(c))?isNaN(tp(c).getDate())?s[r][n]=c:s[r][n]=Qg(c):s[r][n]=Zg(c),++n;break;case 1:(u=(u=u.slice(1,u.length-1)).replace(/""/g,'"'))&&u.match(/^=".*"$/)&&(u=u.slice(2,-1)),s[r][n++]=""!==u?u:null}if("EOD"===u)break}}else s[++r]=[],n=0;return t&&t.sheetRows&&(s=s.slice(0,t.sheetRows)),s}function t(t,i){return $f(function(t,i){switch(i.type){case"base64":return e(Ph(t),i);case"binary":return e(t,i);case"buffer":return e(Dh&&Buffer.isBuffer(t)?t.toString("binary"):Oh(t),i);case"array":return e($g(t),i)}throw new Error("Unrecognized type "+i.type)}(t,i),i)}return{to_workbook:function(e,i){return qf(t(e,i),i)},to_sheet:t,from_sheet:function(){var e=function(e,t,i,r,n){e.push(t),e.push(i+","+r),e.push('"'+n.replace(/"/g,'""')+'"')},t=function(e,t,i,r){e.push(t+","+i),e.push(1==t?'"'+r.replace(/"/g,'""')+'"':r)};return function(i){var r,n=[],o=jf(i["!ref"]),s=Array.isArray(i);e(n,"TABLE",0,1,"sheetjs"),e(n,"VECTORS",0,o.e.r-o.s.r+1,""),e(n,"TUPLES",0,o.e.c-o.s.c+1,""),e(n,"DATA",0,0,"");for(var a=o.s.r;a<=o.e.r;++a){t(n,-1,0,"BOT");for(var l=o.s.c;l<=o.e.c;++l){var c=_f({r:a,c:l});if(r=s?(i[a]||[])[l]:i[c])switch(r.t){case"n":var u=r.w;u||null==r.v||(u=r.v),null==u?r.f&&!r.F?t(n,1,0,"="+r.f):t(n,1,0,""):t(n,0,u,"V");break;case"b":t(n,0,r.v?1:0,r.v?"TRUE":"FALSE");break;case"s":t(n,1,0,isNaN(r.v)?r.v:'="'+r.v+'"');break;case"d":r.w||(r.w=Tg(r.z||qh[14],Vg(Qg(r.v)))),t(n,0,r.w,"V");break;default:t(n,1,0,"")}else t(n,1,0,"")}}t(n,-1,0,"EOD");return n.join("\r\n")}}()}}(),xv=function(){function e(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(e,t){return $f(function(e,t){for(var i=e.split("\n"),r=-1,n=-1,o=0,s=[];o!==i.length;++o){var a=i[o].trim().split(":");if("cell"===a[0]){var l=Vf(a[1]);if(s.length<=l.r)for(r=s.length;r<=l.r;++r)s[r]||(s[r]=[]);switch(r=l.r,n=l.c,a[2]){case"t":s[r][n]=a[3].replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n");break;case"v":s[r][n]=+a[3];break;case"vtf":var c=a[a.length-1];case"vtc":"nl"===a[3]?s[r][n]=!!+a[4]:s[r][n]=+a[4],"vtf"==a[2]&&(s[r][n]=[s[r][n],c])}}}return t&&t.sheetRows&&(s=s.slice(0,t.sheetRows)),s}(e,t),t)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),r=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",n=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),o="--SocialCalcSpreadsheetControlSave--";function s(t){if(!t||!t["!ref"])return"";for(var i,r=[],n=[],o="",s=Wf(t["!ref"]),a=Array.isArray(t),l=s.s.r;l<=s.e.r;++l)for(var c=s.s.c;c<=s.e.c;++c)if(o=_f({r:l,c:c}),(i=a?(t[l]||[])[c]:t[o])&&null!=i.v&&"z"!==i.t){switch(n=["cell",o,"t"],i.t){case"s":case"str":n.push(e(i.v));break;case"n":i.f?(n[2]="vtf",n[3]="n",n[4]=i.v,n[5]=e(i.f)):(n[2]="v",n[3]=i.v);break;case"b":n[2]="vt"+(i.f?"f":"c"),n[3]="nl",n[4]=i.v?"1":"0",n[5]=e(i.f||(i.v?"TRUE":"FALSE"));break;case"d":var u=Vg(Qg(i.v));n[2]="vtc",n[3]="nd",n[4]=""+u,n[5]=i.w||Tg(i.z||qh[14],u);break;case"e":continue}r.push(n.join(":"))}return r.push("sheet:c:"+(s.e.c-s.s.c+1)+":r:"+(s.e.r-s.s.r+1)+":tvf:1"),r.push("valueformat:1:text-wiki"),r.join("\n")}return{to_workbook:function(e,i){return qf(t(e,i),i)},to_sheet:t,from_sheet:function(e){return[i,r,n,r,s(e),o].join("\n")}}}(),Tv=function(){function e(e,t,i,r,n){n.raw?t[i][r]=e:""===e||("TRUE"===e?t[i][r]=!0:"FALSE"===e?t[i][r]=!1:isNaN(Zg(e))?isNaN(tp(e).getDate())?t[i][r]=e:t[i][r]=Qg(e):t[i][r]=Zg(e))}var t={44:",",9:"\t",59:";",124:"|"},i={44:3,9:2,59:1,124:0};function r(e){for(var r={},n=!1,o=0,s=0;o<e.length;++o)34==(s=e.charCodeAt(o))?n=!n:!n&&s in t&&(r[s]=(r[s]||0)+1);for(o in s=[],r)Object.prototype.hasOwnProperty.call(r,o)&&s.push([r[o],o]);if(!s.length)for(o in r=i)Object.prototype.hasOwnProperty.call(r,o)&&s.push([r[o],o]);return s.sort((function(e,t){return e[0]-t[0]||i[e[1]]-i[t[1]]})),t[s.pop()[1]]||44}function n(e,t){var i=t||{},n="";var o=i.dense?[]:{},s={s:{c:0,r:0},e:{c:0,r:0}};"sep="==e.slice(0,4)?13==e.charCodeAt(5)&&10==e.charCodeAt(6)?(n=e.charAt(4),e=e.slice(7)):13==e.charCodeAt(5)||10==e.charCodeAt(5)?(n=e.charAt(4),e=e.slice(6)):n=r(e.slice(0,1024)):n=i&&i.FS?i.FS:r(e.slice(0,1024));var a=0,l=0,c=0,u=0,d=0,h=n.charCodeAt(0),g=!1,p=0,f=e.charCodeAt(0);e=e.replace(/\r\n/gm,"\n");var m=null!=i.dateNF?function(e){var t="number"==typeof e?qh[e]:e;return t=t.replace(kg,"(\\d+)"),new RegExp("^"+t+"$")}(i.dateNF):null;function v(){var t=e.slice(u,d),r={};if('"'==t.charAt(0)&&'"'==t.charAt(t.length-1)&&(t=t.slice(1,-1).replace(/""/g,'"')),0===t.length)r.t="z";else if(i.raw)r.t="s",r.v=t;else if(0===t.trim().length)r.t="s",r.v=t;else if(61==t.charCodeAt(0))34==t.charCodeAt(1)&&34==t.charCodeAt(t.length-1)?(r.t="s",r.v=t.slice(2,-1).replace(/""/g,'"')):1!=t.length?(r.t="n",r.f=t.slice(1)):(r.t="s",r.v=t);else if("TRUE"==t)r.t="b",r.v=!0;else if("FALSE"==t)r.t="b",r.v=!1;else if(isNaN(c=Zg(t)))if(!isNaN(tp(t).getDate())||m&&t.match(m)){r.z=i.dateNF||qh[14];var n=0;m&&t.match(m)&&(t=function(e,t,i){var r=-1,n=-1,o=-1,s=-1,a=-1,l=-1;(t.match(kg)||[]).forEach((function(e,t){var c=parseInt(i[t+1],10);switch(e.toLowerCase().charAt(0)){case"y":r=c;break;case"d":o=c;break;case"h":s=c;break;case"s":l=c;break;case"m":s>=0?a=c:n=c}})),l>=0&&-1==a&&n>=0&&(a=n,n=-1);var c=(""+(r>=0?r:(new Date).getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);7==c.length&&(c="0"+c),8==c.length&&(c="20"+c);var u=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return-1==s&&-1==a&&-1==l?c:-1==r&&-1==n&&-1==o?u:c+"T"+u}(0,i.dateNF,t.match(m)||[]),n=1),i.cellDates?(r.t="d",r.v=Qg(t,n)):(r.t="n",r.v=Vg(Qg(t,n))),!1!==i.cellText&&(r.w=Tg(r.z,r.v instanceof Date?Vg(r.v):r.v)),i.cellNF||delete r.z}else r.t="s",r.v=t;else r.t="n",!1!==i.cellText&&(r.w=t),r.v=c;if("z"==r.t||(i.dense?(o[a]||(o[a]=[]),o[a][l]=r):o[_f({c:l,r:a})]=r),u=d+1,f=e.charCodeAt(u),s.e.c<l&&(s.e.c=l),s.e.r<a&&(s.e.r=a),p==h)++l;else if(l=0,++a,i.sheetRows&&i.sheetRows<=a)return!0}e:for(;d<e.length;++d)switch(p=e.charCodeAt(d)){case 34:34===f&&(g=!g);break;case h:case 10:case 13:if(!g&&v())break e}return d-u>0&&v(),o["!ref"]=Uf(s),o}function o(t,i){return i&&i.PRN?i.FS||"sep="==t.slice(0,4)||t.indexOf("\t")>=0||t.indexOf(",")>=0||t.indexOf(";")>=0?n(t,i):$f(function(t,i){var r=i||{},n=[];if(!t||0===t.length)return n;for(var o=t.split(/[\r\n]/),s=o.length-1;s>=0&&0===o[s].length;)--s;for(var a=10,l=0,c=0;c<=s;++c)-1==(l=o[c].indexOf(" "))?l=o[c].length:l++,a=Math.max(a,l);for(c=0;c<=s;++c){n[c]=[];var u=0;for(e(o[c].slice(0,a).trim(),n,c,u,r),u=1;u<=(o[c].length-a)/10+1;++u)e(o[c].slice(a+10*(u-1),a+10*u).trim(),n,c,u,r)}return r.sheetRows&&(n=n.slice(0,r.sheetRows)),n}(t,i),i):n(t,i)}function s(e,t){var i="",r="string"==t.type?[0,0,0,0]:Ib(e,t);switch(t.type){case"base64":i=Ph(e);break;case"binary":case"string":i=e;break;case"buffer":i=65001==t.codepage?e.toString("utf8"):t.codepage&&"undefined"!==typeof Rh?Rh.utils.decode(t.codepage,e):Dh&&Buffer.isBuffer(e)?e.toString("binary"):Oh(e);break;case"array":i=$g(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==r[0]&&187==r[1]&&191==r[2]?i=Cp(i.slice(3)):"string"!=t.type&&"buffer"!=t.type&&65001==t.codepage?i=Cp(i):"binary"==t.type&&"undefined"!==typeof Rh&&t.codepage&&(i=Rh.utils.decode(t.codepage,Rh.utils.encode(28591,i))),"socialcalc:version:"==i.slice(0,19)?xv.to_sheet("string"==t.type?i:Cp(i),t):o(i,t)}return{to_workbook:function(e,t){return qf(s(e,t),t)},to_sheet:s,from_sheet:function(e){for(var t,i=[],r=jf(e["!ref"]),n=Array.isArray(e),o=r.s.r;o<=r.e.r;++o){for(var s=[],a=r.s.c;a<=r.e.c;++a){var l=_f({r:o,c:a});if((t=n?(e[o]||[])[a]:e[l])&&null!=t.v){for(var c=(t.w||(Yf(t),t.w)||"").slice(0,10);c.length<10;)c+=" ";s.push(c+(0===a?" ":""))}else s.push("          ")}i.push(s.join(""))}return i.join("\n")}}}();var Fv=function(){function e(e,t,i){if(e){Pf(e,e.l||0);for(var r=i.Enum||v;e.l<e.length;){var n=e.read_shift(2),o=r[n]||r[65535],s=e.read_shift(2),a=e.l+s,l=o.f&&o.f(e,s,i);if(e.l=a,t(l,o,n))return}}}function t(t,i){if(!t)return t;var r=i||{};var n=r.dense?[]:{},o="Sheet1",s="",a=0,l={},c=[],u=[],d={s:{r:0,c:0},e:{r:0,c:0}},h=r.sheetRows||0;if(0==t[2]&&(8==t[3]||9==t[3])&&t.length>=16&&5==t[14]&&108===t[15])throw new Error("Unsupported Works 3 for Mac file");if(2==t[2])r.Enum=v,e(t,(function(e,t,i){switch(i){case 0:r.vers=e,e>=4096&&(r.qpro=!0);break;case 6:d=e;break;case 204:e&&(s=e);break;case 222:s=e;break;case 15:case 51:r.qpro||(e[1].v=e[1].v.slice(1));case 13:case 14:case 16:14==i&&112==(112&e[2])&&(15&e[2])>1&&(15&e[2])<15&&(e[1].z=r.dateNF||qh[14],r.cellDates&&(e[1].t="d",e[1].v=jg(e[1].v))),r.qpro&&e[3]>a&&(n["!ref"]=Uf(d),l[o]=n,c.push(o),n=r.dense?[]:{},d={s:{r:0,c:0},e:{r:0,c:0}},a=e[3],o=s||"Sheet"+(a+1),s="");var u=r.dense?(n[e[0].r]||[])[e[0].c]:n[_f(e[0])];if(u){u.t=e[1].t,u.v=e[1].v,null!=e[1].z&&(u.z=e[1].z),null!=e[1].f&&(u.f=e[1].f);break}r.dense?(n[e[0].r]||(n[e[0].r]=[]),n[e[0].r][e[0].c]=e[1]):n[_f(e[0])]=e[1]}}),r);else{if(26!=t[2]&&14!=t[2])throw new Error("Unrecognized LOTUS BOF "+t[2]);r.Enum=C,14==t[2]&&(r.qpro=!0,t.l=0),e(t,(function(e,t,i){switch(i){case 204:o=e;break;case 22:e[1].v=e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(e[3]>a&&(n["!ref"]=Uf(d),l[o]=n,c.push(o),n=r.dense?[]:{},d={s:{r:0,c:0},e:{r:0,c:0}},a=e[3],o="Sheet"+(a+1)),h>0&&e[0].r>=h)break;r.dense?(n[e[0].r]||(n[e[0].r]=[]),n[e[0].r][e[0].c]=e[1]):n[_f(e[0])]=e[1],d.e.c<e[0].c&&(d.e.c=e[0].c),d.e.r<e[0].r&&(d.e.r=e[0].r);break;case 27:e[14e3]&&(u[e[14e3][0]]=e[14e3][1]);break;case 1537:u[e[0]]=e[1],e[0]==a&&(o=e[1])}}),r)}if(n["!ref"]=Uf(d),l[s||o]=n,c.push(s||o),!u.length)return{SheetNames:c,Sheets:l};for(var g={},p=[],f=0;f<u.length;++f)l[c[f]]?(p.push(u[f]||c[f]),g[u[f]]=l[u[f]]||l[c[f]]):(p.push(u[f]),g[u[f]]={"!ref":"A1"});return{SheetNames:p,Sheets:g}}function i(e,t,i){var r=[{c:0,r:0},{t:"n",v:0},0,0];return i.qpro&&20768!=i.vers?(r[0].c=e.read_shift(1),r[3]=e.read_shift(1),r[0].r=e.read_shift(2),e.l+=2):(r[2]=e.read_shift(1),r[0].c=e.read_shift(2),r[0].r=e.read_shift(2)),r}function r(e,t,r){var n=e.l+t,o=i(e,0,r);if(o[1].t="s",20768==r.vers){e.l++;var s=e.read_shift(1);return o[1].v=e.read_shift(s,"utf8"),o}return r.qpro&&e.l++,o[1].v=e.read_shift(n-e.l,"cstr"),o}function n(e,t,i){var r=kf(7+i.length);r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(1,39);for(var n=0;n<r.length;++n){var o=i.charCodeAt(n);r.write_shift(1,o>=128?95:o)}return r.write_shift(1,0),r}function o(e,t,i){var r=kf(7);return r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(2,i,"i"),r}function s(e,t,i){var r=kf(13);return r.write_shift(1,255),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(8,i,"f"),r}function a(e,t,i){var r=32768&t;return t=(r?e:0)+((t&=-32769)>=8192?t-16384:t),(r?"":"$")+(i?zf(t):Gf(t))}var l={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},c=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function u(e){var t=[{c:0,r:0},{t:"n",v:0},0];return t[0].r=e.read_shift(2),t[3]=e[e.l++],t[0].c=e[e.l++],t}function d(e,t,i,r){var n=kf(6+r.length);n.write_shift(2,e),n.write_shift(1,i),n.write_shift(1,t),n.write_shift(1,39);for(var o=0;o<r.length;++o){var s=r.charCodeAt(o);n.write_shift(1,s>=128?95:s)}return n.write_shift(1,0),n}function h(e,t){var i=u(e),r=e.read_shift(4),n=e.read_shift(4),o=e.read_shift(2);if(65535==o)return 0===r&&3221225472===n?(i[1].t="e",i[1].v=15):0===r&&3489660928===n?(i[1].t="e",i[1].v=42):i[1].v=0,i;var s=32768&o;return o=(32767&o)-16446,i[1].v=(1-2*s)*(n*Math.pow(2,o+32)+r*Math.pow(2,o)),i}function g(e,t,i,r){var n=kf(14);if(n.write_shift(2,e),n.write_shift(1,i),n.write_shift(1,t),0==r)return n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,65535),n;var o,s=0,a=0,l=0;return r<0&&(s=1,r=-r),a=0|Math.log2(r),0==(2147483648&(l=(r/=Math.pow(2,a-31))>>>0))&&(++a,l=(r/=2)>>>0),r-=l,l|=2147483648,l>>>=0,o=(r*=Math.pow(2,32))>>>0,n.write_shift(4,o),n.write_shift(4,l),a+=16383+(s?32768:0),n.write_shift(2,a),n}function p(e,t){var i=u(e),r=e.read_shift(8,"f");return i[1].v=r,i}function f(e,t){return 0==e[e.l+t-1]?e.read_shift(t,"cstr"):""}function m(e,t){var i=kf(5+e.length);i.write_shift(2,14e3),i.write_shift(2,t);for(var r=0;r<e.length;++r){var n=e.charCodeAt(r);i[i.l++]=n>127?95:n}return i[i.l++]=0,i}var v={0:{n:"BOF",f:Zm},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(e,t,i){var r={s:{c:0,r:0},e:{c:0,r:0}};return 8==t&&i.qpro?(r.s.c=e.read_shift(1),e.l++,r.s.r=e.read_shift(2),r.e.c=e.read_shift(1),e.l++,r.e.r=e.read_shift(2),r):(r.s.c=e.read_shift(2),r.s.r=e.read_shift(2),12==t&&i.qpro&&(e.l+=2),r.e.c=e.read_shift(2),r.e.r=e.read_shift(2),12==t&&i.qpro&&(e.l+=2),65535==r.s.c&&(r.s.c=r.e.c=r.s.r=r.e.r=0),r)}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(e,t,r){var n=i(e,0,r);return n[1].v=e.read_shift(2,"i"),n}},14:{n:"NUMBER",f:function(e,t,r){var n=i(e,0,r);return n[1].v=e.read_shift(8,"f"),n}},15:{n:"LABEL",f:r},16:{n:"FORMULA",f:function(e,t,r){var n=e.l+t,o=i(e,0,r);if(o[1].v=e.read_shift(8,"f"),r.qpro)e.l=n;else{var s=e.read_shift(2);!function(e,t){Pf(e,0);var i=[],r=0,n="",o="",s="",u="";for(;e.l<e.length;){var d=e[e.l++];switch(d){case 0:i.push(e.read_shift(8,"f"));break;case 1:o=a(t[0].c,e.read_shift(2),!0),n=a(t[0].r,e.read_shift(2),!1),i.push(o+n);break;case 2:var h=a(t[0].c,e.read_shift(2),!0),g=a(t[0].r,e.read_shift(2),!1);o=a(t[0].c,e.read_shift(2),!0),n=a(t[0].r,e.read_shift(2),!1),i.push(h+g+":"+o+n);break;case 3:if(e.l<e.length)return void console.error("WK1 premature formula end");break;case 4:i.push("("+i.pop()+")");break;case 5:i.push(e.read_shift(2));break;case 6:for(var p="";d=e[e.l++];)p+=String.fromCharCode(d);i.push('"'+p.replace(/"/g,'""')+'"');break;case 8:i.push("-"+i.pop());break;case 23:i.push("+"+i.pop());break;case 22:i.push("NOT("+i.pop()+")");break;case 20:case 21:u=i.pop(),s=i.pop(),i.push(["AND","OR"][d-20]+"("+s+","+u+")");break;default:if(d<32&&c[d])u=i.pop(),s=i.pop(),i.push(s+c[d]+u);else{if(!l[d])return d<=7?console.error("WK1 invalid opcode "+d.toString(16)):d<=24?console.error("WK1 unsupported op "+d.toString(16)):d<=30?console.error("WK1 invalid opcode "+d.toString(16)):d<=115?console.error("WK1 unsupported function opcode "+d.toString(16)):console.error("WK1 unrecognized opcode "+d.toString(16));if(69==(r=l[d][1])&&(r=e[e.l++]),r>i.length)return void console.error("WK1 bad formula parse 0x"+d.toString(16)+":|"+i.join("|")+"|");var f=i.slice(-r);i.length-=r,i.push(l[d][0]+"("+f.join(",")+")")}}}1==i.length?t[1].f=""+i[0]:console.error("WK1 bad formula parse |"+i.join("|")+"|")}(e.slice(e.l,e.l+s),o),e.l+=s}return o}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:r},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:f},222:{n:"SHEETNAMELP",f:function(e,t){var i=e[e.l++];i>t-1&&(i=t-1);for(var r="";r.length<i;)r+=String.fromCharCode(e[e.l++]);return r}},65535:{n:""}},C={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(e,t){var i=u(e);return i[1].t="s",i[1].v=e.read_shift(t-4,"cstr"),i}},23:{n:"NUMBER17",f:h},24:{n:"NUMBER18",f:function(e,t){var i=u(e);i[1].v=e.read_shift(2);var r=i[1].v>>1;if(1&i[1].v)switch(7&r){case 0:r=5e3*(r>>3);break;case 1:r=500*(r>>3);break;case 2:r=(r>>3)/20;break;case 3:r=(r>>3)/200;break;case 4:r=(r>>3)/2e3;break;case 5:r=(r>>3)/2e4;break;case 6:r=(r>>3)/16;break;case 7:r=(r>>3)/64}return i[1].v=r,i}},25:{n:"FORMULA19",f:function(e,t){var i=h(e);return e.l+=t-14,i}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(e,t){for(var i={},r=e.l+t;e.l<r;){var n=e.read_shift(2);if(14e3==n){for(i[n]=[0,""],i[n][0]=e.read_shift(2);e[e.l];)i[n][1]+=String.fromCharCode(e[e.l]),e.l++;e.l++}}return i}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(e,t){var i=u(e),r=e.read_shift(4);return i[1].v=r>>6,i}},38:{n:"??"},39:{n:"NUMBER27",f:p},40:{n:"FORMULA28",f:function(e,t){var i=p(e);return e.l+=t-10,i}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:f},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(e,t,i){if(i.qpro&&!(t<21)){var r=e.read_shift(1);return e.l+=17,e.l+=1,e.l+=2,[r,e.read_shift(t-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:function(e,t){var i=t||{};if(+i.codepage>=0&&bh(+i.codepage),"string"==i.type)throw new Error("Cannot write WK1 to JS string");var r=Af(),a=jf(e["!ref"]),l=Array.isArray(e),c=[];jw(r,0,function(e){var t=kf(2);return t.write_shift(2,e),t}(1030)),jw(r,6,function(e){var t=kf(8);return t.write_shift(2,e.s.c),t.write_shift(2,e.s.r),t.write_shift(2,e.e.c),t.write_shift(2,e.e.r),t}(a));for(var u=Math.min(a.e.r,8191),d=a.s.r;d<=u;++d)for(var h=Gf(d),g=a.s.c;g<=a.e.c;++g){d===a.s.r&&(c[g]=zf(g));var p=c[g]+h,f=l?(e[d]||[])[g]:e[p];if(f&&"z"!=f.t)if("n"==f.t)(0|f.v)==f.v&&f.v>=-32768&&f.v<=32767?jw(r,13,o(d,g,f.v)):jw(r,14,s(d,g,f.v));else jw(r,15,n(d,g,Yf(f).slice(0,239)))}return jw(r,1),r.end()},book_to_wk3:function(e,t){var i=t||{};if(+i.codepage>=0&&bh(+i.codepage),"string"==i.type)throw new Error("Cannot write WK3 to JS string");var r=Af();jw(r,0,function(e){var t=kf(26);t.write_shift(2,4096),t.write_shift(2,4),t.write_shift(4,0);for(var i=0,r=0,n=0,o=0;o<e.SheetNames.length;++o){var s=e.SheetNames[o],a=e.Sheets[s];if(a&&a["!ref"]){++n;var l=Wf(a["!ref"]);i<l.e.r&&(i=l.e.r),r<l.e.c&&(r=l.e.c)}}i>8191&&(i=8191);return t.write_shift(2,i),t.write_shift(1,n),t.write_shift(1,r),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,1),t.write_shift(1,2),t.write_shift(4,0),t.write_shift(4,0),t}(e));for(var n=0,o=0;n<e.SheetNames.length;++n)(e.Sheets[e.SheetNames[n]]||{})["!ref"]&&jw(r,27,m(e.SheetNames[n],o++));var s=0;for(n=0;n<e.SheetNames.length;++n){var a=e.Sheets[e.SheetNames[n]];if(a&&a["!ref"]){for(var l=jf(a["!ref"]),c=Array.isArray(a),u=[],h=Math.min(l.e.r,8191),p=l.s.r;p<=h;++p)for(var f=Gf(p),v=l.s.c;v<=l.e.c;++v){p===l.s.r&&(u[v]=zf(v));var C=u[v]+f,w=c?(a[p]||[])[v]:a[C];if(w&&"z"!=w.t)if("n"==w.t)jw(r,23,g(p,v,s,w.v));else jw(r,22,d(p,v,s,Yf(w).slice(0,239)))}++s}}return jw(r,1),r.end()},to_workbook:function(e,i){switch(i.type){case"base64":return t(Ih(Ph(e)),i);case"binary":return t(Ih(e),i);case"buffer":case"array":return t(e,i)}throw"Unsupported type "+i.type}}}();var Pv=/^\s|\s$|[\t\n\r]/;function Dv(e,t){if(!t.bookSST)return"";var i=[np];i[i.length]=Ep("sst",null,{xmlns:Hp[0],count:e.Count,uniqueCount:e.Unique});for(var r=0;r!=e.length;++r)if(null!=e[r]){var n=e[r],o="<si>";n.r?o+=n.r:(o+="<t",n.t||(n.t=""),n.t.match(Pv)&&(o+=' xml:space="preserve"'),o+=">"+cp(n.t)+"</t>"),o+="</si>",i[i.length]=o}return i.length>2&&(i[i.length]="</sst>",i[1]=i[1].replace("/>",">")),i.join("")}var kv=function(e,t){var i=!1;return null==t&&(i=!0,t=kf(15+4*e.t.length)),t.write_shift(1,0),Zf(e.t,t),i?t.slice(0,t.l):t};function Av(e){var t=Af();Mf(t,159,function(e,t){return t||(t=kf(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}(e));for(var i=0;i<e.length;++i)Mf(t,19,kv(e[i]));return Mf(t,160),t.end()}function Mv(e){if("undefined"!==typeof Rh)return Rh.utils.encode(mh,e);for(var t=[],i=e.split(""),r=0;r<i.length;++r)t[r]=i[r].charCodeAt(0);return t}function Iv(e){var t,i,r=0,n=Mv(e),o=n.length+1;for((t=Ah(o))[0]=n.length,i=1;i!=o;++i)t[i]=n[i-1];for(i=o-1;i>=0;--i)r=((0===(16384&r)?0:1)|r<<1&32767)^t[i];return 52811^r}var Lv=function(){function e(e,i){switch(i.type){case"base64":return t(Ph(e),i);case"binary":return t(e,i);case"buffer":return t(Dh&&Buffer.isBuffer(e)?e.toString("binary"):Oh(e),i);case"array":return t($g(e),i)}throw new Error("Unrecognized type "+i.type)}function t(e,t){var i=(t||{}).dense?[]:{},r=e.match(/\\trowd.*?\\row\b/g);if(!r.length)throw new Error("RTF missing table");var n={s:{c:0,r:0},e:{c:0,r:r.length-1}};return r.forEach((function(e,t){Array.isArray(i)&&(i[t]=[]);for(var r,o=/\\\w+\b/g,s=0,a=-1;r=o.exec(e);){if("\\cell"===r[0]){var l=e.slice(s,o.lastIndex-r[0].length);if(" "==l[0]&&(l=l.slice(1)),++a,l.length){var c={v:l,t:"s"};Array.isArray(i)?i[t][a]=c:i[_f({r:t,c:a})]=c}}s=o.lastIndex}a>n.e.c&&(n.e.c=a)})),i["!ref"]=Uf(n),i}return{to_workbook:function(t,i){return qf(e(t,i),i)},to_sheet:e,from_sheet:function(e){for(var t,i=["{\\rtf1\\ansi"],r=jf(e["!ref"]),n=Array.isArray(e),o=r.s.r;o<=r.e.r;++o){i.push("\\trowd\\trautofit1");for(var s=r.s.c;s<=r.e.c;++s)i.push("\\cellx"+(s+1));for(i.push("\\pard\\intbl"),s=r.s.c;s<=r.e.c;++s){var a=_f({r:o,c:s});(t=n?(e[o]||[])[s]:e[a])&&(null!=t.v||t.f&&!t.F)&&(i.push(" "+(t.w||(Yf(t),t.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}}}();function Ov(e){for(var t=0,i=1;3!=t;++t)i=256*i+(e[t]>255?255:e[t]<0?0:e[t]);return i.toString(16).toUpperCase().slice(1)}var Nv=6;function Bv(e){return Math.floor((e+Math.round(128/Nv)/256)*Nv)}function Gv(e){return Math.floor((e-5)/Nv*100+.5)/100}function Hv(e){return Math.round((e*Nv+5)/Nv*256)/256}function zv(e){e.width?(e.wpx=Bv(e.width),e.wch=Gv(e.wpx),e.MDW=Nv):e.wpx?(e.wch=Gv(e.wpx),e.width=Hv(e.wch),e.MDW=Nv):"number"==typeof e.wch&&(e.width=Hv(e.wch),e.wpx=Bv(e.width),e.MDW=Nv),e.customWidth&&delete e.customWidth}var Vv=96;function _v(e){return 96*e/Vv}function Wv(e){return e*Vv/96}function Uv(e,t){var i,r=[np,Ep("styleSheet",null,{xmlns:Hp[0],"xmlns:vt":Np})];return e.SSF&&null!=(i=function(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach((function(i){for(var r=i[0];r<=i[1];++r)null!=e[r]&&(t[t.length]=Ep("numFmt",null,{numFmtId:r,formatCode:cp(e[r])}))})),1===t.length?"":(t[t.length]="</numFmts>",t[0]=Ep("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(e.SSF))&&(r[r.length]=i),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(i=function(e){var t=[];return t[t.length]=Ep("cellXfs",null),e.forEach((function(e){t[t.length]=Ep("xf",null,e)})),t[t.length]="</cellXfs>",2===t.length?"":(t[0]=Ep("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(t.cellXfs))&&(r[r.length]=i),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function jv(e,t,i){i||(i=kf(6+4*t.length)),i.write_shift(2,e),Zf(t,i);var r=i.length>i.l?i.slice(0,i.l):i;return null==i.l&&(i.l=i.length),r}function Kv(e,t){t||(t=kf(153)),t.write_shift(2,20*e.sz),function(e,t){t||(t=kf(2));var i=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);t.write_shift(1,i),t.write_shift(1,0)}(e,t),t.write_shift(2,e.bold?700:400);var i=0;"superscript"==e.vertAlign?i=1:"subscript"==e.vertAlign&&(i=2),t.write_shift(2,i),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),ym(e.color,t);var r=0;return"major"==e.scheme&&(r=1),"minor"==e.scheme&&(r=2),t.write_shift(1,r),Zf(e.name,t),t.length>t.l?t.slice(0,t.l):t}var Yv,qv=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Qv=Df;function $v(e,t){t||(t=kf(84)),Yv||(Yv=Gg(qv));var i=Yv[e.patternType];null==i&&(i=40),t.write_shift(4,i);var r=0;if(40!=i)for(ym({auto:1},t),ym({auto:1},t);r<12;++r)t.write_shift(4,0);else{for(;r<4;++r)t.write_shift(4,0);for(;r<12;++r)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function Xv(e,t,i){i||(i=kf(16)),i.write_shift(2,t||0),i.write_shift(2,e.numFmtId||0),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(1,0),i.write_shift(1,0);return i.write_shift(1,0),i.write_shift(1,0),i.write_shift(1,0),i.write_shift(1,0),i}function Jv(e,t){return t||(t=kf(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var Zv=Df;function eC(e){var t;Mf(e,613,Xf(1)),Mf(e,46,(t||(t=kf(51)),t.write_shift(1,0),Jv(0,t),Jv(0,t),Jv(0,t),Jv(0,t),Jv(0,t),t.length>t.l?t.slice(0,t.l):t)),Mf(e,614)}function tC(e){var t,i;Mf(e,619,Xf(1)),Mf(e,48,(t={xfId:0,builtinId:0,name:"Normal"},i||(i=kf(52)),i.write_shift(4,t.xfId),i.write_shift(2,1),i.write_shift(1,+t.builtinId),i.write_shift(1,0),dm(t.name||"",i),i.length>i.l?i.slice(0,i.l):i)),Mf(e,620)}function iC(e){Mf(e,508,function(e,t,i){var r=kf(2052);return r.write_shift(4,e),dm(t,r),dm(i,r),r.length>r.l?r.slice(0,r.l):r}(0,"TableStyleMedium9","PivotStyleMedium4")),Mf(e,509)}function rC(e,t){var i=Af();return Mf(i,278),function(e,t){if(t){var i=0;[[5,8],[23,26],[41,44],[50,392]].forEach((function(e){for(var r=e[0];r<=e[1];++r)null!=t[r]&&++i})),0!=i&&(Mf(e,615,Xf(i)),[[5,8],[23,26],[41,44],[50,392]].forEach((function(i){for(var r=i[0];r<=i[1];++r)null!=t[r]&&Mf(e,44,jv(r,t[r]))})),Mf(e,616))}}(i,e.SSF),function(e){Mf(e,611,Xf(1)),Mf(e,43,Kv({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),Mf(e,612)}(i),function(e){Mf(e,603,Xf(2)),Mf(e,45,$v({patternType:"none"})),Mf(e,45,$v({patternType:"gray125"})),Mf(e,604)}(i),eC(i),function(e){Mf(e,626,Xf(1)),Mf(e,47,Xv({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),Mf(e,627)}(i),function(e,t){Mf(e,617,Xf(t.length)),t.forEach((function(t){Mf(e,47,Xv(t,0))})),Mf(e,618)}(i,t.cellXfs),tC(i),function(e){Mf(e,505,Xf(0)),Mf(e,506)}(i),iC(i),Mf(i,279),i.end()}function nC(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&"string"==typeof e.raw)return e.raw;var i=[np];return i[i.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',i[i.length]="<a:themeElements>",i[i.length]='<a:clrScheme name="Office">',i[i.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',i[i.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',i[i.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',i[i.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',i[i.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',i[i.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',i[i.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',i[i.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',i[i.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',i[i.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',i[i.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',i[i.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',i[i.length]="</a:clrScheme>",i[i.length]='<a:fontScheme name="Office">',i[i.length]="<a:majorFont>",i[i.length]='<a:latin typeface="Cambria"/>',i[i.length]='<a:ea typeface=""/>',i[i.length]='<a:cs typeface=""/>',i[i.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',i[i.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',i[i.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',i[i.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',i[i.length]='<a:font script="Arab" typeface="Times New Roman"/>',i[i.length]='<a:font script="Hebr" typeface="Times New Roman"/>',i[i.length]='<a:font script="Thai" typeface="Tahoma"/>',i[i.length]='<a:font script="Ethi" typeface="Nyala"/>',i[i.length]='<a:font script="Beng" typeface="Vrinda"/>',i[i.length]='<a:font script="Gujr" typeface="Shruti"/>',i[i.length]='<a:font script="Khmr" typeface="MoolBoran"/>',i[i.length]='<a:font script="Knda" typeface="Tunga"/>',i[i.length]='<a:font script="Guru" typeface="Raavi"/>',i[i.length]='<a:font script="Cans" typeface="Euphemia"/>',i[i.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',i[i.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',i[i.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',i[i.length]='<a:font script="Thaa" typeface="MV Boli"/>',i[i.length]='<a:font script="Deva" typeface="Mangal"/>',i[i.length]='<a:font script="Telu" typeface="Gautami"/>',i[i.length]='<a:font script="Taml" typeface="Latha"/>',i[i.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',i[i.length]='<a:font script="Orya" typeface="Kalinga"/>',i[i.length]='<a:font script="Mlym" typeface="Kartika"/>',i[i.length]='<a:font script="Laoo" typeface="DokChampa"/>',i[i.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',i[i.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',i[i.length]='<a:font script="Viet" typeface="Times New Roman"/>',i[i.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',i[i.length]='<a:font script="Geor" typeface="Sylfaen"/>',i[i.length]="</a:majorFont>",i[i.length]="<a:minorFont>",i[i.length]='<a:latin typeface="Calibri"/>',i[i.length]='<a:ea typeface=""/>',i[i.length]='<a:cs typeface=""/>',i[i.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',i[i.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',i[i.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',i[i.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',i[i.length]='<a:font script="Arab" typeface="Arial"/>',i[i.length]='<a:font script="Hebr" typeface="Arial"/>',i[i.length]='<a:font script="Thai" typeface="Tahoma"/>',i[i.length]='<a:font script="Ethi" typeface="Nyala"/>',i[i.length]='<a:font script="Beng" typeface="Vrinda"/>',i[i.length]='<a:font script="Gujr" typeface="Shruti"/>',i[i.length]='<a:font script="Khmr" typeface="DaunPenh"/>',i[i.length]='<a:font script="Knda" typeface="Tunga"/>',i[i.length]='<a:font script="Guru" typeface="Raavi"/>',i[i.length]='<a:font script="Cans" typeface="Euphemia"/>',i[i.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',i[i.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',i[i.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',i[i.length]='<a:font script="Thaa" typeface="MV Boli"/>',i[i.length]='<a:font script="Deva" typeface="Mangal"/>',i[i.length]='<a:font script="Telu" typeface="Gautami"/>',i[i.length]='<a:font script="Taml" typeface="Latha"/>',i[i.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',i[i.length]='<a:font script="Orya" typeface="Kalinga"/>',i[i.length]='<a:font script="Mlym" typeface="Kartika"/>',i[i.length]='<a:font script="Laoo" typeface="DokChampa"/>',i[i.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',i[i.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',i[i.length]='<a:font script="Viet" typeface="Arial"/>',i[i.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',i[i.length]='<a:font script="Geor" typeface="Sylfaen"/>',i[i.length]="</a:minorFont>",i[i.length]="</a:fontScheme>",i[i.length]='<a:fmtScheme name="Office">',i[i.length]="<a:fillStyleLst>",i[i.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',i[i.length]='<a:gradFill rotWithShape="1">',i[i.length]="<a:gsLst>",i[i.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',i[i.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',i[i.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',i[i.length]="</a:gsLst>",i[i.length]='<a:lin ang="16200000" scaled="1"/>',i[i.length]="</a:gradFill>",i[i.length]='<a:gradFill rotWithShape="1">',i[i.length]="<a:gsLst>",i[i.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',i[i.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',i[i.length]="</a:gsLst>",i[i.length]='<a:lin ang="16200000" scaled="0"/>',i[i.length]="</a:gradFill>",i[i.length]="</a:fillStyleLst>",i[i.length]="<a:lnStyleLst>",i[i.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',i[i.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',i[i.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',i[i.length]="</a:lnStyleLst>",i[i.length]="<a:effectStyleLst>",i[i.length]="<a:effectStyle>",i[i.length]="<a:effectLst>",i[i.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',i[i.length]="</a:effectLst>",i[i.length]="</a:effectStyle>",i[i.length]="<a:effectStyle>",i[i.length]="<a:effectLst>",i[i.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',i[i.length]="</a:effectLst>",i[i.length]="</a:effectStyle>",i[i.length]="<a:effectStyle>",i[i.length]="<a:effectLst>",i[i.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',i[i.length]="</a:effectLst>",i[i.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',i[i.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',i[i.length]="</a:effectStyle>",i[i.length]="</a:effectStyleLst>",i[i.length]="<a:bgFillStyleLst>",i[i.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',i[i.length]='<a:gradFill rotWithShape="1">',i[i.length]="<a:gsLst>",i[i.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',i[i.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',i[i.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',i[i.length]="</a:gsLst>",i[i.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',i[i.length]="</a:gradFill>",i[i.length]='<a:gradFill rotWithShape="1">',i[i.length]="<a:gsLst>",i[i.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',i[i.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',i[i.length]="</a:gsLst>",i[i.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',i[i.length]="</a:gradFill>",i[i.length]="</a:bgFillStyleLst>",i[i.length]="</a:fmtScheme>",i[i.length]="</a:themeElements>",i[i.length]="<a:objectDefaults>",i[i.length]="<a:spDef>",i[i.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',i[i.length]="</a:spDef>",i[i.length]="<a:lnDef>",i[i.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',i[i.length]="</a:lnDef>",i[i.length]="</a:objectDefaults>",i[i.length]="<a:extraClrSchemeLst/>",i[i.length]="</a:theme>",i.join("")}function oC(){var e=Af();return Mf(e,332),Mf(e,334,Xf(1)),Mf(e,335,function(e){var t=kf(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Zf(e.name,t),t.slice(0,t.l)}({name:"XLDAPR",version:12e4,flags:3496657072})),Mf(e,336),Mf(e,339,function(e,t){var i=kf(8+2*t.length);return i.write_shift(4,e),Zf(t,i),i.slice(0,i.l)}(1,"XLDAPR")),Mf(e,52),Mf(e,35,Xf(514)),Mf(e,4096,Xf(0)),Mf(e,4097,ev(1)),Mf(e,36),Mf(e,53),Mf(e,340),Mf(e,337,function(e,t){var i=kf(8);return i.write_shift(4,e),i.write_shift(4,t?1:0),i}(1,!0)),Mf(e,51,function(e){var t=kf(4+8*e.length);t.write_shift(4,e.length);for(var i=0;i<e.length;++i)t.write_shift(4,e[i][0]),t.write_shift(4,e[i][1]);return t}([[1,0]])),Mf(e,338),Mf(e,333),e.end()}function sC(){var e=[np];return e.push('<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">\n  <metadataTypes count="1">\n    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>\n  </metadataTypes>\n  <futureMetadata name="XLDAPR" count="1">\n    <bk>\n      <extLst>\n        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">\n          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>\n        </ext>\n      </extLst>\n    </bk>\n  </futureMetadata>\n  <cellMetadata count="1">\n    <bk>\n      <rc t="1" v="0"/>\n    </bk>\n  </cellMetadata>\n</metadata>'),e.join("")}var aC=1024;function lC(e,t){for(var i=[21600,21600],r=["m0,0l0",i[1],i[0],i[1],i[0],"0xe"].join(","),n=[Ep("xml",null,{"xmlns:v":jp,"xmlns:o":zp,"xmlns:x":Vp,"xmlns:mv":Up}).replace(/\/>/,">"),Ep("o:shapelayout",Ep("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Ep("v:shapetype",[Ep("v:stroke",null,{joinstyle:"miter"}),Ep("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:i.join(","),path:r})];aC<1e3*e;)aC+=1e3;return t.forEach((function(e){var t=Vf(e[0]),i={color2:"#BEFF82",type:"gradient"};"gradient"==i.type&&(i.angle="-180");var r="gradient"==i.type?Ep("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,o=Ep("v:fill",r,i);++aC,n=n.concat(["<v:shape"+Rp({id:"_x0000_s"+aC,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(e[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",o,Ep("v:shadow",null,{on:"t",obscured:"t"}),Ep("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",yp("x:Anchor",[t.c+1,0,t.r+1,0,t.c+3,20,t.r+5,20].join(",")),yp("x:AutoFill","False"),yp("x:Row",String(t.r)),yp("x:Column",String(t.c)),e[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])})),n.push("</xml>"),n.join("")}function cC(e){var t=[np,Ep("comments",null,{xmlns:Hp[0]})],i=[];return t.push("<authors>"),e.forEach((function(e){e[1].forEach((function(e){var r=cp(e.a);-1==i.indexOf(r)&&(i.push(r),t.push("<author>"+r+"</author>")),e.T&&e.ID&&-1==i.indexOf("tc="+e.ID)&&(i.push("tc="+e.ID),t.push("<author>tc="+e.ID+"</author>"))}))})),0==i.length&&(i.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach((function(e){var r=0,n=[];if(e[1][0]&&e[1][0].T&&e[1][0].ID?r=i.indexOf("tc="+e[1][0].ID):e[1].forEach((function(e){e.a&&(r=i.indexOf(cp(e.a))),n.push(e.t||"")})),t.push('<comment ref="'+e[0]+'" authorId="'+r+'"><text>'),n.length<=1)t.push(yp("t",cp(n[0]||"")));else{for(var o="Comment:\n    "+n[0]+"\n",s=1;s<n.length;++s)o+="Reply:\n    "+n[s]+"\n";t.push(yp("t",cp(o)))}t.push("</text></comment>")})),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function uC(e,t,i){var r=[np,Ep("ThreadedComments",null,{xmlns:Ap}).replace(/[\/]>/,">")];return e.forEach((function(e){var n="";(e[1]||[]).forEach((function(o,s){if(o.T){o.a&&-1==t.indexOf(o.a)&&t.push(o.a);var a={ref:e[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+i.tcid++).slice(-12)+"}"};0==s?n=a.id:a.parentId=n,o.ID=a.id,o.a&&(a.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),r.push(Ep("threadedComment",yp("text",o.t||""),a))}else delete o.ID}))})),r.push("</ThreadedComments>"),r.join("")}var dC=Jf;function hC(e){var t=Af(),i=[];return Mf(t,628),Mf(t,630),e.forEach((function(e){e[1].forEach((function(e){i.indexOf(e.a)>-1||(i.push(e.a.slice(0,54)),Mf(t,632,function(e){return Zf(e.slice(0,54))}(e.a)))}))})),Mf(t,631),Mf(t,633),e.forEach((function(e){e[1].forEach((function(r){r.iauthor=i.indexOf(r.a);var n={s:Vf(e[0]),e:Vf(e[0])};Mf(t,635,function(e,t){return null==t&&(t=kf(36)),t.write_shift(4,e[1].iauthor),wm(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}([n,r])),r.t&&r.t.length>0&&Mf(t,637,rm(r)),Mf(t,636),delete r.iauthor}))})),Mf(t,634),Mf(t,629),t.end()}var gC=["xlsb","xlsm","xlam","biff8","xla"];var pC=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function i(e,i,r,n){var o=!1,s=!1;0==r.length?s=!0:"["==r.charAt(0)&&(s=!0,r=r.slice(1,-1)),0==n.length?o=!0:"["==n.charAt(0)&&(o=!0,n=n.slice(1,-1));var a=r.length>0?0|parseInt(r,10):0,l=n.length>0?0|parseInt(n,10):0;return o?l+=t.c:--l,s?a+=t.r:--a,i+(o?"":"$")+zf(l)+(s?"":"$")+Gf(a)}return function(r,n){return t=n,r.replace(e,i)}}(),fC=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,mC=function(){return function(e,t){return e.replace(fC,(function(e,i,r,n,o,s){var a=Hf(n)-(r?0:t.c),l=Bf(s)-(o?0:t.r);return i+"R"+(0==l?"":o?l+1:"["+l+"]")+"C"+(0==a?"":r?a+1:"["+a+"]")}))}}();function vC(e,t){return e.replace(fC,(function(e,i,r,n,o,s){return i+("$"==r?r+n:zf(Hf(n)+t.c))+("$"==o?o+s:Gf(Bf(s)+t.r))}))}function CC(e){e.l+=1}function wC(e,t){var i=e.read_shift(1==t?1:2);return[16383&i,i>>14&1,i>>15&1]}function bC(e,t,i){var r=2;if(i){if(i.biff>=2&&i.biff<=5)return SC(e);12==i.biff&&(r=4)}var n=e.read_shift(r),o=e.read_shift(r),s=wC(e,2),a=wC(e,2);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:o,c:a[0],cRel:a[1],rRel:a[2]}}}function SC(e){var t=wC(e,2),i=wC(e,2),r=e.read_shift(1),n=e.read_shift(1);return{s:{r:t[0],c:r,cRel:t[1],rRel:t[2]},e:{r:i[0],c:n,cRel:i[1],rRel:i[2]}}}function yC(e,t,i){if(i&&i.biff>=2&&i.biff<=5)return function(e){var t=wC(e,2),i=e.read_shift(1);return{r:t[0],c:i,cRel:t[1],rRel:t[2]}}(e);var r=e.read_shift(i&&12==i.biff?4:2),n=wC(e,2);return{r:r,c:n[0],cRel:n[1],rRel:n[2]}}function RC(e){var t=e.read_shift(2),i=e.read_shift(2);return{r:t,c:255&i,fQuoted:!!(16384&i),cRel:i>>15,rRel:i>>15}}function EC(e){var t=1&e[e.l+1];return e.l+=4,[t,1]}function xC(e){return[e.read_shift(1),e.read_shift(1)]}function TC(e,t){var i=[e.read_shift(1)];if(12==t)switch(i[0]){case 2:i[0]=4;break;case 4:i[0]=16;break;case 0:i[0]=1;break;case 1:i[0]=2}switch(i[0]){case 4:i[1]=Xm(e,1)?"TRUE":"FALSE",12!=t&&(e.l+=7);break;case 37:case 16:i[1]=Pm[e[e.l]],e.l+=12==t?4:8;break;case 0:e.l+=8;break;case 1:i[1]=bm(e);break;case 2:i[1]=sv(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+i[0])}return i}function FC(e,t,i){for(var r=e.read_shift(12==i.biff?4:2),n=[],o=0;o!=r;++o)n.push((12==i.biff?Cm:hv)(e,8));return n}function PC(e,t,i){var r=0,n=0;12==i.biff?(r=e.read_shift(4),n=e.read_shift(4)):(n=1+e.read_shift(1),r=1+e.read_shift(2)),i.biff>=2&&i.biff<8&&(--r,0==--n&&(n=256));for(var o=0,s=[];o!=r&&(s[o]=[]);++o)for(var a=0;a!=n;++a)s[o][a]=TC(e,i.biff);return s}function DC(e,t,i){return e.l+=2,[RC(e)]}function kC(e){return e.l+=6,[]}function AC(e){return e.l+=2,[Zm(e),1&e.read_shift(2)]}var MC=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];var IC={1:{n:"PtgExp",f:function(e,t,i){return e.l++,i&&12==i.biff?[e.read_shift(4,"i"),0]:[e.read_shift(2),e.read_shift(i&&2==i.biff?1:2)]}},2:{n:"PtgTbl",f:Df},3:{n:"PtgAdd",f:CC},4:{n:"PtgSub",f:CC},5:{n:"PtgMul",f:CC},6:{n:"PtgDiv",f:CC},7:{n:"PtgPower",f:CC},8:{n:"PtgConcat",f:CC},9:{n:"PtgLt",f:CC},10:{n:"PtgLe",f:CC},11:{n:"PtgEq",f:CC},12:{n:"PtgGe",f:CC},13:{n:"PtgGt",f:CC},14:{n:"PtgNe",f:CC},15:{n:"PtgIsect",f:CC},16:{n:"PtgUnion",f:CC},17:{n:"PtgRange",f:CC},18:{n:"PtgUplus",f:CC},19:{n:"PtgUminus",f:CC},20:{n:"PtgPercent",f:CC},21:{n:"PtgParen",f:CC},22:{n:"PtgMissArg",f:CC},23:{n:"PtgStr",f:function(e,t,i){return e.l++,iv(e,0,i)}},26:{n:"PtgSheet",f:function(e,t,i){return e.l+=5,e.l+=2,e.l+=2==i.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(e,t,i){return e.l+=2==i.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(e){return e.l++,Pm[e.read_shift(1)]}},29:{n:"PtgBool",f:function(e){return e.l++,0!==e.read_shift(1)}},30:{n:"PtgInt",f:function(e){return e.l++,e.read_shift(2)}},31:{n:"PtgNum",f:function(e){return e.l++,bm(e)}},32:{n:"PtgArray",f:function(e,t,i){var r=(96&e[e.l++])>>5;return e.l+=2==i.biff?6:12==i.biff?14:7,[r]}},33:{n:"PtgFunc",f:function(e,t,i){var r=(96&e[e.l])>>5;e.l+=1;var n=e.read_shift(i&&i.biff<=3?1:2);return[JC[n],XC[n],r]}},34:{n:"PtgFuncVar",f:function(e,t,i){var r=e[e.l++],n=e.read_shift(1),o=i&&i.biff<=3?[88==r?-1:0,e.read_shift(1)]:function(e){return[e[e.l+1]>>7,32767&e.read_shift(2)]}(e);return[n,(0===o[0]?XC:$C)[o[1]]]}},35:{n:"PtgName",f:function(e,t,i){var r=e.read_shift(1)>>>5&3,n=!i||i.biff>=8?4:2,o=e.read_shift(n);switch(i.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[r,0,o]}},36:{n:"PtgRef",f:function(e,t,i){var r=(96&e[e.l])>>5;return e.l+=1,[r,yC(e,0,i)]}},37:{n:"PtgArea",f:function(e,t,i){return[(96&e[e.l++])>>5,bC(e,i.biff>=2&&i.biff,i)]}},38:{n:"PtgMemArea",f:function(e,t,i){var r=e.read_shift(1)>>>5&3;return e.l+=i&&2==i.biff?3:4,[r,e.read_shift(i&&2==i.biff?1:2)]}},39:{n:"PtgMemErr",f:Df},40:{n:"PtgMemNoMem",f:Df},41:{n:"PtgMemFunc",f:function(e,t,i){return[e.read_shift(1)>>>5&3,e.read_shift(i&&2==i.biff?1:2)]}},42:{n:"PtgRefErr",f:function(e,t,i){var r=e.read_shift(1)>>>5&3;return e.l+=4,i.biff<8&&e.l--,12==i.biff&&(e.l+=2),[r]}},43:{n:"PtgAreaErr",f:function(e,t,i){var r=(96&e[e.l++])>>5;return e.l+=i&&i.biff>8?12:i.biff<8?6:8,[r]}},44:{n:"PtgRefN",f:function(e,t,i){var r=(96&e[e.l])>>5;e.l+=1;var n=function(e,t,i){var r=i&&i.biff?i.biff:8;if(r>=2&&r<=5)return function(e){var t=e.read_shift(2),i=e.read_shift(1),r=(32768&t)>>15,n=(16384&t)>>14;return t&=16383,1==r&&t>=8192&&(t-=16384),1==n&&i>=128&&(i-=256),{r:t,c:i,cRel:n,rRel:r}}(e);var n=e.read_shift(r>=12?4:2),o=e.read_shift(2),s=(16384&o)>>14,a=(32768&o)>>15;if(o&=16383,1==a)for(;n>524287;)n-=1048576;if(1==s)for(;o>8191;)o-=16384;return{r:n,c:o,cRel:s,rRel:a}}(e,0,i);return[r,n]}},45:{n:"PtgAreaN",f:function(e,t,i){var r=(96&e[e.l++])>>5,n=function(e,t,i){if(i.biff<8)return SC(e);var r=e.read_shift(12==i.biff?4:2),n=e.read_shift(12==i.biff?4:2),o=wC(e,2),s=wC(e,2);return{s:{r:r,c:o[0],cRel:o[1],rRel:o[2]},e:{r:n,c:s[0],cRel:s[1],rRel:s[2]}}}(e,0,i);return[r,n]}},46:{n:"PtgMemAreaN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},57:{n:"PtgNameX",f:function(e,t,i){return 5==i.biff?function(e){var t=e.read_shift(1)>>>5&3,i=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[t,i,r]}(e):[e.read_shift(1)>>>5&3,e.read_shift(2),e.read_shift(4)]}},58:{n:"PtgRef3d",f:function(e,t,i){var r=(96&e[e.l])>>5;e.l+=1;var n=e.read_shift(2);return i&&5==i.biff&&(e.l+=12),[r,n,yC(e,0,i)]}},59:{n:"PtgArea3d",f:function(e,t,i){var r=(96&e[e.l++])>>5,n=e.read_shift(2,"i");if(i)switch(i.biff){case 5:e.l+=12;break;case 12:0}return[r,n,bC(e,0,i)]}},60:{n:"PtgRefErr3d",f:function(e,t,i){var r=(96&e[e.l++])>>5,n=e.read_shift(2),o=4;if(i)switch(i.biff){case 5:o=15;break;case 12:o=6}return e.l+=o,[r,n]}},61:{n:"PtgAreaErr3d",f:function(e,t,i){var r=(96&e[e.l++])>>5,n=e.read_shift(2),o=8;if(i)switch(i.biff){case 5:e.l+=12,o=6;break;case 12:o=12}return e.l+=o,[r,n]}},255:{}},LC={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},OC={1:{n:"PtgElfLel",f:AC},2:{n:"PtgElfRw",f:DC},3:{n:"PtgElfCol",f:DC},6:{n:"PtgElfRwV",f:DC},7:{n:"PtgElfColV",f:DC},10:{n:"PtgElfRadical",f:DC},11:{n:"PtgElfRadicalS",f:kC},13:{n:"PtgElfColS",f:kC},15:{n:"PtgElfColSV",f:kC},16:{n:"PtgElfRadicalLel",f:AC},25:{n:"PtgList",f:function(e){e.l+=2;var t=e.read_shift(2),i=e.read_shift(2),r=e.read_shift(4),n=e.read_shift(2),o=e.read_shift(2);return{ixti:t,coltype:3&i,rt:MC[i>>2&31],idx:r,c:n,C:o}}},29:{n:"PtgSxName",f:function(e){return e.l+=2,[e.read_shift(4)]}},255:{}},NC={0:{n:"PtgAttrNoop",f:function(e){return e.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(e,t,i){var r=255&e[e.l+1]?1:0;return e.l+=i&&2==i.biff?3:4,[r]}},2:{n:"PtgAttrIf",f:function(e,t,i){var r=255&e[e.l+1]?1:0;return e.l+=2,[r,e.read_shift(i&&2==i.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function(e,t,i){e.l+=2;for(var r=e.read_shift(i&&2==i.biff?1:2),n=[],o=0;o<=r;++o)n.push(e.read_shift(i&&2==i.biff?1:2));return n}},8:{n:"PtgAttrGoto",f:function(e,t,i){var r=255&e[e.l+1]?1:0;return e.l+=2,[r,e.read_shift(i&&2==i.biff?1:2)]}},16:{n:"PtgAttrSum",f:function(e,t,i){e.l+=i&&2==i.biff?3:4}},32:{n:"PtgAttrBaxcel",f:EC},33:{n:"PtgAttrBaxcel",f:EC},64:{n:"PtgAttrSpace",f:function(e){return e.read_shift(2),xC(e)}},65:{n:"PtgAttrSpaceSemi",f:function(e){return e.read_shift(2),xC(e)}},128:{n:"PtgAttrIfError",f:function(e){var t=255&e[e.l+1]?1:0;return e.l+=2,[t,e.read_shift(2)]}},255:{}};function BC(e,t,i,r){if(r.biff<8)return Df(e,t);for(var n=e.l+t,o=[],s=0;s!==i.length;++s)switch(i[s][0]){case"PtgArray":i[s][1]=PC(e,0,r),o.push(i[s][1]);break;case"PtgMemArea":i[s][2]=FC(e,i[s][1],r),o.push(i[s][2]);break;case"PtgExp":r&&12==r.biff&&(i[s][1][1]=e.read_shift(4),o.push(i[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+i[s][0]}return 0!==(t=n-e.l)&&o.push(Df(e,t)),o}function GC(e,t,i){for(var r,n,o=e.l+t,s=[];o!=e.l;)t=o-e.l,n=e[e.l],r=IC[n]||IC[LC[n]],24!==n&&25!==n||(r=(24===n?OC:NC)[e[e.l+1]]),r&&r.f?s.push([r.n,r.f(e,t,i)]):Df(e,t);return s}function HC(e){for(var t=[],i=0;i<e.length;++i){for(var r=e[i],n=[],o=0;o<r.length;++o){var s=r[o];if(s)if(2===s[0])n.push('"'+s[1].replace(/"/g,'""')+'"');else n.push(s[1]);else n.push("")}t.push(n.join(","))}return t.join(";")}var zC={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function VC(e,t,i){if(!e)return"SH33TJSERR0";if(i.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[t];if(i.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),0==t?"":e.XTI[t-1];if(!r)return"SH33TJSERR1";var n="";if(i.biff>8)switch(e[r[0]][0]){case 357:return n=-1==r[1]?"#REF":e.SheetNames[r[1]],r[1]==r[2]?n:n+":"+e.SheetNames[r[2]];case 358:return null!=i.SID?e.SheetNames[i.SID]:"SH33TJSSAME"+e[r[0]][0];default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return n=-1==r[1]?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?n:n+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map((function(e){return e.Name})).join(";;");default:return e[r[0]][0][3]?(n=-1==r[1]?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?n:n+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function _C(e,t,i){var r=VC(e,t,i);return"#REF"==r?r:function(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}(r,i)}function WC(e,t,i,r,n){var o,s,a,l,c=n&&n.biff||8,u={s:{c:0,r:0},e:{c:0,r:0}},d=[],h=0,g=0,p="";if(!e[0]||!e[0][0])return"";for(var f=-1,m="",v=0,C=e[0].length;v<C;++v){var w=e[0][v];switch(w[0]){case"PtgUminus":d.push("-"+d.pop());break;case"PtgUplus":d.push("+"+d.pop());break;case"PtgPercent":d.push(d.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(o=d.pop(),s=d.pop(),f>=0){switch(e[0][f][1][0]){case 0:m=Jg(" ",e[0][f][1][1]);break;case 1:m=Jg("\r",e[0][f][1][1]);break;default:if(m="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][f][1][0])}s+=m,f=-1}d.push(s+zC[w[0]]+o);break;case"PtgIsect":o=d.pop(),s=d.pop(),d.push(s+" "+o);break;case"PtgUnion":o=d.pop(),s=d.pop(),d.push(s+","+o);break;case"PtgRange":o=d.pop(),s=d.pop(),d.push(s+":"+o);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":a=If(w[1][1],u,n),d.push(Of(a,c));break;case"PtgRefN":a=i?If(w[1][1],i,n):w[1][1],d.push(Of(a,c));break;case"PtgRef3d":h=w[1][1],a=If(w[1][2],u,n);p=_C(r,h,n);d.push(p+"!"+Of(a,c));break;case"PtgFunc":case"PtgFuncVar":var b=w[1][0],S=w[1][1];b||(b=0);var y=0==(b&=127)?[]:d.slice(-b);d.length-=b,"User"===S&&(S=y.shift()),d.push(S+"("+y.join(",")+")");break;case"PtgBool":d.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":d.push(w[1]);break;case"PtgNum":d.push(String(w[1]));break;case"PtgStr":d.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":l=Lf(w[1][1],i?{s:i}:u,n),d.push(Nf(l,n));break;case"PtgArea":l=Lf(w[1][1],u,n),d.push(Nf(l,n));break;case"PtgArea3d":h=w[1][1],l=w[1][2],p=_C(r,h,n),d.push(p+"!"+Nf(l,n));break;case"PtgAttrSum":d.push("SUM("+d.pop()+")");break;case"PtgName":g=w[1][2];var R=(r.names||[])[g-1]||(r[0]||[])[g],E=R?R.Name:"SH33TJSNAME"+String(g);E&&"_xlfn."==E.slice(0,6)&&!n.xlfn&&(E=E.slice(6)),d.push(E);break;case"PtgNameX":var x,T=w[1][1];if(g=w[1][2],!(n.biff<=5)){var F="";if(14849==((r[T]||[])[0]||[])[0]||(1025==((r[T]||[])[0]||[])[0]?r[T][g]&&r[T][g].itab>0&&(F=r.SheetNames[r[T][g].itab-1]+"!"):F=r.SheetNames[g-1]+"!"),r[T]&&r[T][g])F+=r[T][g].Name;else if(r[0]&&r[0][g])F+=r[0][g].Name;else{var P=(VC(r,T,n)||"").split(";;");P[g-1]?F=P[g-1]:F+="SH33TJSERRX"}d.push(F);break}T<0&&(T=-T),r[T]&&(x=r[T][g]),x||(x={Name:"SH33TJSERRY"}),d.push(x.Name);break;case"PtgParen":var D="(",k=")";if(f>=0){switch(m="",e[0][f][1][0]){case 2:D=Jg(" ",e[0][f][1][1])+D;break;case 3:D=Jg("\r",e[0][f][1][1])+D;break;case 4:k=Jg(" ",e[0][f][1][1])+k;break;case 5:k=Jg("\r",e[0][f][1][1])+k;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][f][1][0])}f=-1}d.push(D+d.pop()+k);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":d.push("#REF!");break;case"PtgExp":a={c:w[1][1],r:w[1][0]};var A={c:i.c,r:i.r};if(r.sharedf[_f(a)]){var M=r.sharedf[_f(a)];d.push(WC(M,u,A,r,n))}else{var I=!1;for(o=0;o!=r.arrayf.length;++o)if(s=r.arrayf[o],!(a.c<s[0].s.c||a.c>s[0].e.c)&&!(a.r<s[0].s.r||a.r>s[0].e.r)){d.push(WC(s[1],u,A,r,n)),I=!0;break}I||d.push(w[1])}break;case"PtgArray":d.push("{"+HC(w[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":f=v;break;case"PtgMissArg":d.push("");break;case"PtgList":d.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(w))}if(3!=n.biff&&f>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(e[0][v][0])){var L=!0;switch((w=e[0][f])[1][0]){case 4:L=!1;case 0:m=Jg(" ",w[1][1]);break;case 5:L=!1;case 1:m=Jg("\r",w[1][1]);break;default:if(m="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}d.push((L?m:"")+d.pop()+(L?"":m)),f=-1}}if(d.length>1&&n.WTF)throw new Error("bad formula stack");return d[0]}function UC(e,t,i,r,n){var o=uv(t,i,n),s=function(e){if(null==e){var t=kf(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}return Sm("number"==typeof e?e:0)}(e.v),a=kf(6);a.write_shift(2,33),a.write_shift(4,0);for(var l=kf(e.bf.length),c=0;c<e.bf.length;++c)l[c]=e.bf[c];return Nh([o,s,a,l])}function jC(e,t,i){var r=e.read_shift(4),n=GC(e,r,i),o=e.read_shift(4);return[n,o>0?BC(e,o,n,i):null]}var KC=jC,YC=jC,qC=jC,QC=jC,$C={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},XC={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},JC={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};var ZC="undefined"!==typeof Map;function ew(e,t,i){var r=0,n=e.length;if(i){if(ZC?i.has(t):Object.prototype.hasOwnProperty.call(i,t))for(var o=ZC?i.get(t):i[t];r<o.length;++r)if(e[o[r]].t===t)return e.Count++,o[r]}else for(;r<n;++r)if(e[r].t===t)return e.Count++,r;return e[n]={t:t},e.Count++,e.Unique++,i&&(ZC?(i.has(t)||i.set(t,[]),i.get(t).push(n)):(Object.prototype.hasOwnProperty.call(i,t)||(i[t]=[]),i[t].push(n))),n}function tw(e,t){var i={min:e+1,max:e+1},r=-1;return t.MDW&&(Nv=t.MDW),null!=t.width?i.customWidth=1:null!=t.wpx?r=Gv(t.wpx):null!=t.wch&&(r=t.wch),r>-1?(i.width=Hv(r),i.customWidth=1):null!=t.width&&(i.width=t.width),t.hidden&&(i.hidden=!0),null!=t.level&&(i.outlineLevel=i.level=t.level),i}function iw(e,t){if(e){var i=[.7,.7,.75,.75,.3,.3];"xlml"==t&&(i=[1,1,1,1,.5,.5]),null==e.left&&(e.left=i[0]),null==e.right&&(e.right=i[1]),null==e.top&&(e.top=i[2]),null==e.bottom&&(e.bottom=i[3]),null==e.header&&(e.header=i[4]),null==e.footer&&(e.footer=i[5])}}function rw(e,t,i){var r=i.revssf[null!=t.z?t.z:"General"],n=60,o=e.length;if(null==r&&i.ssf)for(;n<392;++n)if(null==i.ssf[n]){Fg(t.z,n),i.ssf[n]=t.z,i.revssf[t.z]=r=n;break}for(n=0;n!=o;++n)if(e[n].numFmtId===r)return n;return e[o]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},o}function nw(e,t,i){if(e&&e["!ref"]){var r=jf(e["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+i+"): "+e["!ref"])}}var ow=["objects","scenarios","selectLockedCells","selectUnlockedCells"],sw=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function aw(e,t,i,r){if(e.c&&i["!comments"].push([t,e.c]),void 0===e.v&&"string"!==typeof e.f||"z"===e.t&&!e.f)return"";var n="",o=e.t,s=e.v;if("z"!==e.t)switch(e.t){case"b":n=e.v?"1":"0";break;case"n":n=""+e.v;break;case"e":n=Pm[e.v];break;case"d":r&&r.cellDates?n=Qg(e.v,-1).toISOString():((e=Xg(e)).t="n",n=""+(e.v=Vg(Qg(e.v)))),"undefined"===typeof e.z&&(e.z=qh[14]);break;default:n=e.v}var a=yp("v",cp(n)),l={r:t},c=rw(r.cellXfs,e,r);switch(0!==c&&(l.s=c),e.t){case"n":case"z":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;default:if(null==e.v){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){a=yp("v",""+ew(r.Strings,e.v,r.revStrings)),l.t="s";break}l.t="str"}if(e.t!=o&&(e.t=o,e.v=s),"string"==typeof e.f&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;a=Ep("f",cp(e.f),u)+(null!=e.v?a:"")}return e.l&&i["!links"].push([t,e.l]),e.D&&(l.cm=1),Ep("c",a,l)}function lw(e,t,i,r){var n,o=[np,Ep("worksheet",null,{xmlns:Hp[0],"xmlns:r":Op})],s=i.SheetNames[e],a="",l=i.Sheets[s];null==l&&(l={});var c=l["!ref"]||"A1",u=jf(c);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=Uf(u)}r||(r={}),l["!comments"]=[];var d=[];!function(e,t,i,r,n){var o=!1,s={},a=null;if("xlsx"!==r.bookType&&t.vbaraw){var l=t.SheetNames[i];try{t.Workbook&&(l=t.Workbook.Sheets[i].CodeName||l)}catch(u){}o=!0,s.codeName=wp(cp(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),a=(a||"")+Ep("outlinePr",null,c)}(o||a)&&(n[n.length]=Ep("sheetPr",a,s))}(l,i,e,t,o),o[o.length]=Ep("dimension",null,{ref:c}),o[o.length]=function(e,t,i,r){var n={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),Ep("sheetViews",Ep("sheetView",null,n),{})}(0,0,0,i),t.sheetFormat&&(o[o.length]=Ep("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),null!=l["!cols"]&&l["!cols"].length>0&&(o[o.length]=function(e,t){for(var i,r=["<cols>"],n=0;n!=t.length;++n)(i=t[n])&&(r[r.length]=Ep("col",null,tw(n,i)));return r[r.length]="</cols>",r.join("")}(0,l["!cols"])),o[n=o.length]="<sheetData/>",l["!links"]=[],null!=l["!ref"]&&(a=function(e,t){var i,r,n=[],o=[],s=jf(e["!ref"]),a="",l="",c=[],u=0,d=0,h=e["!rows"],g=Array.isArray(e),p={r:l},f=-1;for(d=s.s.c;d<=s.e.c;++d)c[d]=zf(d);for(u=s.s.r;u<=s.e.r;++u){for(o=[],l=Gf(u),d=s.s.c;d<=s.e.c;++d){i=c[d]+l;var m=g?(e[u]||[])[d]:e[i];void 0!==m&&null!=(a=aw(m,i,e,t))&&o.push(a)}(o.length>0||h&&h[u])&&(p={r:l},h&&h[u]&&((r=h[u]).hidden&&(p.hidden=1),f=-1,r.hpx?f=_v(r.hpx):r.hpt&&(f=r.hpt),f>-1&&(p.ht=f,p.customHeight=1),r.level&&(p.outlineLevel=r.level)),n[n.length]=Ep("row",o.join(""),p))}if(h)for(;u<h.length;++u)h&&h[u]&&(p={r:u+1},(r=h[u]).hidden&&(p.hidden=1),f=-1,r.hpx?f=_v(r.hpx):r.hpt&&(f=r.hpt),f>-1&&(p.ht=f,p.customHeight=1),r.level&&(p.outlineLevel=r.level),n[n.length]=Ep("row","",p));return n.join("")}(l,t,0,0),a.length>0&&(o[o.length]=a)),o.length>n+1&&(o[o.length]="</sheetData>",o[n]=o[n].replace("/>",">")),l["!protect"]&&(o[o.length]=function(e){var t={sheet:1};return ow.forEach((function(i){null!=e[i]&&e[i]&&(t[i]="1")})),sw.forEach((function(i){null==e[i]||e[i]||(t[i]="0")})),e.password&&(t.password=Iv(e.password).toString(16).toUpperCase()),Ep("sheetProtection",null,t)}(l["!protect"])),null!=l["!autofilter"]&&(o[o.length]=function(e,t,i,r){var n="string"==typeof e.ref?e.ref:Uf(e.ref);i.Workbook||(i.Workbook={Sheets:[]}),i.Workbook.Names||(i.Workbook.Names=[]);var o=i.Workbook.Names,s=Wf(n);s.s.r==s.e.r&&(s.e.r=Wf(t["!ref"]).e.r,n=Uf(s));for(var a=0;a<o.length;++a){var l=o[a];if("_xlnm._FilterDatabase"==l.Name&&l.Sheet==r){l.Ref="'"+i.SheetNames[r]+"'!"+n;break}}return a==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+i.SheetNames[r]+"'!"+n}),Ep("autoFilter",null,{ref:n})}(l["!autofilter"],l,i,e)),null!=l["!merges"]&&l["!merges"].length>0&&(o[o.length]=function(e){if(0===e.length)return"";for(var t='<mergeCells count="'+e.length+'">',i=0;i!=e.length;++i)t+='<mergeCell ref="'+Uf(e[i])+'"/>';return t+"</mergeCells>"}(l["!merges"]));var h,g,p=-1,f=-1;return l["!links"].length>0&&(o[o.length]="<hyperlinks>",l["!links"].forEach((function(e){e[1].Target&&(h={ref:e[0]},"#"!=e[1].Target.charAt(0)&&(f=Om(r,-1,cp(e[1].Target).replace(/#.*$/,""),Mm.HLINK),h["r:id"]="rId"+f),(p=e[1].Target.indexOf("#"))>-1&&(h.location=cp(e[1].Target.slice(p+1))),e[1].Tooltip&&(h.tooltip=cp(e[1].Tooltip)),o[o.length]=Ep("hyperlink",null,h))})),o[o.length]="</hyperlinks>"),delete l["!links"],null!=l["!margins"]&&(o[o.length]=(iw(g=l["!margins"]),Ep("pageMargins",null,g))),t&&!t.ignoreEC&&void 0!=t.ignoreEC||(o[o.length]=yp("ignoredErrors",Ep("ignoredError",null,{numberStoredAsText:1,sqref:c}))),d.length>0&&(f=Om(r,-1,"../drawings/drawing"+(e+1)+".xml",Mm.DRAW),o[o.length]=Ep("drawing",null,{"r:id":"rId"+f}),l["!drawing"]=d),l["!comments"].length>0&&(f=Om(r,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Mm.VML),o[o.length]=Ep("legacyDrawing",null,{"r:id":"rId"+f}),l["!legacy"]=f),o.length>1&&(o[o.length]="</worksheet>",o[1]=o[1].replace("/>",">")),o.join("")}function cw(e,t,i,r){var n=function(e,t,i){var r=kf(145),n=(i["!rows"]||[])[e]||{};r.write_shift(4,e),r.write_shift(4,0);var o=320;n.hpx?o=20*_v(n.hpx):n.hpt&&(o=20*n.hpt),r.write_shift(2,o),r.write_shift(1,0);var s=0;n.level&&(s|=n.level),n.hidden&&(s|=16),(n.hpx||n.hpt)&&(s|=32),r.write_shift(1,s),r.write_shift(1,0);var a=0,l=r.l;r.l+=4;for(var c={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var d=-1,h=-1,g=u<<10;g<u+1<<10;++g)c.c=g,(Array.isArray(i)?(i[c.r]||[])[c.c]:i[_f(c)])&&(d<0&&(d=g),h=g);d<0||(++a,r.write_shift(4,d),r.write_shift(4,h))}var p=r.l;return r.l=l,r.write_shift(4,a),r.l=p,r.length>r.l?r.slice(0,r.l):r}(r,i,t);(n.length>17||(t["!rows"]||[])[r])&&Mf(e,0,n)}var uw=Cm,dw=wm;function hw(e){return[sm(e),bm(e),"n"]}var gw=Cm,pw=wm;var fw=["left","right","top","bottom","header","footer"];function mw(e,t,i,r,n,o,s){if(void 0===t.v)return!1;var a="";switch(t.t){case"b":a=t.v?"1":"0";break;case"d":(t=Xg(t)).z=t.z||qh[14],t.v=Vg(Qg(t.v)),t.t="n";break;case"n":case"e":a=""+t.v;break;default:a=t.v}var l={r:i,c:r};switch(l.s=rw(n.cellXfs,t,n),t.l&&o["!links"].push([_f(l),t.l]),t.c&&o["!comments"].push([_f(l),t.c]),t.t){case"s":case"str":return n.bookSST?(a=ew(n.Strings,t.v,n.revStrings),l.t="s",l.v=a,s?Mf(e,18,function(e,t,i){return null==i&&(i=kf(8)),am(t,i),i.write_shift(4,t.v),i}(0,l)):Mf(e,7,function(e,t,i){return null==i&&(i=kf(12)),om(t,i),i.write_shift(4,t.v),i}(0,l))):(l.t="str",s?Mf(e,17,function(e,t,i){return null==i&&(i=kf(8+4*e.v.length)),am(t,i),Zf(e.v,i),i.length>i.l?i.slice(0,i.l):i}(t,l)):Mf(e,6,function(e,t,i){return null==i&&(i=kf(12+4*e.v.length)),om(t,i),Zf(e.v,i),i.length>i.l?i.slice(0,i.l):i}(t,l))),!0;case"n":return t.v==(0|t.v)&&t.v>-1e3&&t.v<1e3?s?Mf(e,13,function(e,t,i){return null==i&&(i=kf(8)),am(t,i),mm(e.v,i),i}(t,l)):Mf(e,2,function(e,t,i){return null==i&&(i=kf(12)),om(t,i),mm(e.v,i),i}(t,l)):s?Mf(e,16,function(e,t,i){return null==i&&(i=kf(12)),am(t,i),Sm(e.v,i),i}(t,l)):Mf(e,5,function(e,t,i){return null==i&&(i=kf(16)),om(t,i),Sm(e.v,i),i}(t,l)),!0;case"b":return l.t="b",s?Mf(e,15,function(e,t,i){return null==i&&(i=kf(5)),am(t,i),i.write_shift(1,e.v?1:0),i}(t,l)):Mf(e,4,function(e,t,i){return null==i&&(i=kf(9)),om(t,i),i.write_shift(1,e.v?1:0),i}(t,l)),!0;case"e":return l.t="e",s?Mf(e,14,function(e,t,i){return null==i&&(i=kf(8)),am(t,i),i.write_shift(1,e.v),i.write_shift(2,0),i.write_shift(1,0),i}(t,l)):Mf(e,3,function(e,t,i){return null==i&&(i=kf(9)),om(t,i),i.write_shift(1,e.v),i}(t,l)),!0}return s?Mf(e,12,function(e,t,i){return null==i&&(i=kf(4)),am(t,i)}(0,l)):Mf(e,1,function(e,t,i){return null==i&&(i=kf(8)),om(t,i)}(0,l)),!0}function vw(e,t){var i,r;t&&t["!merges"]&&(Mf(e,177,(i=t["!merges"].length,null==r&&(r=kf(4)),r.write_shift(4,i),r)),t["!merges"].forEach((function(t){Mf(e,176,pw(t))})),Mf(e,178))}function Cw(e,t){t&&t["!cols"]&&(Mf(e,390),t["!cols"].forEach((function(t,i){t&&Mf(e,60,function(e,t,i){null==i&&(i=kf(18));var r=tw(e,t);i.write_shift(-4,e),i.write_shift(-4,e),i.write_shift(4,256*(r.width||10)),i.write_shift(4,0);var n=0;return t.hidden&&(n|=1),"number"==typeof r.width&&(n|=2),t.level&&(n|=t.level<<8),i.write_shift(2,n),i}(i,t))})),Mf(e,391))}function ww(e,t){t&&t["!ref"]&&(Mf(e,648),Mf(e,649,function(e){var t=kf(24);return t.write_shift(4,4),t.write_shift(4,1),wm(e,t),t}(jf(t["!ref"]))),Mf(e,650))}function bw(e,t,i){t["!links"].forEach((function(t){if(t[1].Target){var r=Om(i,-1,t[1].Target.replace(/#.*$/,""),Mm.HLINK);Mf(e,494,function(e,t){var i=kf(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));wm({s:Vf(e[0]),e:Vf(e[0])},i),pm("rId"+t,i);var r=e[1].Target.indexOf("#");return Zf((-1==r?"":e[1].Target.slice(r+1))||"",i),Zf(e[1].Tooltip||"",i),Zf("",i),i.slice(0,i.l)}(t,r))}})),delete t["!links"]}function Sw(e,t,i){Mf(e,133),Mf(e,137,function(e,t,i){null==i&&(i=kf(30));var r=924;return(((t||{}).Views||[])[0]||{}).RTL&&(r|=32),i.write_shift(2,r),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(1,0),i.write_shift(1,0),i.write_shift(2,0),i.write_shift(2,100),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(4,0),i}(0,i)),Mf(e,138),Mf(e,134)}function yw(e,t){var i,r;t["!protect"]&&Mf(e,535,(i=t["!protect"],null==r&&(r=kf(66)),r.write_shift(2,i.password?Iv(i.password):0),r.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach((function(e){e[1]?r.write_shift(4,null==i[e[0]]||i[e[0]]?0:1):r.write_shift(4,null!=i[e[0]]&&i[e[0]]?0:1)})),r))}function Rw(e,t,i,r){var n=Af(),o=i.SheetNames[e],s=i.Sheets[o]||{},a=o;try{i&&i.Workbook&&(a=i.Workbook.Sheets[e].CodeName||a)}catch(d){}var l,c,u=jf(s["!ref"]||"A1");if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],Mf(n,129),(i.vbaraw||s["!outline"])&&Mf(n,147,function(e,t,i){null==i&&(i=kf(84+4*e.length));var r=192;t&&(t.above&&(r&=-65),t.left&&(r&=-129)),i.write_shift(1,r);for(var n=1;n<3;++n)i.write_shift(1,0);return ym({auto:1},i),i.write_shift(-4,-1),i.write_shift(-4,-1),cm(e,i),i.slice(0,i.l)}(a,s["!outline"])),Mf(n,148,dw(u)),Sw(n,0,i.Workbook),Cw(n,s),function(e,t,i,r){var n,o=jf(t["!ref"]||"A1"),s="",a=[];Mf(e,145);var l=Array.isArray(t),c=o.e.r;t["!rows"]&&(c=Math.max(o.e.r,t["!rows"].length-1));for(var u=o.s.r;u<=c;++u){s=Gf(u),cw(e,t,o,u);var d=!1;if(u<=o.e.r)for(var h=o.s.c;h<=o.e.c;++h){u===o.s.r&&(a[h]=zf(h)),n=a[h]+s;var g=l?(t[u]||[])[h]:t[n];d=!!g&&mw(e,g,u,h,r,t,d)}}Mf(e,146)}(n,s,0,t),yw(n,s),function(e,t,i,r){if(t["!autofilter"]){var n=t["!autofilter"],o="string"===typeof n.ref?n.ref:Uf(n.ref);i.Workbook||(i.Workbook={Sheets:[]}),i.Workbook.Names||(i.Workbook.Names=[]);var s=i.Workbook.Names,a=Wf(o);a.s.r==a.e.r&&(a.e.r=Wf(t["!ref"]).e.r,o=Uf(a));for(var l=0;l<s.length;++l){var c=s[l];if("_xlnm._FilterDatabase"==c.Name&&c.Sheet==r){c.Ref="'"+i.SheetNames[r]+"'!"+o;break}}l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+i.SheetNames[r]+"'!"+o}),Mf(e,161,wm(jf(o))),Mf(e,162)}}(n,s,i,e),vw(n,s),bw(n,s,r),s["!margins"]&&Mf(n,476,(l=s["!margins"],null==c&&(c=kf(48)),iw(l),fw.forEach((function(e){Sm(l[e],c)})),c)),t&&!t.ignoreEC&&void 0!=t.ignoreEC||ww(n,s),function(e,t,i,r){if(t["!comments"].length>0){var n=Om(r,-1,"../drawings/vmlDrawing"+(i+1)+".vml",Mm.VML);Mf(e,551,pm("rId"+n)),t["!legacy"]=n}}(n,s,e,r),Mf(n,130),n.end()}var Ew=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];var xw="][*?/\\".split("");function Tw(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var i=!0;return xw.forEach((function(r){if(-1!=e.indexOf(r)){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");i=!1}})),i}function Fw(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t,i,r,n=e.Workbook&&e.Workbook.Sheets||[];t=e.SheetNames,i=n,r=!!e.vbaraw,t.forEach((function(e,n){Tw(e);for(var o=0;o<n;++o)if(e==t[o])throw new Error("Duplicate Sheet Name: "+e);if(r){var s=i&&i[n]&&i[n].CodeName||e;if(95==s.charCodeAt(0)&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}}));for(var o=0;o<e.SheetNames.length;++o)nw(e.Sheets[e.SheetNames[o]],e.SheetNames[o],o)}function Pw(e){var t=[np];t[t.length]=Ep("workbook",null,{xmlns:Hp[0],"xmlns:r":Op});var i=e.Workbook&&(e.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Ew.forEach((function(t){null!=e.Workbook.WBProps[t[0]]&&e.Workbook.WBProps[t[0]]!=t[1]&&(r[t[0]]=e.Workbook.WBProps[t[0]])})),e.Workbook.WBProps.CodeName&&(r.codeName=e.Workbook.WBProps.CodeName,delete r.CodeName)),t[t.length]=Ep("workbookPr",null,r);var n=e.Workbook&&e.Workbook.Sheets||[],o=0;if(n&&n[0]&&n[0].Hidden){for(t[t.length]="<bookViews>",o=0;o!=e.SheetNames.length&&n[o]&&n[o].Hidden;++o);o==e.SheetNames.length&&(o=0),t[t.length]='<workbookView firstSheet="'+o+'" activeTab="'+o+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",o=0;o!=e.SheetNames.length;++o){var s={name:cp(e.SheetNames[o].slice(0,31))};if(s.sheetId=""+(o+1),s["r:id"]="rId"+(o+1),n[o])switch(n[o].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden"}t[t.length]=Ep("sheet",null,s)}return t[t.length]="</sheets>",i&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach((function(e){var i={name:e.Name};e.Comment&&(i.comment=e.Comment),null!=e.Sheet&&(i.localSheetId=""+e.Sheet),e.Hidden&&(i.hidden="1"),e.Ref&&(t[t.length]=Ep("definedName",cp(e.Ref),i))})),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function Dw(e,t){return t||(t=kf(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),pm(e.strRelID,t),Zf(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function kw(e,t){if(t.Workbook&&t.Workbook.Sheets){for(var i,r,n=t.Workbook.Sheets,o=0,s=-1,a=-1;o<n.length;++o)!n[o]||!n[o].Hidden&&-1==s?s=o:1==n[o].Hidden&&-1==a&&(a=o);if(!(a>s))Mf(e,135),Mf(e,158,(i=s,r||(r=kf(29)),r.write_shift(-4,0),r.write_shift(-4,460),r.write_shift(4,28800),r.write_shift(4,17600),r.write_shift(4,500),r.write_shift(4,i),r.write_shift(4,i),r.write_shift(1,120),r.length>r.l?r.slice(0,r.l):r)),Mf(e,136)}}function Aw(e,t){var i=Af();return Mf(i,131),Mf(i,128,function(e,t){t||(t=kf(127));for(var i=0;4!=i;++i)t.write_shift(4,0);return Zf("SheetJS",t),Zf(ph.version,t),Zf(ph.version,t),Zf("7262",t),t.length>t.l?t.slice(0,t.l):t}()),Mf(i,153,function(e,t){t||(t=kf(72));var i=0;return e&&e.filterPrivacy&&(i|=8),t.write_shift(4,i),t.write_shift(4,0),cm(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}(e.Workbook&&e.Workbook.WBProps||null)),kw(i,e),function(e,t){Mf(e,143);for(var i=0;i!=t.SheetNames.length;++i)Mf(e,156,Dw({Hidden:t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[i]&&t.Workbook.Sheets[i].Hidden||0,iTabID:i+1,strRelID:"rId"+(i+1),name:t.SheetNames[i]}));Mf(e,144)}(i,e),Mf(i,132),i.end()}function Mw(e,t,i,r,n){return(".bin"===t.slice(-4)?Rw:lw)(e,i,r,n)}function Iw(e,t,i){return(".bin"===t.slice(-4)?hC:cC)(e,i)}function Lw(e,t){var i=[];return e.Props&&i.push(function(e,t){var i=[];return Ng(jm).map((function(e){for(var t=0;t<Gm.length;++t)if(Gm[t][1]==e)return Gm[t];for(t=0;t<Vm.length;++t)if(Vm[t][1]==e)return Vm[t];throw e})).forEach((function(r){if(null!=e[r[1]]){var n=t&&t.Props&&null!=t.Props[r[1]]?t.Props[r[1]]:e[r[1]];"date"===r[2]&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"Z")),"number"==typeof n?n=String(n):!0===n||!1===n?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),i.push(yp(jm[r[1]]||r[1],n))}})),Ep("DocumentProperties",i.join(""),{xmlns:zp})}(e.Props,t)),e.Custprops&&i.push(function(e,t){var i=["Worksheets","SheetNames"],r="CustomDocumentProperties",n=[];return e&&Ng(e).forEach((function(t){if(Object.prototype.hasOwnProperty.call(e,t)){for(var r=0;r<Gm.length;++r)if(t==Gm[r][1])return;for(r=0;r<Vm.length;++r)if(t==Vm[r][1])return;for(r=0;r<i.length;++r)if(t==i[r])return;var o=e[t],s="string";"number"==typeof o?(s="float",o=String(o)):!0===o||!1===o?(s="boolean",o=o?"1":"0"):o=String(o),n.push(Ep(up(t),o,{"dt:dt":s}))}})),t&&Ng(t).forEach((function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&(!e||!Object.prototype.hasOwnProperty.call(e,i))){var r=t[i],o="string";"number"==typeof r?(o="float",r=String(r)):!0===r||!1===r?(o="boolean",r=r?"1":"0"):r instanceof Date?(o="dateTime.tz",r=r.toISOString()):r=String(r),n.push(Ep(up(i),r,{"dt:dt":o}))}})),"<"+r+' xmlns="'+zp+'">'+n.join("")+"</"+r+">"}(e.Props,e.Custprops)),i.join("")}function Ow(e){return Ep("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+mC(e.Ref,{r:0,c:0})})}function Nw(e,t,i,r,n,o,s){if(!e||void 0==e.v&&void 0==e.f)return"";var a={};if(e.f&&(a["ss:Formula"]="="+cp(mC(e.f,s))),e.F&&e.F.slice(0,t.length)==t){var l=Vf(e.F.slice(t.length+1));a["ss:ArrayRange"]="RC:R"+(l.r==s.r?"":"["+(l.r-s.r)+"]")+"C"+(l.c==s.c?"":"["+(l.c-s.c)+"]")}if(e.l&&e.l.Target&&(a["ss:HRef"]=cp(e.l.Target),e.l.Tooltip&&(a["x:HRefScreenTip"]=cp(e.l.Tooltip))),i["!merges"])for(var c=i["!merges"],u=0;u!=c.length;++u)c[u].s.c==s.c&&c[u].s.r==s.r&&(c[u].e.c>c[u].s.c&&(a["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(a["ss:MergeDown"]=c[u].e.r-c[u].s.r));var d="",h="";switch(e.t){case"z":if(!r.sheetStubs)return"";break;case"n":d="Number",h=String(e.v);break;case"b":d="Boolean",h=e.v?"1":"0";break;case"e":d="Error",h=Pm[e.v];break;case"d":d="DateTime",h=new Date(e.v).toISOString(),null==e.z&&(e.z=e.z||qh[14]);break;case"s":d="String",h=((e.v||"")+"").replace(ap,(function(e){return sp[e]})).replace(dp,(function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"}))}var g=rw(r.cellXfs,e,r);a["ss:StyleID"]="s"+(21+g),a["ss:Index"]=s.c+1;var p=null!=e.v?h:"",f="z"==e.t?"":'<Data ss:Type="'+d+'">'+p+"</Data>";return(e.c||[]).length>0&&(f+=e.c.map((function(e){var t=Ep("ss:Data",(e.t||"").replace(/(\r\n|[\r\n])/g,"&#10;"),{xmlns:"http://www.w3.org/TR/REC-html40"});return Ep("Comment",t,{"ss:Author":e.a})})).join("")),Ep("Cell",f,a)}function Bw(e,t){var i='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Wv(t.hpt)),t.hpx&&(i+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(i+=' ss:Hidden="1"')),i+">"}function Gw(e,t,i){var r=[],n=i.SheetNames[e],o=i.Sheets[n],s=o?function(e,t,i,r){if(!e)return"";if(!((r||{}).Workbook||{}).Names)return"";for(var n=r.Workbook.Names,o=[],s=0;s<n.length;++s){var a=n[s];a.Sheet==i&&(a.Name.match(/^_xlfn\./)||o.push(Ow(a)))}return o.join("")}(o,0,e,i):"";return s.length>0&&r.push("<Names>"+s+"</Names>"),s=o?function(e,t){if(!e["!ref"])return"";var i=jf(e["!ref"]),r=e["!merges"]||[],n=0,o=[];e["!cols"]&&e["!cols"].forEach((function(e,t){zv(e);var i=!!e.width,r=tw(t,e),n={"ss:Index":t+1};i&&(n["ss:Width"]=Bv(r.width)),e.hidden&&(n["ss:Hidden"]="1"),o.push(Ep("Column",null,n))}));for(var s=Array.isArray(e),a=i.s.r;a<=i.e.r;++a){for(var l=[Bw(a,(e["!rows"]||[])[a])],c=i.s.c;c<=i.e.c;++c){var u=!1;for(n=0;n!=r.length;++n)if(!(r[n].s.c>c)&&!(r[n].s.r>a)&&!(r[n].e.c<c)&&!(r[n].e.r<a)){r[n].s.c==c&&r[n].s.r==a||(u=!0);break}if(!u){var d={r:a,c:c},h=_f(d),g=s?(e[a]||[])[c]:e[h];l.push(Nw(g,h,e,t,0,0,d))}}l.push("</Row>"),l.length>2&&o.push(l.join(""))}return o.join("")}(o,t):"",s.length>0&&r.push("<Table>"+s+"</Table>"),r.push(function(e,t,i,r){if(!e)return"";var n=[];if(e["!margins"]&&(n.push("<PageSetup>"),e["!margins"].header&&n.push(Ep("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&n.push(Ep("Footer",null,{"x:Margin":e["!margins"].footer})),n.push(Ep("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),n.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[i])if(r.Workbook.Sheets[i].Hidden)n.push(Ep("Visible",1==r.Workbook.Sheets[i].Hidden?"SheetHidden":"SheetVeryHidden",{}));else{for(var o=0;o<i&&(!r.Workbook.Sheets[o]||r.Workbook.Sheets[o].Hidden);++o);o==i&&n.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),e["!protect"]&&(n.push(yp("ProtectContents","True")),e["!protect"].objects&&n.push(yp("ProtectObjects","True")),e["!protect"].scenarios&&n.push(yp("ProtectScenarios","True")),null==e["!protect"].selectLockedCells||e["!protect"].selectLockedCells?null==e["!protect"].selectUnlockedCells||e["!protect"].selectUnlockedCells||n.push(yp("EnableSelection","UnlockedCells")):n.push(yp("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach((function(t){e["!protect"][t[0]]&&n.push("<"+t[1]+"/>")}))),0==n.length?"":Ep("WorksheetOptions",n.join(""),{xmlns:Vp})}(o,0,e,i)),r.join("")}function Hw(e,t){t||(t={}),e.SSF||(e.SSF=Xg(qh)),e.SSF&&(Dg(),Pg(e.SSF),t.revssf=Hg(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],rw(t.cellXfs,{},{revssf:{General:0}}));var i=[];i.push(Lw(e,t)),i.push(""),i.push(""),i.push("");for(var r=0;r<e.SheetNames.length;++r)i.push(Ep("Worksheet",Gw(r,t,e),{"ss:Name":cp(e.SheetNames[r])}));return i[2]=function(e,t){var i=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach((function(e,t){var r=[];r.push(Ep("NumberFormat",null,{"ss:Format":cp(qh[e.numFmtId])}));var n={"ss:ID":"s"+(21+t)};i.push(Ep("Style",r.join(""),n))})),Ep("Styles",i.join(""))}(0,t),i[3]=function(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,i=[],r=0;r<t.length;++r){var n=t[r];null==n.Sheet&&(n.Name.match(/^_xlfn\./)||i.push(Ow(n)))}return Ep("Names",i.join(""))}(e),np+Ep("Workbook",i.join(""),{xmlns:_p,"xmlns:o":zp,"xmlns:x":Vp,"xmlns:ss":_p,"xmlns:dt":Wp,"xmlns:html":Kp})}var zw="e0859ff2f94f6810ab9108002b27b3d9",Vw="02d5cdd59c2e1b10939708002b2cf9ae",_w="05d5cdd59c2e1b10939708002b2cf9ae";function Ww(e,t){var i=t||{},r=Mg.utils.cfb_new({root:"R"}),n="/Workbook";switch(i.bookType||"xls"){case"xls":i.bookType="biff8";case"xla":i.bookType||(i.bookType="xla");case"biff8":n="/Workbook",i.biff=8;break;case"biff5":n="/Book",i.biff=5;break;default:throw new Error("invalid type "+i.bookType+" for XLS CFB")}return Mg.utils.cfb_add(r,n,eb(e,i)),8==i.biff&&(e.Props||e.Custprops)&&function(e,t){var i,r=[],n=[],o=[],s=0,a=Bg(Em,"n"),l=Bg(xm,"n");if(e.Props)for(i=Ng(e.Props),s=0;s<i.length;++s)(Object.prototype.hasOwnProperty.call(a,i[s])?r:Object.prototype.hasOwnProperty.call(l,i[s])?n:o).push([i[s],e.Props[i[s]]]);if(e.Custprops)for(i=Ng(e.Custprops),s=0;s<i.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},i[s])||(Object.prototype.hasOwnProperty.call(a,i[s])?r:Object.prototype.hasOwnProperty.call(l,i[s])?n:o).push([i[s],e.Custprops[i[s]]]);var c=[];for(s=0;s<o.length;++s)Ym.indexOf(o[s][0])>-1||_m.indexOf(o[s][0])>-1||null!=o[s][1]&&c.push(o[s]);n.length&&Mg.utils.cfb_add(t,"/\x05SummaryInformation",$m(n,zw,l,xm)),(r.length||c.length)&&Mg.utils.cfb_add(t,"/\x05DocumentSummaryInformation",$m(r,Vw,a,Em,c.length?c:null,_w))}(e,r),8==i.biff&&e.vbaraw&&function(e,t){t.FullPaths.forEach((function(i,r){if(0!=r){var n=i.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");"/"!==n.slice(-1)&&Mg.utils.cfb_add(e,n,t.FileIndex[r].content)}}))}(r,Mg.read(e.vbaraw,{type:"string"==typeof e.vbaraw?"binary":"buffer"})),r}var Uw={0:{f:function(e,t){var i={},r=e.l+t;i.r=e.read_shift(4),e.l+=4;var n=e.read_shift(2);e.l+=1;var o=e.read_shift(1);return e.l=r,7&o&&(i.level=7&o),16&o&&(i.hidden=!0),32&o&&(i.hpt=n/20),i}},1:{f:function(e){return[nm(e)]}},2:{f:function(e){return[nm(e),fm(e),"n"]}},3:{f:function(e){return[nm(e),e.read_shift(1),"e"]}},4:{f:function(e){return[nm(e),e.read_shift(1),"b"]}},5:{f:function(e){return[nm(e),bm(e),"n"]}},6:{f:function(e){return[nm(e),Jf(e),"str"]}},7:{f:function(e){return[nm(e),e.read_shift(4),"s"]}},8:{f:function(e,t,i){var r=e.l+t,n=nm(e);n.r=i["!row"];var o=[n,Jf(e),"str"];if(i.cellFormula){e.l+=2;var s=YC(e,r-e.l,i);o[3]=WC(s,0,n,i.supbooks,i)}else e.l=r;return o}},9:{f:function(e,t,i){var r=e.l+t,n=nm(e);n.r=i["!row"];var o=[n,bm(e),"n"];if(i.cellFormula){e.l+=2;var s=YC(e,r-e.l,i);o[3]=WC(s,0,n,i.supbooks,i)}else e.l=r;return o}},10:{f:function(e,t,i){var r=e.l+t,n=nm(e);n.r=i["!row"];var o=[n,e.read_shift(1),"b"];if(i.cellFormula){e.l+=2;var s=YC(e,r-e.l,i);o[3]=WC(s,0,n,i.supbooks,i)}else e.l=r;return o}},11:{f:function(e,t,i){var r=e.l+t,n=nm(e);n.r=i["!row"];var o=[n,e.read_shift(1),"e"];if(i.cellFormula){e.l+=2;var s=YC(e,r-e.l,i);o[3]=WC(s,0,n,i.supbooks,i)}else e.l=r;return o}},12:{f:function(e){return[sm(e)]}},13:{f:function(e){return[sm(e),fm(e),"n"]}},14:{f:function(e){return[sm(e),e.read_shift(1),"e"]}},15:{f:function(e){return[sm(e),e.read_shift(1),"b"]}},16:{f:hw},17:{f:function(e){return[sm(e),Jf(e),"str"]}},18:{f:function(e){return[sm(e),e.read_shift(4),"s"]}},19:{f:tm},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(e,t,i){var r=e.l+t;e.l+=4,e.l+=1;var n=e.read_shift(4),o=hm(e),s=qC(e,0,i),a=um(e);e.l=r;var l={Name:o,Ptg:s};return n<268435455&&(l.Sheet=n),a&&(l.Comment=a),l}},40:{},42:{},43:{f:function(e,t,i){var r={};r.sz=e.read_shift(2)/20;var n=function(e){var t=e.read_shift(1);return e.l++,{fBold:1&t,fItalic:2&t,fUnderline:4&t,fStrikeout:8&t,fOutline:16&t,fShadow:32&t,fCondense:64&t,fExtend:128&t}}(e);switch(n.fItalic&&(r.italic=1),n.fCondense&&(r.condense=1),n.fExtend&&(r.extend=1),n.fShadow&&(r.shadow=1),n.fOutline&&(r.outline=1),n.fStrikeout&&(r.strike=1),700===e.read_shift(2)&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript"}var o=e.read_shift(1);0!=o&&(r.underline=o);var s=e.read_shift(1);s>0&&(r.family=s);var a=e.read_shift(1);switch(a>0&&(r.charset=a),e.l++,r.color=function(e){var t={},i=e.read_shift(1)>>>1,r=e.read_shift(1),n=e.read_shift(2,"i"),o=e.read_shift(1),s=e.read_shift(1),a=e.read_shift(1);switch(e.l++,i){case 0:t.auto=1;break;case 1:t.index=r;var l=Fm[r];l&&(t.rgb=Ov(l));break;case 2:t.rgb=Ov([o,s,a]);break;case 3:t.theme=r}return 0!=n&&(t.tint=n>0?n/32767:n/32768),t}(e),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor"}return r.name=Jf(e),r}},44:{f:function(e,t){return[e.read_shift(2),Jf(e)]}},45:{f:Qv},46:{f:Zv},47:{f:function(e,t){var i=e.l+t,r=e.read_shift(2),n=e.read_shift(2);return e.l=i,{ixfe:r,numFmtId:n}}},48:{},49:{f:function(e){return e.read_shift(4,"i")}},50:{},51:{f:function(e){for(var t=[],i=e.read_shift(4);i-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Sv},62:{f:function(e){return[nm(e),tm(e),"is"]}},63:{f:function(e){var t={};t.i=e.read_shift(4);var i={};i.r=e.read_shift(4),i.c=e.read_shift(4),t.r=_f(i);var r=e.read_shift(1);return 2&r&&(t.l="1"),8&r&&(t.a="1"),t}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Df,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(e){var t=e.read_shift(2);return e.l+=28,{RTL:32&t}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(e,t){var i={},r=e[e.l];return++e.l,i.above=!(64&r),i.left=!(128&r),e.l+=18,i.name=lm(e,t-19),i}},148:{f:uw,p:16},151:{f:function(){}},152:{},153:{f:function(e,t){var i={},r=e.read_shift(4);i.defaultThemeVersion=e.read_shift(4);var n=t>8?Jf(e):"";return n.length>0&&(i.CodeName=n),i.autoCompressPictures=!!(65536&r),i.backupFile=!!(64&r),i.checkCompatibility=!!(4096&r),i.date1904=!!(1&r),i.filterPrivacy=!!(8&r),i.hidePivotFieldList=!!(1024&r),i.promptedSolutions=!!(16&r),i.publishItems=!!(2048&r),i.refreshAllConnections=!!(262144&r),i.saveExternalLinkValues=!!(128&r),i.showBorderUnselectedTables=!!(4&r),i.showInkAnnotation=!!(32&r),i.showObjects=["all","placeholders","none"][r>>13&3],i.showPivotChartFilter=!!(32768&r),i.updateLinks=["userSet","never","always"][r>>8&3],i}},154:{},155:{},156:{f:function(e,t){var i={};return i.Hidden=e.read_shift(4),i.iTabID=e.read_shift(4),i.strRelID=gm(e,t-8),i.name=Jf(e),i}},157:{},158:{},159:{T:1,f:function(e){return[e.read_shift(4),e.read_shift(4)]}},160:{T:-1},161:{T:1,f:Cm},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:gw},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Jf(e)}}},336:{T:-1},337:{f:function(e){return e.l+=4,0!=e.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:gm},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Cv},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(e,t,i){var r=e.l+t,n=vm(e),o=e.read_shift(1),s=[n];if(s[2]=o,i.cellFormula){var a=KC(e,r-e.l,i);s[1]=a}else e.l=r;return s}},427:{f:function(e,t,i){var r=e.l+t,n=[Cm(e,16)];if(i.cellFormula){var o=QC(e,r-e.l,i);n[1]=o,e.l=r}else e.l=r;return n}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(e){var t={};return fw.forEach((function(i){t[i]=bm(e)})),t}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(e,t){var i=e.l+t,r=Cm(e,16),n=um(e),o=Jf(e),s=Jf(e),a=Jf(e);e.l=i;var l={rfx:r,relId:n,loc:o,display:a};return s&&(l.Tooltip=s),l}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:gm},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:dC},633:{T:1},634:{T:-1},635:{T:1,f:function(e){var t={};t.iauthor=e.read_shift(4);var i=Cm(e,16);return t.rfx=i.s,t.ref=_f(i.s),e.l+=16,t}},636:{T:-1},637:{f:im},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(e,t){return e.l+=10,{name:Jf(e)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function jw(e,t,i,r){var n=t;if(!isNaN(n)){var o=r||(i||[]).length||0,s=e.next(4);s.write_shift(2,n),s.write_shift(2,o),o>0&&pf(i)&&e.push(i)}}function Kw(e,t,i){return e||(e=kf(7)),e.write_shift(2,t),e.write_shift(2,i),e.write_shift(2,0),e.write_shift(1,0),e}function Yw(e,t,i,r){if(null!=t.v)switch(t.t){case"d":case"n":var n="d"==t.t?Vg(Qg(t.v)):t.v;return void(n==(0|n)&&n>=0&&n<65536?jw(e,2,function(e,t,i){var r=kf(9);return Kw(r,e,t),r.write_shift(2,i),r}(i,r,n)):jw(e,3,function(e,t,i){var r=kf(15);return Kw(r,e,t),r.write_shift(8,i,"f"),r}(i,r,n)));case"b":case"e":return void jw(e,5,function(e,t,i,r){var n=kf(9);return Kw(n,e,t),tv(i,r||"b",n),n}(i,r,t.v,t.t));case"s":case"str":return void jw(e,4,function(e,t,i){var r=kf(8+2*i.length);return Kw(r,e,t),r.write_shift(1,i.length),r.write_shift(i.length,i,"sbcs"),r.l<r.length?r.slice(0,r.l):r}(i,r,(t.v||"").slice(0,255)))}jw(e,1,Kw(null,i,r))}function qw(e,t){var i=t||{};for(var r=Af(),n=0,o=0;o<e.SheetNames.length;++o)e.SheetNames[o]==i.sheet&&(n=o);if(0==n&&i.sheet&&e.SheetNames[0]!=i.sheet)throw new Error("Sheet not found: "+i.sheet);return jw(r,4==i.biff?1033:3==i.biff?521:9,pv(0,16,i)),function(e,t,i,r){var n,o=Array.isArray(t),s=jf(t["!ref"]||"A1"),a="",l=[];if(s.e.c>255||s.e.r>16383){if(r.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),n=Uf(s)}for(var c=s.s.r;c<=s.e.r;++c){a=Gf(c);for(var u=s.s.c;u<=s.e.c;++u){c===s.s.r&&(l[u]=zf(u)),n=l[u]+a;var d=o?(t[c]||[])[u]:t[n];d&&Yw(e,d,c,u)}}}(r,e.Sheets[e.SheetNames[n]],0,i),jw(r,10),r.end()}function Qw(e,t,i){jw(e,49,function(e,t){var i=e.name||"Arial",r=t&&5==t.biff,n=kf(r?15+i.length:16+2*i.length);return n.write_shift(2,20*(e.sz||12)),n.write_shift(4,0),n.write_shift(2,400),n.write_shift(4,0),n.write_shift(2,0),n.write_shift(1,i.length),r||n.write_shift(1,1),n.write_shift((r?1:2)*i.length,i,r?"sbcs":"utf16le"),n}({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},i))}function $w(e,t){if(t){var i=0;t.forEach((function(t,r){++i<=256&&t&&jw(e,125,function(e,t){var i=kf(12);i.write_shift(2,t),i.write_shift(2,t),i.write_shift(2,256*e.width),i.write_shift(2,0);var r=0;return e.hidden&&(r|=1),i.write_shift(1,r),r=e.level||0,i.write_shift(1,r),i.write_shift(2,0),i}(tw(r,t),r))}))}}function Xw(e,t,i,r,n){var o=16+rw(n.cellXfs,t,n);if(null!=t.v||t.bf)if(t.bf)jw(e,6,UC(t,i,r,0,o));else switch(t.t){case"d":case"n":jw(e,515,function(e,t,i,r){var n=kf(14);return uv(e,t,r,n),Sm(i,n),n}(i,r,"d"==t.t?Vg(Qg(t.v)):t.v,o));break;case"b":case"e":jw(e,517,function(e,t,i,r,n,o){var s=kf(8);return uv(e,t,r,s),tv(i,o,s),s}(i,r,t.v,o,0,t.t));break;case"s":case"str":if(n.bookSST)jw(e,253,function(e,t,i,r){var n=kf(10);return uv(e,t,r,n),n.write_shift(4,i),n}(i,r,ew(n.Strings,t.v,n.revStrings),o));else jw(e,516,function(e,t,i,r,n){var o=!n||8==n.biff,s=kf(+o+8+(1+o)*i.length);return uv(e,t,r,s),s.write_shift(2,i.length),o&&s.write_shift(1,1),s.write_shift((1+o)*i.length,i,o?"utf16le":"sbcs"),s}(i,r,(t.v||"").slice(0,255),o,n));break;default:jw(e,513,uv(i,r,o))}else jw(e,513,uv(i,r,o))}function Jw(e,t,i){var r,n=Af(),o=i.SheetNames[e],s=i.Sheets[o]||{},a=(i||{}).Workbook||{},l=(a.Sheets||[])[e]||{},c=Array.isArray(s),u=8==t.biff,d="",h=[],g=jf(s["!ref"]||"A1"),p=u?65536:16384;if(g.e.c>255||g.e.r>=p){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");g.e.c=Math.min(g.e.c,255),g.e.r=Math.min(g.e.c,p-1)}jw(n,2057,pv(0,16,t)),jw(n,13,ev(1)),jw(n,12,ev(100)),jw(n,15,Jm(!0)),jw(n,17,Jm(!1)),jw(n,16,Sm(.001)),jw(n,95,Jm(!0)),jw(n,42,Jm(!1)),jw(n,43,Jm(!1)),jw(n,130,ev(1)),jw(n,128,function(e){var t=kf(8);return t.write_shift(4,0),t.write_shift(2,e[0]?e[0]+1:0),t.write_shift(2,e[1]?e[1]+1:0),t}([0,0])),jw(n,131,Jm(!1)),jw(n,132,Jm(!1)),u&&$w(n,s["!cols"]),jw(n,512,function(e,t){var i=8!=t.biff&&t.biff?2:4,r=kf(2*i+6);return r.write_shift(i,e.s.r),r.write_shift(i,e.e.r+1),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c+1),r.write_shift(2,0),r}(g,t)),u&&(s["!links"]=[]);for(var f=g.s.r;f<=g.e.r;++f){d=Gf(f);for(var m=g.s.c;m<=g.e.c;++m){f===g.s.r&&(h[m]=zf(m)),r=h[m]+d;var v=c?(s[f]||[])[m]:s[r];v&&(Xw(n,v,f,m,t),u&&v.l&&s["!links"].push([r,v.l]))}}var C=l.CodeName||l.name||o;return u&&jw(n,574,function(e){var t=kf(18),i=1718;return e&&e.RTL&&(i|=64),t.write_shift(2,i),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}((a.Views||[])[0])),u&&(s["!merges"]||[]).length&&jw(n,229,function(e){var t=kf(2+8*e.length);t.write_shift(2,e.length);for(var i=0;i<e.length;++i)gv(e[i],t);return t}(s["!merges"])),u&&function(e,t){for(var i=0;i<t["!links"].length;++i){var r=t["!links"][i];jw(e,440,wv(r)),r[1].Tooltip&&jw(e,2048,bv(r))}delete t["!links"]}(n,s),jw(n,442,av(C)),u&&function(e,t){var i=kf(19);i.write_shift(4,2151),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(2,3),i.write_shift(1,1),i.write_shift(4,0),jw(e,2151,i),(i=kf(39)).write_shift(4,2152),i.write_shift(4,0),i.write_shift(4,0),i.write_shift(2,3),i.write_shift(1,0),i.write_shift(4,0),i.write_shift(2,1),i.write_shift(4,4),i.write_shift(2,0),gv(jf(t["!ref"]||"A1"),i),i.write_shift(4,4),jw(e,2152,i)}(n,s),jw(n,10),n.end()}function Zw(e,t,i){var r=Af(),n=(e||{}).Workbook||{},o=n.Sheets||[],s=n.WBProps||{},a=8==i.biff,l=5==i.biff;(jw(r,2057,pv(0,5,i)),"xla"==i.bookType&&jw(r,135),jw(r,225,a?ev(1200):null),jw(r,193,function(e,t){t||(t=kf(e));for(var i=0;i<e;++i)t.write_shift(1,0);return t}(2)),l&&jw(r,191),l&&jw(r,192),jw(r,226),jw(r,92,function(e,t){var i=!t||8==t.biff,r=kf(i?112:54);for(r.write_shift(8==t.biff?2:1,7),i&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(i?0:536870912));r.l<r.length;)r.write_shift(1,i?0:32);return r}(0,i)),jw(r,66,ev(a?1200:1252)),a&&jw(r,353,ev(0)),a&&jw(r,448),jw(r,317,function(e){for(var t=kf(2*e),i=0;i<e;++i)t.write_shift(2,i+1);return t}(e.SheetNames.length)),a&&e.vbaraw&&jw(r,211),a&&e.vbaraw)&&jw(r,442,av(s.CodeName||"ThisWorkbook"));jw(r,156,ev(17)),jw(r,25,Jm(!1)),jw(r,18,Jm(!1)),jw(r,19,ev(0)),a&&jw(r,431,Jm(!1)),a&&jw(r,444,ev(0)),jw(r,61,function(){var e=kf(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}()),jw(r,64,Jm(!1)),jw(r,141,ev(0)),jw(r,34,Jm("true"==function(e){return e.Workbook&&e.Workbook.WBProps&&gp(e.Workbook.WBProps.date1904)?"true":"false"}(e))),jw(r,14,Jm(!0)),a&&jw(r,439,Jm(!1)),jw(r,218,ev(0)),Qw(r,0,i),function(e,t,i){t&&[[5,8],[23,26],[41,44],[50,392]].forEach((function(r){for(var n=r[0];n<=r[1];++n)null!=t[n]&&jw(e,1054,mv(n,t[n],i))}))}(r,e.SSF,i),function(e,t){for(var i=0;i<16;++i)jw(e,224,vv({numFmtId:0,style:!0},0,t));t.cellXfs.forEach((function(i){jw(e,224,vv(i,0,t))}))}(r,i),a&&jw(r,352,Jm(!1));var c,u=r.end(),d=Af();a&&jw(d,140,(c||(c=kf(4)),c.write_shift(2,1),c.write_shift(2,1),c)),a&&i.Strings&&function(e,t,i,r){var n=r||(i||[]).length||0;if(n<=8224)return jw(e,t,i,n);var o=t;if(!isNaN(o)){for(var s=i.parts||[],a=0,l=0,c=0;c+(s[a]||8224)<=8224;)c+=s[a]||8224,a++;var u=e.next(4);for(u.write_shift(2,o),u.write_shift(2,c),e.push(i.slice(l,l+c)),l+=c;l<n;){for((u=e.next(4)).write_shift(2,60),c=0;c+(s[a]||8224)<=8224;)c+=s[a]||8224,a++;u.write_shift(2,c),e.push(i.slice(l,l+c)),l+=c}}}(d,252,function(e){var t=kf(8);t.write_shift(4,e.Count),t.write_shift(4,e.Unique);for(var i=[],r=0;r<e.length;++r)i[r]=rv(e[r]);var n=Nh([t].concat(i));return n.parts=[t.length].concat(i.map((function(e){return e.length}))),n}(i.Strings)),jw(d,10);var h=d.end(),g=Af(),p=0,f=0;for(f=0;f<e.SheetNames.length;++f)p+=(a?12:11)+(a?2:1)*e.SheetNames[f].length;var m=u.length+p+h.length;for(f=0;f<e.SheetNames.length;++f){jw(g,133,fv({pos:m,hs:(o[f]||{}).Hidden||0,dt:0,name:e.SheetNames[f]},i)),m+=t[f].length}var v=g.end();if(p!=v.length)throw new Error("BS8 "+p+" != "+v.length);var C=[];return u.length&&C.push(u),v.length&&C.push(v),h.length&&C.push(h),Nh(C)}function eb(e,t){for(var i=0;i<=e.SheetNames.length;++i){var r=e.Sheets[e.SheetNames[i]];if(r&&r["!ref"])Wf(r["!ref"]).e.c>255&&"undefined"!=typeof console&&console.error&&console.error("Worksheet '"+e.SheetNames[i]+"' extends beyond column IV (255).  Data may be lost.")}var n=t||{};switch(n.biff||2){case 8:case 5:return function(e,t){var i=t||{},r=[];e&&!e.SSF&&(e.SSF=Xg(qh)),e&&e.SSF&&(Dg(),Pg(e.SSF),i.revssf=Hg(e.SSF),i.revssf[e.SSF[65535]]=0,i.ssf=e.SSF),i.Strings=[],i.Strings.Count=0,i.Strings.Unique=0,kb(i),i.cellXfs=[],rw(i.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var n=0;n<e.SheetNames.length;++n)r[r.length]=Jw(n,i,e);return r.unshift(Zw(e,r,i)),Nh(r)}(e,t);case 4:case 3:case 2:return qw(e,t)}throw new Error("invalid type "+n.bookType+" for BIFF")}function tb(e,t,i,r){for(var n=e["!merges"]||[],o=[],s=t.s.c;s<=t.e.c;++s){for(var a=0,l=0,c=0;c<n.length;++c)if(!(n[c].s.r>i||n[c].s.c>s)&&!(n[c].e.r<i||n[c].e.c<s)){if(n[c].s.r<i||n[c].s.c<s){a=-1;break}a=n[c].e.r-n[c].s.r+1,l=n[c].e.c-n[c].s.c+1;break}if(!(a<0)){var u=_f({r:i,c:s}),d=r.dense?(e[i]||[])[s]:e[u],h=d&&null!=d.v&&(d.h||hp(d.w||(Yf(d),d.w)||""))||"",g={};a>1&&(g.rowspan=a),l>1&&(g.colspan=l),r.editable?h='<span contenteditable="true">'+h+"</span>":d&&(g["data-t"]=d&&d.t||"z",null!=d.v&&(g["data-v"]=d.v),null!=d.z&&(g["data-z"]=d.z),d.l&&"#"!=(d.l.Target||"#").charAt(0)&&(h='<a href="'+d.l.Target+'">'+h+"</a>")),g.id=(r.id||"sjs")+"-"+u,o.push(Ep("td",h,g))}}return"<tr>"+o.join("")+"</tr>"}var ib='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',rb="</body></html>";function nb(e,t,i){return[].join("")+"<table"+(i&&i.id?' id="'+i.id+'"':"")+">"}function ob(e,t){var i=t||{},r=null!=i.header?i.header:ib,n=null!=i.footer?i.footer:rb,o=[r],s=Wf(e["!ref"]);i.dense=Array.isArray(e),o.push(nb(0,0,i));for(var a=s.s.r;a<=s.e.r;++a)o.push(tb(e,s,a,i));return o.push("</table>"+n),o.join("")}function sb(e,t,i){var r=i||{};var n=0,o=0;if(null!=r.origin)if("number"==typeof r.origin)n=r.origin;else{var s="string"==typeof r.origin?Vf(r.origin):r.origin;n=s.r,o=s.c}var a=t.getElementsByTagName("tr"),l=Math.min(r.sheetRows||1e7,a.length),c={s:{r:0,c:0},e:{r:n,c:o}};if(e["!ref"]){var u=Wf(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),-1==n&&(c.e.r=n=u.e.r+1)}var d=[],h=0,g=e["!rows"]||(e["!rows"]=[]),p=0,f=0,m=0,v=0,C=0,w=0;for(e["!cols"]||(e["!cols"]=[]);p<a.length&&f<l;++p){var b=a[p];if(lb(b)){if(r.display)continue;g[f]={hidden:!0}}var S=b.children;for(m=v=0;m<S.length;++m){var y=S[m];if(!r.display||!lb(y)){var R=y.hasAttribute("data-v")?y.getAttribute("data-v"):y.hasAttribute("v")?y.getAttribute("v"):bp(y.innerHTML),E=y.getAttribute("data-z")||y.getAttribute("z");for(h=0;h<d.length;++h){var x=d[h];x.s.c==v+o&&x.s.r<f+n&&f+n<=x.e.r&&(v=x.e.c+1-o,h=-1)}w=+y.getAttribute("colspan")||1,((C=+y.getAttribute("rowspan")||1)>1||w>1)&&d.push({s:{r:f+n,c:v+o},e:{r:f+n+(C||1)-1,c:v+o+(w||1)-1}});var T={t:"s",v:R},F=y.getAttribute("data-t")||y.getAttribute("t")||"";null!=R&&(0==R.length?T.t=F||"z":r.raw||0==R.trim().length||"s"==F||("TRUE"===R?T={t:"b",v:!0}:"FALSE"===R?T={t:"b",v:!1}:isNaN(Zg(R))?isNaN(tp(R).getDate())||(T={t:"d",v:Qg(R)},r.cellDates||(T={t:"n",v:Vg(T.v)}),T.z=r.dateNF||qh[14]):T={t:"n",v:Zg(R)})),void 0===T.z&&null!=E&&(T.z=E);var P="",D=y.getElementsByTagName("A");if(D&&D.length)for(var k=0;k<D.length&&(!D[k].hasAttribute("href")||"#"==(P=D[k].getAttribute("href")).charAt(0));++k);P&&"#"!=P.charAt(0)&&(T.l={Target:P}),r.dense?(e[f+n]||(e[f+n]=[]),e[f+n][v+o]=T):e[_f({c:v+o,r:f+n})]=T,c.e.c<v+o&&(c.e.c=v+o),v+=w}}++f}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),c.e.r=Math.max(c.e.r,f-1+n),e["!ref"]=Uf(c),f>=l&&(e["!fullref"]=Uf((c.e.r=a.length-p+f-1+n,c))),e}function ab(e,t){return sb((t||{}).dense?[]:{},e,t)}function lb(e){var t="",i=function(e){return e.ownerDocument.defaultView&&"function"===typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"===typeof getComputedStyle?getComputedStyle:null}(e);return i&&(t=i(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),"none"===t}var cb=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Rp({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return np+t}}(),ub=function(){var e="          <table:table-cell />\n",t=function(t,i,r){var n=[];n.push('      <table:table table:name="'+cp(i.SheetNames[r])+'" table:style-name="ta1">\n');var o=0,s=0,a=Wf(t["!ref"]||"A1"),l=t["!merges"]||[],c=0,u=Array.isArray(t);if(t["!cols"])for(s=0;s<=a.e.c;++s)n.push("        <table:table-column"+(t["!cols"][s]?' table:style-name="co'+t["!cols"][s].ods+'"':"")+"></table:table-column>\n");var d="",h=t["!rows"]||[];for(o=0;o<a.s.r;++o)d=h[o]?' table:style-name="ro'+h[o].ods+'"':"",n.push("        <table:table-row"+d+"></table:table-row>\n");for(;o<=a.e.r;++o){for(d=h[o]?' table:style-name="ro'+h[o].ods+'"':"",n.push("        <table:table-row"+d+">\n"),s=0;s<a.s.c;++s)n.push(e);for(;s<=a.e.c;++s){var g=!1,p={},f="";for(c=0;c!=l.length;++c)if(!(l[c].s.c>s)&&!(l[c].s.r>o)&&!(l[c].e.c<s)&&!(l[c].e.r<o)){l[c].s.c==s&&l[c].s.r==o||(g=!0),p["table:number-columns-spanned"]=l[c].e.c-l[c].s.c+1,p["table:number-rows-spanned"]=l[c].e.r-l[c].s.r+1;break}if(g)n.push("          <table:covered-table-cell/>\n");else{var m=_f({r:o,c:s}),v=u?(t[o]||[])[s]:t[m];if(v&&v.f&&(p["table:formula"]=cp(("of:="+v.f.replace(fC,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")),v.F&&v.F.slice(0,m.length)==m)){var C=Wf(v.F);p["table:number-matrix-columns-spanned"]=C.e.c-C.s.c+1,p["table:number-matrix-rows-spanned"]=C.e.r-C.s.r+1}if(v){switch(v.t){case"b":f=v.v?"TRUE":"FALSE",p["office:value-type"]="boolean",p["office:boolean-value"]=v.v?"true":"false";break;case"n":f=v.w||String(v.v||0),p["office:value-type"]="float",p["office:value"]=v.v||0;break;case"s":case"str":f=null==v.v?"":v.v,p["office:value-type"]="string";break;case"d":f=v.w||Qg(v.v).toISOString(),p["office:value-type"]="date",p["office:date-value"]=Qg(v.v).toISOString(),p["table:style-name"]="ce1";break;default:n.push(e);continue}var w=cp(f).replace(/  +/g,(function(e){return'<text:s text:c="'+e.length+'"/>'})).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>");if(v.l&&v.l.Target){var b=v.l.Target;"#"==(b="#"==b.charAt(0)?"#"+b.slice(1).replace(/\./,"!"):b).charAt(0)||b.match(/^\w+:/)||(b="../"+b),w=Ep("text:a",w,{"xlink:href":b.replace(/&/g,"&amp;")})}n.push("          "+Ep("table:table-cell",Ep("text:p",w,{}),p)+"\n")}else n.push(e)}}n.push("        </table:table-row>\n")}return n.push("      </table:table>\n"),n.join("")};return function(e,i){var r=[np],n=Rp({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),o=Rp({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});"fods"==i.bookType?(r.push("<office:document"+n+o+">\n"),r.push(Bm().replace(/office:document-meta/g,"office:meta"))):r.push("<office:document-content"+n+">\n"),function(e,t){e.push(" <office:automatic-styles>\n"),e.push('  <number:date-style style:name="N37" number:automatic-order="true">\n'),e.push('   <number:month number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push('   <number:day number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push("   <number:year/>\n"),e.push("  </number:date-style>\n");var i=0;t.SheetNames.map((function(e){return t.Sheets[e]})).forEach((function(t){if(t&&t["!cols"])for(var r=0;r<t["!cols"].length;++r)if(t["!cols"][r]){var n=t["!cols"][r];if(null==n.width&&null==n.wpx&&null==n.wch)continue;zv(n),n.ods=i;var o=t["!cols"][r].wpx+"px";e.push('  <style:style style:name="co'+i+'" style:family="table-column">\n'),e.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+o+'"/>\n'),e.push("  </style:style>\n"),++i}}));var r=0;t.SheetNames.map((function(e){return t.Sheets[e]})).forEach((function(t){if(t&&t["!rows"])for(var i=0;i<t["!rows"].length;++i)if(t["!rows"][i]){t["!rows"][i].ods=r;var n=t["!rows"][i].hpx+"px";e.push('  <style:style style:name="ro'+r+'" style:family="table-row">\n'),e.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+n+'"/>\n'),e.push("  </style:style>\n"),++r}})),e.push('  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">\n'),e.push('   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>\n'),e.push("  </style:style>\n"),e.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n'),e.push(" </office:automatic-styles>\n")}(r,e),r.push("  <office:body>\n"),r.push("    <office:spreadsheet>\n");for(var s=0;s!=e.SheetNames.length;++s)r.push(t(e.Sheets[e.SheetNames[s]],e,s));return r.push("    </office:spreadsheet>\n"),r.push("  </office:body>\n"),"fods"==i.bookType?r.push("</office:document>"):r.push("</office:document-content>"),r.join("")}}();function db(e,t){if("fods"==t.bookType)return ub(e,t);var i=rp(),r="",n=[],o=[];return ip(i,r="mimetype","application/vnd.oasis.opendocument.spreadsheet"),ip(i,r="content.xml",ub(e,t)),n.push([r,"text/xml"]),o.push([r,"ContentFile"]),ip(i,r="styles.xml",cb(e,t)),n.push([r,"text/xml"]),o.push([r,"StylesFile"]),ip(i,r="meta.xml",np+Bm()),n.push([r,"text/xml"]),o.push([r,"MetadataFile"]),ip(i,r="manifest.rdf",function(e){var t,i,r=[np];r.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n');for(var n=0;n!=e.length;++n)r.push(Nm(e[n][0],e[n][1])),r.push((t="",i=e[n][0],['  <rdf:Description rdf:about="'+t+'">\n','    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+i+'"/>\n',"  </rdf:Description>\n"].join("")));return r.push(Nm("","Document","pkg")),r.push("</rdf:RDF>"),r.join("")}(o)),n.push([r,"application/rdf+xml"]),ip(i,r="META-INF/manifest.xml",function(e){var t=[np];t.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n'),t.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n');for(var i=0;i<e.length;++i)t.push('  <manifest:file-entry manifest:full-path="'+e[i][0]+'" manifest:media-type="'+e[i][1]+'"/>\n');return t.push("</manifest:manifest>"),t.join("")}(n)),i}function hb(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function gb(e){return"undefined"!=typeof TextEncoder?(new TextEncoder).encode(e):Ih(wp(e))}function pb(e){var t=e.reduce((function(e,t){return e+t.length}),0),i=new Uint8Array(t),r=0;return e.forEach((function(e){i.set(e,r),r+=e.length})),i}function fb(e,t){var i=t?t[0]:0,r=127&e[i];e:if(e[i++]>=128){if(r|=(127&e[i])<<7,e[i++]<128)break e;if(r|=(127&e[i])<<14,e[i++]<128)break e;if(r|=(127&e[i])<<21,e[i++]<128)break e;if(r+=(127&e[i])*Math.pow(2,28),++i,e[i++]<128)break e;if(r+=(127&e[i])*Math.pow(2,35),++i,e[i++]<128)break e;if(r+=(127&e[i])*Math.pow(2,42),++i,e[i++]<128)break e}return t&&(t[0]=i),r}function mb(e){var t=new Uint8Array(7);t[0]=127&e;var i=1;e:if(e>127){if(t[i-1]|=128,t[i]=e>>7&127,++i,e<=16383)break e;if(t[i-1]|=128,t[i]=e>>14&127,++i,e<=2097151)break e;if(t[i-1]|=128,t[i]=e>>21&127,++i,e<=268435455)break e;if(t[i-1]|=128,t[i]=e/256>>>21&127,++i,e<=34359738367)break e;if(t[i-1]|=128,t[i]=e/65536>>>21&127,++i,e<=4398046511103)break e;t[i-1]|=128,t[i]=e/16777216>>>21&127,++i}return t.slice(0,i)}function vb(e){var t=0,i=127&e[t];e:if(e[t++]>=128){if(i|=(127&e[t])<<7,e[t++]<128)break e;if(i|=(127&e[t])<<14,e[t++]<128)break e;if(i|=(127&e[t])<<21,e[t++]<128)break e;i|=(127&e[t])<<28}return i}function Cb(e){for(var t=[],i=[0];i[0]<e.length;){var r,n=i[0],o=fb(e,i),s=7&o,a=0;if(0==(o=Math.floor(o/8)))break;switch(s){case 0:for(var l=i[0];e[i[0]++]>=128;);r=e.slice(l,i[0]);break;case 5:a=4,r=e.slice(i[0],i[0]+a),i[0]+=a;break;case 1:a=8,r=e.slice(i[0],i[0]+a),i[0]+=a;break;case 2:a=fb(e,i),r=e.slice(i[0],i[0]+a),i[0]+=a;break;default:throw new Error("PB Type ".concat(s," for Field ").concat(o," at offset ").concat(n))}var c={data:r,type:s};null==t[o]?t[o]=[c]:t[o].push(c)}return t}function wb(e){var t=[];return e.forEach((function(e,i){e.forEach((function(e){e.data&&(t.push(mb(8*i+e.type)),2==e.type&&t.push(mb(e.data.length)),t.push(e.data))}))})),pb(t)}function bb(e){for(var t,i=[],r=[0];r[0]<e.length;){var n=fb(e,r),o=Cb(e.slice(r[0],r[0]+n));r[0]+=n;var s={id:vb(o[1][0].data),messages:[]};o[2].forEach((function(t){var i=Cb(t.data),n=vb(i[3][0].data);s.messages.push({meta:i,data:e.slice(r[0],r[0]+n)}),r[0]+=n})),(null==(t=o[3])?void 0:t[0])&&(s.merge=vb(o[3][0].data)>>>0>0),i.push(s)}return i}function Sb(e){var t=[];return e.forEach((function(e){var i=[];i[1]=[{data:mb(e.id),type:0}],i[2]=[],null!=e.merge&&(i[3]=[{data:mb(+!!e.merge),type:0}]);var r=[];e.messages.forEach((function(e){r.push(e.data),e.meta[3]=[{type:0,data:mb(e.data.length)}],i[2].push({data:wb(e.meta),type:2})}));var n=wb(i);t.push(mb(n.length)),t.push(n),r.forEach((function(e){return t.push(e)}))})),pb(t)}function yb(e,t){if(0!=e)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var i=[0],r=fb(t,i),n=[];i[0]<t.length;){var o=3&t[i[0]];if(0!=o){var s=0,a=0;if(1==o?(a=4+(t[i[0]]>>2&7),s=(224&t[i[0]++])<<3,s|=t[i[0]++]):(a=1+(t[i[0]++]>>2),2==o?(s=t[i[0]]|t[i[0]+1]<<8,i[0]+=2):(s=(t[i[0]]|t[i[0]+1]<<8|t[i[0]+2]<<16|t[i[0]+3]<<24)>>>0,i[0]+=4)),n=[pb(n)],0==s)throw new Error("Invalid offset 0");if(s>n[0].length)throw new Error("Invalid offset beyond length");if(a>=s)for(n.push(n[0].slice(-s)),a-=s;a>=n[n.length-1].length;)n.push(n[n.length-1]),a-=n[n.length-1].length;n.push(n[0].slice(-s,-s+a))}else{var l=t[i[0]++]>>2;if(l<60)++l;else{var c=l-59;l=t[i[0]],c>1&&(l|=t[i[0]+1]<<8),c>2&&(l|=t[i[0]+2]<<16),c>3&&(l|=t[i[0]+3]<<24),l>>>=0,l++,i[0]+=c}n.push(t.slice(i[0],i[0]+l)),i[0]+=l}}var u=pb(n);if(u.length!=r)throw new Error("Unexpected length: ".concat(u.length," != ").concat(r));return u}function Rb(e){for(var t=[],i=0;i<e.length;){var r=e[i++],n=e[i]|e[i+1]<<8|e[i+2]<<16;i+=3,t.push(yb(r,e.slice(i,i+n))),i+=n}if(i!==e.length)throw new Error("data is not a valid framed stream!");return pb(t)}function Eb(e){for(var t=[],i=0;i<e.length;){var r=Math.min(e.length-i,268435455),n=new Uint8Array(4);t.push(n);var o=mb(r),s=o.length;t.push(o),r<=60?(s++,t.push(new Uint8Array([r-1<<2]))):r<=256?(s+=2,t.push(new Uint8Array([240,r-1&255]))):r<=65536?(s+=3,t.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(s+=4,t.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(s+=5,t.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),t.push(e.slice(i,i+r)),s+=r,n[0]=0,n[1]=255&s,n[2]=s>>8&255,n[3]=s>>16&255,i+=r}return pb(t)}function xb(e,t){var i=new Uint8Array(32),r=hb(i),n=12,o=0;switch(i[0]=5,e.t){case"n":i[1]=2,function(e,t,i){var r=Math.floor(0==i?0:Math.LOG10E*Math.log(Math.abs(i)))+6176-20,n=i/Math.pow(10,r-6176);e[t+15]|=r>>7,e[t+14]|=(127&r)<<1;for(var o=0;n>=1;++o,n/=256)e[t+o]=255&n;e[t+15]|=i>=0?0:128}(i,n,e.v),o|=1,n+=16;break;case"b":i[1]=6,r.setFloat64(n,e.v?1:0,!0),o|=2,n+=8;break;case"s":if(-1==t.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));i[1]=3,r.setUint32(n,t.indexOf(e.v),!0),o|=8,n+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(8,o,!0),i.slice(0,n)}function Tb(e,t){var i=new Uint8Array(32),r=hb(i),n=12,o=0;switch(i[0]=3,e.t){case"n":i[2]=2,r.setFloat64(n,e.v,!0),o|=32,n+=8;break;case"b":i[2]=6,r.setFloat64(n,e.v?1:0,!0),o|=32,n+=8;break;case"s":if(-1==t.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));i[2]=3,r.setUint32(n,t.indexOf(e.v),!0),o|=16,n+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(4,o,!0),i.slice(0,n)}function Fb(e){return fb(Cb(e)[1][0].data)}function Pb(e,t,i){var r,n,o,s;if(!(null==(r=e[6])?void 0:r[0])||!(null==(n=e[7])?void 0:n[0]))throw"Mutation only works on post-BNC storages!";if((null==(s=null==(o=e[8])?void 0:o[0])?void 0:s.data)&&vb(e[8][0].data)>0||!1)throw"Math only works with normal offsets";for(var a=0,l=hb(e[7][0].data),c=0,u=[],d=hb(e[4][0].data),h=0,g=[],p=0;p<t.length;++p)if(null!=t[p]){var f,m;switch(l.setUint16(2*p,c,!0),d.setUint16(2*p,h,!0),typeof t[p]){case"string":f=xb({t:"s",v:t[p]},i),m=Tb({t:"s",v:t[p]},i);break;case"number":f=xb({t:"n",v:t[p]},i),m=Tb({t:"n",v:t[p]},i);break;case"boolean":f=xb({t:"b",v:t[p]},i),m=Tb({t:"b",v:t[p]},i);break;default:throw new Error("Unsupported value "+t[p])}u.push(f),c+=f.length,g.push(m),h+=m.length,++a}else l.setUint16(2*p,65535,!0),d.setUint16(2*p,65535);for(e[2][0].data=mb(a);p<e[7][0].data.length/2;++p)l.setUint16(2*p,65535,!0),d.setUint16(2*p,65535,!0);return e[6][0].data=pb(u),e[3][0].data=pb(g),a}function Db(e){return function(t){for(var i=0;i!=e.length;++i){var r=e[i];void 0===t[r[0]]&&(t[r[0]]=r[1]),"n"===r[2]&&(t[r[0]]=Number(t[r[0]]))}}}function kb(e){Db([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Ab(e,t){return"ods"==t.bookType?db(e,t):"numbers"==t.bookType?function(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var i=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=Wf(i["!ref"]);r.s.r=r.s.c=0;var n=!1;r.e.c>9&&(n=!0,r.e.c=9),r.e.r>49&&(n=!0,r.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(Uf(r)));var o=Vb(i,{range:r,header:1}),s=["~Sh33tJ5~"];o.forEach((function(e){return e.forEach((function(e){"string"==typeof e&&s.push(e)}))}));var a={},l=[],c=Mg.read(t.numbers,{type:"base64"});c.FileIndex.map((function(e,t){return[e,c.FullPaths[t]]})).forEach((function(e){var t=e[0],i=e[1];2==t.type&&t.name.match(/\.iwa/)&&bb(Rb(t.content)).forEach((function(e){l.push(e.id),a[e.id]={deps:[],location:i,type:vb(e.messages[0].meta[1][0].data)}}))})),l.sort((function(e,t){return e-t}));var u=l.filter((function(e){return e>1})).map((function(e){return[e,mb(e)]}));c.FileIndex.map((function(e,t){return[e,c.FullPaths[t]]})).forEach((function(e){var t=e[0];e[1],t.name.match(/\.iwa/)&&bb(Rb(t.content)).forEach((function(e){e.messages.forEach((function(t){u.forEach((function(t){e.messages.some((function(e){return 11006!=vb(e.meta[1][0].data)&&function(e,t){e:for(var i=0;i<=e.length-t.length;++i){for(var r=0;r<t.length;++r)if(e[i+r]!=t[r])continue e;return!0}return!1}(e.data,t[1])}))&&a[t[0]].deps.push(e.id)}))}))}))}));for(var d,h=Mg.find(c,a[1].location),g=bb(Rb(h.content)),p=0;p<g.length;++p){var f=g[p];1==f.id&&(d=f)}var m=Fb(Cb(d.messages[0].data)[1][0].data);for(g=bb(Rb((h=Mg.find(c,a[m].location)).content)),p=0;p<g.length;++p)(f=g[p]).id==m&&(d=f);for(m=Fb(Cb(d.messages[0].data)[2][0].data),g=bb(Rb((h=Mg.find(c,a[m].location)).content)),p=0;p<g.length;++p)(f=g[p]).id==m&&(d=f);for(m=Fb(Cb(d.messages[0].data)[2][0].data),g=bb(Rb((h=Mg.find(c,a[m].location)).content)),p=0;p<g.length;++p)(f=g[p]).id==m&&(d=f);var v=Cb(d.messages[0].data);v[6][0].data=mb(r.e.r+1),v[7][0].data=mb(r.e.c+1);for(var C=Fb(v[46][0].data),w=Mg.find(c,a[C].location),b=bb(Rb(w.content)),S=0;S<b.length&&b[S].id!=C;++S);if(b[S].id!=C)throw"Bad ColumnRowUIDMapArchive";var y=Cb(b[S].messages[0].data);y[1]=[],y[2]=[],y[3]=[];for(var R=0;R<=r.e.c;++R){var E=[];E[1]=E[2]=[{type:0,data:mb(R+420690)}],y[1].push({type:2,data:wb(E)}),y[2].push({type:0,data:mb(R)}),y[3].push({type:0,data:mb(R)})}y[4]=[],y[5]=[],y[6]=[];for(var x=0;x<=r.e.r;++x)(E=[])[1]=E[2]=[{type:0,data:mb(x+726270)}],y[4].push({type:2,data:wb(E)}),y[5].push({type:0,data:mb(x)}),y[6].push({type:0,data:mb(x)});b[S].messages[0].data=wb(y),w.content=Eb(Sb(b)),w.size=w.content.length,delete v[46];var T=Cb(v[4][0].data);T[7][0].data=mb(r.e.r+1);var F=Fb(Cb(T[1][0].data)[2][0].data);if((b=bb(Rb((w=Mg.find(c,a[F].location)).content)))[0].id!=F)throw"Bad HeaderStorageBucket";var P=Cb(b[0].messages[0].data);for(x=0;x<o.length;++x){var D=Cb(P[2][0].data);D[1][0].data=mb(x),D[4][0].data=mb(o[x].length),P[2][x]={type:P[2][0].type,data:wb(D)}}b[0].messages[0].data=wb(P),w.content=Eb(Sb(b)),w.size=w.content.length;var k=Fb(T[2][0].data);if((b=bb(Rb((w=Mg.find(c,a[k].location)).content)))[0].id!=k)throw"Bad HeaderStorageBucket";for(P=Cb(b[0].messages[0].data),R=0;R<=r.e.c;++R)(D=Cb(P[2][0].data))[1][0].data=mb(R),D[4][0].data=mb(r.e.r+1),P[2][R]={type:P[2][0].type,data:wb(D)};b[0].messages[0].data=wb(P),w.content=Eb(Sb(b)),w.size=w.content.length;var A=Fb(T[4][0].data);!function(){for(var e,t=Mg.find(c,a[A].location),i=bb(Rb(t.content)),r=0;r<i.length;++r){var n=i[r];n.id==A&&(e=n)}var o=Cb(e.messages[0].data);o[3]=[];var l=[];s.forEach((function(e,t){l[1]=[{type:0,data:mb(t)}],l[2]=[{type:0,data:mb(1)}],l[3]=[{type:2,data:gb(e)}],o[3].push({type:2,data:wb(l)})})),e.messages[0].data=wb(o);var u=Eb(Sb(i));t.content=u,t.size=t.content.length}();var M=Cb(T[3][0].data),I=M[1][0];delete M[2];var L=Cb(I.data),O=Fb(L[2][0].data);!function(){for(var e,t=Mg.find(c,a[O].location),i=bb(Rb(t.content)),n=0;n<i.length;++n){var l=i[n];l.id==O&&(e=l)}var u=Cb(e.messages[0].data);delete u[6],delete M[7];var d=new Uint8Array(u[5][0].data);u[5]=[];for(var h=0,g=0;g<=r.e.r;++g){var p=Cb(d);h+=Pb(p,o[g],s),p[1][0].data=mb(g),u[5].push({data:wb(p),type:2})}u[1]=[{type:0,data:mb(r.e.c+1)}],u[2]=[{type:0,data:mb(r.e.r+1)}],u[3]=[{type:0,data:mb(h)}],u[4]=[{type:0,data:mb(r.e.r+1)}],e.messages[0].data=wb(u);var f=Eb(Sb(i));t.content=f,t.size=t.content.length}(),I.data=wb(L),T[3][0].data=wb(M),v[4][0].data=wb(T),d.messages[0].data=wb(v);var N=Eb(Sb(g));return h.content=N,h.size=h.content.length,c}(e,t):"xlsb"==t.bookType?function(e,t){aC=1024,e&&!e.SSF&&(e.SSF=Xg(qh));e&&e.SSF&&(Dg(),Pg(e.SSF),t.revssf=Hg(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF);t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ZC?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var i="xlsb"==t.bookType?"bin":"xml",r=gC.indexOf(t.bookType)>-1,n={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};kb(t=t||{});var o=rp(),s="",a=0;t.cellXfs=[],rw(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});if(ip(o,s="docProps/core.xml",zm(e.Props,t)),n.coreprops.push(s),Om(t.rels,2,s,Mm.CORE_PROPS),s="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var l=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,ip(o,s,Wm(e.Props)),n.extprops.push(s),Om(t.rels,3,s,Mm.EXT_PROPS),e.Custprops!==e.Props&&Ng(e.Custprops||{}).length>0&&(ip(o,s="docProps/custom.xml",Um(e.Custprops)),n.custprops.push(s),Om(t.rels,4,s,Mm.CUST_PROPS));for(a=1;a<=e.SheetNames.length;++a){var u={"!id":{}},d=e.Sheets[e.SheetNames[a-1]];(d||{})["!type"];if(ip(o,s="xl/worksheets/sheet"+a+"."+i,Mw(a-1,s,t,e,u)),n.sheets.push(s),Om(t.wbrels,-1,"worksheets/sheet"+a+"."+i,Mm.WS[0]),d){var h=d["!comments"],g=!1,p="";h&&h.length>0&&(ip(o,p="xl/comments"+a+"."+i,Iw(h,p,t)),n.comments.push(p),Om(u,-1,"../comments"+a+"."+i,Mm.CMNT),g=!0),d["!legacy"]&&g&&ip(o,"xl/drawings/vmlDrawing"+a+".vml",lC(a,d["!comments"])),delete d["!comments"],delete d["!legacy"]}u["!id"].rId1&&ip(o,Im(s),Lm(u))}null!=t.Strings&&t.Strings.length>0&&(ip(o,s="xl/sharedStrings."+i,function(e,t,i){return(".bin"===t.slice(-4)?Av:Dv)(e,i)}(t.Strings,s,t)),n.strs.push(s),Om(t.wbrels,-1,"sharedStrings."+i,Mm.SST));ip(o,s="xl/workbook."+i,function(e,t,i){return(".bin"===t.slice(-4)?Aw:Pw)(e,i)}(e,s,t)),n.workbooks.push(s),Om(t.rels,1,s,Mm.WB),ip(o,s="xl/theme/theme1.xml",nC(e.Themes,t)),n.themes.push(s),Om(t.wbrels,-1,"theme/theme1.xml",Mm.THEME),ip(o,s="xl/styles."+i,function(e,t,i){return(".bin"===t.slice(-4)?rC:Uv)(e,i)}(e,s,t)),n.styles.push(s),Om(t.wbrels,-1,"styles."+i,Mm.STY),e.vbaraw&&r&&(ip(o,s="xl/vbaProject.bin",e.vbaraw),n.vba.push(s),Om(t.wbrels,-1,"vbaProject.bin",Mm.VBA));return ip(o,s="xl/metadata."+i,function(e){return(".bin"===e.slice(-4)?oC:sC)()}(s)),n.metadata.push(s),Om(t.wbrels,-1,"metadata."+i,Mm.XLMETA),ip(o,"[Content_Types].xml",Am(n,t)),ip(o,"_rels/.rels",Lm(t.rels)),ip(o,"xl/_rels/workbook."+i+".rels",Lm(t.wbrels)),delete t.revssf,delete t.ssf,o}(e,t):Mb(e,t)}function Mb(e,t){aC=1024,e&&!e.SSF&&(e.SSF=Xg(qh)),e&&e.SSF&&(Dg(),Pg(e.SSF),t.revssf=Hg(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ZC?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var i="xml",r=gC.indexOf(t.bookType)>-1,n={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};kb(t=t||{});var o=rp(),s="",a=0;if(t.cellXfs=[],rw(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),ip(o,s="docProps/core.xml",zm(e.Props,t)),n.coreprops.push(s),Om(t.rels,2,s,Mm.CORE_PROPS),s="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var l=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,ip(o,s,Wm(e.Props)),n.extprops.push(s),Om(t.rels,3,s,Mm.EXT_PROPS),e.Custprops!==e.Props&&Ng(e.Custprops||{}).length>0&&(ip(o,s="docProps/custom.xml",Um(e.Custprops)),n.custprops.push(s),Om(t.rels,4,s,Mm.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,a=1;a<=e.SheetNames.length;++a){var d={"!id":{}},h=e.Sheets[e.SheetNames[a-1]];(h||{})["!type"];if(ip(o,s="xl/worksheets/sheet"+a+"."+i,lw(a-1,t,e,d)),n.sheets.push(s),Om(t.wbrels,-1,"worksheets/sheet"+a+"."+i,Mm.WS[0]),h){var g=h["!comments"],p=!1,f="";if(g&&g.length>0){var m=!1;g.forEach((function(e){e[1].forEach((function(e){1==e.T&&(m=!0)}))})),m&&(ip(o,f="xl/threadedComments/threadedComment"+a+"."+i,uC(g,u,t)),n.threadedcomments.push(f),Om(d,-1,"../threadedComments/threadedComment"+a+"."+i,Mm.TCMNT)),ip(o,f="xl/comments"+a+"."+i,cC(g)),n.comments.push(f),Om(d,-1,"../comments"+a+"."+i,Mm.CMNT),p=!0}h["!legacy"]&&p&&ip(o,"xl/drawings/vmlDrawing"+a+".vml",lC(a,h["!comments"])),delete h["!comments"],delete h["!legacy"]}d["!id"].rId1&&ip(o,Im(s),Lm(d))}return null!=t.Strings&&t.Strings.length>0&&(ip(o,s="xl/sharedStrings."+i,Dv(t.Strings,t)),n.strs.push(s),Om(t.wbrels,-1,"sharedStrings."+i,Mm.SST)),ip(o,s="xl/workbook."+i,Pw(e)),n.workbooks.push(s),Om(t.rels,1,s,Mm.WB),ip(o,s="xl/theme/theme1.xml",nC(e.Themes,t)),n.themes.push(s),Om(t.wbrels,-1,"theme/theme1.xml",Mm.THEME),ip(o,s="xl/styles."+i,Uv(e,t)),n.styles.push(s),Om(t.wbrels,-1,"styles."+i,Mm.STY),e.vbaraw&&r&&(ip(o,s="xl/vbaProject.bin",e.vbaraw),n.vba.push(s),Om(t.wbrels,-1,"vbaProject.bin",Mm.VBA)),ip(o,s="xl/metadata."+i,sC()),n.metadata.push(s),Om(t.wbrels,-1,"metadata."+i,Mm.XLMETA),u.length>1&&(ip(o,s="xl/persons/person.xml",function(e){var t=[np,Ep("personList",null,{xmlns:Ap,"xmlns:x":Hp[0]}).replace(/[\/]>/,">")];return e.forEach((function(e,i){t.push(Ep("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+i).slice(-12)+"}",userId:e,providerId:"None"}))})),t.push("</personList>"),t.join("")}(u)),n.people.push(s),Om(t.wbrels,-1,"persons/person.xml",Mm.PEOPLE)),ip(o,"[Content_Types].xml",Am(n,t)),ip(o,"_rels/.rels",Lm(t.rels)),ip(o,"xl/_rels/workbook.xml.rels",Lm(t.wbrels)),delete t.revssf,delete t.ssf,o}function Ib(e,t){var i="";switch((t||{}).type||"base64"){case"buffer":case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":i=Ph(e.slice(0,12));break;case"binary":i=e;break;default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[i.charCodeAt(0),i.charCodeAt(1),i.charCodeAt(2),i.charCodeAt(3),i.charCodeAt(4),i.charCodeAt(5),i.charCodeAt(6),i.charCodeAt(7)]}function Lb(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Og(t.file,Mg.write(e,{type:Dh?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Mg.write(e,t)}function Ob(e,t){var i={},r=Dh?"nodebuffer":"undefined"!==typeof Uint8Array?"array":"string";if(t.compression&&(i.compression="DEFLATE"),t.password)i.type=r;else switch(t.type){case"base64":i.type="base64";break;case"binary":i.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":i.type=r;break;default:throw new Error("Unrecognized type "+t.type)}var n=e.FullPaths?Mg.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[i.type]||i.type,compression:!!t.compression}):e.generate(i);if("undefined"!==typeof Deno&&"string"==typeof n){if("binary"==t.type||"base64"==t.type)return n;n=new Uint8Array(Lh(n))}return t.password&&"undefined"!==typeof encrypt_agile?Lb(encrypt_agile(n,t.password),t):"file"===t.type?Og(t.file,n):"string"==t.type?Cp(n):n}function Nb(e,t,i){i||(i="");var r=i+e;switch(t.type){case"base64":return Fh(wp(r));case"binary":return wp(r);case"string":return e;case"file":return Og(t.file,r,"utf8");case"buffer":return Dh?kh(r,"utf8"):"undefined"!==typeof TextEncoder?(new TextEncoder).encode(r):Nb(r,{type:"binary"}).split("").map((function(e){return e.charCodeAt(0)}))}throw new Error("Unrecognized type "+t.type)}function Bb(e,t){switch(t.type){case"string":case"base64":case"binary":for(var i="",r=0;r<e.length;++r)i+=String.fromCharCode(e[r]);return"base64"==t.type?Fh(i):"string"==t.type?Cp(i):i;case"file":return Og(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function Gb(e,t){Sh(),Fw(e);var i=Xg(t||{});if(i.cellStyles&&(i.cellNF=!0,i.sheetStubs=!0),"array"==i.type){i.type="binary";var r=Gb(e,i);return i.type="array",Lh(r)}var n=0;if(i.sheet&&(n="number"==typeof i.sheet?i.sheet:e.SheetNames.indexOf(i.sheet),!e.SheetNames[n]))throw new Error("Sheet not found: "+i.sheet+" : "+typeof i.sheet);switch(i.bookType||"xlsb"){case"xml":case"xlml":return Nb(Hw(e,i),i);case"slk":case"sylk":return Nb(Rv.from_sheet(e.Sheets[e.SheetNames[n]],i),i);case"htm":case"html":return Nb(ob(e.Sheets[e.SheetNames[n]],i),i);case"txt":return function(e,t){switch(t.type){case"base64":return Fh(e);case"binary":case"string":return e;case"file":return Og(t.file,e,"binary");case"buffer":return Dh?kh(e,"binary"):e.split("").map((function(e){return e.charCodeAt(0)}))}throw new Error("Unrecognized type "+t.type)}(jb(e.Sheets[e.SheetNames[n]],i),i);case"csv":return Nb(Ub(e.Sheets[e.SheetNames[n]],i),i,"\ufeff");case"dif":return Nb(Ev.from_sheet(e.Sheets[e.SheetNames[n]],i),i);case"dbf":return Bb(yv.from_sheet(e.Sheets[e.SheetNames[n]],i),i);case"prn":return Nb(Tv.from_sheet(e.Sheets[e.SheetNames[n]],i),i);case"rtf":return Nb(Lv.from_sheet(e.Sheets[e.SheetNames[n]],i),i);case"eth":return Nb(xv.from_sheet(e.Sheets[e.SheetNames[n]],i),i);case"fods":return Nb(db(e,i),i);case"wk1":return Bb(Fv.sheet_to_wk1(e.Sheets[e.SheetNames[n]],i),i);case"wk3":return Bb(Fv.book_to_wk3(e,i),i);case"biff2":i.biff||(i.biff=2);case"biff3":i.biff||(i.biff=3);case"biff4":return i.biff||(i.biff=4),Bb(eb(e,i),i);case"biff5":i.biff||(i.biff=5);case"biff8":case"xla":case"xls":return i.biff||(i.biff=8),function(e,t){var i=t||{};return Lb(Ww(e,i),i)}(e,i);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return function(e,t){var i=Xg(t||{});return Ob(Ab(e,i),i)}(e,i);default:throw new Error("Unrecognized bookType |"+i.bookType+"|")}}function Hb(e){if(!e.bookType){var t=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(e.bookType=t.slice(1)),e.bookType={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"}[e.bookType]||e.bookType}}function zb(e,t,i,r,n,o,s,a){var l=Gf(i),c=a.defval,u=a.raw||!Object.prototype.hasOwnProperty.call(a,"raw"),d=!0,h=1===n?[]:{};if(1!==n)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:i,enumerable:!1})}catch(m){h.__rowNum__=i}else h.__rowNum__=i;if(!s||e[i])for(var g=t.s.c;g<=t.e.c;++g){var p=s?e[i][g]:e[r[g]+l];if(void 0!==p&&void 0!==p.t){var f=p.v;switch(p.t){case"z":if(null==f)break;continue;case"e":f=0==f?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(null!=o[g]){if(null==f)if("e"==p.t&&null===f)h[o[g]]=null;else if(void 0!==c)h[o[g]]=c;else{if(!u||null!==f)continue;h[o[g]]=null}else h[o[g]]=u&&("n"!==p.t||"n"===p.t&&!1!==a.rawNumbers)?f:Yf(p,f,a);null!=f&&(d=!1)}}else{if(void 0===c)continue;null!=o[g]&&(h[o[g]]=c)}}return{row:h,isempty:d}}function Vb(e,t){if(null==e||null==e["!ref"])return[];var i={t:"n",v:0},r=0,n=1,o=[],s=0,a="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=null!=c.range?c.range:e["!ref"];switch(1===c.header?r=1:"A"===c.header?r=2:Array.isArray(c.header)?r=3:null==c.header&&(r=0),typeof u){case"string":l=jf(u);break;case"number":(l=jf(e["!ref"])).s.r=u;break;default:l=u}r>0&&(n=0);var d=Gf(l.s.r),h=[],g=[],p=0,f=0,m=Array.isArray(e),v=l.s.r,C=0,w={};m&&!e[v]&&(e[v]=[]);var b=c.skipHidden&&e["!cols"]||[],S=c.skipHidden&&e["!rows"]||[];for(C=l.s.c;C<=l.e.c;++C)if(!(b[C]||{}).hidden)switch(h[C]=zf(C),i=m?e[v][C]:e[h[C]+d],r){case 1:o[C]=C-l.s.c;break;case 2:o[C]=h[C];break;case 3:o[C]=c.header[C-l.s.c];break;default:if(null==i&&(i={w:"__EMPTY",t:"s"}),a=s=Yf(i,null,c),f=w[s]||0){do{a=s+"_"+f++}while(w[a]);w[s]=f,w[a]=1}else w[s]=1;o[C]=a}for(v=l.s.r+n;v<=l.e.r;++v)if(!(S[v]||{}).hidden){var y=zb(e,l,v,h,r,o,m,c);(!1===y.isempty||(1===r?!1!==c.blankrows:c.blankrows))&&(g[p++]=y.row)}return g.length=p,g}var _b=/"/g;function Wb(e,t,i,r,n,o,s,a){for(var l=!0,c=[],u="",d=Gf(i),h=t.s.c;h<=t.e.c;++h)if(r[h]){var g=a.dense?(e[i]||[])[h]:e[r[h]+d];if(null==g)u="";else if(null!=g.v){l=!1,u=""+(a.rawNumbers&&"n"==g.t?g.v:Yf(g,null,a));for(var p=0,f=0;p!==u.length;++p)if((f=u.charCodeAt(p))===n||f===o||34===f||a.forceQuotes){u='"'+u.replace(_b,'""')+'"';break}"ID"==u&&(u='"ID"')}else null==g.f||g.F?u="":(l=!1,(u="="+g.f).indexOf(",")>=0&&(u='"'+u.replace(_b,'""')+'"'));c.push(u)}return!1===a.blankrows&&l?null:c.join(s)}function Ub(e,t){var i=[],r=null==t?{}:t;if(null==e||null==e["!ref"])return"";var n=jf(e["!ref"]),o=void 0!==r.FS?r.FS:",",s=o.charCodeAt(0),a=void 0!==r.RS?r.RS:"\n",l=a.charCodeAt(0),c=new RegExp(("|"==o?"\\|":o)+"+$"),u="",d=[];r.dense=Array.isArray(e);for(var h=r.skipHidden&&e["!cols"]||[],g=r.skipHidden&&e["!rows"]||[],p=n.s.c;p<=n.e.c;++p)(h[p]||{}).hidden||(d[p]=zf(p));for(var f=0,m=n.s.r;m<=n.e.r;++m)(g[m]||{}).hidden||null!=(u=Wb(e,n,m,d,s,l,o,r))&&(r.strip&&(u=u.replace(c,"")),(u||!1!==r.blankrows)&&i.push((f++?a:"")+u));return delete r.dense,i.join("")}function jb(e,t){t||(t={}),t.FS="\t",t.RS="\n";var i=Ub(e,t);if("undefined"==typeof Rh||"string"==t.type)return i;var r=Rh.utils.encode(1200,i,"str");return String.fromCharCode(255)+String.fromCharCode(254)+r}function Kb(e,t,i){var r,n=i||{},o=+!n.skipHeader,s=e||{},a=0,l=0;if(s&&null!=n.origin)if("number"==typeof n.origin)a=n.origin;else{var c="string"==typeof n.origin?Vf(n.origin):n.origin;a=c.r,l=c.c}var u={s:{c:0,r:0},e:{c:l,r:a+t.length-1+o}};if(s["!ref"]){var d=jf(s["!ref"]);u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),-1==a&&(a=d.e.r+1,u.e.r=a+t.length-1+o)}else-1==a&&(a=0,u.e.r=t.length-1+o);var h=n.header||[],g=0;t.forEach((function(e,t){Ng(e).forEach((function(i){-1==(g=h.indexOf(i))&&(h[g=h.length]=i);var c=e[i],u="z",d="",p=_f({c:l+g,r:a+t+o});r=Yb(s,p),!c||"object"!==typeof c||c instanceof Date?("number"==typeof c?u="n":"boolean"==typeof c?u="b":"string"==typeof c?u="s":c instanceof Date?(u="d",n.cellDates||(u="n",c=Vg(c)),d=n.dateNF||qh[14]):null===c&&n.nullError&&(u="e",c=0),r?(r.t=u,r.v=c,delete r.w,delete r.R,d&&(r.z=d)):s[p]=r={t:u,v:c},d&&(r.z=d)):s[p]=c}))})),u.e.c=Math.max(u.e.c,l+h.length-1);var p=Gf(a);if(o)for(g=0;g<h.length;++g)s[zf(g+l)+p]={t:"s",v:h[g]};return s["!ref"]=Uf(u),s}function Yb(e,t,i){if("string"==typeof t){if(Array.isArray(e)){var r=Vf(t);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return Yb(e,_f("number"!=typeof t?t:{r:t,c:i||0}))}function qb(){return{SheetNames:[],Sheets:{}}}function Qb(e,t,i,r){var n=1;if(!i)for(;n<=65535&&-1!=e.SheetNames.indexOf(i="Sheet"+n);++n,i=void 0);if(!i||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(i)>=0){var o=i.match(/(^.*?)(\d+)$/);n=o&&+o[2]||0;var s=o&&o[1]||i;for(++n;n<=65535&&-1!=e.SheetNames.indexOf(i=s+n);++n);}if(Tw(i),e.SheetNames.indexOf(i)>=0)throw new Error("Worksheet with name |"+i+"| already exists!");return e.SheetNames.push(i),e.Sheets[i]=t,i}function $b(e,t,i){return t?(e.l={Target:t},i&&(e.l.Tooltip=i)):delete e.l,e}var Xb={encode_col:zf,encode_row:Gf,encode_cell:_f,encode_range:Uf,decode_col:Hf,decode_row:Bf,split_cell:function(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:Vf,decode_range:Wf,format_cell:Yf,sheet_add_aoa:Qf,sheet_add_json:Kb,sheet_add_dom:sb,aoa_to_sheet:$f,json_to_sheet:function(e,t){return Kb(null,e,t)},table_to_sheet:ab,table_to_book:function(e,t){return qf(ab(e,t),t)},sheet_to_csv:Ub,sheet_to_txt:jb,sheet_to_json:Vb,sheet_to_html:ob,sheet_to_formulae:function(e){var t,i="",r="";if(null==e||null==e["!ref"])return[];var n,o=jf(e["!ref"]),s="",a=[],l=[],c=Array.isArray(e);for(n=o.s.c;n<=o.e.c;++n)a[n]=zf(n);for(var u=o.s.r;u<=o.e.r;++u)for(s=Gf(u),n=o.s.c;n<=o.e.c;++n)if(i=a[n]+s,r="",void 0!==(t=c?(e[u]||[])[n]:e[i])){if(null!=t.F){if(i=t.F,!t.f)continue;r=t.f,-1==i.indexOf(":")&&(i=i+":"+i)}if(null!=t.f)r=t.f;else{if("z"==t.t)continue;if("n"==t.t&&null!=t.v)r=""+t.v;else if("b"==t.t)r=t.v?"TRUE":"FALSE";else if(void 0!==t.w)r="'"+t.w;else{if(void 0===t.v)continue;r="s"==t.t?"'"+t.v:""+t.v}}l[l.length]=i+"="+r}return l},sheet_to_row_object_array:Vb,sheet_get_cell:Yb,book_new:qb,book_append_sheet:Qb,book_set_sheet_visibility:function(e,t,i){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=function(e,t){if("number"==typeof t){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}if("string"==typeof t){var i=e.SheetNames.indexOf(t);if(i>-1)return i;throw new Error("Cannot find sheet name |"+t+"|")}throw new Error("Cannot find sheet |"+t+"|")}(e,t);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),i){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+i)}e.Workbook.Sheets[r].Hidden=i},cell_set_number_format:function(e,t){return e.z=t,e},cell_set_hyperlink:$b,cell_set_internal_link:function(e,t,i){return $b(e,"#"+t,i)},cell_add_comment:function(e,t,i){e.c||(e.c=[]),e.c.push({t:t,a:i||"SheetJS"})},sheet_set_array_formula:function(e,t,i,r){for(var n="string"!=typeof t?t:jf(t),o="string"==typeof t?t:Uf(t),s=n.s.r;s<=n.e.r;++s)for(var a=n.s.c;a<=n.e.c;++a){var l=Yb(e,s,a);l.t="n",l.F=o,delete l.v,s==n.s.r&&a==n.s.c&&(l.f=i,r&&(l.D=!0))}return e},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};ph.version;const Jb=e=>{let{rowData:t}=e;return(0,hh.jsx)("div",{className:"exportexcel-container",children:(0,hh.jsx)("button",{className:"exportexcel",onClick:()=>{const e=Xb.book_new(),i=Xb.json_to_sheet(t);Xb.book_append_sheet(e,i,"Data");const r=(new Date).toISOString().split("T")[0];!function(e,t,i){var r=i||{};r.type="file",r.file=t,Hb(r),Gb(e,r)}(e,"".concat(r,".xlsx"))},children:"Export to Excel"})})},Zb=e=>{let{isOpen:t,setIsOpen:i,editData:n,setRowData:o,setIsEdit:s,isAdd:a,setIsAdd:l}=e;const[u,d]=(0,r.useState)(n),[h,g]=(0,r.useState)({});(0,r.useEffect)((()=>{d(a?{}:n)}),[n,a]);const p=(e,t)=>{u&&d(c(c({},u),{},{[t]:e.target.value}))},f=()=>{d(n),i(!1),s(!1),l(!1)};return(0,hh.jsx)("div",{className:"flyout-container",children:(0,hh.jsx)("div",{className:"flyout ".concat(t?"open":""),children:(0,hh.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",padding:"1rem"},children:[(0,hh.jsxs)("div",{className:"flyout-content",style:{width:"100%"},children:[(0,hh.jsx)("h2",{className:"flyout-title",children:a?"Add Data":"Edit Data"}),(0,hh.jsxs)("div",{className:"form-container",children:[(0,hh.jsxs)("div",{className:"form-group",children:[(0,hh.jsx)("label",{children:"First Name"}),(0,hh.jsx)("input",{type:"text",value:(null===u||void 0===u?void 0:u.firstName)||"",onChange:e=>p(e,"firstName"),className:"input-field"}),h.firstName&&(0,hh.jsx)("span",{className:"error",children:h.firstName})]}),(0,hh.jsxs)("div",{className:"form-group",children:[(0,hh.jsx)("label",{children:"Last Name"}),(0,hh.jsx)("input",{type:"text",value:(null===u||void 0===u?void 0:u.lastName)||"",onChange:e=>p(e,"lastName"),className:"input-field"}),h.lastName&&(0,hh.jsx)("span",{className:"error",children:h.lastName})]}),(0,hh.jsxs)("div",{className:"form-group",children:[(0,hh.jsx)("label",{children:"Date Of Birth"}),(0,hh.jsx)("input",{type:"text",value:(null===u||void 0===u?void 0:u.dateOfBirth)||"",onChange:e=>p(e,"dateOfBirth"),className:"input-field"}),h.dateOfBirth&&(0,hh.jsx)("span",{className:"error",children:h.dateOfBirth})]}),(0,hh.jsxs)("div",{className:"form-group",children:[(0,hh.jsx)("label",{children:"Gender"}),(0,hh.jsx)("input",{type:"text",value:(null===u||void 0===u?void 0:u.gender)||"",onChange:e=>p(e,"gender"),className:"input-field"}),h.gender&&(0,hh.jsx)("span",{className:"error",children:h.gender})]}),(0,hh.jsxs)("div",{className:"form-group",children:[(0,hh.jsx)("label",{children:"Email"}),(0,hh.jsx)("input",{type:"text",value:(null===u||void 0===u?void 0:u.email)||"",onChange:e=>p(e,"email"),className:"input-field"}),h.email&&(0,hh.jsx)("span",{className:"error",children:h.email})]}),(0,hh.jsxs)("div",{className:"button-container",children:[(0,hh.jsx)("button",{onClick:()=>{if(u&&(()=>{const e={};return null!==u&&void 0!==u&&u.firstName||(e.firstName="First Name is required"),null!==u&&void 0!==u&&u.lastName||(e.lastName="Last Name is required"),null!==u&&void 0!==u&&u.dateOfBirth||(e.dateOfBirth="Date of Birth is required"),null!==u&&void 0!==u&&u.gender||(e.gender="Gender is required"),null!==u&&void 0!==u&&u.email?/\S+@\S+\.\S+/.test(u.email)||(e.email="Email format is invalid"):e.email="Email is required",g(e),0===Object.keys(e).length})()){const e=localStorage.getItem("data"),t=e?JSON.parse(e):[];if(a){let e=0;for(let r of t)r.id>e&&(e=r.id);u.id=e+1;const i=[...t,u];localStorage.setItem("data",JSON.stringify(i)),o(i)}else{const e=t.map((e=>e.id===u.id?u:e));localStorage.setItem("data",JSON.stringify(e)),o(e)}i(!1),s(!1),l(!1)}},className:"save-button",children:"Save"}),(0,hh.jsx)("button",{onClick:f,className:"cancel-button",children:"Cancel"})]})]})]}),(0,hh.jsx)("div",{style:{cursor:"pointer"},children:(0,hh.jsx)("p",{onClick:f,children:"Close"})})]})})})},eS=()=>(0,hh.jsx)("div",{className:"header",children:(0,hh.jsx)("p",{className:"header_txt",children:"Ag Grid Task"})}),tS=e=>{let{setRowData:t,rowData:i}=e;const[n,o]=(0,r.useState)("");return(0,hh.jsxs)("div",{className:"search-container",children:[(0,hh.jsx)("label",{children:"Search: "}),(0,hh.jsx)("input",{type:"text",placeholder:"Enter any text to filter.",value:n,onChange:e=>{const r=e.target.value;o(r);const n=i.filter((e=>Object.values(e).join(" ").toLowerCase().includes(r.toLowerCase())));if(t(n),!r){const e=JSON.parse(localStorage.getItem("data"));t(e)}}})]})};var iS={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},rS=r.createContext&&r.createContext(iS),nS=["attr","size","title"];function oS(e,t){if(null==e)return{};var i,r,n=function(e,t){if(null==e)return{};var i={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;i[r]=e[r]}return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)i=o[r],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function sS(){return sS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},sS.apply(this,arguments)}function aS(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function lS(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?aS(Object(i),!0).forEach((function(t){cS(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):aS(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function cS(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function uS(e){return e&&e.map(((e,t)=>r.createElement(e.tag,lS({key:t},e.attr),uS(e.child))))}function dS(e){return t=>r.createElement(hS,sS({attr:lS({},e.attr)},t),uS(e.child))}function hS(e){var t=t=>{var i,{attr:n,size:o,title:s}=e,a=oS(e,nS),l=o||t.size||"1em";return t.className&&(i=t.className),e.className&&(i=(i?i+" ":"")+e.className),r.createElement("svg",sS({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,n,a,{className:i,style:lS(lS({color:e.color||t.color},t.style),e.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),s&&r.createElement("title",null,s),e.children)};return void 0!==rS?r.createElement(rS.Consumer,null,(e=>t(e))):t(iS)}function gS(e){return dS({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M38.8 5.1C28.4-3.1 13.3-1.2 5.1 9.2S-1.2 34.7 9.2 42.9l592 464c10.4 8.2 25.5 6.3 33.7-4.1s6.3-25.5-4.1-33.7L525.6 386.7c39.6-40.6 66.4-86.1 79.9-118.4c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C465.5 68.8 400.8 32 320 32c-68.2 0-125 26.3-169.3 60.8L38.8 5.1zM223.1 149.5C248.6 126.2 282.7 112 320 112c79.5 0 144 64.5 144 144c0 24.9-6.3 48.3-17.4 68.7L408 294.5c8.4-19.3 10.6-41.4 4.8-63.3c-11.1-41.5-47.8-69.4-88.6-71.1c-5.8-.2-9.2 6.1-7.4 11.7c2.1 6.4 3.3 13.2 3.3 20.3c0 10.2-2.4 19.8-6.6 28.3l-90.3-70.8zM373 389.9c-16.4 6.5-34.3 10.1-53 10.1c-79.5 0-144-64.5-144-144c0-6.9 .5-13.6 1.4-20.2L83.1 161.5C60.3 191.2 44 220.8 34.5 243.7c-3.3 7.9-3.3 16.7 0 24.6c14.9 35.7 46.2 87.7 93 131.1C174.5 443.2 239.2 480 320 480c47.8 0 89.9-12.9 126.2-32.5L373 389.9z"},child:[]}]})(e)}function pS(e){return dS({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM144 256a144 144 0 1 1 288 0 144 144 0 1 1 -288 0zm144-64c0 35.3-28.7 64-64 64c-7.1 0-13.9-1.2-20.3-3.3c-5.5-1.8-11.9 1.6-11.7 7.4c.3 6.9 1.3 13.8 3.2 20.7c13.7 51.2 66.4 81.6 117.6 67.9s81.6-66.4 67.9-117.6c-11.1-41.5-47.8-69.4-88.6-71.1c-5.8-.2-9.2 6.1-7.4 11.7c2.1 6.4 3.3 13.2 3.3 20.3z"},child:[]}]})(e)}function fS(e){return dS({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M495.9 166.6c3.2 8.7 .5 18.4-6.4 24.6l-43.3 39.4c1.1 8.3 1.7 16.8 1.7 25.4s-.6 17.1-1.7 25.4l43.3 39.4c6.9 6.2 9.6 15.9 6.4 24.6c-4.4 11.9-9.7 23.3-15.8 34.3l-4.7 8.1c-6.6 11-14 21.4-22.1 31.2c-5.9 7.2-15.7 9.6-24.5 6.8l-55.7-17.7c-13.4 10.3-28.2 18.9-44 25.4l-12.5 57.1c-2 9.1-9 16.3-18.2 17.8c-13.8 2.3-28 3.5-42.5 3.5s-28.7-1.2-42.5-3.5c-9.2-1.5-16.2-8.7-18.2-17.8l-12.5-57.1c-15.8-6.5-30.6-15.1-44-25.4L83.1 425.9c-8.8 2.8-18.6 .3-24.5-6.8c-8.1-9.8-15.5-20.2-22.1-31.2l-4.7-8.1c-6.1-11-11.4-22.4-15.8-34.3c-3.2-8.7-.5-18.4 6.4-24.6l43.3-39.4C64.6 273.1 64 264.6 64 256s.6-17.1 1.7-25.4L22.4 191.2c-6.9-6.2-9.6-15.9-6.4-24.6c4.4-11.9 9.7-23.3 15.8-34.3l4.7-8.1c6.6-11 14-21.4 22.1-31.2c5.9-7.2 15.7-9.6 24.5-6.8l55.7 17.7c13.4-10.3 28.2-18.9 44-25.4l12.5-57.1c2-9.1 9-16.3 18.2-17.8C227.3 1.2 241.5 0 256 0s28.7 1.2 42.5 3.5c9.2 1.5 16.2 8.7 18.2 17.8l12.5 57.1c15.8 6.5 30.6 15.1 44 25.4l55.7-17.7c8.8-2.8 18.6-.3 24.5 6.8c8.1 9.8 15.5 20.2 22.1 31.2l4.7 8.1c6.1 11 11.4 22.4 15.8 34.3zM256 336a80 80 0 1 0 0-160 80 80 0 1 0 0 160z"},child:[]}]})(e)}const mS=e=>{let{onColumnVisibilityChange:t,columnVisibility:i}=e;const[n,o]=(0,r.useState)(!1);return(0,hh.jsxs)("div",{className:"setting-container",children:[(0,hh.jsxs)("div",{className:"setting",onClick:()=>{o((e=>!e))},children:[(0,hh.jsx)(fS,{}),(0,hh.jsx)("p",{children:"View Settings"})]}),n&&(0,hh.jsxs)("div",{className:"setting-option",children:[(0,hh.jsxs)("p",{onClick:()=>t("lastName"),style:{display:"flex",gap:"5px",padding:"15px 5px 0 5px"},children:[i.lastName?(0,hh.jsx)(pS,{}):(0,hh.jsx)(gS,{})," ",(0,hh.jsx)("p",{children:"Last Name"})]}),(0,hh.jsxs)("p",{onClick:()=>t("email"),style:{display:"flex",gap:"5px",padding:"15px 5px 0 5px"},children:[i.email?(0,hh.jsx)(pS,{}):(0,hh.jsx)(gS,{})," ",(0,hh.jsx)("p",{children:"Email"})]}),(0,hh.jsxs)("p",{onClick:()=>t("gender"),style:{display:"flex",gap:"5px",padding:"15px 5px 10px 5px"},children:[i.gender?(0,hh.jsx)(pS,{}):(0,hh.jsx)(gS,{})," ",(0,hh.jsx)("p",{children:"Gender"})]})]})]})};function vS(e){return dS({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 5.63l-2.34-2.34a.996.996 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83a.996.996 0 0 0 0-1.41z"},child:[]}]})(e)}function CS(e){return dS({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M32 464a48 48 0 0 0 48 48h288a48 48 0 0 0 48-48V128H32zm272-256a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zm-96 0a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zm-96 0a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zM432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16z"},child:[]}]})(e)}const wS={flex:1,minWidth:100,filter:!0},bS=[{id:1,firstName:"John",lastName:"Doe",gender:"Male",dateOfBirth:"1990-05-15",email:"john.doe@example.com"},{id:2,firstName:"Jane",lastName:"Smith",gender:"Female",dateOfBirth:"1985-08-22",email:"jane.smith@example.com"},{id:3,firstName:"Alice",lastName:"Johnson",gender:"Female",dateOfBirth:"1992-12-01",email:"alice.johnson@example.com"},{id:4,firstName:"Bob",lastName:"Williams",gender:"Male",dateOfBirth:"1980-02-18",email:"bob.williams@example.com"},{id:5,firstName:"Charlie",lastName:"Brown",gender:"Male",dateOfBirth:"1995-10-30",email:"charlie.brown@example.com"},{id:6,firstName:"Eve",lastName:"Davis",gender:"Female",dateOfBirth:"1998-07-12",email:"eve.davis@example.com"},{id:7,firstName:"Oscar",lastName:"Miller",gender:"Male",dateOfBirth:"1988-03-27",email:"oscar.miller@example.com"},{id:8,firstName:"Sophia",lastName:"Martinez",gender:"Female",dateOfBirth:"1993-11-08",email:"sophia.martinez@example.com"},{id:9,firstName:"John",lastName:"Doe",gender:"Male",dateOfBirth:"1990-05-15",email:"john.doe@example.com"},{id:10,firstName:"Jane",lastName:"Smith",gender:"Female",dateOfBirth:"1985-08-22",email:"jane.smith@example.com"},{id:11,firstName:"Alice",lastName:"Johnson",gender:"Female",dateOfBirth:"1992-12-01",email:"alice.johnson@example.com"},{id:12,firstName:"Bob",lastName:"Williams",gender:"Male",dateOfBirth:"1980-02-18",email:"bob.williams@example.com"},{id:13,firstName:"Charlie",lastName:"Brown",gender:"Male",dateOfBirth:"1995-10-30",email:"charlie.brown@example.com"},{id:14,firstName:"Eve",lastName:"Davis",gender:"Female",dateOfBirth:"1998-07-12",email:"eve.davis@example.com"},{id:15,firstName:"Oscar",lastName:"Miller",gender:"Male",dateOfBirth:"1988-03-27",email:"oscar.miller@example.com"},{id:16,firstName:"Sophia",lastName:"Martinez",gender:"Female",dateOfBirth:"1993-11-08",email:"sophia.martinez@example.com"},{id:17,firstName:"John",lastName:"Doe",gender:"Male",dateOfBirth:"1990-05-15",email:"john.doe@example.com"},{id:18,firstName:"Jane",lastName:"Smith",gender:"Female",dateOfBirth:"1985-08-22",email:"jane.smith@example.com"},{id:19,firstName:"Alice",lastName:"Johnson",gender:"Female",dateOfBirth:"1992-12-01",email:"alice.johnson@example.com"},{id:20,firstName:"Bob",lastName:"Williams",gender:"Male",dateOfBirth:"1980-02-18",email:"bob.williams@example.com"},{id:21,firstName:"Charlie",lastName:"Brown",gender:"Male",dateOfBirth:"1995-10-30",email:"charlie.brown@example.com"},{id:22,firstName:"Eve",lastName:"Davis",gender:"Female",dateOfBirth:"1998-07-12",email:"eve.davis@example.com"},{id:23,firstName:"Oscar",lastName:"Miller",gender:"Male",dateOfBirth:"1988-03-27",email:"oscar.miller@example.com"},{id:24,firstName:"Sophia",lastName:"Martinez",gender:"Female",dateOfBirth:"1993-11-08",email:"sophia.martinez@example.com"}],SS=()=>{const[e,t]=(0,r.useState)(!1),[i,n]=(0,r.useState)(),[o,s]=(0,r.useState)(!1),[a,l]=(0,r.useState)([]),[u,d]=(0,r.useState)(!1),[h,g]=(0,r.useState)({email:!0,gender:!0,lastName:!0}),p=nd,f=(e=>{let{setIsOpen:t,setEditData:i,setIsEdit:r,setRowData:n}=e;return[{headerName:"First Name",field:"firstName",suppressMovable:!0,suppressHeaderMenuButton:!0,onCellClicked:e=>{r(!0),t((t=>(i(e.data),!t)))}},{headerName:"Last Name",field:"lastName",onCellClicked:e=>{r(!0),t((t=>(i(e.data),!t)))}},{headerName:"Gender",field:"gender",onCellClicked:e=>{r(!0),t((t=>(i(e.data),!t)))}},{headerName:"Date of Birth",field:"dateOfBirth",suppressMovable:!0,suppressHeaderMenuButton:!0,onCellClicked:e=>{r(!0),t((t=>(i(e.data),!t)))}},{headerName:"Email",field:"email",onCellClicked:e=>{r(!0),t((t=>(i(e.data),!t)))}},{headerName:"Actions",suppressMovable:!0,suppressHeaderMenuButton:!0,cellRenderer:e=>null!==e&&void 0!==e&&e.data?(0,hh.jsxs)("div",{style:{display:"flex",gap:"2rem"},children:[(0,hh.jsx)("span",{style:{cursor:"pointer",color:"blue"},onClick:n=>{n.stopPropagation(),r(!0),t((t=>(i(e.data),!t)))},children:(0,hh.jsx)(vS,{size:20})}),(0,hh.jsx)("span",{style:{cursor:"pointer",color:"red"},onClick:t=>{t.stopPropagation();let i=JSON.parse(localStorage.getItem("data")).filter((t=>t.id!==e.data.id));n(i),localStorage.removeItem("data"),localStorage.setItem("data",JSON.stringify(i))},children:(0,hh.jsx)(CS,{})})]}):null}]})({setIsOpen:t,setEditData:n,setIsEdit:s,setRowData:l}),m=f.map((e=>"email"===e.field?c(c({},e),{},{hide:!h.email}):"gender"===e.field?c(c({},e),{},{hide:!h.gender}):"lastName"===e.field?c(c({},e),{},{hide:!h.lastName}):e));return(0,r.useEffect)((()=>{const e=localStorage.getItem("data");JSON.parse(e).length>1?l(JSON.parse(e)):(localStorage.setItem("data",JSON.stringify(bS)),l(JSON.parse(localStorage.getItem("data"))))}),[]),(0,hh.jsxs)("div",{className:"dashboard-container",children:[(0,hh.jsx)(Zb,{isOpen:e,setIsOpen:t,setRowData:l,rowData:a,editData:i,setIsEdit:s,isEdit:o,isAdd:u,setIsAdd:d}),(0,hh.jsxs)("div",{children:[(0,hh.jsx)("div",{className:"dashboard-header",children:(0,hh.jsx)(eS,{})}),(0,hh.jsxs)("div",{className:"dashboard-search-setting",children:[(0,hh.jsx)("div",{className:"search",children:(0,hh.jsx)(tS,{setRowData:l,rowData:a})}),(0,hh.jsx)("div",{className:"setting",children:(0,hh.jsx)(mS,{onColumnVisibilityChange:e=>{g((t=>c(c({},t),{},{[e]:!t[e]})))},columnVisibility:h})})]}),(0,hh.jsx)("div",{className:"dashboard-btn",children:(0,hh.jsxs)("div",{className:"btn",children:[(0,hh.jsx)(gh,{setIsOpen:t,setRowData:a,setIsAdd:d}),(0,hh.jsx)(Jb,{rowData:a})]})})]}),(0,hh.jsx)("div",{className:"ag-grid-container",children:(0,hh.jsx)("div",{className:"ag-grid",children:(0,hh.jsx)(dh,{tooltipShowDelay:500,columnDefs:m,defaultColDef:wS,rowData:a,theme:p,onColumnVisible:e=>{const t=c({},h),i=e.column;t[i.getColId()]=i.isVisible(),g(t)},pagination:!0,paginationPageSize:10,paginationPageSizeSelector:[10,15,20],domLayout:"normal"})})})]})};const yS=function(){return(0,hh.jsx)(SS,{})};n.createRoot(document.getElementById("root")).render((0,hh.jsx)(r.StrictMode,{children:(0,hh.jsx)(yS,{})}))})();
//# sourceMappingURL=main.7a79c6d3.js.map